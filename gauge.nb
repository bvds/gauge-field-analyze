Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7673569687731447`*^9, 
  3.7673569687738857`*^9}},ExpressionUUID->"2d04608b-9946-4c28-ab78-\
bf003fc0a624"],

Cell["\<\
Disable current notebook FileOutlineCache and CellChangeTimes.  See: \
https://stackoverflow.com/questions/2816628/version-control-of-mathematica-\
notebooks \
\>", "Text",ExpressionUUID->"c8b91507-5d14-469e-9fe1-3e146e8bfa42"],

Cell[CellGroupData[{

Cell["Library", \
"Title",ExpressionUUID->"31efac24-1e46-467d-80dc-82c8a417d0ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/groups.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/xml.m\>\""}], ";", 
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9a0d4813-a1f7-4da2-b04f-c5e675ccd229"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/lattice.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/linear-algebra.m\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b77e1fe3-7fc9-4148-8f48-850d8cbeb44e"],

Cell[CellGroupData[{

Cell["Lattice Saddle Point", \
"Section",ExpressionUUID->"c1f0fa5f-d477-4b31-adaa-328e09ba3c88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/minres1.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/minresqlp0.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/minres.m\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ef57838d-0bb7-4838-97af-b421b960b743"],

Cell["Random utility functions.", \
"Text",ExpressionUUID->"e00451bd-86c6-494c-9a1f-fc56e2272768"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"methodName", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "x", "]"}], "===", "List"}], ",", 
     RowBox[{"First", "[", "x", "]"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{"Tricky", ":", "  ", 
    RowBox[{"explicit", " ", 
     RowBox[{"Sequence", "[", "...", "]"}], " ", "will", " ", 
     RowBox[{"disappear", "!"}]}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"methodOptions", "[", "x_", "]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "x", "]"}], "===", "List"}], ",", 
       RowBox[{"Rest", "[", "x", "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"SetAttributes", "[", 
   RowBox[{"addTime", ",", 
    RowBox[{"{", 
     RowBox[{"HoldAll", ",", "SequenceHold"}], "}"}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"addTime", "[", 
    RowBox[{"timer_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{"SessionTime", "[", "]"}]}], ",", 
       RowBox[{"result", "=", "expr"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"timer", "+=", 
       RowBox[{
        RowBox[{"SessionTime", "[", "]"}], "-", "t1"}]}], ";", "result"}]}], 
    "]"}]}], ";", 
  RowBox[{
   RowBox[{"printMemory", "[", "n_", "]"}], ":=", 
   RowBox[{"EngineeringForm", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"ByteCount", "[", "n", "]"}], "]"}], ",", "3"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5c414282-b0e5-4c60-ba61-07e725b2a16c"],

Cell["Shift cutoff", \
"Text",ExpressionUUID->"f4a0d336-4a49-4007-b87e-040762657cc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"applyCutoff1", "::", "usage"}], "=", 
   "\"\<Rescale shifts for a single link.  Large zzz removes the cutoff.  \
When Norm[shift]=Pi, there is an inflection point in the associated color \
matrix meaning that the quadratic approximation becomes qualitatively \
different than the full matrix exponential.  Thus, we set shift to zero when \
Norm[shift]>=Pi.  The cutoff represents the Norm[shift] where the quadratic \
approximation *starts* breaking down.  In that case, we scale back the size \
of the shift.\>\""}], ";", 
  RowBox[{
   RowBox[{"applyCutoff1", "[", 
    RowBox[{
     RowBox[{"hess_", "?", "VectorQ"}], ",", "grad_", ",", 
     RowBox[{"cutoff_:", "1"}], ",", 
     RowBox[{"zzz_:", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"First", ",", " ", 
      RowBox[{
      "see", " ", "if", " ", "any", " ", "component", " ", "exceeds", " ", 
       "the", " ", 
       RowBox[{"cutoff", ".", "  ", "Thus"}]}], ",", " ", 
      RowBox[{
       RowBox[{"we", " ", "avoid", " ", "any", " ", "divide"}], "-", "by", 
       "-", 
       RowBox[{"zero", " ", 
        RowBox[{"error", "."}]}]}]}], " ", "*)"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tooBig", "=", 
        RowBox[{"Inner", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pi", " ", "zzz", " ", 
              RowBox[{"Abs", "[", "#1", "]"}]}], "\[LessEqual]", 
             RowBox[{"Abs", "[", "#2", "]"}]}], ")"}], "&"}], ",", "hess", 
          ",", "grad", ",", "Or"}], "]"}]}], ",", "shift"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"tooBig", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", "grad"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Otherwise", ",", " ", 
         RowBox[{
         "rescale", " ", "based", " ", "on", " ", "the", " ", "norm", " ", 
          "of", " ", "the", " ", "shift"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"shift", "=", 
         RowBox[{"grad", "/", "hess"}]}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Pi", " ", "zzz"}], "<=", 
           RowBox[{"Norm", "[", "shift", "]"}]}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"0", "&"}], ",", "shift"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Norm", "[", "shift", "]"}], "<", 
           RowBox[{"cutoff", "  ", "zzz"}]}], ",", " ", "shift", ",", "True", 
          ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cutoff", "/", 
             RowBox[{"Norm", "[", "shift", "]"}]}], ")"}], " ", "shift"}]}], 
         " ", "]"}]}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"shiftNorm", "[", "shifts_", "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"Norm", ",", 
      RowBox[{"Partition", "[", 
       RowBox[{"shifts", ",", 
        RowBox[{
         RowBox[{"nc", "^", "2"}], "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"compareVectors", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"shiftNorm", "[", "a", "]"}], ",", 
       RowBox[{"shiftNorm", "[", "b", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Norm", "[", "a", "]"}], ",", 
       RowBox[{"Norm", "[", "b", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"a", ".", "b"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", "a", "]"}], " ", 
        RowBox[{"Norm", "[", "b", "]"}]}], ")"}]}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"applyCutoff2", "::", "usage"}], "=", 
   "\"\<Rescale shifts on an entire lattice so that the largest norm of a \
shift on a link is less than the cutoff.\>\""}], ";", 
  RowBox[{
   RowBox[{"applyCutoff2", "[", 
    RowBox[{
     RowBox[{"shifts_", "?", "ArrayQ"}], ",", 
     RowBox[{"cutoff_:", "1"}], ",", 
     RowBox[{"zzz_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxNorm", "=", 
       RowBox[{"shiftNorm", "[", "shifts", "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"maxNorm", "<", 
        RowBox[{"cutoff", " ", "zzz"}]}], ",", "shifts", ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<applyCutoff2: rescale maxNorm \>\"", ",", "maxNorm", ",", 
          "\"\< to \>\"", ",", "cutoff"}], "]"}], ";", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cutoff", "/", "maxNorm"}], ")"}], " ", "shifts"}]}]}], 
      "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"applyCutoff3", "::", "usage"}], "=", 
   "\"\<Apply cutoff to the eigenspace of the Hessian.  In this case, the \
shifts are independent, but have no direct meaning. We infer the effect on \
the lattice links by using the rotation back onto the lattice.  We demand \
that the norm of the largest shift on any single link be less than the cutoff \
(default value Pi).\>\""}], ";", " ", 
  RowBox[{
   RowBox[{"applyCutoff3", "[", 
    RowBox[{"hess_", ",", "grad_", ",", "proj_", ",", 
     RowBox[{"cutoff_:", "Pi"}], ",", 
     RowBox[{"zzz_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"maxLinkShift", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"shiftNorm", ",", "proj"}], "]"}]}], ",", "result", ",", 
       RowBox[{"count", "=", "0"}], ",", 
       RowBox[{"doPairs", "=", "False"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"doPairs", ",", 
        RowBox[{
         RowBox[{"goodPairs0", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"badPairs0", "=", 
          RowBox[{"{", "}"}]}]}]}], "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cutoff", " ", "zzz", " ", 
              RowBox[{"Abs", "[", "#1", "]"}]}], "\[LessEqual]", 
             RowBox[{
              RowBox[{"Abs", "[", "#2", "]"}], " ", "#3"}]}], ",", 
            RowBox[{
             RowBox[{"count", "+=", "1"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{"doPairs", ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"badPairs0", ",", 
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}]}], "]"}], ";", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"doPairs", ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"goodPairs0", ",", 
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}]}], "]"}], ";", 
             RowBox[{"#2", "/", "#1"}]}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"hess", ",", "grad", ",", "maxLinkShift"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"count", ">", "0"}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<applyCutoff3:  \>\"", ",", "count", ",", "\"\< of \>\"", ",", 
          RowBox[{"Length", "[", "hess", "]"}], ",", " ", "\"\< zeros\>\""}], 
         "]"}]}], "]"}], ";", "result"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cutoffNullspace", "::", "usage"}], "=", 
   "\"\<Select vectors in proj that are associated with shifts that violate \
the cutoff.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cutoffNullspace", "[", 
    RowBox[{"hess_", ",", "grad_", ",", "proj_", ",", 
     RowBox[{"cutoff_:", "Pi"}], ",", 
     RowBox[{"zzz_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", 
       RowBox[{"count", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"zzz", "<", "Infinity"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"cutoff", " ", "zzz", " ", 
               RowBox[{"Abs", "[", "#1", "]"}]}], "\[LessEqual]", 
              RowBox[{
               RowBox[{"Abs", "[", "#2", "]"}], " ", 
               RowBox[{"shiftNorm", "[", "#3", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"count", "+=", "1"}], ";", "#3"}], ",", "Nothing"}], 
           "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"hess", ",", "grad", ",", "proj"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"count", ">", "0"}], " ", "||", "True"}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<cutoffNullSpace:  \>\"", ",", "count", ",", "\"\< of \>\"", ",", 
          RowBox[{"Length", "[", "hess", "]"}], ",", " ", "\"\< zeros\>\""}], 
         "]"}]}], "]"}], ";", "result"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"5d7f8e6d-f4d8-4eb8-9b13-e5badac257f5"],

Cell["\<\
Define basis for describing lattice-wide shifts.   The parameter fixed \
describes the type of shift:
fixed == -1:  All possible shifts, including those associated with gauge \
transformations.
fixed == 0:  Shifts on a smaller basis where all shifts associated with gauge \
transformations have been removed.
fixed > 0:  For each Polyakov loop in the direction = fixed, apply a constant \
shift. \
\>", "Text",ExpressionUUID->"f8e8e0fc-dd29-4b3b-9019-fdadd750a44d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nGrad", "::", "usage"}], "=", 
   "\"\<Size of basis for lattice-wide shifts.\>\""}], ";", 
  RowBox[{
   RowBox[{"nGrad", "[", "fixed_", "]"}], ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fixed", "<", "1"}], ",", "nd", ",", 
      RowBox[{"nd", "-", "1", "+", 
       RowBox[{"1", "/", 
        RowBox[{"latticeDimensions", "[", 
         RowBox[{"[", "fixed", "]"}], "]"}]}]}]}], "]"}], 
    RowBox[{"latticeVolume", "[", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}]}]}], ";", 
  RowBox[{
   RowBox[{"coords2grad", "::", "usage"}], "=", 
   "\"\<Use latticeIndex, rather than linearSiteIndex to order the sites, so \
we can handle fixed>0.\>\""}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"coords2grad", "[", "fixed_", "]"}], "[", 
    RowBox[{"dir_", ",", "coordsIn_", ",", "generator_"}], "]"}], ":=", 
   RowBox[{"generator", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], "*", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"coords", "=", "coordsIn"}], ",", 
         RowBox[{"dimensions", "=", "latticeDimensions"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fixed", "\[Equal]", "dir"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "fixed", "]"}], "]"}], "=", "1"}], ";", 
           RowBox[{
            RowBox[{"dimensions", "[", 
             RowBox[{"[", "fixed", "]"}], "]"}], "=", "1"}]}]}], "]"}], ";", 
        RowBox[{
         RowBox[{"latticeIndex", "[", 
          RowBox[{"coords", ",", "dimensions"}], "]"}], "-", "1", "+", " ", 
         RowBox[{
          RowBox[{"latticeVolume", "[", "]"}], "*", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"fixed", "\[Equal]", "k"}], ",", 
              RowBox[{"1", "/", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ",", "1"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"dir", "-", "1"}]}], "}"}]}], "]"}]}]}]}]}], 
      "]"}]}]}]}], ";", 
  RowBox[{
   RowBox[{"nGauge", "::", "usage"}], "=", 
   "\"\<Size of basis for a gauge tranformation.  fixed=0: arbitrary gauge \
tranformation.  fixed>0:  gauge transforms that preserve Axial gauge in the \
\\\"fixed\\\" direction.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nGauge", "[", "fixed_", "]"}], ":=", 
   RowBox[{
    RowBox[{"latticeVolume", "[", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fixed", "<", "1"}], ",", "1", ",", 
      RowBox[{"1", "/", 
       RowBox[{"latticeDimensions", "[", 
        RowBox[{"[", "fixed", "]"}], "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coords2gauge", "[", "fixed_", "]"}], "[", 
    RowBox[{"coordsIn_", ",", "generator_"}], "]"}], ":=", 
   RowBox[{"generator", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], "*", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"coords", "=", "coordsIn"}], ",", 
         RowBox[{"dimensions", "=", "latticeDimensions"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fixed", ">", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "fixed", "]"}], "]"}], "=", "1"}], ";", 
           RowBox[{
            RowBox[{"dimensions", "[", 
             RowBox[{"[", "fixed", "]"}], "]"}], "=", "1"}]}]}], "]"}], ";", 
        RowBox[{
         RowBox[{"latticeIndex", "[", 
          RowBox[{"coords", ",", "dimensions"}], "]"}], "-", "1"}]}]}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gradLinkTake", "[", "fixed_", "]"}], "[", 
    RowBox[{"dir_", ",", "coords_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "+", 
    RowBox[{
     RowBox[{"coords2grad", "[", "fixed", "]"}], "[", 
     RowBox[{"dir", ",", "coords", ",", "0"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"symAdd", "::", "index"}], "=", "\"\<Invalid index.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"symAdd", ",", "HoldFirst"}], "]"}], ";", 
  RowBox[{
   RowBox[{"symAdd", "[", 
    RowBox[{"m_", ",", "i_", ",", "j_", ",", "value_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{"m", ",", 
         RowBox[{"Key", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", "0.0"}], "]"}], "+", 
       "value"}]}], ";", 
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"{", 
        RowBox[{"j", ",", "i"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{"m", ",", 
         RowBox[{"Key", "[", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i"}], "}"}], "]"}], ",", "0."}], "]"}], "+", 
       "value"}]}]}], ")"}]}], ";", 
  RowBox[{"SetAttributes", "[", 
   RowBox[{"oneAdd", ",", "HoldFirst"}], "]"}], ";", 
  RowBox[{
   RowBox[{"oneAdd", "[", 
    RowBox[{"m_", ",", "i_", ",", "j_", ",", "value_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Lookup", "[", 
      RowBox[{"m", ",", 
       RowBox[{"Key", "[", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", "0.0"}], "]"}], "+", 
     "value"}]}]}], ";", 
  RowBox[{
   RowBox[{"reTrDot", "::", "usage"}], "=", 
   "\"\<Compute Re[Tr[a.b]] where a and b are color matrices.\>\""}], ";", 
  RowBox[{"reTrDot", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "_Complex", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "_Complex", ",", "2"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nc"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nc"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"nc", ",", "_Integer"}], "}"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"5bd1d1ed-8308-422e-833b-5a759d0efe63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gaugeTransformShifts", "::", "usage"}], "=", 
   "\"\<Return a matrix containing shifts associated with all possible \
infinitesimal gauge transformations.  The result is returned as a \
SparseArray.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaugeTransformShifts", "::", "axial"}], "=", 
   "\"\<Not Axial gauge.\>\""}], ";", 
  RowBox[{"SetAttributes", "[", 
   RowBox[{"gaugeTransformShifts", ",", "HoldFirst"}], "]"}], ";", 
  RowBox[{
   RowBox[{"gaugeTransformShifts", "[", 
    RowBox[{"rootGaugeField_", ",", 
     RowBox[{"fixed_:", "-", "1"}]}], "]"}], ":=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gaugeShifts", "=", 
          RowBox[{"Association", "[", "]"}]}], ",", 
         RowBox[{"gen", "=", 
          RowBox[{"suGenerators", "[", "]"}]}], ",", 
         RowBox[{"c2grad", "=", 
          RowBox[{"coords2grad", "[", "fixed", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"coords", "=", 
               RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", "gindex",
               ",", "index1", ",", "index2", ",", "u1", ",", "u2", ",", 
              "ugu1", ",", "ugu2"}], "}"}], ",", 
            RowBox[{
             RowBox[{"u1", "=", 
              RowBox[{
               RowBox[{"getLink", "[", "rootGaugeField", "]"}], "[", 
               RowBox[{"dir", ",", "coords"}], "]"}]}], ";", 
             RowBox[{"u2", "=", 
              RowBox[{
               RowBox[{"getLink", "[", "rootGaugeField", "]"}], "[", 
               RowBox[{"dir", ",", 
                RowBox[{"shift", "[", 
                 RowBox[{"dir", ",", "coords", ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Only", " ", "do", " ", "the", " ", "axial", " ", "direction", 
               " ", 
               RowBox[{"once", ".", " ", "But"}], " ", "verify", " ", "that", 
               " ", "lattice", " ", "is", " ", "in", " ", "Axial", " ", 
               RowBox[{"gauge", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dir", "==", "fixed"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "fixed", "]"}], "]"}], ">", "1"}]}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"AnyTrue", "[", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"u1", "-", "u2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "6"}]}]}], "&"}], ",", "2"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Message", "[", 
                    RowBox[{"gaugeTransformShifts", "::", "axial"}], "]"}], 
                   ";", 
                   RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
                RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"gindex", "=", 
              RowBox[{
               RowBox[{"coords2gauge", "[", "fixed", "]"}], "[", 
               RowBox[{"coords", ",", "gac"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"index1", "=", 
              RowBox[{"c2grad", "[", 
               RowBox[{"dir", ",", "coords", ",", "0"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ugu1", "=", 
              RowBox[{
               RowBox[{"ConjugateTranspose", "[", "u1", "]"}], ".", 
               RowBox[{"gen", "[", 
                RowBox[{"[", "gac", "]"}], "]"}], ".", "u1"}]}], ";", 
             RowBox[{"index2", "=", 
              RowBox[{"c2grad", "[", 
               RowBox[{"dir", ",", 
                RowBox[{"shift", "[", 
                 RowBox[{"dir", ",", "coords", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "]"}]}], ";", 
             RowBox[{"ugu2", "=", " ", 
              RowBox[{"u2", ".", 
               RowBox[{"gen", "[", 
                RowBox[{"[", "gac", "]"}], "]"}], ".", 
               RowBox[{"ConjugateTranspose", "[", "u2", "]"}]}]}], ";", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"oneAdd", "[", 
                 RowBox[{"gaugeShifts", ",", "gindex", ",", 
                  RowBox[{"index1", "+", "ac"}], ",", 
                  RowBox[{"2", " ", 
                   RowBox[{"reTrDot", "[", 
                    RowBox[{"ugu1", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ac", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
                
                RowBox[{"oneAdd", "[", 
                 RowBox[{"gaugeShifts", ",", "gindex", ",", 
                  RowBox[{"index2", "+", "ac"}], ",", 
                  RowBox[{
                   RowBox[{"-", "2"}], " ", 
                   RowBox[{"reTrDot", "[", 
                    RowBox[{"ugu2", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ac", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"ac", ",", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "kernel", ",", 
            RowBox[{"latticeVolume", "[", "]"}], ",", "$KernelCount"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"gac", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir", ",", "nd"}], "}"}]}], "]"}], ";", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "gaugeShifts", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nGauge", "[", "fixed", "]"}], ",", 
            RowBox[{"nGrad", "[", "fixed", "]"}]}], "}"}]}], "]"}]}]}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"kernel", ",", "$KernelCount"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"dynamicPart", "::", "usage"}], "=", 
   "\"\<Dynamic (non gauge shift) part of a shift vector.  This returns a \
function that can be applied to a shift vector.\>\""}], ";", 
  RowBox[{
   RowBox[{"dynamicPart", "::", "method"}], " ", "=", " ", 
   "\"\<Unknown method.\>\""}], ";", 
  RowBox[{
   RowBox[{"Options", "[", "dynamicPart", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"printDetails", "\[Rule]", "True"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"dynamicPart", "[", 
    RowBox[{"gaugeTransformShifts_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"printer", "=", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "printDetails", "]"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<dynamicPart memory:  \>\"", ",", 
            RowBox[{"printMemory", "[", "#", "]"}], ",", 
            "\"\<, gaugeTransform shifts \>\"", ",", 
            RowBox[{"printMemory", "[", "gaugeTransformShifts", "]"}], ",", 
            "\"\< (bytes) for \>\"", ",", 
            RowBox[{"methodName", "[", 
             RowBox[{"OptionValue", "[", "Method", "]"}], "]"}]}], "]"}]}], 
         "]"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "Method", "]"}], "===", 
        "\"\<Orthogonalize\>\""}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ortho", "=", 
           RowBox[{"SparseArray", "[", 
            RowBox[{"Chop", "[", 
             RowBox[{"Orthogonalize", "[", "gaugeTransformShifts", "]"}], 
             "]"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"printer", "[", "ortho", "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ortho", ".", "#"}], ")"}], ".", "ortho"}]}], ")"}], 
           "&"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"methodName", "[", 
         RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], "===", 
        "\"\<LeastSquares\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Since", " ", "the", " ", "gauge", " ", "fields", " ", "were", " ", 
          "calculated", " ", "in", " ", "single", " ", "precision"}], ",", 
         " ", 
         RowBox[{
         "we", " ", "choose", " ", "a", " ", "compatible", " ", "default", 
          " ", 
          RowBox[{"tolerance", ".", "  ", "\[IndentingNewLine]", "This"}], 
          " ", "tends", " ", "to", " ", "be", " ", "slow"}], ",", " ", 
         RowBox[{
         "since", " ", "the", " ", "matrix", " ", "is", " ", "poorly", " ", 
          RowBox[{"conditioned", ".", " ", "Maybe"}], " ", "use", " ", "some",
           " ", "kind", " ", "of", " ", "restart", " ", 
          RowBox[{"strategy", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Default", " ", "to", " ", "sparse", " ", "method"}], ",", 
         " ", 
         RowBox[{"using", " ", "Krylov"}], ",", " ", 
         RowBox[{"possibly", " ", 
          RowBox[{"QMR", "?"}]}]}], " ", "*)"}], 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"projection", "=", 
           RowBox[{
            RowBox[{"LeastSquares", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "gaugeTransformShifts", "]"}], ",", 
              "#", ",", 
              RowBox[{"methodOptions", "[", 
               RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], ",", 
              RowBox[{"Method", "\[Rule]", "\"\<Krylov\>\""}], ",", 
              RowBox[{"Tolerance", "\[Rule]", 
               RowBox[{"10.0", "^", 
                RowBox[{"-", "7"}]}]}]}], "]"}], "&"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"printer", "[", "projection", "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "-", 
             RowBox[{
              RowBox[{"projection", "[", "#", "]"}], ".", 
              "gaugeTransformShifts"}]}], ")"}], "&"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"In", " ", "the", " ", "dense", " ", "case"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "this", " ", "will", " ", "be", " ", "the", " ", "fastest", " ", 
            "since", " ", "the", " ", "matrix", " ", "factorization", " ", 
            "is", " ", "pre"}], "-", 
           RowBox[{
            RowBox[{"computed", ".", "  ", "If"}], " ", "Krylov", " ", "and", 
            " ", "\"\<Method\>\""}]}], "\[Rule]", 
          RowBox[{"\"\<ConjugateGradient\>\"", " ", "is", " ", "selected"}]}],
          ",", " ", 
         RowBox[{"this", " ", "is", " ", "quite", " ", 
          RowBox[{"slow", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"methodName", "[", 
         RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], "===", 
        "\"\<LinearSolve\>\""}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"linearSolve", "=", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{
             RowBox[{"gaugeTransformShifts", ".", 
              RowBox[{"Transpose", "[", "gaugeTransformShifts", "]"}]}], ",", 
             
             RowBox[{"methodOptions", "[", 
              RowBox[{"OptionValue", "[", "Method", "]"}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"printer", "[", "linearSolve", "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "-", 
             RowBox[{
              RowBox[{"linearSolve", "[", 
               RowBox[{"gaugeTransformShifts", ".", "#"}], "]"}], ".", 
              "gaugeTransformShifts"}]}], ")"}], "&"}]}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "Method", "]"}], "===", "Automatic"}], "||", 
        RowBox[{
         RowBox[{"methodName", "[", 
          RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], "===", 
         "\"\<MINRES\>\""}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Store", " ", "options"}], ",", " ", 
         RowBox[{
          RowBox[{"setting", " ", "any", " ", "default", " ", 
           RowBox[{"values", ".", "  ", "rTolerance"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"-", "13"}]}], " ", "produces"}], " ", "<", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"-", "7"}]}], " ", "errors", " ", "in", " ", "the", " ", 
            
            RowBox[{"projection", "."}]}]}]}]}], " ", "*)"}], 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"opts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"methodOptions", "[", 
              RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], ",", 
             RowBox[{"rTolerance", "\[Rule]", 
              RowBox[{"10", "^", 
               RowBox[{"-", "13"}]}]}]}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"printer", "[", "Null", "]"}], ";", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "-", 
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"minres", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"gaugeTransformShifts", ".", 
                    RowBox[{"(", 
                    RowBox[{"x", ".", "gaugeTransformShifts"}], ")"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"gaugeTransformShifts", ".", "#"}], ",", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"Sequence", ",", "opts"}], "]"}]}], "]"}], "]"}], 
              ".", "gaugeTransformShifts"}]}], ")"}], "&"}]}]}], "]"}], ",", 
       "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"dynamicPart", "::", "method"}], "]"}], ";", "$Failed"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"794ab239-2a09-44b9-9a82-0844d8a4d179"],

Cell["\<\
Whole lattice at once. 
fixedDir>0 applies the same shift to all links in each Polyakov loop winding \
around the lattice in direction fixedDir.  Thus, it is compatible with \
choosing an Axial gauge in that direction.  This should remove most gauge \
invariant shifts\
\>", "Text",ExpressionUUID->"04dced60-ef4e-4513-b1c5-a96d48f6a69e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "latticeHessian", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"allLinks", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"latticeHessian", "::", "usage"}], "=", 
   "\"\<Set allLinks to False to compare with single-link code.  Option \
fixedDir>0 will apply a constant shift to any link a given Polyakov loop \
winding in that direction, compatible with choosing an Axial gauge in that \
direction.\>\""}], ";", 
  RowBox[{
   RowBox[{"latticeHessian", "[", 
    RowBox[{"getRootLink_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fixed", "=", 
       RowBox[{"OptionValue", "[", "fixedDir", "]"}]}], "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Adding", " ", "elements", " ", "to", " ", "a", " ", "SparseArray", 
         " ", "one", " ", "at", " ", "a", " ", "time", " ", "is", " ", "very",
          " ", "inefficient", " ", "in", " ", "Mathematica"}], ";", " ", 
        RowBox[{
         RowBox[{"see", " ", 
          RowBox[{"https", ":"}]}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
             "questions"}], "/", "777"}], "/", "efficient"}], "-", "by", "-", 
          "element", "-", "updates", "-", "to", "-", 
          RowBox[{"sparsearrays", ".", "  ", "Instead"}]}]}]}], ",", " ", 
       RowBox[{
       "we", " ", "accumulate", " ", "Array", " ", "elements", " ", "in", " ",
         "an", " ", "Association", " ", "and", " ", "create", " ", "a", " ", 
        "SparseArray", " ", "at", " ", "the", " ", 
        RowBox[{"end", "."}]}]}], " ", "*)"}], 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hess", "=", 
          RowBox[{"Association", "[", "]"}]}], ",", 
         RowBox[{"grad", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"0.0", "&"}], ",", 
            RowBox[{"nGrad", "[", "fixed", "]"}]}], "]"}]}], ",", 
         RowBox[{"gen", "=", 
          RowBox[{
           RowBox[{"suGenerators", "[", "]"}], "+", 
           RowBox[{"0.0", " ", "I"}]}]}], ",", 
         RowBox[{"sym", "=", 
          RowBox[{
           RowBox[{"0.5", "*", 
            RowBox[{"Outer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", ".", "#2"}], "+", 
                 RowBox[{"#2", ".", "#1"}]}], ")"}], "&"}], ",", 
              RowBox[{"suGenerators", "[", "]"}], ",", 
              RowBox[{"suGenerators", "[", "]"}], ",", "1"}], "]"}]}], "+", 
           RowBox[{"0.0", " ", "I"}]}]}], ",", "coords"}], "}"}], ",", 
       RowBox[{
        RowBox[{"innerLoopTime", "=", "0"}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coords", "=", 
            RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Number", " ", "of", " ", "color", " ", "matrix", " ", 
             RowBox[{"multiplications", ":", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"number", " ", "of", " ", "plaquettes"}], ")"}], " ", 
               
               RowBox[{"(", 
                RowBox[{"16", " ", "+", " ", 
                 RowBox[{"nc", " ", 
                  RowBox[{"(", 
                   RowBox[{"16", " ", "+", " ", 
                    RowBox[{"10", " ", "nc"}]}], ")"}]}]}], ")"}]}]}]}], " ", 
            "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"c00", "=", 
                RowBox[{
                 RowBox[{"ConjugateTranspose", "[", 
                  RowBox[{"getRootLink", "[", 
                   RowBox[{"dir2", ",", "coords"}], "]"}], "]"}], ".", 
                 RowBox[{"getRootLink", "[", 
                  RowBox[{"dir1", ",", "coords"}], "]"}]}]}], ",", 
               RowBox[{"c10", "=", 
                RowBox[{
                 RowBox[{"getRootLink", "[", 
                  RowBox[{"dir1", ",", "coords"}], "]"}], ".", 
                 RowBox[{"getRootLink", "[", 
                  RowBox[{"dir2", ",", 
                   RowBox[{"shift", "[", 
                    RowBox[{"dir1", ",", "coords"}], "]"}]}], "]"}]}]}], ",", 
               
               RowBox[{"c11", "=", 
                RowBox[{
                 RowBox[{"getRootLink", "[", 
                  RowBox[{"dir2", ",", 
                   RowBox[{"shift", "[", 
                    RowBox[{"dir1", ",", "coords"}], "]"}]}], "]"}], ".", 
                 RowBox[{"ConjugateTranspose", "[", 
                  RowBox[{"getRootLink", "[", 
                   RowBox[{"dir1", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir2", ",", "coords"}], "]"}]}], "]"}], 
                  "]"}]}]}], ",", 
               RowBox[{"c01", "=", 
                RowBox[{
                 RowBox[{"ConjugateTranspose", "[", 
                  RowBox[{"getRootLink", "[", 
                   RowBox[{"dir1", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir2", ",", "coords"}], "]"}]}], "]"}], "]"}], 
                 ".", 
                 RowBox[{"ConjugateTranspose", "[", 
                  RowBox[{"getRootLink", "[", 
                   RowBox[{"dir2", ",", "coords"}], "]"}], "]"}]}]}], ",", 
               "s1", ",", "s2", ",", "s3", ",", "s4", ",", "v00", ",", "v10", 
               ",", "v11", ",", "v01", ",", "w1", ",", "w2", ",", "w3", ",", 
               "w4"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"s1", "=", 
               RowBox[{"c00", ".", "c10"}]}], ";", 
              RowBox[{"s2", "=", 
               RowBox[{"c10", ".", "c11"}]}], ";", 
              RowBox[{"s3", "=", 
               RowBox[{"c11", ".", "c01"}]}], ";", 
              RowBox[{"s4", "=", 
               RowBox[{"c01", ".", "c00"}]}], ";", 
              RowBox[{"v00", "=", 
               RowBox[{"c01", ".", "s1"}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                RowBox[{"s4", ".", "c10"}]}], " ", "*)"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"v10", "=", 
               RowBox[{"c00", ".", "s2"}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                RowBox[{"s1", ".", "c11"}]}], " ", "*)"}], ";", 
              RowBox[{"v11", "=", 
               RowBox[{"c10", ".", "s3"}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                RowBox[{"s2", ".", "c01"}]}], " ", "*)"}], ";", 
              RowBox[{"v01", "=", 
               RowBox[{"c11", ".", "s4"}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                RowBox[{"s3", ".", "c00"}]}], " ", "*)"}], ";", 
              RowBox[{"w1", "=", 
               RowBox[{"s4", ".", "s2"}]}], ";", 
              RowBox[{"w2", "=", 
               RowBox[{"s1", ".", "s3"}]}], ";", 
              RowBox[{"w3", "=", 
               RowBox[{"s2", ".", "s4"}]}], ";", 
              RowBox[{"w4", "=", 
               RowBox[{"s3", ".", "s1"}]}], ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"Block", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"g1", "=", 
                    RowBox[{
                    RowBox[{"coords2grad", "[", "fixed", "]"}], "[", 
                    RowBox[{"dir1", ",", "coords", ",", "ca1"}], "]"}]}], ",", 
                    RowBox[{"g2", "=", 
                    RowBox[{
                    RowBox[{"coords2grad", "[", "fixed", "]"}], "[", 
                    RowBox[{"dir2", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir1", ",", "coords"}], "]"}], ",", "ca1"}], 
                    "]"}]}], ",", 
                    RowBox[{"g3", "=", 
                    RowBox[{
                    RowBox[{"coords2grad", "[", "fixed", "]"}], "[", 
                    RowBox[{"dir1", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir2", ",", "coords"}], "]"}], ",", "ca1"}], 
                    "]"}]}], ",", 
                    RowBox[{"g4", "=", 
                    RowBox[{
                    RowBox[{"coords2grad", "[", "fixed", "]"}], "[", 
                    RowBox[{"dir2", ",", "coords", ",", "ca1"}], "]"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"ss42", "=", 
                    RowBox[{"s4", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}], ".", "s2"}]}], ",", 
                    RowBox[{"ss13", "=", 
                    RowBox[{"s1", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}], ".", "s3"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"vv0011", "=", 
                    RowBox[{"v00", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}], ".", "c11"}]}], ",", 
                    RowBox[{"vv1001", "=", 
                    RowBox[{"v10", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}], ".", "c01"}]}], ",", 
                    RowBox[{"vv1100", "=", 
                    RowBox[{"v11", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}], ".", "c00"}]}], ",", 
                    RowBox[{"vv0110", "=", 
                    RowBox[{"v01", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}], ".", "c10"}]}], ",", 
                    "t0", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"Negative", " ", "for", " ", "inverse", " ", 
                    RowBox[{"links", "."}]}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"grad", "[", 
                    RowBox[{"[", "g1", "]"}], "]"}], "+=", 
                    RowBox[{"-", 
                    RowBox[{"Im", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"w3", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
                   RowBox[{
                    RowBox[{"grad", "[", 
                    RowBox[{"[", "g3", "]"}], "]"}], "+=", 
                    RowBox[{"Im", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"w1", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"grad", "[", 
                    RowBox[{"[", "g2", "]"}], "]"}], "+=", 
                    RowBox[{"-", 
                    RowBox[{"Im", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"w4", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
                   RowBox[{
                    RowBox[{"grad", "[", 
                    RowBox[{"[", "g4", "]"}], "]"}], "+=", 
                    RowBox[{"Im", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"w2", ".", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "Time", " ", "is", " ", "dominated", " ", "by", " ", 
                    "matrix", " ", "construction"}], ",", " ", 
                    RowBox[{
                    "and", " ", "matrix", " ", "construction", " ", "is", " ",
                     "dominated", " ", "by", " ", "the", " ", "inner", " ", 
                    "color", " ", 
                    RowBox[{"loop", "."}]}]}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"t0", "=", 
                    RowBox[{"SessionTime", "[", "]"}]}], ";", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"gg1", "=", 
                    RowBox[{"g1", "-", "ca1", "+", "ca2"}]}], ",", 
                    RowBox[{"gg2", "=", 
                    RowBox[{"g2", "-", "ca1", "+", "ca2"}]}], ",", 
                    RowBox[{"gg3", "=", 
                    RowBox[{"g3", "-", "ca1", "+", "ca2"}]}], ",", 
                    RowBox[{"gg4", "=", 
                    RowBox[{"g4", "-", "ca1", "+", "ca2"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"oneAdd", "[", 
                    RowBox[{"hess", ",", "g1", ",", "gg1", ",", 
                    RowBox[{"-", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{
                    RowBox[{"sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ca1", ",", "ca2"}], "]"}], "]"}], ",", "w3"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"oneAdd", "[", 
                    RowBox[{"hess", ",", "g3", ",", "gg3", ",", 
                    RowBox[{"-", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{
                    RowBox[{"sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ca1", ",", "ca2"}], "]"}], "]"}], ",", "w1"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"oneAdd", "[", 
                    RowBox[{"hess", ",", "g2", ",", "gg2", ",", 
                    RowBox[{"-", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{
                    RowBox[{"sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ca1", ",", "ca2"}], "]"}], "]"}], ",", "w4"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"oneAdd", "[", 
                    RowBox[{"hess", ",", "g4", ",", "gg4", ",", 
                    RowBox[{"-", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{
                    RowBox[{"sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ca1", ",", "ca2"}], "]"}], "]"}], ",", "w2"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "allLinks", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"symAdd", "[", 
                    RowBox[{"hess", ",", "g1", ",", "gg3", ",", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{"ss42", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"symAdd", "[", 
                    RowBox[{"hess", ",", "g2", ",", "gg4", ",", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{"ss13", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"symAdd", "[", 
                    RowBox[{"hess", ",", "g2", ",", "gg3", ",", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{"vv0011", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"symAdd", "[", 
                    RowBox[{"hess", ",", "g3", ",", "gg4", ",", 
                    RowBox[{"-", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{"vv1001", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca2", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
                    RowBox[{"symAdd", "[", 
                    RowBox[{"hess", ",", "g4", ",", "gg1", ",", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{"vv1100", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"symAdd", "[", 
                    RowBox[{"hess", ",", "g1", ",", "gg2", ",", 
                    RowBox[{"-", 
                    RowBox[{"reTrDot", "[", 
                    RowBox[{"vv0110", ",", 
                    RowBox[{"gen", "[", 
                    RowBox[{"[", "ca2", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
                    "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ca2", ",", 
                    RowBox[{
                    RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
                   ";", 
                   RowBox[{"innerLoopTime", "+=", 
                    RowBox[{
                    RowBox[{"SessionTime", "[", "]"}], "-", "t0"}]}]}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ca1", ",", 
                  RowBox[{
                   RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}]}],
             "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"dir1", ",", 
            RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir2", ",", 
            RowBox[{"dir1", "+", "1"}], ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"SparseArray", "[", 
           RowBox[{"Normal", "[", "hess", "]"}], "]"}], ",", "grad"}], 
         "}"}]}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b0b43bc6-d299-49c3-b7ba-54683ab769a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findDelta", "::", "usage"}], "=", 
    "\"\<Given a Hessian matrix and a gradient, find the associated shifts \
using either dense or sparse matrix techniques.\>\""}], ";", 
   RowBox[{
    RowBox[{"Options", "[", "findDelta", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dynamicPartMethod", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Method", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"rescaleCutoff", "\[Rule]", "1"}], ",", 
      RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
      RowBox[{"storePairs", "\[Rule]", "False"}], ",", 
      RowBox[{"largeShiftSearch", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"storeBB", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Roughly", " ", "speaking"}], ",", " ", 
        RowBox[{
        "the", " ", "relative", " ", "error", " ", "in", " ", "the", " ", 
         "matrix", " ", "norm", " ", "of", " ", "the", " ", "link", " ", 
         "goes", " ", "as", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "shift", "]"}], "^", "3"}], "/", "48."}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cutoffValue", "\[Rule]", "2"}]}], "}"}]}], ";", 
   RowBox[{"(*", " ", 
    RowBox[{"Dense", " ", "matrix", " ", "version", " ", 
     RowBox[{"(", "default", ")"}]}], " ", "*)"}], 
   RowBox[{
    RowBox[{"findDelta", "[", 
     RowBox[{"hessIn_", ",", "gradIn_", ",", "gaugeTransformShifts_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"hess", ",", "grad", ",", 
         RowBox[{"zzz", "=", 
          RowBox[{"OptionValue", "[", "rescaleCutoff", "]"}]}], ",", 
         RowBox[{"cutoff", "=", 
          RowBox[{"OptionValue", "[", "cutoffValue", "]"}]}], ",", 
         RowBox[{"damping", "=", 
          RowBox[{"OptionValue", "[", "dampingFactor", "]"}]}], ",", "values",
          ",", "oo", ",", "proj", ",", "shifts"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "gaugeTransformShifts", "]"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Find", " ", "projection", " ", "onto", " ", "subspace", " ", 
            "orthogonal", " ", "to", " ", "all", " ", "gauge", " ", 
            RowBox[{"transforms", ".", "  ", "proj"}], " ", "is", " ", 
            RowBox[{"dense", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"proj", "=", 
            RowBox[{"NullSpace", "[", "gaugeTransformShifts", "]"}]}], ";", 
           RowBox[{"hess", "=", 
            RowBox[{"proj", ".", "hessIn", ".", 
             RowBox[{"Transpose", "[", "proj", "]"}]}]}], ";", 
           RowBox[{"grad", "=", 
            RowBox[{"proj", ".", "gradIn"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Normal", " ", 
            RowBox[{"case", ":", " ", 
             RowBox[{"no", " ", "projection", " ", "onto", " ", "the", " ", 
              RowBox[{"subspace", "."}]}]}]}], " ", "*)"}], 
          RowBox[{
           RowBox[{"proj", "=", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{"Length", "[", "hessIn", "]"}], ",", "SparseArray"}], 
             "]"}]}], ";", 
           RowBox[{"hess", "=", "hessIn"}], ";", 
           RowBox[{"grad", "=", "gradIn"}]}]}], "]"}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"values", ",", "oo"}], "}"}], "=", 
         RowBox[{"Eigensystem", "[", 
          RowBox[{"Normal", "[", "hess", "]"}], "]"}]}], ";", 
        RowBox[{"shifts", "=", 
         RowBox[{
          RowBox[{"applyCutoff3", "[", 
           RowBox[{"values", ",", 
            RowBox[{"oo", ".", "grad"}], ",", 
            RowBox[{"oo", ".", "proj"}], ",", "2", ",", "zzz"}], "]"}], ".", 
          "oo", ".", "proj"}]}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<shifts norms and rescale:  \>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"shiftNorm", "[", "shifts", "]"}], ",", 
            RowBox[{"Norm", "[", "shifts", "]"}], ",", 
            RowBox[{
             RowBox[{"shifts", ".", "hessIn", ".", "shifts"}], "/", 
             RowBox[{"shifts", ".", "gradIn"}]}]}], "}"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "storePairs", "]"}], ",", 
          RowBox[{
           RowBox[{"hess0", "=", "hess"}], ";", 
           RowBox[{"grad0", "=", "grad"}], ";", 
           RowBox[{"oo0", "=", "oo"}], ";", 
           RowBox[{"pairs0", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"values", ",", 
               RowBox[{"oo", ".", "grad"}]}], "}"}], "]"}]}], ";", 
           RowBox[{"proj0", "=", "proj"}], ";", 
           RowBox[{"shifts0", "=", "shifts"}]}]}], "]"}], ";", 
        RowBox[{
         RowBox[{"-", "damping"}], " ", 
         RowBox[{"applyCutoff2", "[", 
          RowBox[{"shifts", ",", "cutoff", ",", "zzz"}], "]"}]}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"OptionValue", "[", "Method", "]"}], "===", "Automatic"}], "||", 
      RowBox[{
       RowBox[{"OptionValue", "[", "Method", "]"}], "===", 
       "\"\<Dense\>\""}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MINRES", "/", "MINRES"}], "-", 
    RowBox[{"QLP", " ", 
     RowBox[{"version", "."}]}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"minresLabels", "=", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<MINRES\>\"", "\[Rule]", "minres"}], ",", 
      RowBox[{"\"\<MINRES1\>\"", "\[Rule]", "minres1"}], ",", 
      RowBox[{"\"\<MINRES-QLP\>\"", "\[Rule]", "minresqlp0"}], ",", 
      RowBox[{"\"\<MINRES-QLP0\>\"", "\[Rule]", "minresqlp0"}]}], "]"}]}], 
   ";", 
   RowBox[{
    RowBox[{"findDelta", "[", 
     RowBox[{"hess_", ",", "grad_", ",", "gaugeTransformShifts_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zzz", "=", 
          RowBox[{"OptionValue", "[", "rescaleCutoff", "]"}]}], ",", 
         RowBox[{"minresFun", "=", 
          RowBox[{"minresLabels", "[", 
           RowBox[{"methodName", "[", 
            RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], "]"}]}], ",", 
         
         RowBox[{"cutoff", "=", 
          RowBox[{"OptionValue", "[", "cutoffValue", "]"}]}], ",", 
         RowBox[{"damping", "=", 
          RowBox[{"OptionValue", "[", "dampingFactor", "]"}]}], ",", "result",
          ",", "shifts", ",", "dp", ",", "dp0", ",", "smallProj", ",", 
         "smallProj0", ",", 
         RowBox[{"tinit", "=", 
          RowBox[{"SessionTime", "[", "]"}]}], ",", 
         RowBox[{"tdp", "=", "0"}], ",", 
         RowBox[{"tsp", "=", "0"}], ",", 
         RowBox[{"tdot", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dp0", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatrixQ", "[", "gaugeTransformShifts", "]"}], ",", 
           RowBox[{"dynamicPart", "[", 
            RowBox[{"gaugeTransformShifts", ",", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"OptionValue", "[", "dynamicPartMethod", "]"}]}]}], 
            "]"}], ",", "Identity"}], "]"}]}], ";", 
        RowBox[{"Clear", "[", "bb0", "]"}], ";", 
        RowBox[{"bb0", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"dp", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"OptionValue", "[", "storeBB", "]"}], "\[Equal]", 
               "True"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"bb0", ",", "#"}], "]"}]}], "]"}], ";", 
            RowBox[{"addTime", "[", 
             RowBox[{"tdp", ",", 
              RowBox[{"dp0", "[", "#", "]"}]}], "]"}]}], ")"}], "&"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Calculate", " ", "eigenvectors", " ", "associated", " ", "with", 
           " ", "shifts", " ", "that", " ", "are", " ", "too", " ", 
           RowBox[{"large", ".", "  ", "Since"}]}], ",", " ", 
          RowBox[{"the", " ", "Mma", " ", "routine", " ", 
           RowBox[{"Eigensystem", "[", "...", "]"}], " ", 
           RowBox[{"doesn", "'"}], "t", " ", "allow", " ", "the", " ", 
           "matrix", " ", "to", " ", "be", " ", "given", " ", "as", " ", "a", 
           " ", "function"}], ",", " ", 
          RowBox[{
           RowBox[{"we", " ", "use", " ", 
            RowBox[{"ersatzLanczos", "[", "]"}], " ", "as", " ", "a", " ", 
            "work"}], "-", 
           RowBox[{"around", "."}]}]}], " ", "*)"}], 
        RowBox[{"smallProj0", "=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vals", ",", "vecs", ",", 
             RowBox[{"nsmall", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"OptionValue", "[", "largeShiftSearch", "]"}], "=!=",
                  "Automatic"}], ",", 
                RowBox[{"OptionValue", "[", "largeShiftSearch", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"This", " ", "estimate", " ", "is", " ", "ad"}], 
                  "-", 
                  RowBox[{
                   RowBox[{"hoc", ".", "  ", "Perhaps"}], " ", "one", " ", 
                   "could", " ", "use", " ", "the", " ", "distribution", " ", 
                   "of", " ", 
                   RowBox[{"pairs", "?"}]}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "grad", "]"}], "/", "10"}], "]"}]}], 
               "]"}]}]}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
             RowBox[{"ersatzLanczos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dp", "[", 
                 RowBox[{"addTime", "[", 
                  RowBox[{"tdot", ",", 
                   RowBox[{"hess", ".", "#"}]}], "]"}], "]"}], "&"}], ",", 
               RowBox[{"Length", "[", "grad", "]"}], ",", 
               RowBox[{"eigenPairs", "->", 
                RowBox[{"-", "nsmall"}]}], ",", 
               RowBox[{"initialVector", "\[Rule]", "grad"}], ",", 
               RowBox[{"maxIterations", "\[Rule]", 
                RowBox[{"2", " ", "nsmall"}]}], ",", 
               RowBox[{"printDetails", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
            
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"largeShiftSpace", "=", 
                RowBox[{"cutoffNullspace", "[", 
                 RowBox[{"vals", ",", 
                  RowBox[{"vecs", ".", "grad"}], ",", "vecs", ",", "2", ",", 
                  RowBox[{"OptionValue", "[", "rescaleCutoff", "]"}]}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "largeShiftSpace", "]"}], ">", "0"}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"largeShiftSpace", ".", "#"}], ")"}], ".", 
                    "largeShiftSpace"}]}], ")"}], "&"}], ",", "Identity"}], 
               "]"}]}], "]"}]}]}], "]"}]}], ";", 
        RowBox[{"smallProj", "=", 
         RowBox[{
          RowBox[{"addTime", "[", 
           RowBox[{"tsp", ",", 
            RowBox[{"smallProj0", "[", "#", "]"}]}], "]"}], "&"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Call", " ", "the", " ", "appropriate", " ", "MINRES", " ", 
           "routine"}], ",", " ", 
          RowBox[{"setting", " ", "some", " ", "default", " ", 
           RowBox[{"values", "."}]}]}], " ", "*)"}], 
        RowBox[{"result", "=", 
         RowBox[{"minresFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"smallProj", "[", 
             RowBox[{"dp", "[", 
              RowBox[{"addTime", "[", 
               RowBox[{"tdot", ",", 
                RowBox[{"hess", ".", "#"}]}], "]"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"smallProj", "[", 
            RowBox[{"dp", "[", "grad", "]"}], "]"}], ",", 
           RowBox[{"methodOptions", "[", 
            RowBox[{"OptionValue", "[", "Method", "]"}], "]"}], ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"Sequence", ",", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"localSize", "\[Rule]", "5000"}], ",", " ", 
                 RowBox[{"printDetails", "\[Rule]", "1"}]}], "}"}], ",", 
               RowBox[{"Options", "[", "minresFun", "]"}]}], "]"}]}], "]"}]}],
           "]"}]}], ";", 
        RowBox[{"shifts", "=", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Verify", " ", "result", " ", "is", " ", "in", " ", "the", " ", 
          "subspace"}], " ", "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Result overlap with small shift subspace, dynamicPart, and \
both:  \>\"", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"shifts", ".", 
                RowBox[{"smallProj", "[", "shifts", "]"}]}], ",", 
               RowBox[{"shifts", ".", 
                RowBox[{"dp", "[", "shifts", "]"}]}], ",", 
               RowBox[{"shifts", ".", 
                RowBox[{"smallProj", "[", 
                 RowBox[{"dp", "[", "shifts", "]"}], "]"}]}]}], "}"}], "/", 
             RowBox[{"shifts", ".", "shifts"}]}]}], "]"}]}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<findDelta time (seconds):  dynamic part=\>\"", ",", "tdp", ",", 
          "\"\<, small shifts=\>\"", ",", "tsp", ",", "\"\<, A=\>\"", ",", 
          "tdot", ",", "\"\<, total=\>\"", ",", " ", 
          RowBox[{
           RowBox[{"SessionTime", "[", "]"}], "-", "tinit"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "storePairs", "]"}], ",", 
          RowBox[{
           RowBox[{"hess0", "=", "hess"}], ";", 
           RowBox[{"grad0", "=", "grad"}], ";", 
           RowBox[{"oo0", "=", "None"}], ";", 
           RowBox[{"pairs0", "=", "None"}], ";", 
           RowBox[{"proj0", "=", "None"}], ";", 
           RowBox[{"shifts0", "=", "shifts"}]}]}], "]"}], ";", 
        RowBox[{
         RowBox[{"-", "damping"}], " ", 
         RowBox[{"applyCutoff2", "[", 
          RowBox[{"shifts", ",", "cutoff", ",", "zzz"}], "]"}]}]}]}], "]"}], "/;", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"minresLabels", ",", 
       RowBox[{"methodName", "[", 
        RowBox[{"OptionValue", "[", "Method", "]"}], "]"}]}], "]"}]}]}], 
   ";"}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"59df4277-22af-4370-8af9-f53dd8cdb61a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"applyDelta", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applyDelta", "[", 
    RowBox[{"tgf_", ",", "delta_", ",", "fixed_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gradMap", "=", 
       RowBox[{"gradLinkTake", "[", "fixed", "]"}]}], "}"}], ",", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"coords", "=", 
           RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"tgf", "[", 
           RowBox[{"[", 
            RowBox[{"dir", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"getLink", "[", "tgf", "]"}], "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ".", 
           RowBox[{"MatrixExp", "[", 
            RowBox[{"I", " ", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"delta", ",", 
                RowBox[{"gradMap", "[", 
                 RowBox[{"dir", ",", "coords"}], "]"}]}], "]"}], ".", " ", 
              RowBox[{"suGenerators", "[", "]"}]}]}], "]"}], ".", 
           RowBox[{
            RowBox[{"getLink", "[", "tgf", "]"}], "[", 
            RowBox[{"dir", ",", "coords"}], "]"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"6ebbe3c8-a687-41ca-ad1f-83d076e221ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeSaddlePointStep", "::", "usage"}], "=", 
    "\"\<Setting the option fixedDir=0 will use a projection onto the \
subspace orthogonal to all gauge transforms.  This should be the most correct \
method.  Can apply this to both dense and sparse systems.\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "For", " ", "passing", " ", "options", " ", "through", " ", "to", " ", 
     RowBox[{
     "subfunctions", ":", "  ", "\[IndentingNewLine]", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "353"}], "/", "functions"}], "-", "with", "-", 
     RowBox[{"options", "/"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "latticeSaddlePointStep", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "findDelta", "]"}], ",", 
     RowBox[{"Options", "[", "latticeHessian", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hess", ",", "grad", ",", "delta", ",", 
       RowBox[{"tmpGaugeField", "=", 
        RowBox[{"makeRootLattice", "[", "]"}]}], ",", 
       RowBox[{"t0", "=", 
        RowBox[{"SessionTime", "[", "]"}]}], ",", "t1", ",", "t2", ",", 
       "t3"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"hess", ",", "grad"}], "}"}], "=", 
       RowBox[{"latticeHessian", "[", 
        RowBox[{
         RowBox[{"getLink", "[", "tmpGaugeField", "]"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", 
             RowBox[{"Options", "[", "latticeHessian", "]"}]}], "]"}]}], 
          "]"}]}], "]"}]}], ";", 
      RowBox[{"t1", "=", 
       RowBox[{"SessionTime", "[", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Debug", " ", "prints"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{"False", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<hessian difference:  \>\"", ",", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "hess", "]"}], "-", "hess0"}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<gradient difference:  \>\"", ",", 
           RowBox[{"Chop", "[", 
            RowBox[{"grad", "-", "gradient0"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<hessian:\>\"", ",", 
           RowBox[{"Normal", "[", "hess", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<gradient:  \>\"", ",", "grad"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<hessian, first link:  \>\"", ",", 
           RowBox[{"Normal", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"hess", ",", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}], ",", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}]}], "]"}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<gradient, first link:  \>\"", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"grad", ",", 
             RowBox[{
              RowBox[{"nc", "^", "2"}], "-", "1"}]}], "]"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"delta", "=", 
       RowBox[{"findDelta", "[", 
        RowBox[{"hess", ",", "grad", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "fixedDir", "]"}], ">", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"gaugeTransformShifts", "[", 
            RowBox[{"tmpGaugeField", ",", 
             RowBox[{"OptionValue", "[", "fixedDir", "]"}]}], "]"}], ",", 
           "None"}], "]"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", 
             RowBox[{"Options", "[", "findDelta", "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Debug", " ", "prints"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{"False", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<delta difference:  \>\"", ",", 
          RowBox[{"Chop", "[", 
           RowBox[{"delta", "-", "delta0"}], "]"}]}], "]"}], ",", "False", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<delta:  \>\"", ",", "delta"}], "]"}], ",", "False", ",",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<delta, first link:  \>\"", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"delta", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "]"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"t2", "=", 
       RowBox[{"SessionTime", "[", "]"}]}], ";", 
      RowBox[{"applyDelta", "[", 
       RowBox[{"tmpGaugeField", ",", "delta", ",", 
        RowBox[{"OptionValue", "[", "fixedDir", "]"}]}], "]"}], ";", 
      RowBox[{"t3", "=", 
       RowBox[{"SessionTime", "[", "]"}]}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<times:  \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"innerLoopTime", ",", 
          RowBox[{"t1", "-", "t0"}], ",", 
          RowBox[{"t2", "-", "t1"}], ",", 
          RowBox[{"t3", "-", "t2"}]}], "}"}]}], "]"}], ";", 
      "tmpGaugeField"}]}], "]"}]}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"48d083fd-27de-4856-b29b-093a49e1b574"],

Cell[CellGroupData[{

Cell["One link shifts", \
"Subsection",ExpressionUUID->"a4ef86a0-5ede-463b-994f-2e6a1b4df984"],

Cell["\<\
Do a link at a time.  This is mostly for posterity & debugging since the \
resulting action density was dominated by one-plaquette spikes.\
\>", "Text",ExpressionUUID->"8653b142-7112-4bee-b7a1-1980582f8f46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"linkSaddlePointStep", "::", "usage"}], "=", 
   "\"\<One iteration of the saddle point search.  Set rescaleCutoff to a \
large number to test this against the explicit calculation.\>\""}], ";", 
  RowBox[{
   RowBox[{"Options", "[", "linkSaddlePointStep", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rescaleCutoff", "\[Rule]", "1"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"printHessian", "\[Rule]", "False"}], ",", 
     RowBox[{"printShift", "\[Rule]", "False"}], ",", 
     RowBox[{"makeHess0", "\[Rule]", "False"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"linkSaddlePointStep", "[", 
    RowBox[{"u2Staples_", ",", "u1_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zzz", "=", 
        RowBox[{"OptionValue", "[", "rescaleCutoff", "]"}]}], ",", 
       RowBox[{"cutoff", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"0.1", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "beta", "]"}], ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"nc", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"3", " ", "beta"}], ")"}]}], "]"}], ",", "1"}], 
           "]"}]}], "]"}]}], ",", 
       RowBox[{"damping", "=", 
        RowBox[{"OptionValue", "[", "dampingFactor", "]"}]}], ",", 
       RowBox[{"debug", "=", "False"}], ",", 
       RowBox[{"ff", "=", 
        RowBox[{"u2Staples", ".", "u1"}]}], ",", "grad", ",", "mm", ",", "oo",
        ",", "values", ",", "deltas", ",", "sqrtU", ",", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "u2Staples", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"False", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<cutoff:  \>\"", ",", "cutoff"}], "]"}]}], "]"}], ";", 
      RowBox[{"grad", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Tr", "[", 
           RowBox[{"ff", ".", "#"}], "]"}], "&"}], ",", 
         RowBox[{"suGenerators", "[", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<grad:  \>\"", ",", "grad"}], "]"}]}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", " ", "linear", " ", "system", " ", 
          RowBox[{"mm", ".", "shifts"}]}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"Im", "[", "grad", "]"}]}]}], ",", " ", 
        RowBox[{
        "paying", " ", "careful", " ", "attention", " ", "to", " ", 
         "nullspace", " ", "of", " ", 
         RowBox[{"mm", ".", "  ", "Could"}], " ", "equivalently", " ", "use", 
         " ", 
         RowBox[{"LDL", "^", "T"}], " ", "factorization", " ", "with", " ", 
         "symmetric", " ", 
         RowBox[{"pivoting", "."}]}]}], "  ", "*)"}], 
      RowBox[{"mm", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"Tr", "[", "ff", "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2.0", " ", 
            RowBox[{"Length", "[", "ff", "]"}]}], ")"}]}], " ", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "grad", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"suSymmetric", "[", "]"}], ".", 
          RowBox[{"Re", "[", "grad", "]"}]}], "/", "2.0"}]}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"values", ",", "oo"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{
       "Using", " ", "the", " ", "fact", " ", "that", " ", "the", " ", 
        "periodicity", " ", "of", " ", "B_a", " ", "is", " ", "4", " ", "Pi", 
        " ", "or", " ", 
        RowBox[{"less", "."}]}], " ", "*)"}], " ", 
      RowBox[{"deltas", "=", 
       RowBox[{
        RowBox[{"-", "damping"}], " ", 
        RowBox[{"applyCutoff1", "[", 
         RowBox[{"values", ",", 
          RowBox[{"oo", ".", 
           RowBox[{"Im", "[", "grad", "]"}]}], ",", "cutoff", ",", "zzz"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "printHessian", "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Hessian:  \>\"", ",", "mm"}], "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<gradient:  \>\"", ",", 
           RowBox[{"Im", "[", "grad", "]"}]}], "]"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "printShift", "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<shifts:  \>\"", ",", 
          RowBox[{"deltas", ".", "oo"}]}], "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "makeHess0", "]"}], ",", 
        RowBox[{
         RowBox[{"gradient0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"gradient0", ",", 
            RowBox[{"-", 
             RowBox[{"Im", "[", "grad", "]"}]}]}], "]"}]}], ";", 
         RowBox[{"hess0", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MatrixQ", "[", "hess0", "]"}], ",", 
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"hess0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "mm"}]}], "}"}]}], "}"}], "]"}], ",", 
            RowBox[{"-", "mm"}]}], "]"}]}], ";", 
         RowBox[{"delta0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"delta0", ",", 
            RowBox[{"deltas", ".", "oo"}]}], "]"}]}]}]}], "]"}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u1", ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"I", " ", 
           RowBox[{"deltas", ".", "oo", ".", 
            RowBox[{"suGenerators", "[", "]"}]}]}], "]"}]}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"Abs", "[", "deltas", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
  ";", 
  RowBox[{
   RowBox[{"linkSaddlePoint", "::", "usage"}], "=", 
   "\"\<Saddle point search for a single link.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "linkSaddlePoint", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tolerance", "\[Rule]", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}]}], ",", 
       RowBox[{"maxCount", "\[Rule]", "1"}], ",", 
       RowBox[{"printHessian", "\[Rule]", "False"}], ",", 
       RowBox[{"printShift", "\[Rule]", "False"}], ",", 
       RowBox[{"printDebug", "\[Rule]", "False"}], ",", 
       RowBox[{"updateGaugeField", "\[Rule]", "True"}]}], "}"}], ",", 
     RowBox[{"Options", "[", "linkSaddlePointStep", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkSaddlePoint", "[", 
    RowBox[{"dir_", ",", "coords_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"maxShift", "=", 
        RowBox[{"4", " ", "Pi"}]}], ",", 
       RowBox[{"u1", "=", 
        RowBox[{"SUPower", "[", 
         RowBox[{
          RowBox[{"getLink", "[", 
           RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}]}], ",", 
       "u2", ",", "u2SumStaples", ",", 
       RowBox[{"count", "=", "0"}], ",", "uu"}], "}"}], ",", 
     RowBox[{
      RowBox[{"u2", "=", "u1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"u2SumStaples", "=", 
       RowBox[{"u2", ".", 
        RowBox[{"sumStaples", "[", 
         RowBox[{"dir", ",", "coords"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"maxShift", ">", 
          RowBox[{"OptionValue", "[", "tolerance", "]"}]}], "&&", 
         RowBox[{"count", "<", 
          RowBox[{"OptionValue", "[", "maxCount", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"count", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u1", ",", "maxShift"}], "}"}], "=", 
          RowBox[{"linkSaddlePointStep", "[", 
           RowBox[{"u2SumStaples", ",", "u1", ",", 
            RowBox[{"Apply", "[", 
             RowBox[{"Sequence", ",", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "opts", "}"}], ",", 
                RowBox[{"Options", "[", "linkSaddlePointStep", "]"}]}], 
               "]"}]}], "]"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "printDebug", "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Max shift:  \>\"", ",", "maxShift"}], "]"}]}], 
          "]"}]}]}], "]"}], ";", 
      RowBox[{"uu", "=", 
       RowBox[{"u1", ".", "u2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "printDebug", "]"}], ",", 
        RowBox[{"SUMatrixQ", "[", "uu", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "updateGaugeField", "]"}], ",", 
        RowBox[{"setLink", "[", 
         RowBox[{"dir", ",", "coords", ",", "uu"}], "]"}]}], "]"}], ";", 
      RowBox[{"{", 
       RowBox[{"uu", ",", "maxShift"}], "}"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"Options", "[", "latticeSaddlePoint", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"maxCount", "\[Rule]", "1"}], ",", 
       RowBox[{"tolerance", "\[Rule]", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}]}]}], "}"}], ",", 
     RowBox[{"Options", "[", "linkSaddlePoint", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"latticeSaddlePoint", "[", 
    RowBox[{"opt", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"count", "=", "0"}], ",", 
       RowBox[{"maxShift", "=", 
        RowBox[{"4", " ", "Pi"}]}], ",", "linkShift", ",", 
       RowBox[{"stats", "=", 
        RowBox[{"{", "}"}]}], ",", "stat", ",", "uu", ",", "newGaugeField"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"count", "<", 
          RowBox[{"OptionValue", "[", "maxCount", "]"}]}], "&&", 
         RowBox[{"maxShift", ">", 
          RowBox[{"OptionValue", "[", "tolerance", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"maxShift", "=", "0"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "makeHess0", "]"}], ",", 
           RowBox[{
            RowBox[{"gradient0", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{"hess0", "=", "Null"}], ";", 
            RowBox[{"delta0", "=", 
             RowBox[{"{", "}"}]}]}]}], "]"}], ";", 
         RowBox[{"newGaugeField", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"uu", ",", "linkShift"}], "}"}], "=", 
              RowBox[{"linkSaddlePoint", "[", 
               RowBox[{"dir", ",", 
                RowBox[{"latticeCoordinates", "[", "k", "]"}], ",", " ", 
                RowBox[{"maxCount", "->", "1"}], ",", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Sequence", ",", 
                  RowBox[{"FilterRules", "[", 
                   RowBox[{
                    RowBox[{"{", "opt", "}"}], ",", 
                    RowBox[{"Options", "[", "linkSaddlePoint", "]"}]}], 
                   "]"}]}], "]"}]}], "]"}]}], ";", 
             RowBox[{"maxShift", "=", 
              RowBox[{"Max", "[", 
               RowBox[{"linkShift", ",", "maxShift"}], "]"}]}], ";", "uu"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"dir", ",", "nd"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"stat", "=", 
           RowBox[{"{", 
            RowBox[{"count", ",", " ", "maxShift", ",", 
             RowBox[{"averagePlaquette", "[", "]"}]}], "}"}]}], "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{"False", ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"stat", ",", 
             RowBox[{"exponentialModel", "[", 
              RowBox[{
               RowBox[{"talliesToAverageErrors", "[", 
                RowBox[{"polyakovLoopTallies", "[", "\"\<simple\>\"", "]"}], 
                "]"}], ",", 
               RowBox[{"printResult", "\[Rule]", "True"}]}], "]"}]}], "]"}]}],
           "]"}], ";", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stats", ",", "stat"}], "]"}], ";", 
         RowBox[{"count", "++"}]}]}], "]"}], ";", 
      RowBox[{"{", 
       RowBox[{"newGaugeField", ",", "stats"}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"9e5d8c5f-de60-45a9-b500-e4a61b6145fb"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", \
"Title",ExpressionUUID->"76e3bcbc-ac2e-4979-ae1b-903dcd5b1de9"],

Cell[CellGroupData[{

Cell["Parallel processors", \
"Section",ExpressionUUID->"00f95bb7-b3d3-4c59-9b24-f94ce49234b3"],

Cell["\<\
For parallelization, I had to go to menu Evaluation->Parallel Kernel \
Configuration and set the number manually.  Automatic launching of additional \
kernels is broken?  Note that the parallelization is based on the leading \
dimension of the table.
Verify parallel kernels are running:\
\>", "Text",ExpressionUUID->"7e2b0662-20aa-44ba-85a6-de52c24d4760"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "$ProcessID", 
  "]"}]], "Input",ExpressionUUID->"60a5f1d4-ba7e-421b-8a7f-ada56983707a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "25215", ",", "25218", ",", "25237", ",", "25273", ",", "25322", ",", 
   "25379"}], 
  "}"}]], "Output",ExpressionUUID->"27fb0df5-c889-45ab-a39f-fdf2b147d16a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["matrixPower, SU(N)  generators", \
"Section",ExpressionUUID->"dbb30539-1695-457a-b017-3b73cf822a2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"centerSUMatrix", "[", 
   RowBox[{"1", ",", "7"}], 
   "]"}]}]], "Input",ExpressionUUID->"555344c0-e344-4398-99ab-399bb54f2c22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"162d79ae-2470-4b09-82ef-5b46e1749e0f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"randomSUMatrix", "[", "7", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"6c7d094d-cbee-4294-80eb-6a953a7e0f74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"gaugeField", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "15"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.766972462904788*^9, 3.766972464175539*^9}, {
  3.767356782678484*^9, 3.7673567833886337`*^9}, {3.767357017701527*^9, 
  3.767357038858267*^9}, {3.76735796456426*^9, 3.767357975954447*^9}, {
  3.7673907291441927`*^9, 
  3.7673907295357113`*^9}},ExpressionUUID->"cfc0aeba-e57b-47db-a6ee-\
89128e519b02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.956699371337891`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.040671166032553`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.049990065395832`"}], "-", 
      RowBox[{"0.066759899258614`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.130659118294716`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.242990866303444`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.00153985642828`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.025455404073`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.476965427398682`"}], "-", 
      RowBox[{"0.828118026256561`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.184020891785622`"}], "-", 
      RowBox[{"0.228496193885803`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.144960388541222`"}], "-", 
      RowBox[{"0.247807174921036`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.173146083950996`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.22313466668129`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.420855641365051`"}], "+", 
      RowBox[{"0.812828481197357`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"9f543be0-f48c-446e-b52d-0cfb700b76d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "x", 
  "]"}]], "Input",ExpressionUUID->"7c0ffab6-45e8-4dba-b792-2602745013bb"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"ea71291e-4675-4b34-a39b-8fff9dba5947"]
}, Open  ]],

Cell["Take the root", \
"Text",ExpressionUUID->"c9017db1-49ec-4c31-8ae8-ca07d7c59fe5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"x", ",", "0.2"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9737b979-7234-403d-a77f-da741cd131e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "z", 
  "]"}]], "Input",ExpressionUUID->"1df9ed73-c862-47a0-84db-d0408348232a"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"babfd3ce-61fc-4f86-b8ed-98c7d5ed5427"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], "-", 
    RowBox[{"SUPower", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], ",", "Infinity"}], 
  "]"}]], "Input",ExpressionUUID->"2c93c725-dd14-4d13-b4fd-b476efb9ce97"],

Cell[BoxData["2.3262371608973003`*^-15"], \
"Output",ExpressionUUID->"2d474e9c-4e95-455f-8481-05329d8ac0ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrixEqual", "[", 
  RowBox[{
   RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], ",", "x"}], 
  "]"}]], "Input",ExpressionUUID->"2db875f1-e723-407d-aefd-63d570ce6bac"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"40e40490-a063-474d-aa5e-9b1d6c7f23b8"]
}, Open  ]],

Cell["Test normalization & orthogonality of the SU (N) generators", \
"Text",ExpressionUUID->"ee74d701-9f31-481b-9378-90bddc250cff"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", 
      RowBox[{"suGenerators", "[", "4", "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"0db0eee5-a0dc-4831-bfdb-a24fefefcb4a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare Mathematica mean plaquette against chroma value", \
"Section",ExpressionUUID->"db6b05b7-f32b-4370-830f-2b6b5568a3d5"],

Cell["Compare with chroma output xml file.", \
"Text",ExpressionUUID->"7c132b3f-122b-45cc-a5dd-3ffd3d76bc32"],

Cell["These should match plane_ij_plaq.", \
"Text",ExpressionUUID->"105aa520-26e2-4a1f-9417-f76de34ac5b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dir1", "<", "dir2"}], ",", 
      RowBox[{"Mean", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"plaquette", "[", 
           RowBox[{"dir1", ",", "dir2", ",", 
            RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "]"}], "/", 
          "nc"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir2", ",", 
      RowBox[{"dir1", "+", "1"}], ",", "3"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"e21f9cc0-fe49-4ac7-ba6c-fc60929455b8"],

Cell["\<\
{{0.9424840512244733, 0.9432405719201301}, {0.9357560701712518}}\
\>", "Output",ExpressionUUID->"90541cc5-753b-49fd-bfe8-07da657edf9a"]
}, Open  ]],

Cell["This should match w_plaq", \
"Text",ExpressionUUID->"e666013d-2675-4a31-a4b3-503d1fc3d9fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"Mean", "[", 
   RowBox[{"Flatten", "[", "%", "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"26445f14-cdf2-4582-ae8b-059b29f9ced8"],

Cell["0.9404935644386184", \
"Output",ExpressionUUID->"fb7019cb-6ae1-427b-88c9-d1e32f9ef256"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Compare the mean plaquette against ",
 StyleBox["Teper\[CloseCurlyQuote]s",
  IgnoreSpellCheck->True],
 " results"
}], "Section",ExpressionUUID->"0e3721d3-9f9f-4aec-8b17-a0e0b5a6136f"],

Cell["\"w_plaq\" is average of all plaquettes.", \
"Text",ExpressionUUID->"ef9662a6-3428-44ce-9551-657dce9923b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-4/periodic-16-28-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"93e6aeaa-35d6-415a-a5b1-2a02a3b5d13b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-4/periodic-16-33-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"45f1a60c-af24-4ccf-a0a9-aec69bcc0a8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-3/periodic-24-21-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"c12afa4a-e383-4a2b-acfd-02a84aebe344"],

Cell["\<\
Pull out the average plaquette from the production lattice updates.\
\>", "Text",ExpressionUUID->"305c15a3-7e7c-4b48-ab43-e2dc8c22f5e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"wp", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"xmlFilter", "[", 
     RowBox[{
      RowBox[{"expr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<purgaug\>\"", ",", "\"\<doHB\>\"", ",", "\"\<MCUpdates\>\"", ",", 
        "\"\<elem\>\"", ",", "\"\<Update\>\"", ",", 
        "\"\<InlineObservables\>\"", ",", "\"\<elem\>\"", ",", 
        "\"\<Plaquette\>\"", ",", "\"\<w_plaq\>\""}], "}"}]}], "]"}], "]"}]}],
   "]"}]], "Input",ExpressionUUID->"ba8f4f67-3074-4dd8-ab48-9be37129ddd0"],

Cell[BoxData["80000"], \
"Output",ExpressionUUID->"575cfba2-7cce-4952-abbc-fe274cec0e69"]
}, Open  ]],

Cell["\<\
Mean and standard error, ignoring autocorrelations.  
For SU(4), 2+1 dimensions, L=16^3 lattice, beta=28 abd 33, the average \
plaquette values match Teper\[CloseCurlyQuote]s result.  See \
arXiv:hep-lat/0206027v1 24 Jun 2002.\
\>", "Text",ExpressionUUID->"14a1ebbf-69e7-46dd-953d-62dca914e78d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Length", "[", "wp", "]"}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"bb541a45-0edc-4f89-a74e-93d177e29aa1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8676694244789538`", ",", "1.40560374756656`*^-6"}], 
  "}"}]], "Output",ExpressionUUID->"f60cbba9-6532-4889-95ee-2d2c8051f0a4"]
}, Open  ]],

Cell["\<\
What is the effect of autocorrelations on the error estimate?  Using \
https://en.wikipedia.org/wiki/Unbiased_estimation_of_standard_deviation
Find a model for the autocorrelation function (ACF), fitting to an \
exponential:\
\>", "Text",ExpressionUUID->"690ba936-9f6d-46ea-ab01-8d5adf0820e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cutoff", "=", "20"}], "}"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "cutoff"}], "}"}]}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"CorrelationFunction", "[", 
          RowBox[{"wp", ",", 
           RowBox[{"{", "cutoff", "}"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"e46d7efd-f26c-49cb-9f83-eefcf3a7baee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"data", ",", "5"}], "]"}], ",", 
    RowBox[{"{", "x", "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"502f87f3-c302-4b7a-9fac-dce132715663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.2872905383680901`"}], " ", 
  "x"}]], "Output",ExpressionUUID->"5bbf9817-15d1-45c2-af5f-c95547e2131d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ff", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"0a7c8018-a533-4964-af3f-4f49342775dc"],

Cell["\<\
From the Wikipedia article, the correction to the standard error is \
Sqrt[gamma2/gamma1], where :\
\>", "Text",ExpressionUUID->"0e87aa9a-e980-43af-8632-cd793257c02e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma1", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"f8aa7823-a8c9-40da-95b3-6a5cc997ff6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma2", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"eee091d7-c009-48ab-9225-64b5ad597bf6"],

Cell["Since n is large, look at leading order in n :", \
"Text",ExpressionUUID->"ac25176b-3a8b-41fe-b9d2-4acd5856e68a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gamma1", "[", "Infinity", "]"}], ",", 
   RowBox[{"gamma2", "[", "Infinity", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"900f3d2c-1a30-4aff-a3be-1993cc8be3bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "7.009409712669671`"}], 
  "}"}]], "Output",ExpressionUUID->"0b454090-0913-44be-9c71-cc762c74e3c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", "ff", "]"}]}], ")"}]}], "-", "1"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "1"}]}]], "Input",ExpressionUUID->"f04096b5-7675-497b-bbfb-d91a959e30e3"],

Cell[BoxData["7.009409712669671`"], \
"Output",ExpressionUUID->"c6631b84-3251-413d-a356-6f4ab030b36b"]
}, Open  ]],

Cell["\<\
There is a modest impact on the standard error, with the error estimate now \
matching Teper\[CloseCurlyQuote]s error estimate.  Good agreement for both \
SU(3) and SU(4).\
\>", "Text",ExpressionUUID->"b0145318-b479-46c8-9602-f7fef270df58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"gamma2", "[", "Infinity", "]"}], "/", 
      RowBox[{"Length", "[", "wp", "]"}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"4f7f5246-cce3-47d4-ad8f-4cbff69cdfd2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8676694244789538`", ",", "3.7213766594582798`*^-6"}], 
  "}"}]], "Output",ExpressionUUID->"caea97e0-b0b7-42ee-acae-a43e291e2503"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Polyakov loop, string tension", \
"Section",ExpressionUUID->"c0c1454d-926e-4e97-9beb-ac17940ec7c4"],

Cell["Test with trivial lattice.", \
"Text",ExpressionUUID->"4aec363d-807a-475d-991c-6016f97b4f4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6", ",", "8"}], "}"}]}], ";", 
  RowBox[{
  "makeTrivialLattice", "[", 
   "]"}]}]], "Input",ExpressionUUID->"98c5bfa6-1b35-4a89-972e-65ab06af40a6"],

Cell["\<\
Lattice with constant link in one direction.  Smeared Polyakov loop should \
give the same result as the simple Polyakov loop.\
\>", "Text",ExpressionUUID->"7d1249af-98ac-4456-afea-f64097619779"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uu", "=", 
       RowBox[{"randomSUMatrix", "[", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Trace:  \>\"", ",", 
        RowBox[{"Tr", "[", "uu", "]"}]}], "]"}], ";", 
      RowBox[{"uu", "=", 
       RowBox[{"SUPower", "[", 
        RowBox[{"uu", ",", 
         RowBox[{"1", "/", 
          RowBox[{"latticeDimensions", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", "uu", ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"4513aab7-f110-459e-a6ca-77942f6d8ca0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trace:  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "0.9931499715202564`"}], "-", 
    RowBox[{"1.8506741973480212`", " ", "\[ImaginaryI]"}]}]}],
  SequenceForm["Trace:  ", 
   Complex[-0.9931499715202564, -1.8506741973480212`]],
  Editable->
   False]], "Print",ExpressionUUID->"b4fa4c81-ea88-4d24-97ef-50c02359cefe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyakovLoop", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"31645a15-dca5-404b-9853-0ee0c12163bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.9931499715202567`"}], "-", 
  RowBox[{
  "1.8506741973480203`", " ", 
   "\[ImaginaryI]"}]}]], \
"Output",ExpressionUUID->"84da31aa-8974-4ce9-a2ce-7de2ee433bfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyakovLoop", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"9e1583e4-c354-444e-b6bc-ae197a7ddaa5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.9931499715202567`"}], "-", 
  RowBox[{
  "1.8506741973480203`", " ", 
   "\[ImaginaryI]"}]}]], \
"Output",ExpressionUUID->"7099919d-965c-4f9d-b6a2-910e05b6bf86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"loopThickness", "[", 
  "]"}]], "Input",ExpressionUUID->"d753cf6c-6ed9-4ebd-b534-f8c0c806172a"],

Cell[BoxData["11.697598614944667`"], \
"Output",ExpressionUUID->"3b1c1991-2fe6-4e4a-85fb-6277ffe61ba0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"tallyData", "=", 
  RowBox[{"talliesToAverageErrors", "[", 
   RowBox[{"polyakovLoopTallies", "[", "\"\<simple\>\"", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"e8aef995-4fbf-4b8b-8955-39c4781344d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tallyData", "=", 
  RowBox[{"talliesToAverageErrors", "[", 
   RowBox[{"polyakovLoopTallies", "[", "\"\<smeared\>\"", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"d00fbb57-f8c1-42e9-bcad-bacffe17841c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.004170396888019297`", ",", "0.00030151025625792965`"}], 
     "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.003478262520239419`", ",", "0.0003242503181648495`"}], 
     "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.00245383294869438`", ",", "0.00028253744120390096`"}], 
     "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0017756391421765738`", ",", "0.00026818387848587976`"}], 
     "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0012755876776279198`", ",", "0.0002710803318396858`"}], 
     "}"}]}], ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0008289473338730119`", ",", "0.00025728619989006437`"}], 
     "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0004707712360189323`", ",", "0.0002714885943937544`"}], 
     "}"}]}], ",", 
   RowBox[{"8", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.00006309026103799468`"}], ",", 
      "0.00027498787944608624`"}], "}"}]}], ",", 
   RowBox[{"9", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.0004873476955645394`"}], ",", 
      "0.0002872814945727909`"}], "}"}]}], ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.0006414940848528436`"}], ",", 
      "0.0002890918616347785`"}], "}"}]}], ",", 
   RowBox[{"11", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.0007619838600143781`"}], ",", 
      "0.0003737303565426513`"}], "}"}]}], ",", 
   RowBox[{
    SqrtBox["221"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.001145577360672568`"}], ",", "0.0003726142038113814`"}],
      "}"}]}]}], 
  "\[RightAssociation]"}]], \
"Output",ExpressionUUID->"1b1f9b42-b632-421d-84d0-217ecb385d16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{"exponentialModel", "[", 
    RowBox[{"tallyData", ",", 
     RowBox[{"printResult", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0ab48d40-ac71-4243-bc6d-64a343c203fe"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"norm", "0.006567378552024714`", "0.0005420363643801315`", 
      "12.116121691457208`", "2.668318890622927`*^-7"},
     {"aw", "0.36563593614486445`", "0.03340321902346922`", 
      "10.946128751482526`", "6.900155210540742`*^-7"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->
   False]], "Print",ExpressionUUID->"389c01a4-7919-4ad7-be64-76c7936a5d15"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nn", "=", 
      RowBox[{"Normal", "[", "tallyData", "]"}]}], ",", "maxx", ",", "miny", 
     ",", "maxy"}], "}"}], ",", 
   RowBox[{
    RowBox[{"maxx", "=", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "nn"}], "]"}], "]"}], "+", "0.5"}]}], ";", 
    RowBox[{"maxy", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"1.5", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", "nn"}], 
       "]"}], "]"}]}], ";", 
    RowBox[{"miny", "=", 
     RowBox[{"Min", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Min", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"1.5", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", "nn"}], 
         "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ErrorListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"ErrorBar", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
          ",", "nn"}], "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"miny", ",", "maxy"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"ColumnForm", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\< = \>\"",
                     ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    "\"\<\[PlusMinus]\>\"", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "&"}], 
                  ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"ff", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<BestFitParameters\>\"", ",", 
                    "\"\<ParameterErrors\>\""}], "}"}], "]"}], "]"}]}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Beta] = \>\"", ",", 
                    RowBox[{"N", "[", "beta", "]"}], ",", 
                    "\"\<, \!\(\*SubscriptBox[\(N\), \(d\)]\) = \>\"", ",", 
                    "nd", ",", 
                    "\"\<, \!\(\*SubscriptBox[\(N\), \(c\)]\) = \>\"", ",", 
                    "nc"}], "}"}], "]"}], ",", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<lattice = \>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"latticeDimensions", ",", "\"\<, \>\""}], "]"}]}],
                     "}"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"maxx", "*", "0.9"}], ",", 
               RowBox[{"maxy", "*", "0.9"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Dashing", "[", ".02", "]"}], ",", "Gray", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"maxx", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
        ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<separation (links)\>\"", ",", 
           "\"\<Polyakov loop correlator\>\""}], "}"}]}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"ff", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"eebb9c65-ad3e-4480-8d98-562b443e87e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Axial gauge", \
"Section",ExpressionUUID->"a1c1bbe6-f074-406a-ac7c-c6ffc4eacbaf"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-4.m\>\""}]], \
"Input",ExpressionUUID->"ec3655d8-38b1-4a7d-b718-4b80aeeef422"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"5dd31ab0-fae4-46d2-bd92-48606c717fd6"],

Cell[BoxData["0.9404935644386324`"], \
"Output",ExpressionUUID->"5f007e90-760f-463b-a28f-9fd832119cf7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "3", 
  "]"}]], "Input",ExpressionUUID->"89ef1a0c-4f0f-470f-8cb8-7133aac8adb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"67ae6656-91d7-4223-bc46-982774baca07"],

Cell[BoxData["0.9404938721121576`"], \
"Output",ExpressionUUID->"437f73d5-4943-41d8-a415-ba7d45119a67"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["staples", \
"Section",ExpressionUUID->"a3cdfc84-d033-4252-a8cf-5af5f301749c"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-3-5.m\>\""}]], \
"Input",ExpressionUUID->"8a0090dd-648b-4a98-bbe4-88d68ac28f27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xxx", "=", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"8bb8d152-a1ab-4391-b0bf-f10ef2657976"],

Cell[BoxData["0.9404938721121576`"], \
"Output",ExpressionUUID->"2b5896f7-82b0-4550-a463-80485b77edb5"]
}, Open  ]],

Cell["Set all links to the identity", \
"Text",ExpressionUUID->"29ab58da-7987-4db3-ad7a-e1b6c642b2ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "nc", "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"nd", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"b946bfba-43dc-4c26-bf82-3da15da84f5d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sumStaples", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"b3ae56a7-b5ea-45a7-900e-faa0581cbc49"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"a972b839-b4a9-448e-ac00-ce2fb91fbc4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stapleTest", "[", 
  "]"}]], "Input",ExpressionUUID->"e08438ab-1886-4139-8295-f618f20cd11a"],

Cell[BoxData["1"], \
"Output",ExpressionUUID->"8b2e72bf-9267-4ac7-84ae-2b9286a060b3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nearest stationary point for single  link and sum of staples", \
"Section",ExpressionUUID->"ea282df4-9160-4463-8126-eaff1b79fc30"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
staple and starting matrix.  To compare,  remove the damping factors in the \
function saddlePointStep[] by setting rescaleCutoff to a large number and \
dampingFactor to 1.\
\>", "Text",ExpressionUUID->"a7813421-ea59-48d0-93a1-48d9b854885f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], 
  ";"}]], "Input",ExpressionUUID->"b7134f69-3d79-4f62-a0fd-b94d083411cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeRandomStaple", "[", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "nd"}], "-", "2"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{"bVector", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"bb", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
    RowBox[{
    "suGenerators", "[", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"a1c3eed8-029f-4991-bfbf-da8c98937504"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"bb", "[", "3", "]"}], "2"], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "2", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "2", "]"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bb", "[", "3", "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"198526d9-e6ba-47c2-95eb-b00efe8db2c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run test", \
"Subsection",ExpressionUUID->"da7b8aa5-359a-4015-8f83-c1c7061ad4ea"],

Cell["Make random staple and starting link.", \
"Text",ExpressionUUID->"9e8bb80e-1572-4b9d-bc2b-e63fc0601168"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testStaple", "=", 
   RowBox[{"makeRandomStaple", "[", "]"}]}], ";", 
  RowBox[{"uu", "=", 
   RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
  RowBox[{"sqrtU", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"uu", ",", "0.5"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9130c6e3-6caa-48da-a201-516f3848d814"],

Cell["\<\
Explicitly find the second order expansion of the exponential.\
\>", "Text",ExpressionUUID->"598ce003-f717-4a15-b9ca-f7d259cfb5c6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"testStaple", ".", "sqrtU", ".", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", "bVector"}], "-", 
         RowBox[{
          RowBox[{"bVector", ".", "bVector"}], "/", 
          RowBox[{"2", "!"}]}]}], "]"}], ".", "sqrtU"}], "]"}], "]"}], "]"}], 
   "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], "+", 
       RowBox[{"Re", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{"bb", "[", "i_", "]"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{"bb", "[", "i", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{
         RowBox[{"bb", "[", "i_", "]"}], "^", "n_"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{
        RowBox[{"bb", "[", "i", "]"}], "^", "n"}]}]}]}], 
    "}"}]}]}]], \
"Input",ExpressionUUID->"6a95ba59-19b7-49dd-9b6e-5a60dc89ad9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.6030275532297495`"}], "+", 
  RowBox[{"0.22039680098227182`", " ", 
   RowBox[{"bb", "[", "1", "]"}]}], "+", 
  RowBox[{"0.015288617837935316`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "1", "]"}], "2"]}], "-", 
  RowBox[{"0.0407710091245715`", " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "-", 
  RowBox[{"0.08847406444104186`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "+", 
  RowBox[{"0.2560891786144439`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"0.11257337848969418`", " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "-", 
  RowBox[{"0.23298831336539033`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "-", 
  RowBox[{"0.1043309231936697`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "+", 
  RowBox[{"0.1293790918550582`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"0.5379009306403653`", " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "-", 
  RowBox[{"0.31401150670946587`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "-", 
  RowBox[{"0.09354831246981164`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "+", 
  RowBox[{"0.015288617837935316`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{"0.555600156261005`", " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.31401150670946587`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.14407229353870987`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.08847406444104186`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.2560891786144439`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "5", "]"}], "2"]}], "-", 
  RowBox[{"0.18050557750477675`", " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "-", 
  RowBox[{"0.09354831246981164`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.14407229353870987`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.23298831336539033`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "-", 
  RowBox[{"0.1043309231936697`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.1293790918550582`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"0.8032798011194755`", " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.23298831336539033`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.08847406444104186`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.09354831246981164`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.31401150670946587`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.015288617837935316`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "7", "]"}], "2"]}], "+", 
  RowBox[{"0.15860880758372364`", " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.12047097318133473`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.13451586543954497`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.05108052492133582`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.16636035491468185`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.054010143386680975`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.18129462792735007`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.1463122053991444`", " ", 
   RowBox[{"bb", "[", "7", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.2518826410336897`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "8", "]"}], 
    "2"]}]}]], "Output",ExpressionUUID->"24b3c30a-38b3-4ab0-a8ab-5ee28b0473e7"]
}, Open  ]],

Cell["Find the stationary point, based on this :", \
"Text",ExpressionUUID->"311645dc-63f3-4d62-b159-2a5da2e39cf6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"bb", "[", "i", "]"}]}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"550f4ef5-06c0-4564-ba47-23d788a873b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"bb", "[", "1", "]"}], "\[Rule]", "1.3623040829546842`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "2", "]"}], "\[Rule]", "1.8328728207904819`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "3", "]"}], "\[Rule]", "2.451217683590129`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "4", "]"}], "\[Rule]", "0.989808334724233`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "5", "]"}], "\[Rule]", "1.6805147702777736`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "6", "]"}], "\[Rule]", "1.2794214633970735`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "7", "]"}], "\[Rule]", "1.393498831375975`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "8", "]"}], "\[Rule]", 
    RowBox[{"-", "0.5246179222097134`"}]}]}], 
  "}"}]], "Output",ExpressionUUID->"84141ab8-f035-4788-a567-854001618966"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v1", "=", 
  RowBox[{"sqrtU", ".", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"I", " ", "bVector"}], "/.", "sp"}], "]"}], ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"c03163ff-9f1b-4818-bd65-86fab0e3a288"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.10500072610684753`"}], "+", 
      RowBox[{"0.7471764929913395`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3763926601157129`"}], "+", 
      RowBox[{"0.2925191236190155`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3688040432177538`"}], "+", 
      RowBox[{"0.25970529696680233`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.02584670585333751`"}], "-", 
      RowBox[{"0.08708563702894037`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.6883507084853985`"}], "-", 
      RowBox[{"0.12434768985769185`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6437551089184221`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.2967125772796471`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.6152590791443152`"}], "-", 
      RowBox[{"0.2095386384142107`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3214403876383704`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.4244386399443151`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12998427043169897`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.5264806094239949`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"636dce73-0a4e-4309-8755-f81d50e56f33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v1", 
  "]"}]], "Input",ExpressionUUID->"c0f5bc1c-9524-457c-9b77-7b68fba52094"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6879403773840286`", ",", "2.094201568014401`", ",", 
   RowBox[{"-", "2.7821419453984295`"}]}], 
  "}"}]], "Output",ExpressionUUID->"f5aad6cd-1d2f-42c6-b1c6-ddb2c5a90879"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"3fe08654-62f2-4d02-9d81-7e2b3d7a8735"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"u2", ",", "maxShift"}], "}"}], "=", 
  RowBox[{"linkSaddlePointStep", "[", 
   RowBox[{
    RowBox[{"sqrtU", ".", "testStaple"}], ",", "sqrtU", ",", 
    RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
    RowBox[{"dampingFactor", "\[Rule]", "1"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"80497507-228c-4fdc-80f9-3b7206b667b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.4089145174283525`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.2508983043608513`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.03787668071595404`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.34276788224772575`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6106612329971187`"}], "+", 
        RowBox[{"0.5272640256806607`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.020235257317930966`"}], "+", 
        RowBox[{"0.2596879030558513`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6052322433259413`"}], "-", 
        RowBox[{"0.6189600529708443`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.07200228837862936`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.42136775185216835`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.8376513614860717`"}], "+", 
        RowBox[{"0.018217636329927456`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.048289528556046776`"}], "+", 
        RowBox[{"0.3596193012814569`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.002413105997776055`"}], "+", 
        RowBox[{"0.40785361445523044`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", "3.1814300260567525`"}], 
  "}"}]], "Output",ExpressionUUID->"8678fc18-bc60-477f-b9c0-233d94b1ca09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v2", "=", 
  RowBox[{
  "u2", ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"ac7a0f4c-2d12-4266-b88c-dfe83862a927"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.10500072610684626`"}], "+", 
      RowBox[{"0.7471764929913391`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.37639266011571504`"}], "+", 
      RowBox[{"0.29251912361901605`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.36880404321775234`"}], "+", 
      RowBox[{"0.2597052969668021`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.025846705853336843`"}], "-", 
      RowBox[{"0.08708563702894212`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.6883507084853975`"}], "-", 
      RowBox[{"0.12434768985769076`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6437551089184234`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.2967125772796465`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.6152590791443151`"}], "-", 
      RowBox[{"0.20953863841421153`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.32144038763836913`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.4244386399443155`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.1299842704316965`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.5264806094239953`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"517a8745-305d-4384-94ca-5f1f16872a5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v2", 
  "]"}]], "Input",ExpressionUUID->"89631d59-895b-46fd-b2a6-708ffba5df6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6879403773840297`", ",", "2.0942015680144004`", ",", 
   RowBox[{"-", "2.78214194539843`"}]}], 
  "}"}]], "Output",ExpressionUUID->"8fedd7ba-9864-4856-a14b-e33c1dd708e5"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nearest stationary point for entire lattice", \
"Section",ExpressionUUID->"1b840428-3dba-4350-9abd-ef8fad741fdb"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
lattice.  Tested for nd=3 and SU(2), SU(3) with multiple sites, and SU(4) \
with one site.\
\>", "Text",ExpressionUUID->"775818f5-3441-4cfb-87a0-fc2a48ea802e"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"90f99fee-2842-49b5-a115-5316d7dd6a49"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Switch", " ", "order", " ", "to", " ", "verify", " ", "we", " ", "are", 
    " ", "not", " ", "dependent", " ", "on", " ", 
    RowBox[{"latticeCoordinates", "[", "]"}], " ", 
    RowBox[{"indexing", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"linearSiteIndex", "[", 
       RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", "i", ",", 
        RowBox[{
         RowBox[{"latticeVolume", "[", "]"}], "-", "i", "+", "1"}]}], "]"}]}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]}], \
"Input",ExpressionUUID->"aef1e77b-70db-47d7-b29f-29c8a6ef602f"],

Cell[BoxData["0.11416926656338111`"], \
"Output",ExpressionUUID->"4c087365-0326-4869-81e8-581eabc0490e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{
   RowBox[{"bVector", "[", 
    RowBox[{"dir_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", 
        RowBox[{"dir", ",", "site", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
     RowBox[{"suGenerators", "[", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"30907186-02ad-4415-8f1d-ae3905203408"],

Cell["\<\
Create links with second order perturbation.  Variables have same lattice \
index as links.\
\>", "Text",ExpressionUUID->"e296b2ed-594c-419b-8904-1f44a2b2df9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"SUPower", "[", 
        RowBox[{
         RowBox[{"gaugeField", "[", 
          RowBox[{"[", 
           RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}], ".", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"bVector", "[", 
           RowBox[{"dir", ",", "i"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"bVector", "[", 
            RowBox[{"dir", ",", "i"}], "]"}], ".", 
           RowBox[{"bVector", "[", 
            RowBox[{"dir", ",", "i"}], "]"}]}], "/", 
          RowBox[{"2", "!"}]}]}], ")"}], ".", 
       RowBox[{"SUPower", "[", 
        RowBox[{
         RowBox[{"gaugeField", "[", 
          RowBox[{"[", 
           RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0c9ce925-7c3c-49ef-8c8b-6a87291ccacb"],

Cell["Sum of plaquettes, not taking the real part yet:", \
"Text",ExpressionUUID->"8ff7648c-bdb7-4ab9-99be-869a5b7f7d7d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coords", "=", 
          RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k2", ",", 
             RowBox[{"linearSiteIndex", "[", 
              RowBox[{"shift", "[", 
               RowBox[{"k1", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"linearSiteIndex", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"k2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
           "]"}], ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", " ", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"bb", "[", "a__", "]"}], "]"}], "\[Rule]", 
         RowBox[{"bb", "[", "a", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", 
       RowBox[{"k1", "+", "1"}], ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Average", " ", "plaquette", " ", "should", " ", "be", " ", "same", " ", 
    "as", " ", 
    RowBox[{"above", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"nc", " ", "nd", " ", 
      RowBox[{"(", 
       RowBox[{"nd", "-", "1"}], ")"}], " ", 
      RowBox[{"latticeVolume", "[", "]"}]}], ")"}]}], " ", 
   RowBox[{"Re", "[", 
    RowBox[{"rp", "/.", 
     RowBox[{
      RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"04f19bb9-b9c4-4e30-a3b1-e461c5b9f3e9"],

Cell[BoxData["0.11416926656338114`"], \
"Output",ExpressionUUID->"1d89ff91-29e3-4528-b629-5ea9f863af76"]
}, Open  ]],

Cell["Calculate gradient and Hessian at bb[dir,i,k] = 0.", \
"Text",ExpressionUUID->"7f53c297-a27e-4759-bfe8-08ef3acedbf8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gradientA", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"rp", ",", 
         RowBox[{"bb", "[", 
          RowBox[{"dir", ",", "i", ",", "k"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{
        RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"857290eb-f32a-450a-b7f7-7473c9bea2ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.9613934189939415`"}], ",", "0.7130435221205562`", ",", 
   RowBox[{"-", "1.3848562467901921`"}], ",", 
   RowBox[{"-", "1.552778113098801`"}], ",", "1.3221479320157425`", ",", 
   "0.5163367992685648`", ",", 
   RowBox[{"-", "0.23188761995299334`"}], ",", 
   RowBox[{"-", "0.8355629067701222`"}], ",", 
   RowBox[{"-", "1.2247563775530619`"}], ",", 
   RowBox[{"-", "1.7454169141268485`"}], ",", 
   RowBox[{"-", "0.7618714796016414`"}], ",", "0.5523341758810053`", ",", 
   "0.3634441662326592`", ",", "0.5229265506690954`", ",", 
   "1.0086392043519554`", ",", 
   RowBox[{"-", "1.3957836346057952`"}], ",", 
   RowBox[{"-", "1.533446854676221`"}], ",", 
   RowBox[{"-", "0.6769656172817621`"}], ",", 
   RowBox[{"-", "0.5995330070258998`"}], ",", 
   RowBox[{"-", "0.5157225694247162`"}], ",", 
   RowBox[{"-", "1.1571744453171262`"}], ",", 
   RowBox[{"-", "0.3594153269901214`"}], ",", 
   RowBox[{"-", "0.21400136781105605`"}], ",", "0.5261651911457685`", ",", 
   "1.2372290828794106`", ",", 
   RowBox[{"-", "0.3413541921992934`"}], ",", 
   RowBox[{"-", "0.04504390857577878`"}], ",", 
   RowBox[{"-", "0.7494161023670388`"}], ",", 
   RowBox[{"-", "1.1959605802047162`"}], ",", 
   RowBox[{"-", "0.7883579366739335`"}], ",", "0.41291652632649234`", ",", 
   RowBox[{"-", "0.2303607543868518`"}], ",", 
   RowBox[{"-", "0.28352593388725983`"}], ",", "0.7382626028392358`", ",", 
   RowBox[{"-", "0.11178337964875001`"}], ",", "0.9579829333263359`"}], 
  "}"}]], "Output",ExpressionUUID->"ac990e55-88eb-4d7c-9cd1-941552db977a"]
}, Open  ]],

Cell["\<\
For parallelization, I had to go to menu Evaluation->Parallel Kernel \
Configuration and set the number manually.  Automatic launching of additional \
kernels is broken?  Note that the parallelization is based on the leading \
dimension of the table.
Verify parallel kernels are running:\
\>", "Text",ExpressionUUID->"155e4abe-b149-4413-ba11-0bdaafb3547c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "$ProcessID", 
  "]"}]], "Input",ExpressionUUID->"d989f3fa-185e-42ec-9a70-1af929ea7129"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "25215", ",", "25218", ",", "25237", ",", "25273", ",", "25322", ",", 
   "25379"}], 
  "}"}]], "Output",ExpressionUUID->"83b1d018-0467-4341-aec9-c73f46079339"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"hessA", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"rp", ",", 
           RowBox[{"bb", "[", 
            RowBox[{"dir1", ",", "i1", ",", "k1"}], "]"}], ",", 
           RowBox[{"bb", "[", 
            RowBox[{"dir2", ",", "i2", ",", "k2"}], "]"}]}], "]"}], "/.", 
         RowBox[{
          RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir1", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i1", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir2", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"9fc6db0e-a169-4996-94ee-6f278635c2e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"36", ",", "36"}], 
  "}"}]], "Output",ExpressionUUID->"a3c38fbd-8057-4a37-83e1-05a1846d23c7"]
}, Open  ]],

Cell["Find the saddle point.", \
"Text",ExpressionUUID->"47cda69a-bf50-4ff0-ab2f-ae8ad49ba288"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deltaA", "=", 
  RowBox[{"-", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"hessA", ",", "gradientA"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"737d31db-efb3-42a4-a1fe-18644cff8567"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.441156126210855`"}], ",", 
   RowBox[{"-", "4.737071413476111`"}], ",", 
   RowBox[{"-", "6.66922316881648`"}], ",", 
   RowBox[{"-", "3.733701727580017`"}], ",", "5.759680421584879`", ",", 
   RowBox[{"-", "0.8665209377116804`"}], ",", "8.334011432492499`", ",", 
   RowBox[{"-", "8.428145043456734`"}], ",", "3.623806173380947`", ",", 
   RowBox[{"-", "3.935365811809498`"}], ",", 
   RowBox[{"-", "1.9055241011156003`"}], ",", "17.604692949585825`", ",", 
   "15.18469013577376`", ",", 
   RowBox[{"-", "4.554859480323707`"}], ",", 
   RowBox[{"-", "4.655628146632598`"}], ",", 
   RowBox[{"-", "2.3341381126106455`"}], ",", 
   RowBox[{"-", "12.505956290676245`"}], ",", 
   RowBox[{"-", "4.890773176228168`"}], ",", 
   RowBox[{"-", "1.0902470300281812`"}], ",", "5.744909853246197`", ",", 
   "5.715438856776931`", ",", 
   RowBox[{"-", "11.153685153845236`"}], ",", "12.25200489171736`", ",", 
   RowBox[{"-", "5.160865279177129`"}], ",", 
   RowBox[{"-", "3.3588404441547004`"}], ",", "6.364354931212894`", ",", 
   "0.4466719392357028`", ",", "3.8241290010061055`", ",", 
   "7.794746141308727`", ",", "1.3409608996891118`", ",", 
   RowBox[{"-", "9.567366697208154`"}], ",", "0.07844654225632038`", ",", 
   RowBox[{"-", "10.489411882336146`"}], ",", "0.9184281860191998`", ",", 
   "11.658681696884987`", ",", 
   RowBox[{"-", "14.788797101093285`"}]}], 
  "}"}]], "Output",ExpressionUUID->"da01cc72-9053-4d9f-9825-054b5f52cf27"]
}, Open  ]],

Cell["Equivalently, find the saddle point using the eigensystem.", \
"Text",ExpressionUUID->"ff29655f-7449-4f85-8d56-89b0f03b4d15"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valsA", ",", "ooA"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "hessA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"deltaA", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"ooA", ".", "gradientA"}]}], "/", "valsA"}], ")"}], ".", 
   "ooA"}]}]}], \
"Input",ExpressionUUID->"76ce6490-2a01-45bc-b420-e512cad5664e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.4411561262108492`"}], ",", 
   RowBox[{"-", "4.737071413476346`"}], ",", 
   RowBox[{"-", "6.669223168816291`"}], ",", 
   RowBox[{"-", "3.733701727580136`"}], ",", "5.759680421585121`", ",", 
   RowBox[{"-", "0.8665209377116658`"}], ",", "8.334011432492543`", ",", 
   RowBox[{"-", "8.428145043456752`"}], ",", "3.623806173380842`", ",", 
   RowBox[{"-", "3.935365811809547`"}], ",", 
   RowBox[{"-", "1.9055241011155262`"}], ",", "17.604692949585992`", ",", 
   "15.184690135774034`", ",", 
   RowBox[{"-", "4.554859480323921`"}], ",", 
   RowBox[{"-", "4.655628146632778`"}], ",", 
   RowBox[{"-", "2.3341381126105993`"}], ",", 
   RowBox[{"-", "12.5059562906763`"}], ",", 
   RowBox[{"-", "4.890773176228042`"}], ",", 
   RowBox[{"-", "1.090247030028235`"}], ",", "5.744909853246438`", ",", 
   "5.7154388567769`", ",", 
   RowBox[{"-", "11.153685153845302`"}], ",", "12.252004891717572`", ",", 
   RowBox[{"-", "5.160865279177198`"}], ",", 
   RowBox[{"-", "3.358840444154718`"}], ",", "6.36435493121324`", ",", 
   "0.4466719392357962`", ",", "3.824129001006345`", ",", 
   "7.794746141308737`", ",", "1.3409608996889544`", ",", 
   RowBox[{"-", "9.567366697208346`"}], ",", "0.07844654225630891`", ",", 
   RowBox[{"-", "10.489411882336148`"}], ",", "0.9184281860192016`", ",", 
   "11.658681696885072`", ",", 
   RowBox[{"-", "14.788797101093328`"}]}], 
  "}"}]], "Output",ExpressionUUID->"db6d89fa-eda1-4d55-b516-b90fdc9cbec0"]
}, Open  ]],

Cell["Substitute shift back into links :", \
"Text",ExpressionUUID->"42e016f3-0c73-4b85-ba21-9a2d27e0e9a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SUPower", "[", 
       RowBox[{
        RowBox[{"gaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}], ".", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"I", " ", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"deltaA", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "+", 
               RowBox[{
                RowBox[{"latticeVolume", "[", "]"}], 
                RowBox[{"(", 
                 RowBox[{"dir", "-", "1"}], ")"}]}]}], ")"}]}]}]}], "]"}], 
         ".", 
         RowBox[{"suGenerators", "[", "]"}]}]}], "]"}], ".", 
      RowBox[{"SUPower", "[", 
       RowBox[{
        RowBox[{"gaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"2c9b144c-09d2-45ea-9200-8c373b57e80b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"holdGaugeField", "=", "gaugeField"}], "}"}], ",", 
   RowBox[{
    RowBox[{"gaugeField", "=", "gaugeFieldA"}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"averagePlaquette", "[", "]"}], "]"}], ";", 
    RowBox[{"gaugeField", "=", "holdGaugeField"}], ";"}]}], 
  "]"}]], "Input",ExpressionUUID->"1690e331-aca5-4d27-ac1f-3d6fe387c084"],

Cell[BoxData["0.009002121593084556`"], \
"Print",ExpressionUUID->"364eb017-6185-4b12-b0b5-871d9d04fcd3"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"a421db17-f2aa-4f1b-9d8e-dcd0e683349f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"cutoffValue", "\[Rule]", "1"}], ",", 
     RowBox[{"allLinks", "\[Rule]", "True"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"bb21a4b8-fc1e-4391-81fc-df2e74cbded0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0150880000000000002`2.7728441724579613", ",", 
     "0.021215`4.477158033934629", ",", "0.001074`3.181519279195531", ",", 
     "0.000909`3.1090788810539616"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0150880000000000002`2.7728441724579613, 0.021215`4.477158033934629, 
    0.001074`3.181519279195531, 0.000909`3.1090788810539616}],
  Editable->
   False]], "Print",ExpressionUUID->"0acef83e-b270-4c80-b69e-d85a51fb2366"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldA", "-", "libGaugeField"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"59fb20cf-7605-4cad-9859-52dc1984fa83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "48"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"ec487f34-abd8-4a28-8cf6-f2c3335a7342"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
nearest stationary point for entire lattice, one direction fixed\
\>", "Section",ExpressionUUID->"7488ae53-c653-461c-8060-ffc37066dfb9"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
lattice in Axial gauge\
\>", "Text",ExpressionUUID->"53cff859-267a-4b0c-9cff-c0e2f2328a56"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"cf2bdf57-7c3c-4c71-a5d9-fe9b984f3a59"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"fDir", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"3d8225aa-c2e6-4ed9-a9a8-ffe745843f33"],

Cell[BoxData["0.15582975480479755`"], \
"Output",ExpressionUUID->"e64702ce-3ab9-4937-8dc4-2271bf6749b9"]
}, Open  ]],

Cell["Create lattice with minimal non-trivial links.", \
"Text",ExpressionUUID->"40ddfdcc-3b45-473e-a799-adb5aef92e59"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"makeTrivialLattice", "[", 
      RowBox[{"randomGauge", "\[Rule]", "False"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"setLink", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".1", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".05", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".01", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", "0.001", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"gaugeField", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"linearSiteIndex", "[", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";"}], "*)"}], 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"ee04164d-f5b0-40f9-8227-78cd1b9832d6"],

Cell[BoxData["0.9948391690779286`"], \
"Output",ExpressionUUID->"d88f55ad-c53f-47d9-96df-76ae084bbe62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", \
"Subsection",ExpressionUUID->"bcbf9412-c6a6-48a5-9164-9910c774d13e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{
   RowBox[{"bVector", "[", 
    RowBox[{"dir_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", 
        RowBox[{"dir", ",", "site", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
     RowBox[{"suGenerators", "[", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"d4273d7d-f6c1-4265-b886-18147aa9cee8"],

Cell["\<\
Constant links in one direction.  Create links with second order perturbation:\
\>", "Text",ExpressionUUID->"439e169e-8612-4bb3-be4f-804315f6de50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", "gaugeField"}], ";", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", "c2"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"c2", "=", "coords"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dir", "\[Equal]", "fDir"}], ",", 
         RowBox[{
          RowBox[{"c2", "[", 
           RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       RowBox[{
        RowBox[{"uu", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", 
           RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
        "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"SUPower", "[", 
           RowBox[{
            RowBox[{"getLink", "[", 
             RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}], ".", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
            RowBox[{"I", " ", 
             RowBox[{"bVector", "[", 
              RowBox[{"dir", ",", "c2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"bVector", "[", 
               RowBox[{"dir", ",", "c2"}], "]"}], ".", 
              RowBox[{"bVector", "[", 
               RowBox[{"dir", ",", "c2"}], "]"}]}], "/", 
             RowBox[{"2", "!"}]}]}], ")"}], ".", 
          RowBox[{"SUPower", "[", 
           RowBox[{
            RowBox[{"getLink", "[", 
             RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}]}], 
         "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir", ",", "nd"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"3767a97d-4a7a-4872-bf9f-7375b534cada"],

Cell["Sum of plaquettes, not taking the real part:", \
"Text",ExpressionUUID->"fb7c66f3-7f20-47a1-9789-07dfbe6ad072"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coords", "=", 
          RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k2", ",", 
             RowBox[{"linearSiteIndex", "[", 
              RowBox[{"shift", "[", 
               RowBox[{"k1", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"linearSiteIndex", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"k2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
           "]"}], ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", " ", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"bb", "[", "a__", "]"}], "]"}], "\[Rule]", 
         RowBox[{"bb", "[", "a", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", 
       RowBox[{"k1", "+", "1"}], ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Average", " ", "plaquette", " ", "should", " ", "be", " ", "same", " ", 
    "as", " ", 
    RowBox[{"above", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"nc", " ", "nd", " ", 
      RowBox[{"(", 
       RowBox[{"nd", "-", "1"}], ")"}], " ", 
      RowBox[{"latticeVolume", "[", "]"}]}], ")"}]}], " ", 
   RowBox[{"Re", "[", 
    RowBox[{"rp", "/.", 
     RowBox[{
      RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"e167286e-7029-4a2a-a16c-904649391f1f"],

Cell[BoxData["0.15582975480479755`"], \
"Output",ExpressionUUID->"ebb20c86-8892-42b7-a9ba-3795d0e59a2a"]
}, Open  ]],

Cell["Calculate gradient and Hessian at bb[dir,i,k] = 0.", \
"Text",ExpressionUUID->"e92bc5b4-e610-42a5-9a37-4354d4b6c26e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "gradMap", "]"}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{"gradient1", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dims0", "=", "latticeDimensions"}], ",", 
        RowBox[{"gi", "=", "1"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"dims0", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"coords", "=", 
              RowBox[{"latticeCoordinates", "[", 
               RowBox[{"i", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"dir", "\[Equal]", "fDir"}], ",", "dims0", ",", 
                  "latticeDimensions"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"k", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"gradMap", "[", 
                 RowBox[{"dir", ",", "coords"}], "]"}], "=", "gi"}]}], "]"}], 
             ";", 
             RowBox[{"gi", "+=", "1"}], ";", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"D", "[", 
                RowBox[{"rp", ",", 
                 RowBox[{"bb", "[", 
                  RowBox[{"dir", ",", "coords", ",", "k"}], "]"}]}], "]"}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}]}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"dir", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"latticeVolume", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir", "\[Equal]", "fDir"}], ",", "dims0", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
        "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"36918714-3487-4547-af12-1a73fd867755"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8798723243559731`", ",", "0.5121227302940211`", ",", 
   RowBox[{"-", "3.2666861933084155`"}], ",", 
   RowBox[{"-", "1.8516824896904`"}], ",", 
   RowBox[{"-", "0.08781558465665656`"}], ",", 
   RowBox[{"-", "2.7309444313300015`"}], ",", "0.03679926184752236`", ",", 
   "0.06174629420049804`", ",", "4.527036659061427`", ",", 
   RowBox[{"-", "1.2145344555902158`"}], ",", "0.7266342772803858`", ",", 
   RowBox[{"-", "0.30506749959232987`"}], ",", 
   RowBox[{"-", "0.12829274506400346`"}], ",", 
   RowBox[{"-", "0.1824918834078817`"}], ",", "0.22506150745188935`", ",", 
   "1.8199238953465102`", ",", 
   RowBox[{"-", "2.307186351339411`"}], ",", "1.1654000039122672`", ",", 
   RowBox[{"-", "0.39482062471076984`"}], ",", 
   RowBox[{"-", "1.1911754590133445`"}], ",", "1.1703574074505965`", ",", 
   "1.374692992589769`", ",", 
   RowBox[{"-", "1.120325729807948`"}], ",", "0.6659542707359168`", ",", 
   RowBox[{"-", "0.10373172577898182`"}], ",", 
   RowBox[{"-", "0.27082091814944653`"}], ",", "0.8323206237271201`", ",", 
   "0.20733549077401714`", ",", 
   RowBox[{"-", "1.0836853392043837`"}], ",", "1.3647179007867234`", ",", 
   "0.6079238834616093`", ",", 
   RowBox[{"-", "2.275246505840215`"}], ",", "0.9461219338642237`", ",", 
   RowBox[{"-", "1.452775985071432`"}], ",", 
   RowBox[{"-", "2.0524855828980098`"}], ",", "1.3623073295312458`", ",", 
   RowBox[{"-", "0.7477871428620934`"}], ",", 
   RowBox[{"-", "1.3620283024547382`"}], ",", 
   RowBox[{"-", "0.48644866852623503`"}], ",", 
   RowBox[{"-", "0.7620453238707271`"}], ",", "0.05854627079664432`", ",", 
   RowBox[{"-", "0.211210110600443`"}], ",", 
   RowBox[{"-", "0.7592532878025265`"}], ",", 
   RowBox[{"-", "1.923452956006344`"}], ",", 
   RowBox[{"-", "0.1923712571293717`"}], ",", "0.4122187376931572`", ",", 
   "1.1521494110909352`", ",", 
   RowBox[{"-", "1.1060237928761198`"}], ",", "1.4213964530353285`", ",", 
   RowBox[{"-", "1.6763049363057383`"}], ",", "1.2506343432488025`", ",", 
   RowBox[{"-", "0.2892250606880275`"}], ",", 
   RowBox[{"-", "1.1715237646393581`"}], ",", 
   RowBox[{"-", "0.7145463669346246`"}], ",", 
   RowBox[{"-", "1.4074990997770587`"}], ",", 
   RowBox[{"-", "1.0620493308743444`"}], ",", 
   RowBox[{"-", "0.41065678870514377`"}], ",", 
   RowBox[{"-", "0.3817192371099659`"}], ",", "1.441695747071046`", ",", 
   RowBox[{"-", "1.2660360097672219`"}]}], 
  "}"}]], "Output",ExpressionUUID->"83525c0a-7358-4f54-89ae-519132000f30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"hess1", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dims", "=", "latticeDimensions"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"dims", "[", 
        RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"rp", ",", 
              RowBox[{"bb", "[", 
               RowBox[{"dir1", ",", 
                RowBox[{"latticeCoordinates", "[", 
                 RowBox[{"i1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"dir1", "\[Equal]", "fDir"}], ",", "dims", ",", 
                    "latticeDimensions"}], "]"}]}], "]"}], ",", "k1"}], "]"}],
               ",", 
              RowBox[{"bb", "[", 
               RowBox[{"dir2", ",", 
                RowBox[{"latticeCoordinates", "[", 
                 RowBox[{"i2", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"dir2", "\[Equal]", "fDir"}], ",", "dims", ",", 
                    "latticeDimensions"}], "]"}]}], "]"}], ",", "k2"}], 
               "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir1", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"latticeVolume", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir1", "\[Equal]", "fDir"}], ",", "dims", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir2", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"latticeVolume", "[", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir2", "\[Equal]", "fDir"}], ",", "dims", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}], "]"}]], \
"Input",ExpressionUUID->"0f2c0ae2-c2cd-4e5e-8922-0f6570ec1f29"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60", ",", "60"}], 
  "}"}]], "Output",ExpressionUUID->"ea931414-f46d-494d-917f-1d585f8965c2"]
}, Open  ]],

Cell["Shifts associated with the remaining gauge freedom.", \
"Text",ExpressionUUID->"bc2b656c-b60c-4936-a355-b40567a2929c"],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"gtf", "=", 
   RowBox[{"gaugeTransformShifts", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "]"}], ",", "fDir"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"a4f10d48-4921-4575-97b2-1430456a009c"],

Cell["The gradient is orthogonal to the gauge transform shifts :", \
"Text",ExpressionUUID->"87fb2ef0-61f3-4f06-8bd2-448907c02197"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"gtf", ".", "gradient1"}], 
  "]"}]], "Input",ExpressionUUID->"6b4d8774-fb4a-4f14-aec3-97e8ccae5889"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",ExpressionUUID->"8f6c185d-3c63-4fea-9cc2-e463125dca28"]
}, Open  ]],

Cell["But the Hessian is not, since it is a quadratic expansion :", \
"Text",ExpressionUUID->"e79361cc-a26a-42cb-937b-a866ff69515c"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"gtf", ".", "hess1", ".", 
    RowBox[{"Transpose", "[", "gtf", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"01de167d-fc1e-4b1a-916b-268da8fc5da0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"proj1", "=", 
   RowBox[{"NullSpace", "[", "gtf", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ecf4a0b2-90a2-4387-b39f-6de25af32eea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"48", ",", "60"}], 
  "}"}]], "Output",ExpressionUUID->"d630b2fe-b4f4-41e8-867b-6b4628cef6e3"]
}, Open  ]],

Cell["Find the saddle point.", \
"Text",ExpressionUUID->"bdca05dc-cccc-4eaf-b14f-90862ec4f122"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delta1", "=", 
  RowBox[{"-", 
   RowBox[{
    RowBox[{"LinearSolve", "[", 
     RowBox[{
      RowBox[{"proj1", ".", "hess1", ".", 
       RowBox[{"Transpose", "[", "proj1", "]"}]}], ",", 
      RowBox[{"proj1", ".", "gradient1"}]}], "]"}], ".", 
    "proj1"}]}]}]], \
"Input",ExpressionUUID->"bf54baa5-c392-4de0-b84d-5ecb84731673"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.8374716778593734`", ",", "3.1707982503389682`", ",", 
   "0.3655696322532653`", ",", 
   RowBox[{"-", "6.089548163423396`"}], ",", "0.11547996244880696`", ",", 
   RowBox[{"-", "1.5916828901388538`"}], ",", "2.623626445793073`", ",", 
   "8.575807150855507`", ",", "5.052854461438134`", ",", 
   RowBox[{"-", "0.42992898779528765`"}], ",", 
   RowBox[{"-", "1.867424347468895`"}], ",", 
   RowBox[{"-", "0.011211338946981427`"}], ",", "0.33053981429731355`", ",", 
   RowBox[{"-", "2.0128812049102014`"}], ",", "7.9813246496517385`", ",", 
   "0.870355324817968`", ",", 
   RowBox[{"-", "5.564244429946447`"}], ",", 
   RowBox[{"-", "1.830856362553783`"}], ",", "5.109767361839844`", ",", 
   "0.21224059482906776`", ",", "6.593149285454266`", ",", 
   "0.9880598996975325`", ",", "5.468442715547914`", ",", 
   RowBox[{"-", "2.021571957718005`"}], ",", "0.10328450415611991`", ",", 
   RowBox[{"-", "4.989996489405151`"}], ",", "9.342673781867031`", ",", 
   "0.6389577455315096`", ",", 
   RowBox[{"-", "4.151902468482231`"}], ",", "2.1568507539144135`", ",", 
   RowBox[{"-", "0.5608673231812501`"}], ",", 
   RowBox[{"-", "6.459862607319321`"}], ",", 
   RowBox[{"-", "4.665106755364703`"}], ",", 
   RowBox[{"-", "4.338876703292392`"}], ",", 
   RowBox[{"-", "0.7275261550339159`"}], ",", 
   RowBox[{"-", "5.216716559107892`"}], ",", 
   RowBox[{"-", "6.463586508439215`"}], ",", 
   RowBox[{"-", "1.8035271170834348`"}], ",", 
   RowBox[{"-", "2.281928337691573`"}], ",", 
   RowBox[{"-", "3.1206537587071526`"}], ",", "7.986753721682814`", ",", 
   RowBox[{"-", "3.6696014294187935`"}], ",", 
   RowBox[{"-", "6.369131659434746`"}], ",", 
   RowBox[{"-", "2.0532738777462876`"}], ",", "4.098148576412428`", ",", 
   RowBox[{"-", "1.107956447336512`"}], ",", 
   RowBox[{"-", "4.270881956401723`"}], ",", "1.7412535529826754`", ",", 
   RowBox[{"-", "9.131650567315578`"}], ",", 
   RowBox[{"-", "1.4640747636401983`"}], ",", "4.860089254589794`", ",", 
   "2.6763928492709708`", ",", 
   RowBox[{"-", "1.9094404660963968`"}], ",", "1.7457043603484317`", ",", 
   "3.3719058249621283`", ",", "5.290296757866749`", ",", 
   RowBox[{"-", "5.702063074424381`"}], ",", 
   RowBox[{"-", "0.01622557540830914`"}], ",", "3.950789847414725`", ",", 
   RowBox[{"-", "2.456989230760517`"}]}], 
  "}"}]], "Output",ExpressionUUID->"56eedc73-f97e-4680-9f91-1f765169b3a6"]
}, Open  ]],

Cell["Equivalently, find the saddle point using the eigensystem.", \
"Text",ExpressionUUID->"edbe454f-3f25-4eee-8532-191372595511"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals1", ",", "oo1"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"proj1", ".", "hess1", ".", 
     RowBox[{"Transpose", "[", "proj1", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"delta1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"oo1", ".", "proj1", ".", "gradient1"}]}], "/", "vals1"}], 
    ")"}], ".", "oo1", ".", 
   "proj1"}]}]}], \
"Input",ExpressionUUID->"2df2cc01-ab7d-4fef-853d-4ee96891a38f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.837471677859321`", ",", "3.1707982503389958`", ",", 
   "0.3655696322532749`", ",", 
   RowBox[{"-", "6.089548163423403`"}], ",", "0.11547996244881475`", ",", 
   RowBox[{"-", "1.59168289013883`"}], ",", "2.6236264457930645`", ",", 
   "8.575807150855482`", ",", "5.052854461438122`", ",", 
   RowBox[{"-", "0.42992898779531924`"}], ",", 
   RowBox[{"-", "1.8674243474689`"}], ",", 
   RowBox[{"-", "0.011211338946968139`"}], ",", "0.33053981429737816`", ",", 
   RowBox[{"-", "2.012881204910228`"}], ",", "7.981324649651726`", ",", 
   "0.8703553248179083`", ",", 
   RowBox[{"-", "5.564244429946364`"}], ",", 
   RowBox[{"-", "1.8308563625538161`"}], ",", "5.109767361839822`", ",", 
   "0.2122405948290574`", ",", "6.593149285454259`", ",", 
   "0.9880598996975349`", ",", "5.4684427155479325`", ",", 
   RowBox[{"-", "2.021571957718001`"}], ",", "0.1032845041561403`", ",", 
   RowBox[{"-", "4.98999648940515`"}], ",", "9.342673781867028`", ",", 
   "0.6389577455315318`", ",", 
   RowBox[{"-", "4.151902468482233`"}], ",", "2.156850753914366`", ",", 
   RowBox[{"-", "0.5608673231812128`"}], ",", 
   RowBox[{"-", "6.459862607319263`"}], ",", 
   RowBox[{"-", "4.665106755364666`"}], ",", 
   RowBox[{"-", "4.338876703292384`"}], ",", 
   RowBox[{"-", "0.7275261550339758`"}], ",", 
   RowBox[{"-", "5.216716559107895`"}], ",", 
   RowBox[{"-", "6.463586508439182`"}], ",", 
   RowBox[{"-", "1.8035271170834348`"}], ",", 
   RowBox[{"-", "2.2819283376916144`"}], ",", 
   RowBox[{"-", "3.120653758707191`"}], ",", "7.98675372168281`", ",", 
   RowBox[{"-", "3.669601429418798`"}], ",", 
   RowBox[{"-", "6.3691316594347835`"}], ",", 
   RowBox[{"-", "2.0532738777463178`"}], ",", "4.098148576412414`", ",", 
   RowBox[{"-", "1.1079564473365062`"}], ",", 
   RowBox[{"-", "4.270881956401716`"}], ",", "1.7412535529827042`", ",", 
   RowBox[{"-", "9.131650567315617`"}], ",", 
   RowBox[{"-", "1.4640747636401967`"}], ",", "4.86008925458977`", ",", 
   "2.676392849270949`", ",", 
   RowBox[{"-", "1.909440466096377`"}], ",", "1.745704360348427`", ",", 
   "3.3719058249621328`", ",", "5.290296757866731`", ",", 
   RowBox[{"-", "5.702063074424328`"}], ",", 
   RowBox[{"-", "0.016225575408370184`"}], ",", "3.9507898474146614`", ",", 
   RowBox[{"-", "2.4569892307604646`"}]}], 
  "}"}]], "Output",ExpressionUUID->"e06b3ac1-5c35-4bc9-baf5-cf992ad8fcc5"]
}, Open  ]],

Cell["Substitute shift back into links :", \
"Text",ExpressionUUID->"9f9b67e7-1c11-4fdd-9a7f-59cbe052736b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newGaugeField", "=", "gaugeField"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", 
        RowBox[{"dims", "=", "latticeDimensions"}], ",", "c2"}], "}"}], ",", 
      RowBox[{
       RowBox[{"c2", "=", "coords"}], ";", 
       RowBox[{
        RowBox[{"c2", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"dims", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"newGaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", 
           RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
        "=", 
        RowBox[{
         RowBox[{"SUPower", "[", 
          RowBox[{
           RowBox[{"getLink", "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}], ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"I", " ", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"delta1", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "-", "1", 
               "+", 
               RowBox[{"gradMap", "[", 
                RowBox[{"dir", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"dir", "\[Equal]", "fDir"}], ",", "c2", ",", 
                   "coords"}], "]"}]}], "]"}]}]}], "]"}], ".", 
            RowBox[{"suGenerators", "[", "]"}]}]}], "]"}], ".", 
         RowBox[{"SUPower", "[", 
          RowBox[{
           RowBox[{"getLink", "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], 
          "]"}]}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir", ",", "nd"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"8c6d2a69-85ca-4c70-b329-6827e40b8033"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"holdGaugeField", "=", "gaugeField"}], "}"}], ",", 
   RowBox[{
    RowBox[{"gaugeField", "=", "newGaugeField"}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"averagePlaquette", "[", "]"}], "]"}], ";", 
    RowBox[{"gaugeField", "=", "holdGaugeField"}], ";"}]}], 
  "]"}]], "Input",ExpressionUUID->"d007488d-d77a-471c-a61d-3158f6c24920"],

Cell[BoxData["0.0057037764007532386`"], \
"Print",ExpressionUUID->"55d002ff-8c42-4762-a9a7-aa42f91fbe59"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"1d172010-d31e-4a95-a770-d576bef05198"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "fDir"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"d761167c-33b7-41ba-b29c-3f6347d5d0a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0388150000000000003`2.8821820919001615", ",", 
     "0.052721`4.872498637095547", ",", "0.027566`4.59088874964835", ",", 
     "0.001605`3.3559900345728852"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0388150000000000003`2.8821820919001615, 0.052721`4.872498637095547, 
    0.027566`4.59088874964835, 0.001605`3.3559900345728852}],
  Editable->
   False]], "Print",ExpressionUUID->"90760329-d149-43b1-b949-328b39a28f11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"grad0", "-", 
    RowBox[{"proj1", ".", "gradient1"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"d594bfa1-2744-4dc1-9073-a5be0a68a1ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "48"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"6c1a495c-cc85-40d5-a396-c1b2a13448c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"hess0", "-", 
     RowBox[{"proj1", ".", "hess1", ".", 
      RowBox[{"Transpose", "[", "proj1", "]"}]}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"d2a04833-1058-4d85-9e2d-e9fd4f65a23c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2304"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"d43508fe-43c3-4f49-8d09-20b1848bfd67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"newGaugeField", "-", "libGaugeField"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"a2490951-9990-44cf-b96f-1ec13e7f56d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "96"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"24fc3fa3-fafc-45e0-957b-517e3c08faf5"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["compare lattice and link stationary point", \
"Section",ExpressionUUID->"a340fe97-3268-41ca-884e-a8cc3a02c3f4"],

Cell["\<\
Test single-link stationary point against the lattice-wide stationary point \
by including only single-link gradients.
Find agreement for single site and multiple -site lattices for SU(2), SU(3), \
and SU(4).

The Hessian matrix is block-diagonal in the lattice links.  However, in the \
case of the full lattice derivative, the eigenvectors may not be, if there \
are degenerate eigenvalues.  In that case, the rescaled shifts may be \
different for the full lattice.  This issue goes away if we remove the \
rescaling. \
\>", "Text",ExpressionUUID->"bbc3ad06-f586-438e-9458-4a077d6de427"],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"ad1a844b-dd1b-4b54-a7c5-ce87c007ff82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"7fc4b45f-9a5f-4b6d-b4c2-bb15da3f9f67"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"newGaugeField", ",", "stats"}], "}"}], "=", 
   RowBox[{"latticeSaddlePoint", "[", 
    RowBox[{
     RowBox[{"maxCount", "->", "1"}], ",", 
     RowBox[{"updateGaugeField", "\[Rule]", "False"}], ",", 
     RowBox[{"makeHess0", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"e9458e63-299c-4dd3-91dd-57684916541b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "283.5015551461338`", ",", "0.023703982478033993`"}], 
  "}"}]], "Print",ExpressionUUID->"2043c341-3bf7-4c60-a9cd-bc3e848a416b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"allLinks", "\[Rule]", "False"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"70d4bdc7-d271-44c7-8f5b-f43662618b83"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"36970645-b6de-43f7-b034-f520c3de37e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.1371709999999999993`2.828384814801965", ",", 
     "0.184454`5.416403075443564", ",", "0.006642`3.9728138690943604", ",", 
     "0.00303`3.631957626334299"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.1371709999999999993`2.828384814801965, 0.184454`5.416403075443564, 
    0.006642`3.9728138690943604, 0.00303`3.631957626334299}],
  Editable->
   False]], "Print",ExpressionUUID->"db2d01a1-fc9e-4a52-8a45-61873f66112a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "12", ",", "3", ",", "3"}], 
  "}"}]], "Output",ExpressionUUID->"c06d2467-3797-4afc-a703-5692a7154741"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"libGaugeField", "-", "newGaugeField"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"97e2b4e1-114d-4411-b8c0-7919ce39e626"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "324"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"cbe5bacd-aca2-4f66-a722-55b8d779280e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Small perturbations", \
"Section",ExpressionUUID->"22698d26-6d55-423f-859a-7ca0272c3f2a"],

Cell["\<\
Verify that small perturbations from a trivial lattice go back to the saddle \
point.
We see that it doesn\[CloseCurlyQuote]t converge without \
rescaleCutoff<Infinity or dampingFactor<1.  A combination works best.\
\>", "Text",ExpressionUUID->"e7e69176-da0f-40b3-917f-64f85c25dae6"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"d89b2911-6049-4cc5-a96b-820a3fe87e36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"makeTrivialLattice", "[", 
   RowBox[{
    RowBox[{"randomPerturbation", "\[Rule]", "0.001"}], ",", 
    RowBox[{"randomGauge", "\[Rule]", "True"}]}], "]"}], ";", 
  RowBox[{"1", "-", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"5455b0c9-9c63-4134-bc66-49fcd7e840d2"],

Cell[BoxData["1.5346633086554817`*^-7"], \
"Output",ExpressionUUID->"905b94e5-4fbb-43a7-b127-f8b5b48743fd"]
}, Open  ]],

Cell["Apply one saddle-point step :", \
"Text",ExpressionUUID->"a7455e12-39e5-49f9-8b2d-aca24b405381"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"gaugeField", "=", 
     RowBox[{"latticeSaddlePointStep", "[", 
      RowBox[{
       RowBox[{"allLinks", "\[Rule]", "False"}], ",", 
       RowBox[{"dampingFactor", "\[Rule]", "0.5"}], ",", 
       RowBox[{"rescaleCutoff", "\[Rule]", "0.001"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"1", "-", 
      RowBox[{"averagePlaquette", "[", "]"}]}], "]"}]}], ",", 
   RowBox[{"{", "20", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"a5f9b768-1d2c-4a95-9050-538d073bfb63"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"04fa834e-0704-4703-af96-c9d1f60c7076"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0450999999999999999`2.822420306670385", ",", 
     "0.060378`4.931393720905468", ",", "0.001298`3.2637896902963446", ",", 
     "0.001101`3.1923023168037457"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0450999999999999999`2.822420306670385, 0.060378`4.931393720905468, 
    0.001298`3.2637896902963446, 0.001101`3.1923023168037457}],
  Editable->
   False]], "Print",ExpressionUUID->"adb8218c-c131-4f5b-a6b8-79e43b1e20af"],

Cell[BoxData["1.2236136548438026`*^-8"], \
"Print",ExpressionUUID->"6be3683c-3fcd-4b1d-9e6c-b0c5740a0140"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"bf006c02-a669-4906-8924-b6fa646fab53"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.042507`2.796704219808451", ",", "0.056295`4.900984821300757", ",", 
     "0.001153`3.2123443051266927", ",", "0.001021`3.159540739918904"}], 
    "}"}]}],
  SequenceForm[
  "times:  ", {
   0.042507`2.796704219808451, 0.056295`4.900984821300757, 
    0.001153`3.2123443051266927, 0.001021`3.159540739918904}],
  Editable->
   False]], "Print",ExpressionUUID->"7d1ac1a7-15e7-40ac-b756-31c9ec0e7ce1"],

Cell[BoxData["3.059044795250543`*^-9"], \
"Print",ExpressionUUID->"6bc7d540-36f2-4c1a-bed7-085bd3efd918"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"8e7546ad-4542-4260-b0f7-0a11fd6f811d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0446340000000000001`2.81790957388445", ",", 
     "0.05922`4.922983400885274", ",", "0.001218`3.2361622861288506", ",", 
     "0.001049`3.1712904860255517"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0446340000000000001`2.81790957388445, 0.05922`4.922983400885274, 
    0.001218`3.2361622861288506, 0.001049`3.1712904860255517}],
  Editable->
   False]], "Print",ExpressionUUID->"447c8c31-7457-455d-a859-fa35166faa12"],

Cell[BoxData["7.647731337101504`*^-10"], \
"Print",ExpressionUUID->"29ddcda5-cae3-47d1-bf53-52d166a78a8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"d370b11b-eb62-4f8b-ad20-5c90991d6d77"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0483359999999999996`2.85251447272163", ",", 
     "0.064616`4.960855067705266", ",", "0.001478`3.320189431890801", ",", 
     "0.00135`3.2808487663270003"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0483359999999999996`2.85251447272163, 0.064616`4.960855067705266, 
    0.001478`3.320189431890801, 0.00135`3.2808487663270003}],
  Editable->
   False]], "Print",ExpressionUUID->"30d48830-6287-43a1-9f55-1d1e304d9a58"],

Cell[BoxData["1.9120527383620356`*^-10"], \
"Print",ExpressionUUID->"e0485441-4de1-4278-a760-b070c08b3b1c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"0e4dbe80-4827-4a0b-8528-439f5d39e425"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0451850000000000002`2.823238051409122", ",", 
     "0.060069`4.929165399912581", ",", "0.001235`3.2421819554276783", ",", 
     "0.001129`3.203208939756962"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0451850000000000002`2.823238051409122, 0.060069`4.929165399912581, 
    0.001235`3.2421819554276783, 0.001129`3.203208939756962}],
  Editable->
   False]], "Print",ExpressionUUID->"03635443-6ab8-4a9b-987c-fa8afbb3042b"],

Cell[BoxData["4.781330886771684`*^-11"], \
"Print",ExpressionUUID->"7b528d93-dff0-4634-9046-fb175d180e3c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"895c0cea-02e6-49fe-a759-8495340ddca6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0477870000000000002`2.8475535317781384", ",", 
     "0.063206`4.951273304646148", ",", "0.00126`3.250885542949557", ",", 
     "0.001126`3.2020533883473212"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0477870000000000002`2.8475535317781384, 0.063206`4.951273304646148, 
    0.00126`3.250885542949557, 0.001126`3.2020533883473212}],
  Editable->
   False]], "Print",ExpressionUUID->"31a5dd6d-0501-4df1-9c7f-5c68c6dd7811"],

Cell[BoxData["1.1965539670200087`*^-11"], \
"Print",ExpressionUUID->"d6f10a3b-f889-4e31-bf1b-17d3d1cc43f1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"5f51203a-eb6c-4016-8fb2-25ddf67ebb8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0464079999999999998`2.8348366172519674", ",", 
     "0.06142`4.938824809939044", ",", "0.001251`3.2477723075254135", ",", 
     "0.00114`3.2074198491684665"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0464079999999999998`2.8348366172519674, 0.06142`4.938824809939044, 
    0.001251`3.2477723075254135, 0.00114`3.2074198491684665}],
  Editable->
   False]], "Print",ExpressionUUID->"94111d9f-873a-4411-8233-7d4d6cd24e5e"],

Cell[BoxData["3.003708393123361`*^-12"], \
"Print",ExpressionUUID->"e3dce67b-154f-495c-b9a7-e3bbe847d098"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"4f3fff7f-592f-46dc-b78b-58af085b27ec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0476559999999999998`2.8463613518832127", ",", 
     "0.062802`4.948488472383411", ",", "0.001234`3.2418301575292165", ",", 
     "0.001153`3.2123443051266927"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0476559999999999998`2.8463613518832127, 0.062802`4.948488472383411, 
    0.001234`3.2418301575292165, 0.001153`3.2123443051266927}],
  Editable->
   False]], "Print",ExpressionUUID->"528f631f-a329-49d9-bdad-7206b805836b"],

Cell[BoxData["7.635003740347202`*^-13"], \
"Print",ExpressionUUID->"a4fcdb19-0a7b-4fa8-b9cb-e69257caa46a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"bbe3c8dd-a5d0-4c78-b384-e49b00d90919"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.051318`2.8785134872051903", ",", "0.067842`4.982013640384905", ",", 
     "0.001607`3.3565308745953386", ",", "0.00179`3.403368028811887"}], 
    "}"}]}],
  SequenceForm[
  "times:  ", {
   0.051318`2.8785134872051903, 0.067842`4.982013640384905, 
    0.001607`3.3565308745953386, 0.00179`3.403368028811887}],
  Editable->
   False]], "Print",ExpressionUUID->"a48f27ef-54b2-4e5a-ab10-8b27eaa5f7ed"],

Cell[BoxData["2.0317081350640365`*^-13"], \
"Print",ExpressionUUID->"1d82216b-d031-4425-b1ea-d57782b2c422"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"6d393db6-aea0-4da9-ba1e-fee06d64f1bc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0485179999999999999`2.8541466549493277", ",", 
     "0.064467`4.959852458429941", ",", "0.001349`3.280526947503898", ",", 
     "0.001339`3.277295574844003"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0485179999999999999`2.8541466549493277, 0.064467`4.959852458429941, 
    0.001349`3.280526947503898, 0.001339`3.277295574844003}],
  Editable->
   False]], "Print",ExpressionUUID->"9bc678ed-a46c-4a8f-a872-d0e04541bebb"],

Cell[BoxData["6.306066779870889`*^-14"], \
"Print",ExpressionUUID->"06221e16-c597-49cf-9012-f0311fccdfe0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"712a2b86-1e25-4ee0-888f-7808a4e1a01c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0476190000000000004`2.8460240357638047", ",", 
     "0.063196`4.951204588251975", ",", "0.001186`3.2245996868602376", ",", 
     "0.001123`3.200894754093452"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0476190000000000004`2.8460240357638047, 0.063196`4.951204588251975, 
    0.001186`3.2245996868602376, 0.001123`3.200894754093452}],
  Editable->
   False]], "Print",ExpressionUUID->"5b0ca463-9b4a-423b-bf28-c27bd5824ea4"],

Cell[BoxData["2.7644553313166398`*^-14"], \
"Print",ExpressionUUID->"c30901ec-a509-469e-87d0-0685eb45c27e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"8cad4937-2c32-4cea-98f8-852801ace010"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0507099999999999999`2.8733373753402964", ",", 
     "0.067086`4.97714689568914", ",", "0.001168`3.2179578406083746", ",", 
     "0.001105`3.1938772758531235"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0507099999999999999`2.8733373753402964, 0.067086`4.97714689568914, 
    0.001168`3.2179578406083746, 0.001105`3.1938772758531235}],
  Editable->
   False]], "Print",ExpressionUUID->"15eac703-0189-4544-952a-1ac45c0c29e9"],

Cell[BoxData["1.8762769116165146`*^-14"], \
"Print",ExpressionUUID->"fa8c33d0-983a-4250-9e45-01886e3fea2b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"1db0304a-bc62-45d8-8f6f-422b4eacb373"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0512080000000000001`2.87758157898016", ",", 
     "0.067372`4.978994437808558", ",", "0.001722`3.38654814494963", ",", 
     "0.001871`3.422588785332004"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0512080000000000001`2.87758157898016, 0.067372`4.978994437808558, 
    0.001722`3.38654814494963, 0.001871`3.422588785332004}],
  Editable->
   False]], "Print",ExpressionUUID->"4f223bc1-1189-463b-8cd5-c4fa262aa0eb"],

Cell[BoxData["1.7430501486614958`*^-14"], \
"Print",ExpressionUUID->"70612ccf-8e66-429b-a4e7-87466a77aa00"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"1aef9b41-52ee-4a48-9fd1-45fbf095995e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0438049999999999999`2.809767449462652", ",", 
     "0.058675`4.918968096102624", ",", "0.001077`3.1827307011299757", ",", 
     "0.000974`3.1390739547106095"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0438049999999999999`2.809767449462652, 0.058675`4.918968096102624, 
    0.001077`3.1827307011299757, 0.000974`3.1390739547106095}],
  Editable->
   False]], "Print",ExpressionUUID->"32b53abb-aebc-460d-8321-358146c5adfd"],

Cell[BoxData["1.6209256159527285`*^-14"], \
"Print",ExpressionUUID->"72ed4a51-ae67-4454-a6eb-c0710b1b79af"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"4a834965-28b1-469e-ae93-f6e59f752239"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0466220000000000004`2.836834664829259", ",", 
     "0.062676`4.947616269716613", ",", "0.001091`3.1883397484203355", ",", 
     "0.001004`3.1522487106409947"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0466220000000000004`2.836834664829259, 0.062676`4.947616269716613, 
    0.001091`3.1883397484203355, 0.001004`3.1522487106409947}],
  Editable->
   False]], "Print",ExpressionUUID->"72d236e1-0998-4098-9aa8-434bb627d67b"],

Cell[BoxData["1.6653345369377348`*^-14"], \
"Print",ExpressionUUID->"5bfba772-9d90-406c-8b7f-14e249a1c5ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"9dd57fb3-ec3b-42c9-9cfc-1ffb860d7061"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.057545`2.928251359191861", ",", "0.075375`5.027742322980202", ",", 
     "0.001335`3.275996263532588", ",", "0.001269`3.2539766199266986"}], 
    "}"}]}],
  SequenceForm[
  "times:  ", {
   0.057545`2.928251359191861, 0.075375`5.027742322980202, 
    0.001335`3.275996263532588, 0.001269`3.2539766199266986}],
  Editable->
   False]], "Print",ExpressionUUID->"d2a1ec9b-8630-4afc-88ea-e489b712ca54"],

Cell[BoxData["1.6653345369377348`*^-14"], \
"Print",ExpressionUUID->"bd3699f7-b126-4a75-980b-42a2b043264d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"efe18e18-4fba-4abd-8a87-d41ae719ecba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0585779999999999997`2.935978304487073", ",", 
     "0.076044`5.031579951004859", ",", "0.001377`3.2894489380889174", ",", 
     "0.00129`3.2611047081312425"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0585779999999999997`2.935978304487073, 0.076044`5.031579951004859, 
    0.001377`3.2894489380889174, 0.00129`3.2611047081312425}],
  Editable->
   False]], "Print",ExpressionUUID->"4ebdaeaf-6643-4685-b7c7-d735598f4ce5"],

Cell[BoxData["1.6209256159527285`*^-14"], \
"Print",ExpressionUUID->"e83cd1b0-8d77-43a7-ae6f-18774dd65307"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"846907d9-76d4-4835-b20f-8438d32aacb0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0592839999999999999`2.9411812633959684", ",", 
     "0.077307`5.038733818059935", ",", "0.001384`3.2916510879527334", ",", 
     "0.001298`3.2637896902963446"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0592839999999999999`2.9411812633959684, 0.077307`5.038733818059935, 
    0.001384`3.2916510879527334, 0.001298`3.2637896902963446}],
  Editable->
   False]], "Print",ExpressionUUID->"83b8e6c2-5fa2-4feb-8714-647b107be9ad"],

Cell[BoxData["1.6431300764452317`*^-14"], \
"Print",ExpressionUUID->"8599ddbe-630a-43cc-b9f5-ac84ac2ab2aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"65ce8347-d6c6-42dc-8202-c818a7ba22d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0432639999999999997`2.8043704347179474", ",", 
     "0.057899`4.913186060726402", ",", "0.001075`3.1819234620836183", ",", 
     "0.000992`3.1470266699861726"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0432639999999999997`2.8043704347179474, 0.057899`4.913186060726402, 
    0.001075`3.1819234620836183, 0.000992`3.1470266699861726}],
  Editable->
   False]], "Print",ExpressionUUID->"37a043ec-a1a1-4227-a58c-3621f48d7448"],

Cell[BoxData["1.5987211554602254`*^-14"], \
"Print",ExpressionUUID->"c6d93177-ef21-4551-9cf2-2a7bc0fd5539"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"be5fbace-ca73-43f8-a45d-468034c05747"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0435920000000000001`2.807650559688478", ",", 
     "0.057569`4.91070368345781", ",", "0.001427`3.304938970946641", ",", 
     "0.001235`3.2421819554276783"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0435920000000000001`2.807650559688478, 0.057569`4.91070368345781, 
    0.001427`3.304938970946641, 0.001235`3.2421819554276783}],
  Editable->
   False]], "Print",ExpressionUUID->"b119b834-6b7a-44f1-904f-24bb38ba3883"],

Cell[BoxData["1.6653345369377348`*^-14"], \
"Print",ExpressionUUID->"df5e20eb-5989-4bb8-b32d-7cce50cb06c1"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare dynamic and Axial shifts", \
"Section",ExpressionUUID->"7e066a80-14b5-4adb-ae99-038b8a9a9aeb"],

Cell["\<\
Dynamic shifts and Axial-gauge preserving shifts should be identical, aside \
from gauge choice, even if the cutoff is included.\
\>", "Text",ExpressionUUID->"aec8e9a2-b4b7-4f09-b462-e4159f993f2d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"aa6b0ed3-b050-49b7-b00a-9848d0ad719c"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"66b8532c-2b58-4a1e-a745-f05071ec3055"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fDir", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"averagePlaquette", "[", 
  "]"}]}], "Input",ExpressionUUID->"b55404e5-fc57-4e18-b448-2f24b90c2d0f"],

Cell[BoxData["0.5968465331757858`"], \
"Output",ExpressionUUID->"1f275db8-3fd8-4282-98b7-fd151f1127e3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare MINRES/MINRES-QLP versus dense, no cutoff.", \
"Section",ExpressionUUID->"be1c8d73-325b-4af5-8ebf-8cb69b0e8b17"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"17e7bac8-07a8-4e45-b99c-2f16eec67b84"],

Cell[" Choose method:", \
"Text",ExpressionUUID->"b0d484c2-6674-421c-8389-0f471c04b29d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Keys", "[", "minresLabels", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"minresMethod", "=", 
  RowBox[{
   RowBox[{"Keys", "[", "minresLabels", "]"}], "[", 
   RowBox[{"[", "4", "]"}], 
   "]"}]}]}], "Input",ExpressionUUID->"d5af84e9-7023-46cc-a860-2b5d12914ae7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"MINRES\"\>", ",", "\<\"MINRES1\"\>", ",", "\<\"MINRES-QLP\"\>",
    ",", "\<\"MINRES-QLP0\"\>"}], 
  "}"}]], "Print",ExpressionUUID->"20b7ae9d-94fb-42c2-8a5b-c21b74844544"],

Cell[BoxData["\<\"MINRES-QLP0\"\>"], \
"Output",ExpressionUUID->"c7b83d08-48b4-4fb9-93d9-1f698800db74"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamic/All", \
"Subsection",ExpressionUUID->"a5f6a33f-487e-4105-ab6a-2d4fa3c64cd0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAllDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"174513f8-eb45-4f2f-9903-04bd581024e8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "256.1294820803012`", ",", "2184.7745600576045`", ",", 
     "1.0000000000035034`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {256.1294820803012, 2184.7745600576045`, 
   1.0000000000035034`}],
  Editable->
   False]], "Print",ExpressionUUID->"4342b038-04b5-457a-b97f-d0cea1a7b6b5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1778879999999999989`3.3021593241160856", ",", 
     "2.583098`6.562655880990158", ",", "0.717111`6.0061013821698035", ",", 
     "0.01655`4.369312995943731"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1778879999999999989`3.3021593241160856, 2.583098`6.562655880990158, 
    0.717111`6.0061013821698035, 0.01655`4.369312995943731}],
  Editable->
   False]], "Print",ExpressionUUID->"ae788134-1884-4ac3-be50-e2d8249ae9ea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9d010c3b-1093-43b2-9b1d-c7897f2ae680"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "48.38752483887463`", ",", "366.95073509390375`", ",", 
     "1.000000000000167`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {48.38752483887463, 366.95073509390375`, 
   1.000000000000167}],
  Editable->
   False]], "Print",ExpressionUUID->"00efb574-2613-478f-a231-13bbd0b48b48"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.2850839999999999995`3.323025951560277", ",", 
     "2.705441`6.582753065151112", ",", "1.184981`6.224226384750851", ",", 
     "0.01708`4.38300286418498"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.2850839999999999995`3.323025951560277, 2.705441`6.582753065151112, 
    1.184981`6.224226384750851, 0.01708`4.38300286418498}],
  Editable->
   False]], "Print",ExpressionUUID->"f4d448d0-d75d-44bd-8240-ebea30e1df47"]
}, Open  ]]
}, Open  ]],

Cell["\<\
For projecting out the gauge transforms on a Nc=3, 4^3 lattice:
247 seconds for solving squared system using conjugate gradients.
67 seconds for default (dense?) LeastSquares
83 seconds for  LeastSquares Krylov method (tol=Automatic).
515 seconds for LeastSquares Krylov, tolerance=0.01
365 seconds for LeastSquares Krylov, tolerance=100\
\>", "Text",ExpressionUUID->"695e9c47-a5c0-435d-945b-6d16401edb31"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAllMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"minresMethod", ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"c94c2a4b-3a44-40b9-8184-fba505e299e2"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "306"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 306],
  Editable->
   False]], "Print",ExpressionUUID->"1a37b936-4235-4ecb-995d-ebc7abb62468"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.575405806364518`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.575405806364518],
  Editable->
   False]], "Print",ExpressionUUID->"d9dd74dc-c647-40c8-ba33-a7379bf4173b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.0354139999999999996`2.213968554302173", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.1209469999999999992`2.4463586761676783", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.189575`5.4282960624905945"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.0354139999999999996`2.213968554302173, ", orthogonalization=", 
   0.1209469999999999992`2.4463586761676783, ", total=", 
   0.189575`5.4282960624905945],
  Editable->
   False]], "Print",ExpressionUUID->"b33369aa-5f6f-4248-b7cd-b4c5e819f35d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"b3f1aba6-d3a0-4a9a-bf4b-3b584f7fb52e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "153", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 0, " of ", 153, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"fd999edb-a6da-48a4-a48b-b427df164b47"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "0.0143520000000000007`0.5337140982549896", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0112369999999999995`0.4504256274605579", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.2364950000000000002`1.7506967678472143", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "1.526829`6.334305398008953"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   0.0143520000000000007`0.5337140982549896, ", small shifts=", 
   0.0112369999999999995`0.4504256274605579, ", A=", 
   0.2364950000000000002`1.7506967678472143, ", total=", 
   1.526829`6.334305398008953],
  Editable->
   False]], "Print",ExpressionUUID->"f29286b0-d0cd-414e-900a-6b8d8dc8e14b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.2919049999999999987`3.324320394196739", ",", 
     "2.692175`6.5806182848341965", ",", "1.529441`6.335047726051251", ",", 
     "0.017751`4.399737821828668"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.2919049999999999987`3.324320394196739, 2.692175`6.5806182848341965, 
    1.529441`6.335047726051251, 0.017751`4.399737821828668}],
  Editable->
   False]], "Print",ExpressionUUID->"c1a55267-fcfd-40e4-bd41-426545e2aaf3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10", "^", 
          RowBox[{"-", "13"}]}]}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"minresMethod", ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0777b3fa-bcff-4c35-aae5-1f417928ada7"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"399.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     398576.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"MINRES\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[398576., 3], " (bytes) for ", "MINRES"],
  Editable->
   False]], "Print",ExpressionUUID->"90f3f375-d678-4899-803f-70412e30692a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "306"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 306],
  Editable->
   False]], "Print",ExpressionUUID->"cc0a9e69-6a4b-414c-96aa-9f7fd7e89ed8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.5614787334082467`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.5614787334082467`],
  Editable->
   False]], "Print",ExpressionUUID->"2c5172c1-0028-4b8c-91f4-f59ff396b14d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "1.8559259999999999999`3.933354227267537", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.1616859999999999995`2.572435992711132", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "2.056708`6.463687635180357"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   1.8559259999999999999`3.933354227267537, ", orthogonalization=", 
   0.1616859999999999995`2.572435992711132, ", total=", 
   2.056708`6.463687635180357],
  Editable->
   False]], "Print",ExpressionUUID->"cf0f53d4-c237-47b5-87ea-c3faa6559b97"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"a8a48fa8-ccf9-47a7-aa78-e31d3303f5b5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "153", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 0, " of ", 153, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"61313096-49e1-4f13-b7d6-d55042d461d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "40.9249330000000000006`3.9527413098069166", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0195809999999999972`0.6536866521267765", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.6041560000000000024`2.1219697320267974", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "43.433186`7.788336685620876"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   40.9249330000000000006`3.9527413098069166, ", small shifts=", 
   0.0195809999999999972`0.6536866521267765, ", A=", 
   0.6041560000000000024`2.1219697320267974, ", total=", 
   43.433186`7.788336685620876],
  Editable->
   False]], "Print",ExpressionUUID->"b26e65cf-3421-4ebc-87db-ab9ef9a7f1ce"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.3320230000000000017`3.331856611552716", ",", 
     "2.741779`6.5885474435631775", ",", "43.657828`7.7905771233627235", ",", 
     "0.020209`4.456059821726972"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.3320230000000000017`3.331856611552716, 2.741779`6.5885474435631775, 
    43.657828`7.7905771233627235, 0.020209`4.456059821726972}],
  Editable->
   False]], "Print",ExpressionUUID->"a4514d9d-b1b5-4141-b4e8-a77bccdf943e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAllDense", "-", "gaugeFieldAllMinres"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"a1d55b1f-7f67-460b-a594-81113b654881"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1728"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"9d4ce146-5268-4551-b7dd-fc5dcae52c8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldDynamicDense", "-", "gaugeFieldDynamicMinres"}], 
     "]"}], ",", 
    RowBox[{"5", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"a0e847ec-38e5-4389-88f0-2781d287778f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1728"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"56a461bf-0549-4e4c-913a-9727a42969b2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Axial", \
"Subsection",ExpressionUUID->"c1544c4e-2cde-4f17-bb05-d8335e520e4b"],

Cell["Compare for the Axial-constant shifts", \
"Text",ExpressionUUID->"94c94240-c889-48c0-87fe-db4f6c655084"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"axialDirection", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "axialDirection", "]"}], ";", 
  RowBox[{"gaugeFieldAxialDense1", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"391f443c-225b-4748-b7fc-be773ebd5ee4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "162.13252049775028`", ",", "1094.5412611326012`", ",", 
     "0.9999999999988488`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {162.13252049775028`, 1094.5412611326012`, 
   0.9999999999988488}],
  Editable->
   False]], "Print",ExpressionUUID->"c331556a-7db7-4bd2-b833-d2fceba24ef5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.7217099999999999994`3.3989656311047276", ",", 
     "3.119159`6.644552511435755", ",", "1.18357`6.223708946379075", ",", 
     "0.022871`4.5098001517254644"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.7217099999999999994`3.3989656311047276, 3.119159`6.644552511435755, 
    1.18357`6.223708946379075, 0.022871`4.5098001517254644}],
  Editable->
   False]], "Print",ExpressionUUID->"617e18d4-6b35-4f85-9ce3-facdaa0b3973"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxialMinres1", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"Method", "\[Rule]", "minresMethod"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10", "^", 
          RowBox[{"-", "13"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"a2b6321f-2ae5-4e9e-bbfb-de52cbe544c4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"280.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     280240.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"MINRES\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[280240., 3], " (bytes) for ", "MINRES"],
  Editable->
   False]], "Print",ExpressionUUID->"3cbaebd6-fb4d-4c4e-953b-1cf874137753"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "230"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 230],
  Editable->
   False]], "Print",ExpressionUUID->"6dcd0af8-8d13-443f-a442-af8cc5f11a82"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "6.244077762402287`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 6.244077762402287],
  Editable->
   False]], "Print",ExpressionUUID->"c8f31d5a-d544-4555-93a0-2427806b467b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.8690619999999999996`3.7278379224948024", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.0615810000000000009`2.277203903185212", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.95597`6.1309592614063275"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.8690619999999999996`3.7278379224948024, ", orthogonalization=", 
   0.0615810000000000009`2.277203903185212, ", total=", 
   0.95597`6.1309592614063275],
  Editable->
   False]], "Print",ExpressionUUID->"c9e38049-46ca-4bc0-a838-12b0896388b6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"25476f84-25dc-42a2-b532-91b1fc96f799"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "115", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 0, " of ", 115, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"016d292b-fcca-4622-b94d-c2c7f5928774"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minresqlp0.  \"\>", "\[InvisibleSpace]", "\<\" flag=\"\>",
    "\[InvisibleSpace]", "8", "\[InvisibleSpace]", "\<\"   \"\>", 
   "\[InvisibleSpace]", "\<\" The iteration limit was reached                 \
       \"\>"}],
  SequenceForm[
  "Exit minresqlp0.  ", " flag=", 8, "   ", 
   " The iteration limit was reached                        "],
  Editable->
   False]], "Print",ExpressionUUID->"995cd3f3-ed83-47ac-9983-b0c700d843ec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minresqlp0.  \"\>", "\[InvisibleSpace]", "\<\" iter=\"\>",
    "\[InvisibleSpace]", "4608"}],
  SequenceForm["Exit minresqlp0.  ", " iter=", 4608],
  Editable->
   False]], "Print",ExpressionUUID->"a30f07a4-eb40-4e6b-a7eb-81c9f52d1a44"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minresqlp0.  \"\>", 
   "\[InvisibleSpace]", "\<\" rnorm=\"\>", "\[InvisibleSpace]", 
   "2.0675218189890725`*^-9", "\[InvisibleSpace]", "\<\"   rnorm direct=\"\>",
    "\[InvisibleSpace]", "2.0675218189890725`*^-9"}],
  SequenceForm[
  "Exit minresqlp0.  ", " rnorm=", 2.0675218189890725`*^-9, 
   "   rnorm direct=", 2.0675218189890725`*^-9],
  Editable->
   False]], "Print",ExpressionUUID->"8162df02-c7c6-4ea2-bd99-8ad24eb2f679"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minresqlp0.  \"\>", 
   "\[InvisibleSpace]", "\<\"                   Arnorm direct=\"\>", 
   "\[InvisibleSpace]", "1.5602212742328049`*^-9"}],
  SequenceForm[
  "Exit minresqlp0.  ", "                   Arnorm direct=", 
   1.5602212742328049`*^-9],
  Editable->
   False]], "Print",ExpressionUUID->"a68f02cf-735e-47f8-a5d6-ecb4298d0e61"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minresqlp0.  \"\>", 
   "\[InvisibleSpace]", "\<\" xnorm=\"\>", "\[InvisibleSpace]", 
   "1094.5412612088169`", "\[InvisibleSpace]", "\<\"   xnorm direct=\"\>", 
   "\[InvisibleSpace]", "1094.5412612088169`"}],
  SequenceForm[
  "Exit minresqlp0.  ", " xnorm=", 1094.5412612088169`, "   xnorm direct=", 
   1094.5412612088169`],
  Editable->
   False]], "Print",ExpressionUUID->"e893dc78-4b1b-4cab-bc5f-43e3fdc912ac"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minresqlp0.  \"\>", 
   "\[InvisibleSpace]", "\<\" Anorm=\"\>", "\[InvisibleSpace]", 
   "7.6182912236956275`", "\[InvisibleSpace]", "\<\"   Acond=\"\>", 
   "\[InvisibleSpace]", "527.2450087631778`"}],
  SequenceForm[
  "Exit minresqlp0.  ", " Anorm=", 7.6182912236956275`, "   Acond=", 
   527.2450087631778],
  Editable->
   False]], "Print",ExpressionUUID->"b7a7986b-8060-4d06-9fe9-2988865bfea2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "18.110772999999999998`3.723516902361607", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0146930000000000034`0.653830354209244", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.2365819999999999997`1.839651335067616", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "19.665265`7.444214800968416"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   18.110772999999999998`3.723516902361607, ", small shifts=", 
   0.0146930000000000034`0.653830354209244, ", A=", 
   0.2365819999999999997`1.839651335067616, ", total=", 
   19.665265`7.444214800968416],
  Editable->
   False]], "Print",ExpressionUUID->"763db7a8-eef4-47d8-aba7-1282f51a298d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.6820029999999999996`3.392583041439812", ",", 
     "3.062157`6.636542451498512", ",", "19.848619`7.448245293236232", ",", 
     "0.021092`4.474632760491421"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.6820029999999999996`3.392583041439812, 3.062157`6.636542451498512, 
    19.848619`7.448245293236232, 0.021092`4.474632760491421}],
  Editable->
   False]], "Print",ExpressionUUID->"2e7d8130-5bca-4d27-8f84-d6c9b30032c9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAxialDense1", "-", "gaugeFieldAxialMinres1"}], "]"}], 
    ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"64dd34b8-b590-465a-99e9-9c85f130bff2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1728"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"a8c1742d-2422-41df-a3f6-cc7254df1047"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare MINRES/MINRES-QLP versus dense", \
"Section",ExpressionUUID->"1ee33c5d-17c8-437a-9145-6a2937e17abe"],

Cell["\<\
MINRES/MINRES-QLP with special handling of large shift eigenvalues, compared \
to dense calculation.\
\>", "Text",ExpressionUUID->"8a83fe88-77ea-4291-a4c9-7df3576e0160"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"b526a658-67f0-4875-8ac5-1b6bfa49b5a2"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"de8dcad6-ee9f-4c4d-b8ef-a91861ade22e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], ";", 
  RowBox[{"shiftsDynamicDense", "=", "shifts0"}], 
  ";"}]], "Input",ExpressionUUID->"89f1d4ee-77ad-4a21-b2d4-e62d1cd6d244"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "14", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 14, " of ", 1024, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"bd5e43ab-a485-45c3-ba70-0467615bd8a1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.320151887931159`", ",", "58.5590236105344`", ",", 
     "0.9999999999998886`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {8.320151887931159, 58.5590236105344, 
   0.9999999999998886}],
  Editable->
   False]], "Print",ExpressionUUID->"4f784a9c-3ac6-4ca8-a4f2-c064c21960b0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.320151887931159`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.320151887931159, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"1c67e584-ed05-4879-950e-7c4682f6ac34"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.2143719999999999986`3.309374363438096", ",", 
     "2.619471`6.568728592595462", ",", "1.29851`6.2639602963703584", ",", 
     "0.017799`4.400910600889111"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.2143719999999999986`3.309374363438096, 2.619471`6.568728592595462, 
    1.29851`6.2639602963703584, 0.017799`4.400910600889111}],
  Editable->
   False]], "Print",ExpressionUUID->"254da0d6-3d74-4002-a5f9-37b4fb4a4a56"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"axialDirection", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "axialDirection", "]"}], ";", 
  RowBox[{"gaugeFieldAxialDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}]}], "]"}]}], ";", 
  RowBox[{"shiftsAxialDense", "=", "shifts0"}], 
  ";"}]], "Input",ExpressionUUID->"f30ad05b-0c75-40b2-b4a4-3fdee63ca5c6"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "18", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 18, " of ", 1024, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"763f7c57-b566-48d7-9707-480d58eac1c0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "9.950408275075661`", ",", "57.671138024498845`", ",", 
     "0.9999999999999637`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {9.950408275075661, 57.671138024498845`, 
   0.9999999999999637}],
  Editable->
   False]], "Print",ExpressionUUID->"08e54216-91e9-49a3-8f9f-978e2f56738b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "9.950408275075661`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 9.950408275075661, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"4f404fa2-9c0d-4220-befa-c196eb0f279a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.273223000000000001`3.320765823633121", ",", 
     "2.617214`6.568354232592387", ",", "1.03153`6.16399686091673", ",", 
     "0.023941`4.529657284479315"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.273223000000000001`3.320765823633121, 2.617214`6.568354232592387, 
    1.03153`6.16399686091673, 0.023941`4.529657284479315}],
  Editable->
   False]], "Print",ExpressionUUID->"3d670f37-ca15-4680-9edb-00b2382b7faf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", 
     RowBox[{"largeShiftSearch", "\[Rule]", "500"}]}], "]"}]}], ";", 
  RowBox[{"shiftsDynamicMinres", "=", "shifts0"}], 
  ";"}]], "Input",ExpressionUUID->"4ae56d15-6f51-4241-a723-7323eb2d6ff8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"399.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     398576.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[398576., 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"3331d159-1e13-4e62-9ccb-7e3a94390ef3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "600"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 600],
  Editable->
   False]], "Print",ExpressionUUID->"db053a07-d587-430d-9d40-95b37bb3858d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.5614787334080966`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.5614787334080966`],
  Editable->
   False]], "Print",ExpressionUUID->"948096fe-cc96-46a1-92e1-1417e98c5430"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "3.2487489999999999995`3.8840799062769213", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.7027309999999999988`2.91812286404078", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "4.031586`6.755990926242966"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   3.2487489999999999995`3.8840799062769213, ", orthogonalization=", 
   0.7027309999999999988`2.91812286404078, ", total=", 
   4.031586`6.755990926242966],
  Editable->
   False]], "Print",ExpressionUUID->"6d205224-1a32-4c7a-a93e-a9d91bab4317"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"a58b00c4-5d71-447c-9721-4e384831f222"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "14", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "300", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 14, " of ", 300, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"db1e5820-9124-4e0e-b121-c239c6127516"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "493"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 493],
  Editable->
   False]], "Print",ExpressionUUID->"5def113b-ac0b-44f8-9dc0-e335c117447b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "58.22878898624258`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "2.095489030235867`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 58.22878898624258, " Acond=", 2.095489030235867],
  Editable->
   False]], "Print",ExpressionUUID->"7ee3e22f-c157-4764-a810-82eda1cdd0a0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "4.0259027854144935`*^-11", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "58.559040781994874`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 4.0259027854144935`*^-11, " ynorm=", 
   58.559040781994874`],
  Editable->
   False]], "Print",ExpressionUUID->"dce09ee8-1051-4d05-ae48-07c1e7276dac"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "6.545308591272217`*^-11"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 6.545308591272217*^-11],
  Editable->
   False]], "Print",ExpressionUUID->"48d21650-3174-4dfd-ae17-0d93c2117a8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "2.8154010000000000007`3.9072083390864747", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.8521069999999999993`3.0871322159107937", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "4.338495`6.787854099107279"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   2.8154010000000000007`3.9072083390864747, ", orthogonalization=", 
   0.8521069999999999993`3.0871322159107937, ", total=", 
   4.338495`6.787854099107279],
  Editable->
   False]], "Print",ExpressionUUID->"c726cb64-fd65-4976-96d7-68ad80929eb3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"a1f6d8a3-c7e2-4a40-95b3-386d2be116f5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "5.8573720000000000005`3.8784072505043206", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0310269999999999983`1.9467731070312921", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.1459550000000000002`2.275319855919003", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "8.59596`7.084809383732403"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   5.8573720000000000005`3.8784072505043206, ", small shifts=", 
   0.0310269999999999983`1.9467731070312921, ", A=", 
   0.1459550000000000002`2.275319855919003, ", total=", 
   8.59596`7.084809383732403],
  Editable->
   False]], "Print",ExpressionUUID->"f93597f9-b920-4912-a2c3-e61cf0b5235a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.320160484609733`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.320160484609733, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"073f8b3a-82eb-41fa-afc1-90cc694c2d1c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.2829560000000000011`3.322621323437781", ",", 
     "2.686497`6.57970135776214", ",", "8.802995`7.095145453014067", ",", 
     "0.02534`4.554321608379416"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.2829560000000000011`3.322621323437781, 2.686497`6.57970135776214, 
    8.802995`7.095145453014067, 0.02534`4.554321608379416}],
  Editable->
   False]], "Print",ExpressionUUID->"566a2934-45d2-43a5-9433-8f2cf80fc4e3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsDynamicDense", ",", "shiftsDynamicMinres"}], 
  "]"}]], "Input",ExpressionUUID->"2681ff44-b60b-4b26-a113-74500ba71eab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.320151887931159`", ",", "8.320160484609733`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"58.5590236105344`", ",", "58.559040781994874`"}], "}"}], ",", 
   "0.20404132773811565`"}], 
  "}"}]], "Output",ExpressionUUID->"101d7264-b421-4a09-8035-c7b5337dcc94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxialMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}]}], "]"}]}], ";", 
  RowBox[{"shiftsAxialMinres", "=", "shifts0"}], 
  ";"}]], "Input",ExpressionUUID->"8b83017b-a6c1-42cd-8a8b-378f3357922c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"280.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     280176.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[280176., 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"e034ee9e-b06a-4fb9-981f-33eb70780015"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "230"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 230],
  Editable->
   False]], "Print",ExpressionUUID->"b490372d-efbd-43ad-96c3-2b5e2ad3722c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "6.244077762402319`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 6.244077762402319],
  Editable->
   False]], "Print",ExpressionUUID->"a5fa08dc-5f6c-4883-92b1-6b775f55b0ac"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.8126999999999999999`3.6987174215672294", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.0665010000000000001`2.310585342148509", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.905384`6.107347813181078"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.8126999999999999999`3.6987174215672294, ", orthogonalization=", 
   0.0665010000000000001`2.310585342148509, ", total=", 
   0.905384`6.107347813181078],
  Editable->
   False]], "Print",ExpressionUUID->"0a2c8ddd-a656-4231-9a66-9d588f06ee97"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"fa9659c3-c222-4991-8303-834e7a8dde6c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "115", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 8, " of ", 115, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"4d177369-aba6-4c93-8bf3-dfae2530c9a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "747"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 747],
  Editable->
   False]], "Print",ExpressionUUID->"57b8d049-6a95-46da-88b4-2bd35df2ff49"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "87.1592341067905`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "5.8033691874892215`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 87.1592341067905, " Acond=", 
   5.8033691874892215`],
  Editable->
   False]], "Print",ExpressionUUID->"81d7de30-f3f9-4870-9f87-79c2ea6cc2ef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "4.6183000966685995`*^-11", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "41.57699443542395`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 4.6183000966685995`*^-11, " ynorm=", 
   41.57699443542395],
  Editable->
   False]], "Print",ExpressionUUID->"3642147c-8c71-4718-8532-3c888ebbf38f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "2.926326869816617`*^-11"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 2.926326869816617*^-11],
  Editable->
   False]], "Print",ExpressionUUID->"cb9fd2cb-44fd-4cd1-8512-5d667fa024cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "2.6555899999999999992`3.7013554205972445", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "1.6611979999999999999`3.196585799921738", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "4.769469`6.828985028191457"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   2.6555899999999999992`3.7013554205972445, ", orthogonalization=", 
   1.6611979999999999999`3.196585799921738, ", total=", 
   4.769469`6.828985028191457],
  Editable->
   False]], "Print",ExpressionUUID->"5847b4c0-bc31-4075-903f-924dc8b7dab4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"cc2a2ab4-6362-43c8-aea7-d93a0c455468"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "3.3154730000000000004`3.6798344176664535", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.028447`1.729490207204986", "\[InvisibleSpace]", "\<\", A=\"\>", 
   "\[InvisibleSpace]", "0.0896280000000000005`2.1121760115152006", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "5.70443`6.9067272530328445"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   3.3154730000000000004`3.6798344176664535, ", small shifts=", 
   0.028447`1.729490207204986, ", A=", 
   0.0896280000000000005`2.1121760115152006, ", total=", 
   5.70443`6.9067272530328445],
  Editable->
   False]], "Print",ExpressionUUID->"8c189008-31f8-4a47-8560-ea428621bc48"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "6.343731475784635`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 6.343731475784635, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"174d8409-55d4-4851-bcc7-da2bbaebb33b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.5172029999999999987`3.365042022803976", ",", 
     "2.890157`6.611436433108149", ",", 
     "5.8802299999999999999`6.919909311285225", ",", 
     "0.019492`4.440371400541251"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.5172029999999999987`3.365042022803976, 2.890157`6.611436433108149, 
    5.8802299999999999999`6.919909311285225, 0.019492`4.440371400541251}],
  Editable->
   False]], "Print",ExpressionUUID->"61d67f50-f019-4943-b6a5-984b5b99f086"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldDynamicDense", "-", "gaugeFieldDynamicMinres"}], 
     "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"16db756a-07de-47c7-ba3f-6bc41f9ee440"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1.8772535718691863`*^-6"}], "+", 
              RowBox[{"1.0833770247575814`*^-6", " ", "\[ImaginaryI]"}]}], 
             ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"9.913233527947263`*^-7", "+", 
              RowBox[{"1.939173971426955`*^-6", " ", "\[ImaginaryI]"}]}], ",",
              "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6.983726175135985`*^-7"}], "-", 
              RowBox[{"1.0051819322454136`*^-6", " ", "\[ImaginaryI]"}]}], 
             ",", "1"}], "}"}], ",", 
           TemplateBox[{"1722"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.32118783558099806`"}], "+", 
              RowBox[{"0.05542066090082917`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.7513313793618228`"}], "-", 
              RowBox[{"0.7411817838348032`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.8105747840591213`", "\[VeryThinSpace]", "-", 
              RowBox[{"0.1580506002197286`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{68., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 195, 31638109925839608497, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 195, 31638109925839608497, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 195, 31638109925839608497, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{92., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[31638109925839608497 === $SessionID, 
   Out[195], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",ExpressionUUID->"5cb5729b-1661-4a18-8588-fe6d7762768d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAxialDense", "-", "gaugeFieldAxialMinres"}], "]"}], 
    ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"45ea4879-9a59-45d7-b660-bb2a8fe20176"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.12037815418947484`"}], "+", 
              RowBox[{"0.049303484881932494`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.19991405348488622`"}], "+", 
              RowBox[{"0.2480891710095698`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.12163317011841224`", "\[VeryThinSpace]", "+", 
              RowBox[{"0.22908804818961226`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.24718412520602762`", "\[VeryThinSpace]", "-", 
              RowBox[{"0.01227417361871555`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           TemplateBox[{"1426"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.23221604312826405`", "\[VeryThinSpace]", "-", 
              RowBox[{"0.1308787674792416`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.062199589699261246`", "\[VeryThinSpace]", "-", 
              RowBox[{"0.08212954932086947`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.3923047602055942`"}], "-", 
              RowBox[{"0.06862796435287816`", " ", "\[ImaginaryI]"}]}], ",", 
             "1"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{68., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 196, 31638109925839608497, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 196, 31638109925839608497, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 196, 31638109925839608497, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{92., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[31638109925839608497 === $SessionID, 
   Out[196], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",ExpressionUUID->"f5585a69-8a53-4f1b-8dc2-c4026682a76d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", \
"Title",ExpressionUUID->"50804d34-6d5e-48ed-a79f-38a4d1e745cf"],

Cell[CellGroupData[{

Cell["Quadratic approximation errors", \
"Section",ExpressionUUID->"0cb17714-19fd-4d88-9889-87e54a4b202b"],

Cell["\<\
The shifts are approximated as a quadratic.  Use the 2-norm vs. shift \
magnitude to characterize this error.  The error is approximated by \
Norm[shift,2]^2/48, but decreases with nc as 1/nc.
Note that the 2-norm of any SU(N) matrix is 1.\
\>", "Text",ExpressionUUID->"0fb13af4-383a-4af7-86b8-2d00f6371bc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nc", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomDirection", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"CircularRealMatrixDistribution", "[", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "-", "1"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"0f924d70-369c-4b62-a61f-d9ec62379132"],

Cell["\<\
For a single generator of the group, we can calculate explicitly. We get the \
same thing for all matrix norms.\
\>", "Text",ExpressionUUID->"d30a188a-1e0e-4d73-856f-0248d32ba276"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shift", "=", 
       RowBox[{"x", " ", 
        RowBox[{
         RowBox[{"suGenerators", "[", "nc", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
        RowBox[{"I", " ", "shift"}], "-", 
        RowBox[{
         RowBox[{"shift", ".", "shift"}], "/", 
         RowBox[{"2", "!"}]}], "-", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"I", " ", "shift"}], "]"}]}], ",", "2"}], "]"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Conjugate", "[", "x", "]"}], "\[Rule]", 
    "x"}]}]}]], \
"Input",ExpressionUUID->"6563c012-5ef4-4280-abf0-52b9c9aa0fc2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  SqrtBox[
   RowBox[{"128", "+", 
    SuperscriptBox["x", "4"], "-", 
    RowBox[{"128", " ", 
     RowBox[{"Cos", "[", 
      FractionBox["x", "2"], "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      FractionBox["x", "2"], "]"}]}], "-", 
    RowBox[{"64", " ", "x", " ", 
     RowBox[{"Sin", "[", 
      FractionBox["x", "2"], 
      "]"}]}]}]]}]], \
"Output",ExpressionUUID->"fe8ffd99-d193-4494-ae71-842219cdac38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "xx_", "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Cos", "[", "yy", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"yy", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
         
         RowBox[{"yy", "\[Rule]", "xx"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "xx_", "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Sin", "[", "yy", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"yy", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
         
         RowBox[{"yy", "\[Rule]", "xx"}]}], ")"}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"Abs", "[", "x", "]"}], "\[Rule]", 
   "x"}]}]], "Input",ExpressionUUID->"7156fc75-8e60-44e0-a1ff-46103a94e121"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   SuperscriptBox["x", "4"]], 
  RowBox[{"8", " ", 
   SqrtBox[
    "3"]}]]], \
"Output",ExpressionUUID->"4b947504-9778-428c-a75f-859891f9da4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "4"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"127545c4-39e7-4eae-bfe6-78ccff2549ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    SqrtBox[
     SuperscriptBox["x", "6"]], "48"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "2"],
    SeriesData[$CellContext`x, 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {
   Rational[1, 48] ($CellContext`x^6)^Rational[1, 2]}, 0, 2, 1],
  Editable->
   False]], "Output",ExpressionUUID->"b683b223-0d0b-4acd-99a0-13e9b1347765"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "/", 
  "48."}]], "Input",ExpressionUUID->"da000adc-e2ae-4208-9c43-00b864a1c19d"],

Cell[BoxData["0.020833333333333332`"], \
"Output",ExpressionUUID->"2156ff6a-5641-4d03-a036-72fc19bbf1ae"]
}, Open  ]],

Cell["\<\
For (SU(2), Norm[shift]^3/48 is an exact solution.  We see that, for SU(3) \
and SU(4), there is a narrow distribution peaked near 1/48.  For SU(5) and \
above, the peak moves downward.\
\>", "Text",ExpressionUUID->"0d592ab2-52dc-46da-83e8-87a1668628c3"],

Cell[BoxData[
 RowBox[{"hh1", "=", 
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"hdata", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rd", "=", 
            RowBox[{"randomDirection", "[", "]"}]}], ",", 
           RowBox[{"x", "=", "0.01"}]}], "}"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"shift", "=", 
             RowBox[{"x", " ", 
              RowBox[{"rd", ".", 
               RowBox[{"suGenerators", "[", "nc", "]"}]}]}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
               RowBox[{"I", " ", "shift"}], "-", 
               RowBox[{
                RowBox[{"shift", ".", "shift"}], "/", 
                RowBox[{"2", "!"}]}], "-", 
               RowBox[{"MatrixExp", "[", 
                RowBox[{"I", " ", "shift"}], "]"}]}], ",", "2"}], "]"}], "/", 
            
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"x", " ", "rd"}], ",", "2"}], "]"}], "^", "3"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", "10000", "}"}]}], "]"}]}], ",", "30", ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"c30fec02-3b54-40d8-93aa-44edea3ee375"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", "hdata", 
  "]"}]], "Input",ExpressionUUID->"8ae60fd0-95dc-4bfa-88eb-f0505db32569"],

Cell[BoxData["0.020833323594354396`"], \
"Output",ExpressionUUID->"353d9170-e06c-4c99-8190-c91ee87aed06"]
}, Open  ]],

Cell["Mean of the distribution for various 1/nc:", \
"Text",ExpressionUUID->"edb926d7-77e2-475d-a043-c8406fa808a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "20"}], ",", "0.003987207811923104`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "16"}], ",", "0.005309460586922509`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "12"}], ",", "0.007542180302737262`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "8"}], ",", "0.01195670498036167`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "6"}], ",", "0.01602903272904034`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "4"}], ",", "0.022300330376689107`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", "0.02572546202970247`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "48"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"eeacfdd2-53cb-421d-8a28-460318980e66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ffcd", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{"cd", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}], ",", 
      RowBox[{"x", "^", "3"}]}], "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"82e760e6-835b-4f1b-8681-1a48487ab5d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.08634097400326857`", " ", "x"}], "+", 
  RowBox[{"0.10693822305642084`", " ", 
   SuperscriptBox["x", "2"]}], "-", 
  RowBox[{"0.39313154558847596`", " ", 
   SuperscriptBox["x", 
    "3"]}]}]], "Output",ExpressionUUID->"55a97131-6307-47c1-936b-5888e68d55b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", "ffcd"}], "]"}], "/.", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{
   "1", "/", 
    "3"}]}]}]], \
"Input",ExpressionUUID->"4d9f8726-5dca-4fbf-9756-14b576eeaa66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.028780324667756187`", ",", "0.01188202478404676`", ",", 
   RowBox[{"-", "0.014560427614387998`"}]}], 
  "}"}]], "Output",ExpressionUUID->"8d1ec19c-0692-4fa2-8a18-86521b95426a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"cd", ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.55"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
     
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<1/Nc\>\"", ",", "\"\<Mean coefficient of cubic in shift\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ffcd", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", ".55"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"8fc58833-8101-4944-a8e6-f23a2127cd2a"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{0.05, 0.003987207811923104}, {0.0625, 
       0.005309460586922509}, {0.08333333333333333, 0.007542180302737262}, {
       0.125, 0.01195670498036167}, {0.16666666666666666`, 
       0.01602903272904034}, {0.25, 0.022300330376689107`}, {
       0.3333333333333333, 0.02572546202970247}, {0.5, 
       0.020833333333333332`}}]}, {}}, {}, {}, {}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJwV13k4Vd0XB3BpIDMpKUKkDJVKpvBtMGQOoVSSKY0qQyKkiZL5cg9FlFJe
UuoV0q/SG5KoXO65A7mSkCilAfHb/jrP5zn7OXuftfdZax01nyAXf2EhISGp
aUJCU9er12JOVS3YbG4cx86Z6FQwd/mgVB+qpAmfxtEr1j0j5q5dhWmWSgbo
/Cl/4H33TLTs+XJ8uZIVdi+xLHLvmot0tZT9akruUAtSHw1sX4LgWIHvQqUA
iP7JPX21ZS18V130nq8UhlnxI3Fzn1pix4WOjnlK53HF953ErCw3RM595blY
jInU+q3PtmgFoKQsQiJEOR+Lvq5wNzM+gttPrvY8zroJCecZAUuUQ/FwfMl7
ycRiDNU6i/2DCBRWX8jzlLyH3ifq268JojEmd8/7nvQDUC8YzXrtsWjd4Z07
Nv0htExHRqqWnkWIxfOUoy8qISlZ7lJtcB5KL9zT9tdUQ12uYPnGnfGI/5iz
OfnSExw+PqhZtPkizE4a/M9V4xkOnkgKlpt/CY+cy3er5dUgolvksvmfRCz8
lcw7K/wf2kwaXD7fSEZM77T3t0+/wIxd1V+N76ZAs8Uwv36sFh90t/kjOhV3
E+vMonbUo8xVqNBHPw3mjKE93+mX6GDIvp45lIY7+496T5q+gvKgs8dYWjrU
ExN6Gv/XiPXSzbERxgzwbu3TYRg3YaCqIejGWwZCGfm237Kb0e/7bvS0WwbE
eip+iyS+wc6imx4nOBl41edg3IW3YKnMcNxmm4nl/RbbjYfeYvkZrpBTaSbS
ZETNjpa8Q1iTosZfWSZ6F/2W/OHVAu29mou7fZlY7/rgmocKC50zG+4l3mNi
RuNZDbvFLDRyewoKy5iot3C7ab6Ehc3Fgo9P7zOxxeDn7SU6LIxZHHX+9i8T
uxWN7n03YMHE4XeTTRUT0e8fPUl2ZEG38oYvp4aJxwee8+uiWOBNRH0/1sKE
ydl384z4LLht0ChJHmYi967Hf787WLBw3qBx6DsTwu38o5UCFj4KBwjZ/mDi
5dpPjSafWFhjV/tp2k8mtn0aO202zIL4ka5j+/8wEWq7ZGijaCsKxS5ELBKi
cFcmvM5BvxVZZ5Kd5CQpLMlRDve91ArPs7EyWksoqI7eu7U7uRW5cZ16Q8RK
HlacHWmtKPaYzH6gSUFeNshkK9UKNa+T9mbLKAifezpuUdCKkBkhGlY6FDoP
+sZqVreivnz7rbWrKFwxvX2x73Mr5pVNTCaYUqCyzB59HGzFcUePbevMKDB+
vv0s+NaK/IdBo33ECXdH7bm/WuHw9f1CS1CI0LCXfjW9DfJjj1uGN1DwkBhK
L17YBruwIwq61hTk+Po5QXZt2D29dHCuM4U7A1F/jBzbsPfYe68CYpu/tW7C
zm1YRENvtQuFU4u2S2W4t+F6XMpPO1cKg95RMVV72vA37KhsuBuFho8v9swM
b8PXzFWnyrZTiB1y17xc0IZOXtGGu3tIPITyTvsVtkFOjcvW9qFQIdPXsbyo
DSM7jZsLiAdXRTKflrbhXUWcINOXws6Qq6I9VW3gCvkxgv0pGP351K/3tg06
7xaskd5H4avwidLav21oOxG7tTmIQvRlTMYKsaHXvUlC/wgFCf1ZTmbT2RDj
7dWhiJf5pw/eF2Vj9WHWVa+jFLzrSpbnz2EjUHv9nu5jFN4kdP0TqcXGjtE9
Vi2hFLw0bo8Z6LKRrGsWsiKMwkB1kN3wCjbw+cTsC8Sig+P9gfpszJeav9/0
OIX1WxS03cFGUV/P9Cvh5LzI29/Sc2Nj5++mLPNICuYlcr8/e7DhP1xjlkLc
aMmxLvRkYyB8vo2AuDcs4JOyNxuhOr0ZsSfJeeKc0hQ/wMY+zQWij6IopOT8
W/DxFBus4HpH2VMUjmiq5GcXs1F/0NHf7iyFzKEfwamlbFSc8tuQTFxd0WAV
X8bGbte6fe+IRe3CBkIr2GjWD77qfo5CXtBrQ+f/2Fjf65vrfp68f0Vkkwif
jJe93a8fT+FnrHP+RAcblTIJCYeIleyWhowIyHxNleE3iAPb3yl++MSGRNxf
wzkXKAgJa/v/7zsb6r3Ktj3Eq+zosRBxGgkHa6r3J1DYJn+n6YAUDQePI4sp
4uj2M/k+sjTqhQ6w/iNuCFppvUWBRnuylbLSJQo+jPNpOuo0snIzN9YQx+/a
6b9Yk4ZsTJFYP/EdzdVGilo0zBaJq8gmUhitaG+ftZLGY6pMdxdxWru+VpcJ
DfvobN4AccVNsXHajEbYVvlZ0kkUOoI6m5rX09jexz2pR6wtfCnksRWNTU6O
TkeJazQ/PKFcaFwXb4rrJ+4dqkhLdqNxll0iL5JMQaoyyf/8NhpKPtwvi4k9
7UzEQ7xoHLqveG4b8XBQqrvTfhp5VqusHxFXDCx0m3OIxmqFxrI3xNH7brqy
g2ior/sd+5F4tu+jLbtDaayMmmEnmUKh6b2lk3o4DcvL3RaqxIydbxw+RdB4
IuF+bTWxqvtH26BTNFr7BuLciHveBdmsOUPjqJucTABxsdOo9a9zxPIvx0KJ
jWykLWMSaDAu9f9NJ554kbVpUxKNCks3+WvE/23U2CiSSsPUxTmplNjJ1BjJ
mTQO+/8trieWr3xu5ppFQ+FgiTOLmLvW0VThCll/7eD298R5ZbQJL5dGcvCz
F33EASt9ja/m0/AKWZLxnVi3+IuhbwGNlPoF9ePEw8vCDZYW0lA9ku81M5XE
Y3HimtJiGoGVPuXyxBZXFVYHl5L7O3KOLyQWU7qmZ1hGw3jLvitqxG8o3ZVj
D2iUUbUaS4kz5j5c/uQhjST9f2V0iT3TNuieqaLRoL7WW49YVbpR2/oxjX0B
VnP0iXsS3LXEn9LYO96rZUhcLCpY2lxDxn9UKjAmPnbugGb6C/K8xV2x64iN
hH9qeNST+cqMnpsST0SfUl/4iqwnUzXQjPj5mNji96/Jel9nHZlyfHiG6vU3
ZD6PAv7UeMcRFZW9LTTmrl1fPPU8+WNFyjptNNQCDr2fmo87qK80RJP49OuE
Ta0n78CTBfd5JH41kUem1hvQa6N4vIPc/7Kzaep9dP1ZCusEJP4Hm5On3veb
wGve5AeyP+YtD6biUe7VJ/+8h+yfb6DZYuKTvOA5cX00NPhJWkrEG7dNyNoN
0DC/ZXViLrFoa7yM9BCNyrpkXSniJuc50i3faGSY7N80i5jRlCPJ/EGDJdT2
+G/K1HlfJrHjFzlfC1ou/yBWqS8TUxmlERy3p72fuNvCbPaHcTLeOvZ0J3HR
szqRwkka2TtWJ7QSGzziz1g5kwOrqM11j4nHDfdO/y7CwcqEktG7xDUPvk17
KMZB+MD11OvEjndmTZrLcLDmtkX/eWL/fL0/jgs5MBJ3t7KaGu/YEOG4iAP6
aJzcmqnvY9x33EGNg6jXXZoqxHx35qT9Ug54vgrLRsj3tlViYqbdGg4+SIRf
oojLKplxtgYclC/8kxVDLLN31WxbYw6SVQqG/IlfPfOTsAEHrrPCg/WINx5/
JWdtx8GyLQrt1SQ/5Gn4M6wcOVgh0quTSzzxdmKulTMHJve7aqKJq3RXK1p6
cODf7/bSjHhVF6WyyZcDkdY1RvdJflJ1CNBFJAcxl1/nRJL8Fj06WWIezUH/
NbMgZ2J+YdZK81gOdl1lx2sSM4VfrzaL48Dl+AVGE8mfUhVrjNelc5B0vVty
HvHfxdOsDP/hwPBLePxpko8932TXGdzhYLZlPN+euCJK38bgHgeC1Gfh84hD
6L32ax9ycFOs7EIhye8DiU0ua55zEBF+UfJZHDmfvy/vXsnjYKulYs5bUj/o
7f0S4+0czJ1u0MAgbq0yqqrv5MC5WcTDg/jNyVZ5nx4ONqQ3JHNJ/akTkm5g
fOPgZ31jFOcMhQeip/VHRbh4/Pm5XWUsif++N4JaMS6sUleFHCMubViUnC7J
hYPl1nFt4qJLj/p053DRTFfoZJP6lyczkrt7ERf/lEzMOhpDIXF+4OwX+lzU
SEWVCpF6efFEeXmqIRfzrqxrKSX1NJ47w8/LhItuw1J3L+KzV/L/9wtcjGX/
e7KS1N8IVV6wth0XE1KwDIwg39syx47kPVx437GoL5yq70b69z2TuLjcsCDz
Dukf9NSEtiqmcrE9x7PYjlhVrPEHO52Ljefjl/WSfkOI72vglsUFI/uOiwrx
s5j0SqcCLkxeqx8+f5icn7rhJxZVXOR5lj0zPEDynfu9xhU9XJTP9eZp+lHQ
R9ShL71csEp8Su+SfkhjmY1U8WcuFu107TMmnjHa6aT1jYu1YxNJtqR/epEj
06I+zkXApph8P28KVh+DOPPleOCNqX+I3Elhc8iKHmFzHqQkJ2iDrWR/EmeL
/V3Pw46r9U/yST+3rbB7+a9NPGR8tf8mThzIzQ79bMMDp/m0fgfpBy+sF5nJ
cuMhN/b6uggnUq8lOtVvHOJBsazCPsWWgsON1D3WOWQ+q9UR+uspuLT94CeM
85AIH+FdWiS+18/quk7y0OtwmVFI+t9rR+RPLhDmY//VL/HflpJ6IKa/8LYI
H5/EO5hnSL+chuDttXJ81IsNOuapU3h761urkBYfynkNatXKFLZEDjaFuvGh
qhXmGSVL5lftfbr7Dh/RDzIVNH8xIbEoLt3nHh/yFKPEgPT3jQs1A/wf8DGD
rXHRaoQJewU/8QNVfAwGjM/zI/8H9lKdbmG1fAw0xcVkDhGPs/svdfCR9ET6
Ev2JmK6Tr5JqxzH17rS3bCZsUwoD5YPaUTWS68Ek/yt94/VDlrodGEjeb/pj
HxMnnBX8avgdYExeuOaqyIR446orKlfeIy1/XOJzeSasmdWdvks7kWfYnVe1
JRMcK1nfn9GdoH3fagm6MnBotr31n/ZO7MzJ+dvhnYE/UL6WbyDAAuZLyq+d
gZvzPsQuNxLgzvjxddN5DLh8ubWn0lgA0WNnF+TTDBRl66u9NRVA6dLDRG4L
A54jdnlCmwS4G3V+s0UDA1VFEbm7nQQId6+T/l7OQMRcOls5UIDyDlb342QG
NAdyIm7vE8DHzHKORSID72p8PdceEID/z5zolxcZ0D4ypOhwWADNigbRd+cY
4DbMyjoZQpyUP8yJZMDk1Fom75QATSuHFV7sZaDHfSxs72kBZiVskoA/A2nL
n7l/PyOA1M9h0wofBvq59vPE4wQIGTvgemsXA9lr/TJMEgUoel67NcaVASsJ
7dDaJAFW5Ijqft/CwHDX0FaXFLL+87cQ4Mgg+xEpvz9dgIPxwkq2Ngz8DNjw
Y4QhgHx+dXeVFQPXzERYsZkCnH7J6tO2YMBR/vV9SUqA6ml2OtkbGBjtT0vP
yiK2UbktCgb+D+/yMY4=
        "]]},
      Annotation[#, "Charting`Private`Tag$7383#1"]& ]}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Mean coefficient of cubic in shift\"", TraditionalForm], 
     None}, {
     FormBox["\"1/Nc\"", TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.55}, {0, 0.02572546202970247}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{
   Automatic, 
    Automatic}]], \
"Output",ExpressionUUID->"8070bf2c-c183-44b8-814e-76e693704937"]
}, Open  ]],

Cell["\<\
Plot error as a function of shift in some random shift direction\
\>", "Text",ExpressionUUID->"dca8104d-2b2b-4b95-ad41-032394b38575"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxData", "=", 
   RowBox[{"2", "Pi"}]}], ";", 
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rd", "=", 
       RowBox[{"randomDirection", "[", "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"shift", "=", 
            RowBox[{"x", " ", 
             RowBox[{"If", "[", 
              RowBox[{"False", ",", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rd"}], "]"}]}]}], ",", 
           "sg"}], "}"}], ",", 
         RowBox[{
          RowBox[{"sg", "=", 
           RowBox[{"shift", ".", 
            RowBox[{"suGenerators", "[", "nc", "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"shift", ",", "2"}], "]"}], ",", 
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
               RowBox[{"I", " ", "sg"}], "-", 
               RowBox[{
                RowBox[{"sg", ".", "sg"}], "/", 
                RowBox[{"2", "!"}]}], "-", 
               RowBox[{"MatrixExp", "[", 
                RowBox[{"I", " ", "sg"}], "]"}]}], ",", "2"}], "]"}]}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "maxData", ",", " ", 
         RowBox[{"maxData", "/", "20"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"b5e74323-5513-4ec7-9e1e-c613f083a697"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{"data", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "^", "3"}], ",", 
      RowBox[{"x", "^", "4"}], ",", 
      RowBox[{"x", "^", "5"}]}], "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"b3f73fad-359a-4061-bfc6-828b3485f8c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.02670146319345156`", " ", 
   SuperscriptBox["x", "3"]}], "-", 
  RowBox[{"0.00032340571702165583`", " ", 
   SuperscriptBox["x", "4"]}], "-", 
  RowBox[{"0.00008985401327101418`", " ", 
   SuperscriptBox["x", 
    "5"]}]}]], "Output",ExpressionUUID->"0d4b938b-0088-4960-908d-bf2d3ced11d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", "ff"}], "]"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "maxData"}]}]], \
"Input",ExpressionUUID->"ea39afd2-c7bd-4e74-87d8-2038cdcbb51d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.623303644360007`", ",", 
   RowBox[{"-", "0.5040425108844688`"}], ",", 
   RowBox[{"-", "0.8799070981724241`"}]}], 
  "}"}]], "Output",ExpressionUUID->"dccc2ace-f627-4b33-bede-989032491a89"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", "data", "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff", ",", 
       RowBox[{
        RowBox[{"x", "^", "3"}], "/", "48"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "maxData"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"1872d324-0fca-4587-a5a3-41c9dc0832a9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Identity staple example, SU(3)", \
"Section",ExpressionUUID->"f4464fcb-ed0c-431c-b4f5-227baa261730"],

Cell["\<\
Special case where the sum of staples is proportional to the identity matrix.\
\
\>", "Text",ExpressionUUID->"7bd7c1f1-f796-4265-82ea-6a8e126860aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diagValue", "=", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], "+", 
   RowBox[{"Cos", "[", "x2", "]"}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"-", "x1"}], "-", "x2"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"0d67449f-c358-48e6-8b38-5d4e2f1add6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", "x1", "]"}], "+", 
  RowBox[{"Cos", "[", "x2", "]"}], "+", 
  RowBox[{"Cos", "[", 
   RowBox[{"x1", "+", "x2"}], 
   "]"}]}]], "Output",ExpressionUUID->"c96b4461-e44b-4afe-aa54-881672b96f95"]
}, Open  ]],

Cell["Saddle Points", \
"Text",ExpressionUUID->"a0464767-ca93-4581-8597-e451ffe1e8f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x1"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x2"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"af89cbe1-338e-4cef-998d-c67adf7572b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "3"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "3"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "3"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "3"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"f5fc5496-5e32-4e3b-bccf-06072130dda8"]
}, Open  ]],

Cell["Hessian", "Text",ExpressionUUID->"0954b861-0f81-43ae-8ad5-16da4ea3ea52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hess", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"diagValue", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"b24c3d88-a98a-40f7-93d2-f031ab078441"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "x1", "]"}]}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "x2", "]"}]}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"b885954f-0f78-459a-bdee-dd65cf112f4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dh", "=", 
  RowBox[{
  "Det", "[", "hess", 
   "]"}]}]], "Input",ExpressionUUID->"2ba79ffb-a384-4fbf-9f38-f1be7adf34c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], " ", 
   RowBox[{"Cos", "[", "x2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x1", "+", "x2"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "x2", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x1", "+", "x2"}], 
    "]"}]}]}]], \
"Output",ExpressionUUID->"d184cc14-a9bb-40e3-9f5d-e340ffee27a3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"Pi", " ", 
      RowBox[{"4", "/", "3"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot3D", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", " ", "limit"}], ",", " ", "limit"}], "}"}], ",", 
       RowBox[{"RegionFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2"}], "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x3", "=", 
              RowBox[{
               RowBox[{"-", "x1"}], "-", "x2"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x2"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x2", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}]}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
     
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
       "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"c72af4ec-7c81-415f-8f65-8af9ecc32fa1"],

Cell[CellGroupData[{

Cell["Test saddle point routine", \
"Subsection",ExpressionUUID->"85019890-0681-4f49-8583-e443e57c2bc5"],

Cell["Run this as a group", \
"Text",ExpressionUUID->"04d5a4f9-1452-49f3-91d1-c4b5e635e170"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sqrtU1", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{
     RowBox[{"u1", "=", 
      RowBox[{"randomSUMatrix", "[", "3", "]"}]}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"phi1", "=", 
  RowBox[{
  "centerPhases", "[", "u1", 
   "]"}]}]}], "Input",ExpressionUUID->"a34cbdc5-1800-4656-9eb9-b9036fd77ede"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.06974390073237449`", ",", "2.728340774947629`", ",", 
   RowBox[{"-", "2.7980846756800033`"}]}], 
  "}"}]], "Output",ExpressionUUID->"ecad5350-8b87-4ee5-9e61-2dd6a27fccac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sqrtU2", ",", "maxShift"}], "}"}], "=", 
   RowBox[{"linkSaddlePointStep", "[", 
    RowBox[{"sqrtU1", ",", "sqrtU1"}], "]"}]}], ";", 
  "maxShift"}]], \
"Input",ExpressionUUID->"9359b299-7106-4975-a5e7-95091bf73f7b"],

Cell[BoxData["0.0011188031184552747`"], \
"Output",ExpressionUUID->"fa159104-ae36-46e8-ad61-597c9420aa1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi2", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"sqrtU2", ".", "sqrtU1"}], 
   "]"}]}]], "Input",ExpressionUUID->"455cc151-6deb-4755-9696-673d3176cb5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.035517783849593663`", ",", "1.3638372512287065`", ",", 
   RowBox[{"-", "1.3993550350783002`"}]}], 
  "}"}]], "Output",ExpressionUUID->"149304ea-8083-40be-a6b3-179f262dd0d0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"3", 
      RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"DensityPlot", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"phi1", ",", "2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{"phi2", ",", "2"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"DensityPlot", "[", 
      RowBox[{"dh", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}]}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"c954456b-3d8f-489a-9835-7b0476313236"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Input gauge configurations", \
"Section",ExpressionUUID->"e924a166-cbb2-49c0-9107-c62bdb273a1a"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"523461ed-4878-488f-9d9c-7a2c59a8f613"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"71a7bd19-91cd-4285-83a9-98c02a760978"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-1.m\>\""}]], \
"Input",ExpressionUUID->"ad08c2af-9241-4c62-acd0-9229dde5d96b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/periodic-22-42-1-cool.m\>\""}], 
  ";"}]], "Input",ExpressionUUID->"3559588d-1f90-4b85-9ff6-4348fbbf99b1"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-5.m\>\""}]], \
"Input",ExpressionUUID->"275aab5a-9760-4e37-879b-b5bfdb89d351"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-80-5.m\>\""}]], \
"Input",ExpressionUUID->"2609f7c4-37f3-4701-b3a5-2e6fa1298ffa"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-28-1.m\>\""}]], \
"Input",ExpressionUUID->"b177112c-c694-4bc2-9057-c002b234572e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-33-4.m\>\""}]], \
"Input",ExpressionUUID->"f538e35b-0e1e-4f75-b6ad-48256f16d29b"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-20-150-5.m\>\""}]], \
"Input",ExpressionUUID->"d388d44e-b21b-49ea-b215-f75b5f01ef74"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/winding-20-80-0-5.m\>\""}]], \
"Input",ExpressionUUID->"381f51f0-7afe-4522-a9c5-c62219960db0"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/winding-20-80-1-5.m\>\""}]], \
"Input",ExpressionUUID->"0c87e4e6-2f0a-4acf-a802-c65cf32f8a7f"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/winding-20-60-0-4.m\>\""}]], \
"Input",ExpressionUUID->"afc12508-8527-4205-991e-e5bd2a0e99cc"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/winding-20-60-1-4.m\>\""}]], \
"Input",ExpressionUUID->"2a0498d4-3117-4fe5-821f-663b74dc9582"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-6/periodic-18-90-1.m\>\""}]], \
"Input",ExpressionUUID->"23ee216f-8f8c-42c2-b6c2-ed97cae425cd"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-6/periodic-18-170-1.m\>\""}]], \
"Input",ExpressionUUID->"0a6e1d01-a9ca-4928-ab9a-2fe3044d00d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"nd", ",", "nc", ",", "beta", ",", "latticeDimensions", ",", 
   RowBox[{"Dimensions", "[", "gaugeField", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"345de230-f994-4a52-b850-c6261e53bc8b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3", ",", "8.175000190734863`", ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "216", ",", "3", ",", "3"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"6e2ede42-15ee-49c4-ad1f-88c87312e137"]
}, Open  ]],

Cell["Test that links are approximately SU (N)", \
"Text",ExpressionUUID->"e43859b7-8ba8-432b-9329-22bfc217d634"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"badMatrices", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"gaugeField", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"SUMatrixQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"1.0", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "10"}]}]}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"4450b32a-06a8-4f09-8753-4dbf6a662d7a"],

Cell[BoxData["0"], \
"Output",ExpressionUUID->"3ba6485a-b429-4502-82d5-b576f343653f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plaquette distribution", \
"Section",ExpressionUUID->"a0a47a8c-ac84-4e13-85e9-a606f0bad220"],

Cell["\<\
The plaquette values, if rescaled to the [0,1] interval, generally fit a Beta \
distribution, but we can equivalently use a Gamma distribution for small \
lattice spacings.\
\>", "Text",ExpressionUUID->"7cfff376-c221-42bb-9e0f-bbccf6ce6087"],

Cell[BoxData[
 RowBox[{
  RowBox[{"useGammaDistribution", "=", "True"}], 
  ";"}]], "Input",ExpressionUUID->"fd266c15-19c1-4cdd-be08-fb8e8adea43c"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"plaquette", "[", 
             RowBox[{"dir1", ",", "dir2", ",", 
              RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "]"}], "/", 
            "nc"}]}], ")"}], "/", 
         RowBox[{"If", "[", 
          RowBox[{"useGammaDistribution", ",", "1", ",", "2"}], "]"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"dir1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"dir2", ",", 
        RowBox[{"dir1", "+", "1"}], ",", "nd"}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"8a22188b-5413-48f8-b643-bfab83b62df3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "data", "]"}], ",", 
   RowBox[{"dist", "=", 
    RowBox[{"FindDistribution", "[", 
     RowBox[{"data", ",", 
      RowBox[{"TargetFunctions", "\[Rule]", 
       RowBox[{"Which", "[", 
        RowBox[{"useGammaDistribution", ",", 
         RowBox[{"{", "GammaDistribution", "}"}], ",", "True", ",", 
         RowBox[{"{", "BetaDistribution", "}"}], ",", "True", ",", "All"}], 
        "]"}]}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"ad5a307f-c449-430b-9418-f67923577568"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0650492058072443`", ",", 
   RowBox[{"GammaDistribution", "[", 
    RowBox[{"4.0372454262987585`", ",", "0.016112274320493006`"}], "]"}]}], 
  "}"}]], "Output",ExpressionUUID->"6e224d4d-9baf-4d91-942a-7cd59d3feea3"]
}, Open  ]],

Cell["Distribution for 1 - Tr(plaquette)/nc", \
"Text",ExpressionUUID->"c10d44da-f37f-45db-9a6c-50789f76fd99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"dm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<nd\>\"", ",", "\"\<nc\>\"", ",", "\"\<beta\>\"", ",", 
       "\"\<mean\>\"", ",", "\"\<alpha\>\"", ",", "\"\<beta\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "42.", ",", "0.0650492058072443`", ",", 
       "4.0372454261752875`", ",", "0.016112274320900954`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "80.", ",", "0.03371067322265413`", ",", 
       "4.011655372432331`", ",", "0.008403182749520672`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "28.", ",", "0.1923250246554901`", ",", 
       "7.7282971359028245`", ",", "0.02488582171194133`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "33.", ",", "0.1604205616819077`", ",", 
       "7.670953223240458`", ",", "0.02091272844591148`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "150.", ",", "0.03380841583718067`", ",", 
       "7.620434296041462`", ",", "0.004436547121053944`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "6", ",", "90.", ",", "0.13525994258717414`", ",", 
       "18.387360829900825`", ",", "0.007356136850654697`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "6", ",", "170.", ",", "0.07017369456939337`", ",", 
       "18.102497926494276`", ",", "0.0038764647207436133`"}], "}"}]}], 
    "}"}]}], "]"}]], \
"Input",ExpressionUUID->"0f395ff4-98a2-4733-a8a7-817d7e416189"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"nd\"\>", "\<\"nc\"\>", "\<\"beta\"\>", "\<\"mean\"\>", "\<\"alpha\"\
\>", "\<\"beta\"\>"},
    {"3", "3", "42.`", "0.0650492058072443`", "4.0372454261752875`", 
     "0.016112274320900954`"},
    {"3", "3", "80.`", "0.03371067322265413`", "4.011655372432331`", 
     "0.008403182749520672`"},
    {"3", "4", "28.`", "0.1923250246554901`", "7.7282971359028245`", 
     "0.02488582171194133`"},
    {"3", "4", "33.`", "0.1604205616819077`", "7.670953223240458`", 
     "0.02091272844591148`"},
    {"3", "4", "150.`", "0.03380841583718067`", "7.620434296041462`", 
     "0.004436547121053944`"},
    {"3", "6", "90.`", "0.13525994258717414`", "18.387360829900825`", 
     "0.007356136850654697`"},
    {"3", "6", "170.`", "0.07017369456939337`", "18.102497926494276`", 
     "0.0038764647207436133`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"a6e98169-49ad-4b10-ae44-63ce52985994"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fit", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"f66e4f9f-36de-496f-a379-3a9f320b33e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.9570128098970327`"}], "+", 
  RowBox[{"2.1922544672143394`", " ", "x"}], "-", 
  RowBox[{
  "0.01302459307696784`", " ", 
   "y"}]}]], "Output",ExpressionUUID->"b23993e0-5537-41d8-93ef-3117b1650c80"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaf", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "/", "y"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"a409dd0d-f15c-4183-8e07-d79836bc74d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "0.38372636384000197`"}], " ", "x"}], "+", 
  RowBox[{"0.5678259467308348`", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  FractionBox[
   RowBox[{"0.33676599859447814`", " ", 
    SuperscriptBox["x", "2"]}], 
   "y"]}]], "Output",ExpressionUUID->"074bce12-25a4-48fd-a284-6451ab50eb3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fit", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "6"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"bcdca394-d224-41a6-b2b1-2f04bd8a4ac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.2764959070649417`"}], "-", 
  RowBox[{"0.003449168587259936`", " ", "x"}], "-", 
  RowBox[{
  "1.0265824185785946`", " ", 
   "y"}]}]], "Output",ExpressionUUID->"01ba710c-2730-48e9-8973-1b11709b986d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"betaf", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "6"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "y"}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"x", " ", "y"}], ")"}]}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"y", "^", "2"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"248cc4d8-aae2-44d6-bada-b8513bca3bde"],

Cell[BoxData[
 RowBox[{
  FractionBox["1.271846550539407`", 
   SuperscriptBox["y", "2"]], "+", 
  FractionBox["0.655794521122695`", "y"], "-", 
  FractionBox["0.01909058801264915`", 
   RowBox[{
   "x", " ", 
    "y"}]]}]], "Output",ExpressionUUID->"1d1c9555-f783-463d-8976-a285ccdb70e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"alphaf", " ", "betaf"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "Infinity", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "Infinity", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"6f36a86f-091a-4dc8-a144-4e20f46de9b1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    InterpretationBox[
     RowBox[{
      RowBox[{"0.3723771448173887`", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"0.26248577822853797`", " ", "x"}], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", 
         FractionBox["1", "x"], "]"}], "0"],
       SeriesData[$CellContext`x, 
        DirectedInfinity[1], {}, -2, 0, 1],
       Editable->False]}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {0.3723771448173887, -0.26248577822853797`}, -2, 0,
       1],
     Editable->False], "y"], "+", 
   FractionBox[
    InterpretationBox[
     RowBox[{
      RowBox[{"0.9430367684350571`", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"0.4944701131367715`", " ", "x"}], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", 
         FractionBox["1", "x"], "]"}], "0"],
       SeriesData[$CellContext`x, 
        DirectedInfinity[1], {}, -2, 0, 1],
       Editable->False]}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {0.9430367684350571, -0.4944701131367715}, -2, 0, 
      1],
     Editable->False], 
    SuperscriptBox["y", "2"]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "y"], "]"}], "3"],
    SeriesData[$CellContext`y, 
     DirectedInfinity[1], {}, 1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`y, 
   DirectedInfinity[1], {
    SeriesData[$CellContext`x, 
     DirectedInfinity[1], {0.3723771448173887, -0.26248577822853797`}, -2, 0, 
     1], 
    SeriesData[$CellContext`x, 
     DirectedInfinity[1], {0.9430367684350571, -0.4944701131367715}, -2, 0, 
     1]}, 1, 3, 1],
  Editable->
   False]], "Output",ExpressionUUID->"260aaa9e-0a11-41cb-9065-ca41791530bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dist", "=", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"nc", "^", "2"}], "/", "2"}], ",", 
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"3", " ", "beta"}], ")"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"27f47a73-784d-4773-816e-8deb6e6050fa"],

Cell[BoxData[
 RowBox[{"GammaDistribution", "[", 
  RowBox[{
   FractionBox["9", "2"], ",", "0.015873015873015872`"}], 
  "]"}]], "Output",ExpressionUUID->"801793c9-815b-4ba2-8528-ec306a670fc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{"a1", ",", "b1"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"d238737e-9bf8-4024-84b3-b5d620ad3a86"],

Cell[BoxData[
 RowBox[{"a1", " ", 
  "b1"}]], "Output",ExpressionUUID->"8232898d-e935-4628-a85f-3561ff9d2dd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "4"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], " ", "2", " ", "Pi"}],
          ")"}]}]}], "}"}], "&"}], ",", "dm"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"3706dcee-eadb-432a-9d4d-8ed87b5a0d18"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"nc\"\>", "\<\"beta\"\>", "\<\"mean\"\>", 
     FractionBox[
      SuperscriptBox["\<\"nc\"\>", "2"], 
      RowBox[{"3", " ", "\<\"beta\"\>"}]], 
     FractionBox[
      SuperscriptBox["\<\"nc\"\>", "4"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\<\"beta\"\>", "2"], " ", "\[Pi]"}]]},
    {"3", "42.`", "0.0650492058072443`", "0.07142857142857142`", 
     "0.0073081351419747856`"},
    {"3", "80.`", "0.03371067322265413`", "0.0375`", "0.0020143047485068`"},
    {"4", "28.`", "0.1923250246554901`", "0.19047619047619047`", 
     "0.05196896100959848`"},
    {"4", "33.`", "0.1604205616819077`", "0.16161616161616163`", 
     "0.03741383418872838`"},
    {"4", "150.`", "0.03380841583718067`", "0.035555555555555556`", 
     "0.0018108295747344535`"},
    {"6", "90.`", "0.13525994258717414`", "0.13333333333333333`", 
     "0.025464790894703257`"},
    {"6", "170.`", "0.07017369456939337`", "0.07058823529411765`", 
     "0.0071371905275811895`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"a05856f9-43df-4129-994a-bdebec212a5d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"width", "=", "0.0025"}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"data", ",", 
       RowBox[{"{", "width", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], " ", "width", " ", 
        RowBox[{
         RowBox[{"PDF", "[", "dist", "]"}], "[", "x", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"3", " ", 
          RowBox[{"Mean", "[", "data", "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"16751e91-9fc7-44fd-8a85-dacfe0aa715d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gauge Invariant Shifts", \
"Section",ExpressionUUID->"70a8f81e-a052-4558-a91a-9b13ccf2d097"],

Cell["\<\
The gauge transforms should leave the action invariant.  Thus any small shift \
in the direction of a gauge transform should have zero gradient and zero \
second derivative.

Orthogonalizing the associated matrix creates a matrix that is roughly 50% \
dense.  This seems to be independent of the basis ordering.  For instance, \
going to checkerboard (linearSiteIndex[]) just changes the sparsity pattern. \
\
\>", "Text",ExpressionUUID->"dab88377-3c50-4b86-a6f3-c28d8ada18d5"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"4f2d55a1-cc48-4445-be7d-b915b1722a76"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"3653405f-b9f4-46d4-b917-683c0887bc71"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-1.m\>\""}]], \
"Input",ExpressionUUID->"df57d747-a076-482f-95ba-8697ded04788"],

Cell["Create trivial lattice with one non-trivial link.", \
"Text",ExpressionUUID->"6a528a5b-77f3-4aab-8f14-4235b0039174"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"makeTrivialLattice", "[", 
      RowBox[{"randomGauge", "\[Rule]", "False"}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", 
         RowBox[{"RandomReal", "[", "]"}], " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"gaugeField", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"linearSiteIndex", "[", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"c077d939-3e0a-4f92-8719-0370d137fe29"],

Cell[BoxData["0.8642381170346707`"], \
"Output",ExpressionUUID->"dae07a97-1709-495b-8e20-07a11a1ab950"]
}, Open  ]],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"79acc237-3b0d-48ad-a768-2ebf94534ca2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"21def71e-0e1e-40de-afeb-edd2cdb00125"],

Cell[BoxData[
 RowBox[{"-", 
  "0.07774365679510266`"}]], \
"Output",ExpressionUUID->"f823896e-b7ee-44e0-8f81-a66eab60b322"]
}, Open  ]],

Cell["\<\
Timing, matrix size, density, and memory use:
See https://mathematica.stackexchange.com/questions/83721/what-are-\
sparsearray-properties-how-and-when-should-they-be-used\
\>", "Text",ExpressionUUID->"731b054e-0d96-47d6-83d2-af9e66d55a4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"rl", "=", 
    RowBox[{"Chop", "[", 
     RowBox[{"makeRootLattice", "[", "]"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Dimensions", "[", 
      RowBox[{"sh", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"gaugeTransformShifts", "[", "rl", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"sh", "[", "Density", "]"}], ",", 
     RowBox[{"printMemory", "[", "sh", "]"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"2a73a8b6-ce86-4511-84df-e64a20cb99a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11.531193`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"85184", ",", "255552"}], "}"}], ",", "0.00018782870022539445`",
      ",", 
     TagBox[
      InterpretationBox[
       RowBox[{"\<\"132.\"\>", "\[Times]", 
        SuperscriptBox["10", "\<\"6\"\>"]}],
       1.31524824*^8,
       AutoDelete->True],
      EngineeringForm[#, 3]& ]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"c5e033b7-268a-4c09-94d9-05b22ec1f36a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Look at sh.Transpose[sh] and distribution of right hand sides\
\>", "Subsection",ExpressionUUID->"1a831bf2-4961-440f-9a01-41af9ea8fad4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals", ",", "oo"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"sh", ".", 
      RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}], "]"}]}], ";", 
  RowBox[{
  "Dimensions", "[", "oo", 
   "]"}]}]], "Input",ExpressionUUID->"ae532ef3-a947-4ef8-a31d-99b914ba148f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1728", ",", "1728"}], 
  "}"}]], "Output",ExpressionUUID->"c434e686-c7e3-4edb-a7d2-4c544127bc2a"]
}, Open  ]],

Cell["\<\
The matrix is fairly well-conditioned.
get 10.5 for data/3-3/periodic-6-8.175-3.m
get 24 for 3-4/periodic-16-33-4.m\
\>", "Text",ExpressionUUID->"0c62380a-0df6-471b-ab32-56a88548f36c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"condition", "[", 
  RowBox[{"sh", ".", 
   RowBox[{"Transpose", "[", "sh", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"90ea6fcc-c61d-467e-b6e8-c4f012ac20d9"],

Cell[BoxData["10.5140938244315`"], \
"Output",ExpressionUUID->"442f584c-53bb-48fc-a902-903847c4214e"]
}, Open  ]],

Cell["\<\
Convergence of conjugate gradients for this matrix is this to the number of \
steps:
get 0.52 for data/3-3/periodic-6-8.175-3.m
and 0.66 for second case\
\>", "Text",ExpressionUUID->"cacd9b46-e463-4804-b207-6024cc6d0f54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sqrt", "[", "%", "]"}], "-", "1"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sqrt", "[", "%", "]"}], "+", "1"}], 
   ")"}]}]], "Input",ExpressionUUID->"88c6b9c3-63d8-4d6f-815c-4c18b1489f2d"],

Cell[BoxData["0.5285847742026885`"], \
"Output",ExpressionUUID->"49e94fc3-6345-419a-9622-b3f6b473bc0f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"vals", ",", "30", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"Max", "[", "vals", "]"}], "+", "1"}], "]"}]}], "}"}], ",", 
      "All"}], "}"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"f360a4f1-c49c-41ea-82b7-fee766e0fe70"],

Cell["Generate and store values of shifts, using flag \
\[OpenCurlyDoubleQuote]storeBB\[CloseCurlyDoubleQuote]", \
"Text",ExpressionUUID->"18d8cd58-c509-4790-8510-3d09cbfb0501"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", 
     RowBox[{"largeShiftSearch", "\[Rule]", "300"}], ",", 
     RowBox[{"storeBB", "\[Rule]", "True"}]}], "]"}], ";", 
   RowBox[{
   "Dimensions", "[", "bb0", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"9fa1be7b-6c70-423d-9557-b93b7192458c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"1.56\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.563872*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"1.34\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.342192*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[1.563872*^6, 3], ", gaugeTransform shifts ", 
   EngineeringForm[1.342192*^6, 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"bd67bae3-3b0b-4c8d-98dc-1f99d10c94f0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "600"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 600],
  Editable->
   False]], "Print",ExpressionUUID->"7eb4d29d-daeb-430e-a305-dc192a3c528b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.6312634638406625`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.6312634638406625`],
  Editable->
   False]], "Print",ExpressionUUID->"d9c7f24b-0eaa-4647-8195-a94079fcd941"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.9672809999999999999`3.3579164045939702", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "2.755896000000000001`3.5115965762397017", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "3.892043`6.740692627619357"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.9672809999999999999`3.3579164045939702, ", orthogonalization=", 
   2.755896000000000001`3.5115965762397017, ", total=", 
   3.892043`6.740692627619357],
  Editable->
   False]], "Print",ExpressionUUID->"ec51e10a-f191-4fc3-af9d-e23fc933efe8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"272acce4-23f8-4bc6-8f94-960117bb1f74"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "18", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "300", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 18, " of ", 300, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"e946e66a-04d2-4fc8-838c-2be7e98b06d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "1542"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 1542],
  Editable->
   False]], "Print",ExpressionUUID->"9a066193-9fd9-44d0-a4a4-9faa128d0b86"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "105.74123527955436`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "2.166197170277021`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 105.74123527955436`, " Acond=", 
   2.166197170277021],
  Editable->
   False]], "Print",ExpressionUUID->"e5287009-914b-4f5d-aac3-9a88bc3c82ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "1.1903059924392521`*^-10", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "100.0627018406592`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 1.1903059924392521`*^-10, " ynorm=", 
   100.0627018406592],
  Editable->
   False]], "Print",ExpressionUUID->"efc44be1-2b5d-413b-8579-b5a12c2705c3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "1.5466884891025703`*^-10"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 1.5466884891025703`*^-10],
  Editable->
   False]], "Print",ExpressionUUID->"ea061ac6-2a82-4fb3-87fb-aa88cba9081c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "2.8008780000000000004`3.4097248164533918", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "16.1264200000000000025`3.8689385949238977", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "26.023481`7.565880386828367"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   2.8008780000000000004`3.4097248164533918, ", orthogonalization=", 
   16.1264200000000000025`3.8689385949238977, ", total=", 
   26.023481`7.565880386828367],
  Editable->
   False]], "Print",ExpressionUUID->"f225361f-3ead-4927-b05a-04dcf873f216"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"1cd6e5de-df3c-4232-b79f-2083915230dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "2.3606390000000000013`3.192117279116268", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.330711000000000002`2.4810351545846356", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.9246410000000000012`2.785263363623661", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "30.264913`7.631454427652538"}],
  SequenceForm[
  "findDelta.  ", "time (seconds):  dynamic part=", 
   2.3606390000000000013`3.192117279116268, ", small shifts=", 
   0.330711000000000002`2.4810351545846356, ", A=", 
   0.9246410000000000012`2.785263363623661, ", total=", 
   30.264913`7.631454427652538],
  Editable->
   False]], "Print",ExpressionUUID->"6d8f2cb0-0c3b-480b-9a0a-ea270c3a0ded"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.39406916812216`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.39406916812216, " to ", 2],
  
  Editable->
   False]], "Print",ExpressionUUID->"a9ca3af8-f4c1-452a-87dd-a861ee55e78d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.6125469999999999964`3.370981609903725", ",", 
     "10.239222`7.160781957016425", ",", "30.90546`7.640550209891046", ",", 
     "0.06479`4.962022977777321"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   8.6125469999999999964`3.370981609903725, 10.239222`7.160781957016425, 
    30.90546`7.640550209891046, 0.06479`4.962022977777321}],
  Editable->
   False]], "Print",ExpressionUUID->"e80f1900-ad19-4ceb-b28b-8a9bfda92cae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2145", ",", "5184"}], 
  "}"}]], "Output",ExpressionUUID->"a67b1d54-d077-4088-b9fc-440e8b1d45ef"]
}, Open  ]],

Cell["\<\
Average overlap of b-vectors with each eigenvector of sh.Transpose[sh], \
eigenvectors are sorted by decreasing eigenvalue.\
\>", "Text",ExpressionUUID->"89360bee-ef33-429f-84fe-46a40c97b4f4"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
     RowBox[{"oo", ".", "sh", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"bb0", "/", 
          RowBox[{"Map", "[", 
           RowBox[{"Norm", ",", "bb0"}], "]"}]}], ",", "600"}], "]"}], 
       "]"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"9d4c8e28-ae50-4f6f-a694-82b482b9bbdc"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
     RowBox[{"oo", ".", "sh", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Orthogonalize", "[", 
        RowBox[{"Drop", "[", 
         RowBox[{"bb0", ",", "600"}], "]"}], "]"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"de2edd8e-1022-43e4-91aa-1bb81bdac193"],

Cell["\<\
Overlap of b-vectors with subspace remains large over iterations.\
\>", "Text",ExpressionUUID->"baf556c7-bf1a-4750-af78-27241c4b68bc"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"Norm", ",", 
    RowBox[{"bb0", ".", 
     RowBox[{"Transpose", "[", "sh", "]"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"347b9b76-3a5d-4c88-997e-fa4aaf6b64c7"],

Cell["\<\
Fraction of independence of each b-vector from all previous b-vectors after \
transforming into the gauge transform space.  We see that the vectors are \
nearly orthogonal, to start with.  Note that the first iterations are for the \
calculation that locates the large shift eigenvectors of the Hessian.  Then \
comes the iterations associated with finding  the actual shifts.\
\>", "Text",ExpressionUUID->"e2aa7ad7-2365-49cb-bba3-f328834eac1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gbb0", "=", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"bb0", ",", "600"}], "]"}], ".", 
    RowBox[{"Transpose", "[", "sh", "]"}]}]}], 
  ";"}]], "Input",ExpressionUUID->"f6f66e83-1c58-4eec-897d-5980a5d37737"],

Cell[BoxData[
 RowBox[{
  RowBox[{"overlaps", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"obb", "=", 
         RowBox[{"If", "[", 
          RowBox[{"False", ",", 
           RowBox[{"gbb0", "/", 
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", "gbb0"}], "]"}]}], ",", 
           RowBox[{"Orthogonalize", "[", "gbb0", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", "=", 
             RowBox[{"gbb0", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"b", "=", 
             RowBox[{"b", "/", 
              RowBox[{"Norm", "[", "b", "]"}]}]}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ob", "=", 
                  RowBox[{"obb", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"b", "=", 
                 RowBox[{"b", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ob", ".", "b"}], ")"}], " ", "ob"}]}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"Norm", "[", "b", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "gbb0", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"fa96b888-dfb3-45e8-bfbb-fa9b976b2d3b"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", "overlaps", 
  "]"}]], "Input",ExpressionUUID->"684bcab3-bcd2-4ec0-b3b7-eb6c9fd678f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare different dynamicPart[ ] methods.", \
"Subsection",ExpressionUUID->"6f1aee46-e380-42a8-ad73-70513ea3f5d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testProjection", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"tol_:", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "sh", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      "r2", ",", 
      RowBox[{"t1", "=", 
       RowBox[{"SessionTime", "[", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"r2", "=", 
      RowBox[{"f", "[", "r1", "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<timing:  \>\"", ",", 
       RowBox[{
        RowBox[{"SessionTime", "[", "]"}], "-", "t1"}], ",", " ", 
       "\"\< s\>\""}], "]"}], ";", 
     RowBox[{
      RowBox[{"AllTrue", "[", 
       RowBox[{
        RowBox[{"r2", "-", 
         RowBox[{"f", "[", "r2", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "#", "]"}], "<", "tol"}], "&"}]}], "]"}], "&&", 
      
      RowBox[{"AllTrue", "[", 
       RowBox[{
        RowBox[{"sh", ".", "r2"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "#", "]"}], "<", "tol"}], "&"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0d3057b0-2077-42f6-bec0-368f343216ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpOrtho", "=", 
     RowBox[{"dynamicPart", "[", "sh", "]"}]}], ")"}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"06771f5b-1c80-400f-8d08-6b8a9bdd7084"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"1.56\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.563872*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"2.67\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     2.669232*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[1.563872*^6, 3], ", gaugeTransform shifts ", 
   EngineeringForm[2.669232*^6, 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"9bc612fd-d510-40ab-a893-43fd80da7a90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.195172`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"839aaf32-a1e3-4fb4-b226-e9dc27676a13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpOrtho", 
  "]"}]], "Input",ExpressionUUID->"f93f61f1-c3e2-4e63-922d-13f6602de969"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.012332`4.241548513886465", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.012332`4.241548513886465, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"3f84a88e-9f70-4285-9a63-6bac8555cff8"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"710ff20f-9f9b-4000-9410-18b5d53967f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLeast", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LeastSquares\>\""}]}], "]"}]}], 
    ")"}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"2a5a6f11-c859-469d-adc8-88a224e21d5a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"2.67\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     2.670008*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"2.67\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     2.669232*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"LeastSquares\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[2.670008*^6, 3], ", gaugeTransform shifts ", 
   EngineeringForm[2.669232*^6, 3], " (bytes) for ", "LeastSquares"],
  Editable->
   False]], "Print",ExpressionUUID->"8be75b76-8c43-4b61-9ac8-b451b83a5093"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.004469`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"586dbc76-b63a-43bb-911a-4374b8a7006f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", 
  RowBox[{"dpLeast", ",", 
   RowBox[{"10", "^", 
    RowBox[{"-", "7"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"df6420cc-dc07-417b-9ce5-02cc8c3442e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.343921`5.686973692716737", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.343921`5.686973692716737, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"5bc8d2f0-3464-43e1-835d-b05ccaa93899"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"ef13a3c1-543f-42a9-a884-3e305b484ebe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLinear", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LinearSolve\>\""}]}], "]"}]}], ")"}],
    ";"}], "]"}]], \
"Input",ExpressionUUID->"b61c9e0b-0df1-4376-ba15-4044a3d0b078"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"1.56\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.563872*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"2.67\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     2.669232*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"LinearSolve\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[1.563872*^6, 3], ", gaugeTransform shifts ", 
   EngineeringForm[2.669232*^6, 3], " (bytes) for ", "LinearSolve"],
  Editable->
   False]], "Print",ExpressionUUID->"fcd38151-1046-4f86-9a00-d460b1ac5272"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.225185`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"452b0290-8a2e-4293-b7e4-d2d351d39747"]
}, Open  ]],

Cell["\<\
For 3-3/periodic-22, 182s, 77MB memory, gaugeTransformShifts 132MB, trouble \
converging.  Looks like the Krylov method just stores the matrix until \
solving.\
\>", "Text",ExpressionUUID->"188e2f8a-f1f3-416b-8b7c-180e83987456"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLinear", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LinearSolve\>\"", ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Krylov\>\"", ",", 
             RowBox[{
             "\"\<Method\>\"", "\[Rule]", "\"\<ConjugateGradient\>\""}], ",", 
             
             RowBox[{"\"\<Tolerance\>\"", "\[Rule]", 
              RowBox[{"10", "^", 
               RowBox[{"-", "9"}]}]}]}], "}"}]}]}], "}"}]}]}], "]"}]}], ")"}],
    ";"}], "]"}]], \
"Input",ExpressionUUID->"d51ecd6c-9df0-42cb-9d5f-dcd1fc3ac3d0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"77.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     7.7008024*^7,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"132.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.31524824*^8,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"LinearSolve\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[7.7008024*^7, 3], ", gaugeTransform shifts ", 
   EngineeringForm[1.31524824*^8, 3], " (bytes) for ", "LinearSolve"],
  Editable->
   False]], "Print",ExpressionUUID->"0b58cd68-d9bb-4128-9e2e-5298880a1b93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.103072`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"3b8f6955-2b15-41e3-a779-bdc937eb2ccd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", 
  RowBox[{"dpLinear", ",", 
   RowBox[{"10", "^", 
    RowBox[{"-", "7"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"2c7b86b6-0625-42b9-bc52-28831bc9368b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "194.864584`8.440247912521668", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 194.864584`8.440247912521668, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"1a8d6649-1148-4350-8a19-6a0ed0ce7a75"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"6cd7d829-2598-4c7a-b247-c5d3e0232304"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"dpzLinear", "=", 
    RowBox[{"dynamicPart", "[", 
     RowBox[{"sh", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<MINRES\>\"", ",", 
         RowBox[{"printDetails", "\[Rule]", "1"}], ",", 
         RowBox[{"rTolerance", "\[Rule]", 
          RowBox[{"10", "^", 
           RowBox[{"-", "10"}]}]}]}], "}"}]}]}], "]"}]}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"89e09c47-899b-4215-a5d2-cd37026c1526"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"132.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.31524824*^8,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"MINRES\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[1.31524824*^8, 3], " (bytes) for ", "MINRES"],
  Editable->
   False]], "Print",ExpressionUUID->"e423a352-7d1f-4c18-88dd-3cbf7b8673d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.016466`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"7d9e4032-df22-418a-932e-d75dab2a6cea"]
}, Open  ]],

Cell["\<\
Faster than built-in Conjugate gradients, perhaps because we don\
\[CloseCurlyQuote]t explicitly construct the matrix.\
\>", "Text",ExpressionUUID->"55f37ac8-fcf2-4f35-84b0-1626952a5e62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", 
  RowBox[{"dpzLinear", ",", 
   RowBox[{"10", "^", 
    RowBox[{"-", "7"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"17c11821-4139-44bf-bdf6-6833af96830b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "59"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 59],
  Editable->
   False]], "Print",ExpressionUUID->"ff6896b9-e7b4-45d8-b787-fd76cc3722e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "395.03716905551056`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "1.9311149002602752`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 395.03716905551056`, " Acond=", 
   1.9311149002602752`],
  Editable->
   False]], "Print",ExpressionUUID->"8e69ace1-7fd0-49f8-a0eb-fce5142cfda8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "3.0333264518078993`*^-6", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "79.31986760299651`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 3.0333264518078993`*^-6, " ynorm=", 
   79.31986760299651],
  Editable->
   False]], "Print",ExpressionUUID->"1669bce8-b8a0-4313-817a-2b83182b0edb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "0.000012729989803035705`"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 0.000012729989803035705`],
  Editable->
   False]], "Print",ExpressionUUID->"ba2f11d0-f1ce-4377-b177-4cce723ed509"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "11.0355619999999999999`5.422457441248361", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "11.491725`7.210900222495141"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   11.0355619999999999999`5.422457441248361, ", orthogonalization=", 0, 
   ", total=", 11.491725`7.210900222495141],
  Editable->
   False]], "Print",ExpressionUUID->"83da1a12-91e8-47a8-9779-f21911aabeb9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"cb48e977-bde0-4f74-b49b-c6cbd4e30c96"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "11.678024`7.217884361285099", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 11.678024`7.217884361285099, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"576ff581-cca9-4862-990f-2a4eca840c8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "67"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 67],
  Editable->
   False]], "Print",ExpressionUUID->"2f10a662-0446-4790-9af1-e535a02a96d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "59.317692446204305`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "1.4150167556267843`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 59.317692446204305`, " Acond=", 
   1.4150167556267843`],
  Editable->
   False]], "Print",ExpressionUUID->"5aee3b3c-81ff-4969-936a-403688ce9f7e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "4.3544976588922137`*^-14", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "8.282375229660045`*^-6"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 4.3544976588922137`*^-14, " ynorm=", 
   8.282375229660045*^-6],
  Editable->
   False]], "Print",ExpressionUUID->"dd1b8e6c-366c-4a8e-847d-8b028cbfe7b6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "1.7927690092655245`*^-13"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 1.7927690092655245`*^-13],
  Editable->
   False]], "Print",ExpressionUUID->"d9dd1be2-075b-4878-9b07-3afe32513215"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "13.3208269999999999996`5.448971383207734", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "13.808233`7.2906531045461564"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   13.3208269999999999996`5.448971383207734, ", orthogonalization=", 0, 
   ", total=", 13.808233`7.2906531045461564],
  Editable->
   False]], "Print",ExpressionUUID->"ddd96962-5ae2-42bd-9332-ff0fd32b2e8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"bfe7e7aa-655c-476f-9161-c2ae3e954185"]
}, Open  ]],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"4e4502c4-2809-4abc-ba11-dfdb33f79615"]
}, Open  ]],

Cell["Not working.", \
"Text",ExpressionUUID->"2b06e251-38fe-44e4-a43b-a078378970ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"dpmLinear", "=", 
    RowBox[{"dynamicPart", "[", 
     RowBox[{"sh", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<multiLinearSolve\>\"", ",", " ", 
         RowBox[{"maxIterations", "\[Rule]", "100"}], ",", 
         RowBox[{"printDetails", "\[Rule]", "True"}]}], "}"}]}]}], "]"}]}], 
   ";"}], "]"}]], \
"Input",ExpressionUUID->"3c9ca5cc-b56f-4b20-9b94-7f48755ef79c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit multiLinearSolve.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "100", 
   "\[InvisibleSpace]", "\<\", Anorm=\"\>", "\[InvisibleSpace]", 
   "7.119545607685574`"}],
  SequenceForm[
  "Exit multiLinearSolve.  ", "istop=", 6, " itn=", 100, ", Anorm=", 
   7.119545607685574],
  Editable->
   False]], "Print",ExpressionUUID->"151cacd6-f773-4455-b6ab-8d081b185f03"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit multiLinearSolve.  \"\>", 
   "\[InvisibleSpace]", "\<\"Memory usage:  vv=\"\>", "\[InvisibleSpace]", 
   "1445696", "\[InvisibleSpace]", "\<\", tt=\"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm[
  "Exit multiLinearSolve.  ", "Memory usage:  vv=", 1445696, ", tt=", 0],
  Editable->
   False]], "Print",ExpressionUUID->"e9cdf4a7-6f98-49cb-9306-e67825798157"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit multiLinearSolve.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.3288579999999999999`3.667523409067849", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.0180859999999999996`2.106827528673186", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.365741`5.7136886458257115"}],
  SequenceForm[
  "Exit multiLinearSolve.  ", "time (seconds): M=", 0, ", A=", 
   0.3288579999999999999`3.667523409067849, ", orthogonalization=", 
   0.0180859999999999996`2.106827528673186, ", total=", 
   0.365741`5.7136886458257115],
  Editable->
   False]], "Print",ExpressionUUID->"477cfd62-5232-4b8b-9031-98fd1d974a69"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit multiLinearSolve.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit multiLinearSolve.  ", "The iteration limit was reached"],
  
  Editable->
   False]], "Print",ExpressionUUID->"a0dce499-f29c-4e23-8fb7-de32c36d4922"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"2.67\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     2.669232*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes)\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[2.669232*^6, 3], " (bytes)"],
  Editable->
   False]], "Print",ExpressionUUID->"b8ac02f4-b11c-4615-89d0-dfd043f22916"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.427251`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"4ef129da-5105-43c3-9c1e-8debae681fec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", 
  RowBox[{"dpmLinear", ",", 
   RowBox[{"10", "^", "0"}]}], 
  "]"}]], "Input",ExpressionUUID->"5074d6d8-4f1d-4763-a5c2-55c089ba652c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.014837`4.321861094519171", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.014837`4.321861094519171, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"45645af4-74e9-45d5-952a-eabff700ce30"],

Cell[BoxData["False"], \
"Output",ExpressionUUID->"0106effd-290b-4356-9e64-0c2bb2d40ef2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Improve sparsity of gauge invariant shift matrix", \
"Subsection",ExpressionUUID->"ca3df55b-f864-47ad-a41a-d206b9bb0bb9"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "sh", 
  "]"}]], "Input",ExpressionUUID->"0e72eafb-d68d-4fbb-b0c0-fce788dd2cd4"],

Cell["\<\
Orthonormal basis of gauge transforms.  We see that we get roughly 50% \
sparsity.\
\>", "Text",ExpressionUUID->"2de1c80b-7e87-4cc4-b793-7125f2fcca81"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"osh", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"Orthogonalize", "[", "sh", "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"c6b18c07-fbeb-4073-9ae9-def5afb6d163"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"osh", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"da7c847b-9efe-42a0-a374-a6427ca619b3"],

Cell[BoxData["0.5576131687242798`"], \
"Output",ExpressionUUID->"20413632-89bb-4280-9a7e-adf7042341b8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lastZero", "[", "x_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", "=", "None"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"j", "=", "i"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", "j"}]}], 
   "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5f91f407-2f3f-4797-9621-45927a46a6d1"],

Cell["\<\
Try to sort rows so that Orthogonalize[..] is more sparse.  This essentially \
didn\[CloseCurlyQuote]t work. \
\>", "Text",ExpressionUUID->"060a2599-3701-4c4e-92f4-68b6e86b72b9"],

Cell["Octahedral plus tetrahedral tessellation of the lattice.", \
"Text",ExpressionUUID->"24eee511-cc37-4f83-bb7a-26367e460cd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "allPlanes", "]"}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "]"}], ":=", 
   RowBox[{"allPlanes", "[", "nd", "]"}]}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "nd_", "]"}], ":=", 
   RowBox[{
    RowBox[{"allPlanes", "[", "nd", "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"BitAnd", "[", 
         RowBox[{"1", ",", 
          RowBox[{"BitShiftRight", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", 
            RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "-", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"nd", "-", "1"}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "nd"}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"d5747cfa-be36-46e2-ae4c-2400484de7e7"],

Cell["Cubic tessellation of the lattice", \
"Text",ExpressionUUID->"e38e4053-5389-47a5-ba3c-8557291c83a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "allPlanes", "]"}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "]"}], ":=", 
   RowBox[{"allPlanes", "[", "nd", "]"}]}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "nd_", "]"}], ":=", 
   RowBox[{
    RowBox[{"allPlanes", "[", "nd", "]"}], "=", 
    RowBox[{
    "IdentityMatrix", "[", "nd", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"559eb96d-4b71-4a4f-8105-407f97aea6ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coordRank", "[", "coords_", "]"}], ":=", 
   RowBox[{"coordRank", "[", 
    RowBox[{"coords", ",", 
     RowBox[{"Total", "[", "latticeDimensions", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"coordRank", "[", 
    RowBox[{"coords_", ",", "top_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cc", "=", 
        RowBox[{
         RowBox[{"allPlanes", "[", "]"}], ".", "coords"}]}], ",", 
       RowBox[{"i", "=", "1"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"cc", ",", 
             RowBox[{"2", "^", "i"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "==", "0"}], "&"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"2", "^", "i"}], "<", "top"}]}], ",", 
        RowBox[{"i", "+=", "1"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"True", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"For", " ", "debugging"}], " ", "*)"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"Length", "[", "cc", "]"}]}], "+", 
         RowBox[{"lastZero", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{"cc", ",", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{"cc", ",", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}]}], "}"}]}], "]"}]}]}],
     "]"}]}]}]], \
"Input",ExpressionUUID->"cf92b9d3-e970-48ed-b43b-8c62d72073ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"coordRank", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "i", ",", "j"}], "}"}], ",", 
       RowBox[{"3", "*", "16"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "16"}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], 
  "]"}]], "Input",ExpressionUUID->"12278aaf-2650-4134-a6f6-a70edd9fefe9"],

Cell[BoxData[
 TagBox[GridBox[{
    {"12", "4", "22", "4", "24", "4", "10", "4", "12", "4", "17", "4", "19", 
     "4", "10", "4"},
    {"4", "22", "4", "8", "4", "24", "4", "8", "4", "17", "4", "8", "4", "19",
      "4", "8"},
    {"22", "4", "12", "4", "10", "4", "24", "4", "17", "4", "12", "4", "10", 
     "4", "19", "4"},
    {"4", "8", "4", "12", "4", "8", "4", "24", "4", "8", "4", "12", "4", "8", 
     "4", "19"},
    {"23", "4", "10", "4", "12", "4", "17", "4", "24", "4", "10", "4", "12", 
     "4", "18", "4"},
    {"4", "23", "4", "8", "4", "17", "4", "8", "4", "24", "4", "8", "4", "18",
      "4", "8"},
    {"10", "4", "23", "4", "17", "4", "12", "4", "10", "4", "24", "4", "18", 
     "4", "12", "4"},
    {"4", "8", "4", "23", "4", "8", "4", "12", "4", "8", "4", "24", "4", "8", 
     "4", "12"},
    {"12", "4", "17", "4", "23", "4", "10", "4", "12", "4", "18", "4", "24", 
     "4", "10", "4"},
    {"4", "17", "4", "8", "4", "23", "4", "8", "4", "18", "4", "8", "4", "24",
      "4", "8"},
    {"17", "4", "12", "4", "10", "4", "23", "4", "18", "4", "12", "4", "10", 
     "4", "24", "4"},
    {"4", "8", "4", "12", "4", "8", "4", "23", "4", "8", "4", "12", "4", "8", 
     "4", "24"},
    {"20", "4", "10", "4", "12", "4", "18", "4", "23", "4", "10", "4", "12", 
     "4", "21", "4"},
    {"4", "20", "4", "8", "4", "18", "4", "8", "4", "23", "4", "8", "4", "21",
      "4", "8"},
    {"10", "4", "20", "4", "18", "4", "12", "4", "10", "4", "23", "4", "21", 
     "4", "12", "4"},
    {"4", "8", "4", "20", "4", "8", "4", "12", "4", "8", "4", "23", "4", "8", 
     "4", "12"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableDepth -> 
    2]]]], "Output",ExpressionUUID->"d88dcdcd-8613-4b8c-b447-5e7c59de965b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkerboardRank", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"Null", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nGauge", "[", "0", "]"}], "}"}]}], "]"}]}], ",", 
      "gindex"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"coords", "=", 
           RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"gindex", "=", 
           RowBox[{
            RowBox[{"coords2gauge", "[", "0", "]"}], "[", 
            RowBox[{"coords", ",", "ca"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", "gindex", "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ca", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
               RowBox[{"coordRank", "[", "coords", "]"}]}]}], ",", "gindex"}],
             "}"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ca", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
       RowBox[{"Sort", "[", "y", "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"77aac5c7-6087-4aac-939e-b474abacde30"],

Cell[BoxData[
 RowBox[{"osh2", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"Orthogonalize", "[", 
     RowBox[{"sh", "[", 
      RowBox[{"[", 
       RowBox[{"checkerboardRank", "[", "]"}], "]"}], "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"976a836e-0b6d-43e0-b52d-5b822b285c06"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "osh2", 
  "]"}]], "Input",ExpressionUUID->"caa1ee35-7f24-4060-9910-59cc92c90c44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"osh2", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"a160ca6b-1045-4e34-acaa-44c1bcaf1789"],

Cell[BoxData["0.3985259130658436`"], \
"Output",ExpressionUUID->"59ff9067-fe9f-42a8-9c7e-8b4db13a10b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"sshh", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"sh", ".", 
     RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"bb2a3070-f142-408c-8c38-2c8f3808767a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sshh", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"ee31d979-43c0-4b6b-9b55-23b0793f4bcf"],

Cell[BoxData["0.028356481481481483`"], \
"Output",ExpressionUUID->"8779bbbb-b114-474b-8360-8a5525d12aca"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dynamic space projection", \
"Subsection",ExpressionUUID->"ee583be3-56d3-4132-bc2a-1bb46b7b9c9c"],

Cell["\<\
Transpose[sh].sh is symmetric positive semi-definite.  The null space \
corresponds to non-gauge shifts.  Note that Transpose[sh].sh is still quite \
sparse.\
\>", "Text",ExpressionUUID->"a51bdc12-2192-4afa-a0ea-1ac57522e26a"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "sh", "]"}], ".", "sh"}], "]"}], "]"}], "]"}],
   "]"}]], "Input",ExpressionUUID->"94d8933c-0d49-4850-9bb5-ab8ac59dc4b0"],

Cell["\<\
Test that the gradients are orthogonal to all gauge transforms.\
\>", "Text",ExpressionUUID->"25a21468-e1c3-465f-becb-82db0a6a5d60"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sh", ".", "grad0"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"5336e040-a38e-4b27-b380-060927ace820"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "6"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"a2824aee-e92d-4313-97d9-adc4e47fe654"]
}, Open  ]],

Cell["\<\
However, since the Hessian is quadratic in the shifts, it is not necessarily \
in the direction of two infinitesimal gauge transforms.\
\>", "Text",ExpressionUUID->"d831ff6e-cfcf-4224-9a68-884ecae49258"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sh", ".", "hess0", ".", 
    RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"16ba49ae-15c2-47f9-8fd1-b4ef1ba5287e"],

Cell["\<\
Project onto subspace of physical degrees of freedom, this results in a dense \
matrix.\
\>", "Text",ExpressionUUID->"1a18d79e-5a04-4d3f-a743-068987ccffea"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"proj", "=", 
    RowBox[{"NullSpace", "[", "sh", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"052fe291-8b26-49ab-ad77-23ee9c0b412c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Adjoint trace identity", \
"Subsection",ExpressionUUID->"a3c22d7f-c4ea-4848-a8cf-c22d6e1fb349"],

Cell["\<\
Verify unitarity of the adjoint color matrix for some random element of \
SU(nc):  
        2 Tr[u.suGenerator[a].ConjugateTranspose[u].suGenerator[b]].  
Also, this matrix should be real-valued.  This matrix comes up in the \
analytic calculations.\
\>", "Text",ExpressionUUID->"1835d5fd-1e18-4938-8a12-6ffd9431551f"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nc", "=", "3"}], ",", "u"}], "}"}], ",", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
    RowBox[{"ff", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"u", ".", "#1", ".", 
            RowBox[{"ConjugateTranspose", "[", "u", "]"}], ".", "#2"}], 
           "]"}]}], "&"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
    RowBox[{"ff2", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"u", ".", "u", ".", "#1", ".", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"u", ".", "u"}], "]"}], ".", "#2"}], "]"}]}], "&"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}]}], "]"}]], \
"Input",ExpressionUUID->"5b02f108-95f0-46fb-a5b3-5d2c9795d535"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"ff", ".", 
   RowBox[{"ConjugateTranspose", "[", "ff", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"eff7ac91-bf94-4ca7-9821-132518a4dfe4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.0000000000000009`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1.0000000000000007`", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1.0000000000000002`", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1.0000000000000007`", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1.0000000000000007`", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1.0000000000000004`", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1.0000000000000007`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1.0000000000000007`"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"63c9521e-bb78-4820-9c1a-69815030d037"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"ff", ".", "ff"}], "-", "ff2"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"3ef5c08f-988f-48d4-bc40-174162d079c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "64"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"fb1519a0-083c-43ca-a632-cde436994bf0"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattice stationary point", \
"Section",ExpressionUUID->"aa898b09-9cda-4a98-9633-7bc8327b62f7"],

Cell[CellGroupData[{

Cell["Trivial lattice", \
"Subsection",ExpressionUUID->"5dc71044-15a4-48a0-aca3-28f2cee996fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "5"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeTrivialLattice", "[", 
   RowBox[{"randomGauge", "\[Rule]", "True"}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"fa06c0e1-583a-453c-8050-7d55393f585d"],

Cell[BoxData["1.0000000000000002`"], \
"Output",ExpressionUUID->"04586ca4-994c-4c7c-98e3-687ee15830fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "->", "0"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"be2b0ad3-439f-46ad-bf21-15b47bea1d6c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"15fa8888-0669-46ce-b35f-71a46234876d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "3.0946810000000000006`3.880708402957223", ",", 
     "3.408215`6.68304198133523", ",", "0.345241`5.688637363717612", ",", 
     "0.004637`3.816752093727798"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   3.0946810000000000006`3.880708402957223, 3.408215`6.68304198133523, 
    0.345241`5.688637363717612, 0.004637`3.816752093727798}],
  Editable->
   False]], "Print",ExpressionUUID->"a8d92578-e8e9-4ec8-869b-41f0d351c288"]
}, Open  ]]
}, Open  ]],

Cell["\<\
Symmetries of the lattice action.   Gauge fixing removes one dimension worth. \
 Difference is 9 for SU(2), 24 for SU(3), 45 for SU(4), 72 for SU(5), \
independent of the size of the lattice.  In general, the difference is 3 \
(nc^2-1).

Also, all curvatures are negative, indicating that this a a local minimum of \
the action, since the action is 1-Re(Tr(plaquettte))/Nc.

The result is independent of gauge choice.\
\>", "Text",ExpressionUUID->"b7131ec8-3d19-41bb-b465-8a8f79973908"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"proj0", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"proj0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "nd"}]}], 
  "}"}]], "Input",ExpressionUUID->"b69e43fa-2f8d-4205-b12b-febdaecb8cdc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"576", ",", "192"}], 
  "}"}]], "Output",ExpressionUUID->"019f691c-f54e-4eb6-9208-dcb49e5596f4"]
}, Open  ]],

Cell["Zero curvature would indicate a gauge symmetry.  ", \
"Text",ExpressionUUID->"e9e2300b-bc23-4131-9cda-4201e83f56dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Rationalize", "[", 
   RowBox[{"Chop", "[", "pairs0", "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"c672218a-e13a-42e8-8c81-e01ffcb2f70b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", "0"}], "}"}], ",", "48"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", "0"}], "}"}], ",", "144"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", "144"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "72"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"15514469-35e6-4ed2-b0a0-9746f85fecbf"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare different strategies.", \
"Subsection",ExpressionUUID->"bcfc2fa1-2be9-43cd-95af-fc0a44cb8d0b"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"35c47a1e-61f0-438c-893f-3045d6e32967"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"bec86423-c494-4ff1-9998-c7787189b400"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cutoff", "=", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"Pi", " ", 
     RowBox[{".01", "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "3"}], ")"}]}]}], ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"averagePlaquette", "[", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"4bf1ef37-0d73-4d29-b454-a8eb542322fc"],

Cell[BoxData["0.6349438216895237`"], \
"Output",ExpressionUUID->"04156583-a041-4f95-8a65-0242d87afd12"]
}, Open  ]],

Cell["Find fraction of shift that is non-gauge transformation.", \
"Text",ExpressionUUID->"bd99bea8-2eea-4369-bbfe-3acaf50794a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"dynamicShifts", "=", 
   RowBox[{"NullSpace", "[", 
    RowBox[{"gp", "=", 
     RowBox[{"gaugeTransformShifts", "[", 
      RowBox[{"makeRootLattice", "[", "]"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"4891064e-ad81-491e-abf5-ee1510328aa5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3456", ",", "5184"}], 
  "}"}]], "Output",ExpressionUUID->"293edd48-198e-48f4-8694-15ab11a66e79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAll", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], ";", 
  RowBox[{"pairsAll", "=", "pairs0"}], ";", 
  RowBox[{"ooprojAll", "=", 
   RowBox[{"oo0", ".", "proj0"}]}], 
  ";"}]], "Input",ExpressionUUID->"94681e1d-0e07-48de-8eca-bd29f4d64b08"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "282", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "5184", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 282, " of ", 5184, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"063a75b7-a7b8-4b81-9f60-f9ca6d3d2838"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.840350994239852`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2.`"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 8.840350994239852, " to ", 2.],
  Editable->
   False]], "Print",ExpressionUUID->"deb85bdc-0cf5-4790-a5d7-e8852ce41ea7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.1846810000000000022`3.3488517623106486", ",", 
     "9.774267`7.1405991961462965", ",", "22.737878`7.507264929780372", ",", 
     "0.069742`4.994009395367354"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   8.1846810000000000022`3.3488517623106486, 9.774267`7.1405991961462965, 
    22.737878`7.507264929780372, 0.069742`4.994009395367354}],
  Editable->
   False]], "Print",ExpressionUUID->"8605d3df-56bb-4d75-85f4-d337013d572a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
     RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", "grad0", 
  "]"}]], "Input",ExpressionUUID->"a1ce230d-ece7-420c-a59d-e446511913eb"],

Cell[BoxData["0.9999999999999999`"], \
"Output",ExpressionUUID->"06fa3b87-9afd-4ca5-b3d3-17d2f823009a"]
}, Open  ]],

Cell["\<\
On lattices with more than one link in each direction, the diagonal is zero.  \
But off-diagonal elements are non-zero since the quadratic expansion violates \
gauge invariance.\
\>", "Text",ExpressionUUID->"7409ba53-92fa-4642-9066-5eb90fc34a13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tr", "[", 
  RowBox[{"gp", ".", "hess0", ".", 
   RowBox[{"Transpose", "[", "gp", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"cb83543c-f1ab-42bc-b780-650b4a608c68"],

Cell[BoxData["1.0137664034739584`*^-13"], \
"Output",ExpressionUUID->"6267efc6-4c27-4e49-9947-f1d0e2f9dc73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamic", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], ";", 
  RowBox[{"pairsDynamic", "=", "pairs0"}], ";", 
  RowBox[{"ooprojDynamic", "=", 
   RowBox[{"oo0", ".", "proj0"}]}], 
  ";"}]], "Input",ExpressionUUID->"afa46855-8ec0-45fb-a1c4-2c85b0d3cfc4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "133", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "3456", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 133, " of ", 3456, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"9c79efe0-78b2-4a8a-852a-3b4efaa94bc1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "5.151305569552345`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2.`"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 5.151305569552345, " to ", 2.],
  Editable->
   False]], "Print",ExpressionUUID->"9db02c83-9858-4e8f-87d7-de70f594e8b9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.3807649999999999991`3.359133668004865", ",", 
     "10.06802`7.153459067429914", ",", "32.77853`7.6661044709467845", ",", 
     "0.063397`4.95258370501543"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   8.3807649999999999991`3.359133668004865, 10.06802`7.153459067429914, 
    32.77853`7.6661044709467845, 0.063397`4.95258370501543}],
  Editable->
   False]], "Print",ExpressionUUID->"56757bbd-a390-4d17-bdec-8a4cbf0d5bac"]
}, Open  ]]
}, Open  ]],

Cell["Map to the shift on the full lattice:", \
"Text",ExpressionUUID->"743462e9-3e1b-4ae7-b156-639ffed87155"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ffdd", "=", "2"}], ";", 
  RowBox[{"Dimensions", "[", 
   RowBox[{"axialProj", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"proj", "=", 
         RowBox[{"Association", "[", "]"}]}], ",", "i", ",", "j"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"coords", "=", 
             RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"proj", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"coords2grad", "[", "ffdd", "]"}], "[", 
                RowBox[{"dir", ",", "coords", ",", "k"}], "]"}], ",", 
               RowBox[{
                RowBox[{"coords2grad", "[", 
                 RowBox[{"-", "1"}], "]"}], "[", 
                RowBox[{"dir", ",", "coords", ",", "k"}], "]"}]}], "}"}], 
             "]"}], "=", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "nd"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{
            RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"Normal", "[", "proj", "]"}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"79c7fcc3-1644-49b4-9e61-4085e12213cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1152", ",", "1536"}], 
  "}"}]], "Output",ExpressionUUID->"35a49e83-1755-4fe9-ae4b-850af4e25fff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "ffdd", 
  "]"}]], "Input",ExpressionUUID->"a4751837-27cd-45f7-bde6-098a052b1e60"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxial", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "ffdd"}]}], "]"}]}], ";", 
  RowBox[{"pairsAxial", "=", "pairs0"}], ";", 
  RowBox[{"ooprojAxial", "=", 
   RowBox[{"oo0", ".", "proj0", ".", "axialProj"}]}], 
  ";"}]], "Input",ExpressionUUID->"1f635142-5508-4a57-a74d-a7522f7968f8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["cutoff:  ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"aec2e3b3-6573-4450-a5bc-0dd5be49ce1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3 zeros: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"16", ",", "1152"}], "}"}]}],
  SequenceForm["applyCutoff3 zeros: ", {16, 1152}],
  Editable->
   False]], "Print",ExpressionUUID->"aaf250b1-5311-423f-9544-2cdaae9c8361"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2 rescale: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"13.162435875684988`", ",", "1"}], "}"}]}],
  SequenceForm["applyCutoff2 rescale: ", {13.162435875684988`, 1}],
  Editable->
   False]], "Print",ExpressionUUID->"5872756a-d12a-4fd0-90b3-ff833ede3922"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1750639999999999985`3.301595822479056", ",", 
     "2.510806`6.550328155632788", ",", "0.312187`5.644929812170774", ",", 
     "0.018249`4.411754069014576"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1750639999999999985`3.301595822479056, 2.510806`6.550328155632788, 
    0.312187`5.644929812170774, 0.018249`4.411754069014576}],
  Editable->
   False]], "Print",ExpressionUUID->"88c152d0-fc72-4eec-a744-b7f60b65edb5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution of shifts", \
"Subsubsection",ExpressionUUID->"ab8e2ae7-8897-4703-9ac8-7cbe0a061203"],

Cell["\<\
Need to turn on switch in function applyCutoff3 to accumulate data for this \
plot.\
\>", "Text",ExpressionUUID->"e004f849-d1d1-4cc9-a73a-1abfe422b0f1"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "goodPairs0"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "badPairs0"}], "]"}]}], "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"cda78787-dce7-4e9f-8a23-c4dd0067bf64"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
     "pairsDynamic"}], "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"758111f3-9ba9-47ca-bd7c-2603fc3d9652"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsAll"}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsAxial"}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsDynamic"}], "]"}]}], "}"}], 
  "]"}]], "Input",ExpressionUUID->"6b732071-435f-4727-b67f-9028ee650712"],

Cell["\<\
Note that a Cauchy Distribution is generated by the ratio of two normally \
distributed variables.\
\>", "Text",ExpressionUUID->"174b75ad-bb54-4b68-858b-65a63102e499"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fitt", "=", 
  RowBox[{"FindDistribution", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], "]"}],
    "]"}]}]], "Input",ExpressionUUID->"b0c856f1-2814-4b1c-ab34-34d83ee86fb4"],

Cell[BoxData[
 RowBox[{"CauchyDistribution", "[", 
  RowBox[{
   RowBox[{"-", "0.004456584998476357`"}], ",", "0.30153209861780533`"}], 
  "]"}]], "Output",ExpressionUUID->"080183f1-866f-4940-8485-d1ead2b135c9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "=", "0.2"}], ",", 
     RowBox[{"max", "=", "2"}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], 
        "]"}], ",", 
       RowBox[{"{", "w", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", "All"}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PDF", "[", 
         RowBox[{"fitt", ",", "x"}], "]"}], 
        RowBox[{"Length", "[", "pairsDynamic", "]"}], " ", "w"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"0ae23791-3935-4ae3-b5dc-f9aa86e669d7"],

Cell["\<\
We see that there is a good fit in the tails and at the peak.\
\>", "Text",ExpressionUUID->"a7404a69-fc0d-4393-973c-20e3476a28d6"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "=", "0.2"}], ",", 
     RowBox[{"data", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
        "pairsDynamic"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"data", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Log\>\"", ",", 
         RowBox[{"{", "w", "}"}]}], "}"}], ",", 
       RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log\>\""}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     RowBox[{"LogPlot", "[", " ", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{"fitt", ",", 
            RowBox[{
             RowBox[{"Exp", "[", "x", "]"}], " ", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"w", "/", "2"}], ")"}]}]}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{"fitt", ",", 
            RowBox[{
             RowBox[{"Exp", "[", "x", "]"}], 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "w"}], "/", "2"}], ")"}]}]}]}], "]"}]}], ")"}], 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Min", "[", "data", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Max", "[", "data", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"4aed1145-ced3-48e2-a623-6f834523405c"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsAll"}], "]"}], 
     ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsAxial"}], "]"}],
      ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "Automatic"}], "}"}]}], 
   ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"aa2e6286-fd1a-479f-90cc-5d1736e5a92f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare shift vectors", \
"Subsubsection",ExpressionUUID->"b6c566c4-b245-454e-8bc2-f3eb0a80cdb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cosAngle", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", ".", "b"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", "a", "]"}], " ", 
     RowBox[{"Norm", "[", "b", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"3beaadf0-6d6c-49f2-855b-077d06119c34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "shifts", "]"}], ";", 
  RowBox[{
   RowBox[{"makeShifts", "[", 
    RowBox[{"type_", ",", "pairs_", ",", "ooproj_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "0", ",", "0"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairs"}], "]"}], 
        ".", "ooproj"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "1", ",", "0"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"applyCutoff3", "[", 
            RowBox[{"##", ",", "ooproj", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", "pairs", "]"}]}], "]"}], ".", 
        "ooproj"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "0", ",", "1"}], "]"}], "=", 
      RowBox[{"applyCutoff2", "[", 
       RowBox[{"shifts", "[", 
        RowBox[{"type", ",", "0", ",", "0"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "1", ",", "1"}], "]"}], "=", 
      RowBox[{"applyCutoff2", "[", 
       RowBox[{"shifts", "[", 
        RowBox[{"type", ",", "1", ",", "0"}], "]"}], "]"}]}], ";"}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"e1ba3afe-d40d-4428-b1fe-3f1b9312f3d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting All\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<All\>\"", ",", "pairsAll", ",", "ooprojAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting Dynamic\>\"", "]"}], ";", 
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<Dynamic\>\"", ",", "pairsDynamic", ",", "ooprojDynamic"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting Axial\>\"", "]"}], ";", 
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<Axial\>\"", ",", "pairsAxial", ",", "ooprojAxial"}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"bf348b45-0928-4dfa-b9dd-39cf686ae1f1"],

Cell[CellGroupData[{

Cell[BoxData["\<\"starting All\"\>"], \
"Print",ExpressionUUID->"90214e19-7881-4cf3-993c-0832df975512"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "70", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1536", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 70, " of ", 1536, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"46176475-f595-4e05-be96-01ba516d846a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "256.1295353274988`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 256.1295353274988, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"d24fe851-285f-497c-b2d6-f3811b2d2cfb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.268441115483451`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.268441115483451, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"505abb1b-0755-4913-bfd0-9703520cfc64"],

Cell[BoxData["\<\"starting Dynamic\"\>"], \
"Print",ExpressionUUID->"fac80416-461f-4d68-ae4b-12f1934a84d4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "32", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 32, " of ", 1024, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"d2d80516-5115-4693-a0fc-3b7a15c3d5f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "48.38767552974463`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 48.38767552974463, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"8f30f69d-f4ba-4250-bcfd-86e7d75f9b6a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "6.3107193177545104`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 6.3107193177545104`, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"09fafd92-f468-4aca-83c4-88f47d441f77"],

Cell[BoxData["\<\"starting Axial\"\>"], \
"Print",ExpressionUUID->"ffce667f-7098-4c65-8b8f-9d6553e74c32"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "48", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1152", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 48, " of ", 1152, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"d07f26bd-1eba-4cc6-bf94-cd1ac7d7f105"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "303.041061134496`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 303.041061134496, " to ", 1],
  
  Editable->
   False]], "Print",ExpressionUUID->"04dbb291-bb52-40f3-98d8-0233c811e59f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "6.756595777700484`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 6.756595777700484, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"3e81df9f-ed6e-4972-b3e7-fe0a76247587"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"typeOuter", "[", "type_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sh", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "0", ",", "1"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "1", ",", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"TableForm", "[", 
     RowBox[{"Outer", "[", 
      RowBox[{"cosAngle", ",", "sh", ",", "sh", ",", "1"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"920e30bb-053d-4942-826e-64ccada81aca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<All\>\"", 
  "]"}]], "Input",ExpressionUUID->"e2dbb5eb-7bc3-426a-8b03-43045db92360"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.0000000000000004`", "0.029184582026525824`", "1.`", 
     "0.029184582026525834`"},
    {"0.029184582026525824`", "1.`", "0.029184582026525813`", "1.`"},
    {"1.`", "0.029184582026525813`", "0.9999999999999998`", 
     "0.029184582026525817`"},
    {"0.029184582026525834`", "1.`", "0.029184582026525817`", "1.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"c728d126-5a06-43f8-9af7-c2664997be7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<Dynamic\>\"", 
  "]"}]], "Input",ExpressionUUID->"9e4d3e0a-53f0-4c84-a2af-c144e4fad290"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.0000000000000004`", "0.10859340149780253`", "1.`", 
     "0.10859340149780249`"},
    {"0.10859340149780253`", "1.`", "0.10859340149780251`", 
     "0.9999999999999999`"},
    {"1.`", "0.10859340149780251`", "1.`", "0.10859340149780251`"},
    {"0.10859340149780249`", "0.9999999999999999`", "0.10859340149780251`", 
     "1.0000000000000002`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"faf88fc8-3eae-412f-a3e8-420c90ffec3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<Axial\>\"", 
  "]"}]], "Input",ExpressionUUID->"a0b9e3a9-c2e6-4f53-9620-38d7dc789a8f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.0000000000000002`", "0.02551511016982429`", "0.9999999999999998`", 
     "0.025515110169824284`"},
    {"0.02551511016982429`", "1.`", "0.02551511016982429`", 
     "1.0000000000000002`"},
    {"0.9999999999999998`", "0.02551511016982429`", "1.`", 
     "0.025515110169824277`"},
    {"0.025515110169824284`", "1.0000000000000002`", "0.025515110169824277`", 
     "0.9999999999999998`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"3ab6491c-a2f5-4a5e-bd2c-488f269a2531"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<All\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"f9dab287-4518-4e2c-929e-aff1a0fe8428"],

Cell[BoxData["0.28641083765239306`"], \
"Output",ExpressionUUID->"45857684-c527-48cb-9cbd-acc5ecd4a739"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Axial\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"2a48e057-a1e3-448d-8fb2-49f6ea636d1c"],

Cell[BoxData["0.034195693593383994`"], \
"Output",ExpressionUUID->"77ac6d58-e512-4428-ab2b-c65f5f0425ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<All\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Axial\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"8de65499-8396-4cf6-9c91-776069c5810e"],

Cell[BoxData["0.08666795454794923`"], \
"Output",ExpressionUUID->"6ca1be50-d7f1-4a47-80f6-c50adee5b13d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<All\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"ad446423-112c-4f6b-9a8f-7a86f681e6cb"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.3967316208293747`", "0.3967316208293747`"},
    {"0.5821360351208185`", "0.5821360351208186`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"1d1446c7-9268-4442-b40f-30470ded6e78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<Dynamic\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"75e66e56-9c4d-477d-b2ee-20140891e26c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.`", "1.`"},
    {"1.`", "1.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"4105b48d-4e2c-40bd-ae6f-303000a79eb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<Axial\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"fdfc56ad-7fbe-45d3-9583-ec05d0ed71fb"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.7848695722465859`", "0.784869572246586`"},
    {"0.7985730121263523`", "0.7985730121263522`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"8378a896-03d9-4ac3-b8e0-2b31e690fa38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"dynamicShifts", ".", 
      RowBox[{"Transpose", "[", "dynamicShifts", "]"}]}], "-", 
     RowBox[{"IdentityMatrix", "[", "1024", "]"}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"f34cb463-70a0-4b48-b9a9-58e4290ec1ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1048576"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"7554c1f7-6eef-4516-bc86-c73744f3cf7b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"{", ".05", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"e07c6cb0-75bb-4ae0-a86c-d98402a15200"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Junk", "Section",ExpressionUUID->"a92408d4-f001-40b1-85ad-94f79aa17479"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phases", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"centerSUMatrix", "[", 
    RowBox[{"1", ",", "3"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"686d2b6b-ee73-41bc-913b-17e1265fdf07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "\[Pi]"}], "3"], ",", 
   FractionBox[
    RowBox[{"2", " ", "\[Pi]"}], "3"], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "\[Pi]"}], "3"]}]}], 
  "}"}]], "Output",ExpressionUUID->"03357285-a29e-4264-9e7a-438b56c8dea2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"phases", ",", "16"}], 
  "]"}]], "Input",ExpressionUUID->"7efc902e-0982-442d-9351-8caf64282079"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.09439510239319549230842892218633613323`16.", ",", 
   "2.09439510239319549230842892218633613323`16.", ",", 
   RowBox[{"-", "4.18879020478639098461685784437267226645`16."}]}], 
  "}"}]], "Output",ExpressionUUID->"2c0859eb-1e6a-4dfb-accc-4a09ba147334"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"lineLinks", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"1d780d2a-b4a6-4278-bcc0-f75e106c6cd4"],

Cell[BoxData[
 RowBox[{"plotAction", "[", 
  RowBox[{"1", ",", "2", ",", "3", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"4", " ", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "/", "3"}]}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"ba76764a-4909-4732-8f1b-eeae0a1a519a"],

Cell[BoxData[
 RowBox[{"latticeSaddlePoint", "[", "5", 
  "]"}]], "Input",ExpressionUUID->"84cd5e73-3a9a-4185-b2bd-67fec59043ff"],

Cell[BoxData[
 RowBox[{"stats", "=", 
  RowBox[{
  "latticeSaddlePoint", "[", "50", 
   "]"}]}]], "Input",ExpressionUUID->"39cd555d-179f-4c65-b660-0cc1041ddcb0"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], "]"}], "]"}], "&"}], ",", "stats"}], 
   "]"}], "]"}]], \
"Input",ExpressionUUID->"fe2c5a12-8f30-48dc-97d9-beb1e3611f95"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"norm", "/.", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
         "]"}]}]}], "}"}], "&"}], ",", "stats"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"3a5eba66-dcda-48cd-811a-84f1b3feb07a"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"aw", "/.", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
         "]"}]}]}], "}"}], "&"}], ",", "stats"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"f29e21a9-c220-44a0-ac09-ce1085150205"],

Cell[BoxData[
 RowBox[{"stats", "=", 
  RowBox[{
  "latticeSaddlePoint", "[", "14", 
   "]"}]}]], "Input",ExpressionUUID->"90951bf1-1e70-40ff-89ca-d4f993fbf3bf"],

Cell["Save resulting lattice", \
"Text",ExpressionUUID->"8bd4fa06-fe44-4021-8d56-44540a6ec977"],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{"\"\<periodic-3-3-22-42-1-fastcool.m\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "nd", ",", "nc", ",", "beta", ",", "latticeDimensions", ",", 
     "latticeLayout", ",", "gaugeField", ",", "linearSiteIndex"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"7b407bca-c25e-4871-ad42-6b55adab4d4d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1029, 659},
WindowMargins->{{Automatic, 93}, {22, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]

