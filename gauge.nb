Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7673569687731447`*^9, 
  3.7673569687738857`*^9}},ExpressionUUID->"de20a98f-e354-4b6f-9a89-\
03be16dbf4b4"],

Cell["\<\
Disable current notebook FileOutlineCache and CellChangeTimes.  See: \
https://stackoverflow.com/questions/2816628/version-control-of-mathematica-\
notebooks \
\>", "Text",ExpressionUUID->"9ee48861-dafe-44bf-a94c-3fd335597e53"],

Cell[CellGroupData[{

Cell["Library", \
"Section",ExpressionUUID->"9f82eb6c-b95c-4051-b624-87f36d09b10f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLink", "[", 
     RowBox[{"dir_", ",", "coords_List"}], "]"}], ":=", 
    RowBox[{"gaugeField", "[", 
     RowBox[{"[", 
      RowBox[{"dir", ",", 
       RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"setLink", "[", 
     RowBox[{"dir_", ",", "coords_List", ",", "mat_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"gaugeField", "[", 
      RowBox[{"[", 
       RowBox[{"dir", ",", 
        RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], "=", 
     "mat"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeVolume", "[", "]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Times", ",", " ", "latticeDimensions"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeCoordinates", "[", "ii_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "not", " ", "necessarily", " ", "the", " ", 
     "inverse", " ", "of", " ", 
     RowBox[{"linearSiteIndex", ".", "  ", "It"}], " ", "is", " ", "simply", 
     " ", "a", " ", "way", " ", "to", " ", "iterate", " ", "over", " ", "the",
      " ", "whole", " ", 
     RowBox[{"lattice", "."}]}], " ", "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"ii", "-", "1"}]}], ",", "j"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "=", 
         RowBox[{"QuotientRemainder", "[", 
          RowBox[{"i", ",", 
           RowBox[{"latticeDimensions", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"j", "+", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nd"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shift", "[", 
    RowBox[{"dir_", ",", "coords_", ",", 
     RowBox[{"size_:", "1"}]}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Wrap", "-", "around"}], ",", " ", 
     RowBox[{
     "assuming", " ", "periodic", " ", "boundary", " ", "conditions"}]}], " ",
     "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cc", "=", "coords"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"cc", "[", 
        RowBox[{"[", "dir", "]"}], "]"}], "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cc", "[", 
            RowBox[{"[", "dir", "]"}], "]"}], "+", "size", "-", "1"}], ",", 
          RowBox[{"latticeDimensions", "[", 
           RowBox[{"[", "dir", "]"}], "]"}]}], "]"}]}]}], ";", "cc"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plaquette", "[", 
    RowBox[{"dir1_", ",", "dir2_", ",", " ", "coords_List"}], "]"}], ":=", 
   RowBox[{"Tr", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getLink", "[", 
      RowBox[{"dir1", ",", "coords"}], "]"}], ".", 
     RowBox[{"getLink", "[", 
      RowBox[{"dir2", ",", 
       RowBox[{"shift", "[", 
        RowBox[{"dir1", ",", "coords"}], "]"}]}], "]"}], ".", 
     RowBox[{"ConjugateTranspose", "[", 
      RowBox[{"getLink", "[", 
       RowBox[{"dir1", ",", 
        RowBox[{"shift", "[", 
         RowBox[{"dir2", ",", "coords"}], "]"}]}], "]"}], "]"}], ".", 
     RowBox[{"ConjugateTranspose", "[", 
      RowBox[{"getLink", "[", 
       RowBox[{"dir2", ",", "coords"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"averagePlaquette", "[", "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"plaquette", "[", 
        RowBox[{"dir1", ",", "dir2", ",", 
         RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir1", ",", "2", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir2", ",", 
         RowBox[{"dir1", "-", "1"}]}], "}"}]}], "]"}], "*", 
     RowBox[{"2", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"latticeVolume", "[", "]"}], "*", "nc", "*", "nd", "*", 
        RowBox[{"(", 
         RowBox[{"nd", "-", "1"}], ")"}]}], ")"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"6c880b77-3e17-4cda-b61a-af6936bf44d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"randomSUMatrix", "[", "n_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mat", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"CircularUnitaryMatrixDistribution", "[", "n", "]"}], "]"}]}],
       "}"}], ",", 
     RowBox[{"mat", "/", 
      RowBox[{
       RowBox[{"Det", "[", "mat", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "n"}], ")"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"centerSUMatrix", "[", 
    RowBox[{"n_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "n", "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "Pi", " ", "I", " ", 
      RowBox[{"j", "/", "n"}]}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"matrixEqual", "[", 
    RowBox[{"m1_", ",", "m2_"}], "]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"And", ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Equal]", "0"}], "&"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{"m1", "-", "m2"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"SUMatrixQ", "[", 
    RowBox[{"mat_", "?", "SquareMatrixQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"Det", "[", "mat", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"z", ".", 
       RowBox[{"ConjugateTranspose", "[", "z", "]"}]}], "]"}], "==", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"Length", "[", "mat", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"530fec0d-608d-4463-8494-a846af9a2893"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SUPower", "[", 
   RowBox[{"mat_", ",", "power_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"values", ",", "vectors", ",", "phases", ",", "phaseSum", ",", 
      RowBox[{"fix", "=", "True"}], ",", "delta"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"values", ",", "vectors"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mat", "]"}]}], ";", 
     RowBox[{"phases", "=", 
      RowBox[{"Arg", "[", "values", "]"}]}], ";", 
     RowBox[{"phaseSum", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"Plus", "@@", "phases"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"Sanity", " ", "check"}], " ", "*)"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"phaseSum", ",", 
          RowBox[{"2", "Pi"}]}], "]"}], "!=", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<phaseSum=\>\"", ",", "phaseSum"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "the", " ", "total", " ", "is", " ", "nonzero"}], 
       ",", " ", 
       RowBox[{"need", " ", "to", " ", "shift"}]}], " ", "*)"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phaseSum", "!=", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"phases", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-=", "phaseSum"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"fix", ",", 
          RowBox[{
           RowBox[{"fix", "=", "False"}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"phases", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"phases", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ">", 
                RowBox[{"2", "*", "Pi"}]}], ",", 
               RowBox[{
                RowBox[{"delta", "=", 
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"phases", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"phases", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", 
                    RowBox[{"2", "*", "Pi"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"4", "*", "Pi"}], ")"}]}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{"phases", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-=", 
                 RowBox[{"2", "*", "Pi", "*", "delta"}]}], ";", 
                RowBox[{
                 RowBox[{"phases", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "+=", 
                 RowBox[{"2", "*", "Pi", "*", "delta"}]}], ";", 
                RowBox[{"fix", "=", "True"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "mat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}]}], 
         "]"}]}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"Transpose", "[", "vectors", "]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", "*", "phases", "*", "power"}], "]"}], "]"}], ".", 
      RowBox[{"Conjugate", "[", "vectors", "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e954d9cb-b767-487e-9f12-96995a7f14d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setAxialGauge", "[", "dir_", "]"}], ":=", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Set", " ", "gauge", " ", "for", " ", "the", " ", "current", " ", 
     "lattice", " ", 
     RowBox[{"configuration", ".", "  ", "This"}], " ", "should", " ", "be", 
     " ", "exact"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "average", " ", "plaquette", " ", "should", " ", 
     "be", " ", 
     RowBox[{"unchanged", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", 
        RowBox[{"debug", "=", "False"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coords", "[", 
          RowBox[{"[", "dir", "]"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], ",", "vt", ",", 
            "ct"}], "}"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Initial", " ", "values"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"False", ",", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"getLink", "[", 
                   RowBox[{"dir", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "coords", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "}"}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"latticeDimensions", "[", 
                  RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{"v", ".", 
               RowBox[{"getLink", "[", 
                RowBox[{"dir", ",", 
                 RowBox[{"shift", "[", 
                  RowBox[{"dir", ",", "coords", ",", 
                   RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Full product:\>\"", ",", " ", "v"}], "]"}]}], 
            "]"}], ";", 
           RowBox[{"v", "=", 
            RowBox[{"suPower", "[", 
             RowBox[{"v", ",", 
              RowBox[{"1", "/", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "dir", "]"}], "]"}]}]}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Root:\>\"", ",", " ", "v"}], "]"}]}], "]"}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Apply", " ", "gauge", " ", "choice", " ", "to", " ", "each", 
              " ", "site"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ct", "=", 
               RowBox[{"shift", "[", 
                RowBox[{"dir", ",", "coords", ",", 
                 RowBox[{"j", "-", "1"}]}], "]"}]}], ";", 
              RowBox[{"vt", "=", 
               RowBox[{
                RowBox[{"ConjugateTranspose", "[", 
                 RowBox[{"getLink", "[", 
                  RowBox[{"dir", ",", 
                   RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "ct", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], ".", "v"}]}],
               ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"setLink", "[", 
                  RowBox[{"dd", ",", 
                   RowBox[{"shift", "[", 
                    RowBox[{"dd", ",", "ct", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "In", " ", "order", " ", "to", " ", "decrease", " ", 
                    "the", " ", "floating", " ", "point", " ", "error"}], ",",
                     " ", 
                    RowBox[{
                    "just", " ", "set", " ", "the", " ", "axial", " ", 
                    "direction", " ", "link", " ", "to", " ", "the", " ", 
                    "correct", " ", 
                    RowBox[{"value", "."}]}]}], " ", "*)"}], 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dd", "\[Equal]", "dir"}], ",", "v", ",", 
                    RowBox[{
                    RowBox[{"getLink", "[", 
                    RowBox[{"dd", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dd", ",", "ct", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], ".", "vt"}]}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"setLink", "[", 
                  RowBox[{"dd", ",", "ct", ",", 
                   RowBox[{
                    RowBox[{"ConjugateTranspose", "[", "vt", "]"}], ".", 
                    RowBox[{"getLink", "[", 
                    RowBox[{"dd", ",", "ct"}], "]"}]}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"dd", ",", "nd"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Verify", " ", "that", " ", "it", " ", "all", " ", "worked", " ", 
             "out"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"getLink", "[", 
                    RowBox[{"dir", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "coords", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "}"}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"latticeDimensions", "[", 
                   RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final link diff:\>\"", ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"v", "-", 
                  RowBox[{"getLink", "[", 
                   RowBox[{"dir", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "coords", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], 
               "]"}]}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9083f81b-6c62-4ab0-b753-7947975525cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";", " ", 
  RowBox[{"s2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "I"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "I"}], ",", "0"}], "}"}]}], "}"}]}], ";", " ", 
  RowBox[{"s3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.764090054416305*^9, 
  3.764090105420974*^9}},ExpressionUUID->"d49a298e-44df-4fce-80e5-\
9da35ae92600"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", \
"Section",ExpressionUUID->"1c93cf5a-79ab-498c-bcfe-5a738bfce9fe"],

Cell[CellGroupData[{

Cell["Test matrixPower", \
"Subsection",ExpressionUUID->"3768ebd7-60d1-412e-8a86-45056134f460"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"centerMatrix", "[", 
   RowBox[{"7", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.767360010217095*^9, 3.7673600280621767`*^9}, {
  3.767390475898447*^9, 3.7673904857583847`*^9}, {3.767390647393319*^9, 
  3.767390648196973*^9}},ExpressionUUID->"83f7ac9d-741e-4e0d-8947-\
0dbc40a223f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"9921ddbe-7e29-4d41-b4aa-291cb2777222"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"randomSUMatrix", "[", "7", "]"}]}]], "Input",
 CellChangeTimes->{{3.7673582050907173`*^9, 3.767358230421783*^9}, {
  3.7673582683533573`*^9, 3.767358298990622*^9}, {3.767358509574492*^9, 
  3.767358510325032*^9}, {3.767359481759447*^9, 3.767359482147523*^9}, {
  3.767359643239163*^9, 3.767359643609215*^9}, {3.7673603360966873`*^9, 
  3.7673603365376167`*^9}, {3.7673905205384197`*^9, 
  3.767390521554913*^9}},ExpressionUUID->"3972b830-e5b1-4e08-84e7-\
b6ace11488f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"gaugeField", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "15"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.766972462904788*^9, 3.766972464175539*^9}, {
  3.767356782678484*^9, 3.7673567833886337`*^9}, {3.767357017701527*^9, 
  3.767357038858267*^9}, {3.76735796456426*^9, 3.767357975954447*^9}, {
  3.7673907291441927`*^9, 
  3.7673907295357113`*^9}},ExpressionUUID->"09e0ea41-9489-459d-9d9f-\
8418726ad0fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.077531345188618`"}], "-", 
      RowBox[{"0.821776568889618`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.538166880607605`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.170436531305313`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.538166880607605`"}], "+", 
      RowBox[{"0.170436531305313`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.077531345188618`"}], "+", 
      RowBox[{"0.821776568889618`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.767357030976116*^9, 3.76735704029375*^9}, {
  3.7673579666429768`*^9, 3.767357976607251*^9}, {3.767390715127975*^9, 
  3.767390730269294*^9}},ExpressionUUID->"7f8dd2b8-0e04-4775-8ef8-\
04e791eafe2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "x", 
  "]"}]], "Input",ExpressionUUID->"80906468-84a1-4026-96bd-690bba264101"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"6bade17b-8904-4ab6-9d76-5e9fdb5e0524"]
}, Open  ]],

Cell["Take the root", \
"Text",ExpressionUUID->"acb868d4-d5e8-4657-ad42-0d4081390ddf"],

Cell[BoxData[
 RowBox[{"z", "=", 
  RowBox[{"SUPower", "[", 
   RowBox[{"x", ",", "0.2"}], 
   "]"}]}]], "Input",ExpressionUUID->"62f8217a-e245-48d9-8c8c-d98248f435b0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "z", 
  "]"}]], "Input",ExpressionUUID->"eaaf0de9-62f1-4337-af34-c735668926af"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"ae834dbc-a32f-46c8-acf7-477b0355c54f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrixEqual", "[", 
  RowBox[{
   RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], ",", "x"}], 
  "]"}]], "Input",ExpressionUUID->"e3d96ab9-95ac-4bd9-80bc-ce055550bf5c"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"75c72e3d-9598-473e-8560-e9d02fd05e10"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Axial gauge", \
"Subsection",ExpressionUUID->"e5feee6c-2068-491e-8d64-92dee0a2fe65"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-4.m\>\""}]], \
"Input",ExpressionUUID->"5a200ad1-31a0-4112-b7a3-c5e52782264c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"7746dad0-5a33-4528-8a58-3d38bc371635"],

Cell[BoxData["0.815348021267465`"], \
"Output",ExpressionUUID->"b2dc8871-83a6-4e5a-b00a-ae87456dbb70"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "3", 
  "]"}]], "Input",ExpressionUUID->"0458857f-8518-4dd3-a723-da3b171368e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"9d6889ff-b3a2-42df-8839-08eb31fce7f6"],

Cell[BoxData["0.8153483292850945`"], \
"Output",ExpressionUUID->"8efa4177-e234-407d-a9db-05d275bf4e3b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Junk", \
"Subsection",ExpressionUUID->"830a836a-e29d-44bd-b114-bab532fe3e60"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{"I", " ", "theta", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a1", " ", "s1"}], "+", 
         RowBox[{"a2", " ", "s2"}], "+", 
         RowBox[{"a3", " ", "s3"}]}], ")"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "^", "2"}], "+", 
       RowBox[{"a2", "^", "2"}], "+", 
       RowBox[{"a3", "^", "2"}]}], "\[Rule]", "1"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "theta"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Cos", "[", "theta", "]"}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"Sin", "[", "theta", "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "theta"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Cos", "[", "theta", "]"}], "-", 
        RowBox[{"I", " ", 
         RowBox[{"Sin", "[", "theta", "]"}]}]}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.764090108855508*^9, 3.764090127657098*^9}, {
  3.7640901819988813`*^9, 3.764090205441126*^9}, {3.764090383222817*^9, 
  3.764090411424221*^9}, {3.764090482110138*^9, 3.764090529890731*^9}, {
  3.764090560586191*^9, 
  3.764090629637965*^9}},ExpressionUUID->"00f5f4df-f14c-43d8-88c5-\
d862949ce502"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "theta", "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}]}], ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"a1", "+", 
        RowBox[{"\[ImaginaryI]", " ", "a2"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "a1"}], "+", "a2"}], ")"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "theta", "]"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7640901297796173`*^9, {3.764090185432784*^9, 3.764090208688999*^9}, {
   3.764090390002452*^9, 3.764090413839761*^9}, {3.7640905106279488`*^9, 
   3.764090530963612*^9}, {3.764090590495772*^9, 
   3.76409063039958*^9}},ExpressionUUID->"7733d0cf-d618-48c6-95e1-\
ed20dd1f2e00"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-4.m\>\""}]], \
"Input",ExpressionUUID->"b31e1c13-01ce-4c66-82c6-5133d181c395"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"beta", ",", "nc", ",", "nd", ",", "latticeDimensions", ",", 
   RowBox[{"Dimensions", "[", "gaugeField", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.766971654166103*^9, 3.766971666373981*^9}, {
  3.767019041979619*^9, 
  3.7670190717957973`*^9}},ExpressionUUID->"edff2e52-b925-4a63-94aa-\
e4f4b97d7412"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.800000190734863`", ",", "2", ",", "3", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "48", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7669716671508913`*^9, {3.76701906129912*^9, 3.767019073340712*^9}, 
   3.767019450260667*^9, 
   3.767020323310501*^9},ExpressionUUID->"f2a11410-3bc5-49fa-80c2-\
9acbc39d1831"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vol", "=", 
  RowBox[{"2", " ", "Pi", " ", 
   RowBox[{"(", 
    RowBox[{"34", "/", "2.54"}], ")"}], "*", "Pi", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0.5", "*", 
      RowBox[{"3.5", "/", "2.54"}]}], ")"}], "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.767371374439612*^9, 3.767371414143136*^9}, {
  3.7673718610450087`*^9, 3.767371898469871*^9}, {3.7673878088750267`*^9, 
  3.767387809772749*^9}, {3.767387847936617*^9, 
  3.76738784858676*^9}},ExpressionUUID->"297d830c-d859-4906-bd95-\
e71dbde7c29a"],

Cell[BoxData["125.42485441729268`"], "Output",
 CellChangeTimes->{{3.767371397721208*^9, 3.767371414990975*^9}, 
   3.76737189959151*^9, 3.767387810506806*^9, 3.767387849293007*^9, 
   3.767388895742126*^9},ExpressionUUID->"513892b6-21aa-4804-9535-\
d4eeae6ff23f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vol", "/", 
  RowBox[{"(", 
   RowBox[{"Pi", " ", 
    RowBox[{"1", "^", "2"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7673714160288258`*^9, 3.7673714557887278`*^9}, {
  3.767371926504825*^9, 3.7673719287549057`*^9}, {3.7673878296165123`*^9, 
  3.7673878301915627`*^9}},ExpressionUUID->"90575861-7818-4697-942a-\
f5f7f24702cb"],

Cell[BoxData["39.92397113418695`"], "Output",
 CellChangeTimes->{{3.767371429446732*^9, 3.767371456507098*^9}, {
   3.767371909420974*^9, 3.767371929516944*^9}, {3.7673878332352333`*^9, 
   3.7673878562970552`*^9}, 
   3.767388897765039*^9},ExpressionUUID->"ee8dc2d7-d746-4835-880e-\
97a9d8b13010"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{877, 677},
WindowMargins->{{Automatic, 91}, {0, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]

