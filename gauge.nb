Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7673569687731447`*^9, 
  3.7673569687738857`*^9}},ExpressionUUID->"521048f1-0f5b-40c7-9fcc-\
57a33d77e506"],

Cell["\<\
Disable current notebook FileOutlineCache and CellChangeTimes.  See: \
https://stackoverflow.com/questions/2816628/version-control-of-mathematica-\
notebooks \
\>", "Text",ExpressionUUID->"35ca5f76-e844-4a00-a9bb-a561656c5ecf"],

Cell[CellGroupData[{

Cell["Library", \
"Title",ExpressionUUID->"f375741d-7d1c-47d0-bfe3-71618e4fe201"],

Cell["\<\
For parallelization, I had to go to menu Evaluation->Parallel Kernel \
Configuration and set the number manually.  Automatic launching of additional \
kernels is broken?  Note that the parallelization is based on the leading \
dimension of the table.
Verify parallel kernels are running:\
\>", "Text",ExpressionUUID->"88d0e5ea-1d3e-4d52-a580-cb9c96ec1520"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/groups.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/xml.m\>\""}], ";", 
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b6e3936e-813f-4d67-89c4-91da0e5a71a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/lattice.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/linear-algebra.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/teper-results.m\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"64e681c2-1f5a-4f7f-8644-87139d41dc21"],

Cell["Lattice Saddle Point", \
"Text",ExpressionUUID->"a31d566d-47d5-4d92-ac0c-ff3905ce56b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/minres1.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/minresqlp0.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/minres.m\>\""}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"13bc2c0e-f909-450a-b878-2d0e290395b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/saddle-point.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/saddle-point-single.m\>\""}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"abff722b-7fa1-4fd9-b9dc-08080e9da613"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"journalStyle", "=", 
   RowBox[{"{", 
    RowBox[{"FontSize", "\[Rule]", "10"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "ACM", " ", "default", " ", "font", " ", "for", " ", "text", " ", "is", 
      " ", "9", " ", 
      RowBox[{"(", 
       RowBox[{
       "10", " ", "for", " ", "large", " ", "journal", " ", "format"}], 
       ")"}]}], " ", "*)"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figureWidth", "=", 
   RowBox[{"72", " ", 
    RowBox[{"If", "[", 
     RowBox[{"False", ",", "6.5", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Maximum", " ", "allowed", " ", "width", " ", "for", " ", "ACM", " ", 
        "journal", " ", "large", " ", 
        RowBox[{"format", "."}]}], " ", "*)"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"10", "/", "3"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "ACM", " ", "journal", " ", "column", " ", "with", " ", "for", " ", 
        "two"}], "-", 
       RowBox[{"column", " ", 
        RowBox[{"format", "."}]}]}], " ", "*)"}], "]"}]}]}], ";"}]}], "Input",
 
 InitializationCell->True,
 CellChangeTimes->{{3.5567387399792356`*^9, 3.556738785657119*^9}, {
  3.559926012120932*^9, 3.559926089440562*^9}, {3.559926325780661*^9, 
  3.559926326691791*^9}, {3.559926615085618*^9, 3.559926615829599*^9}, {
  3.559926675150295*^9, 3.559926676236656*^9}, {3.55992673961215*^9, 
  3.559926765300554*^9}, {3.5706711270365*^9, 3.570671194156896*^9}, {
  3.5706719564022293`*^9, 3.570671961737838*^9}, {3.570672151946643*^9, 
  3.570672170506446*^9}, {3.7709982166427383`*^9, 
  3.770998228536439*^9}},ExpressionUUID->"26b60c37-0230-4aad-a30a-\
ae2f3d9f8ab0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", \
"Title",ExpressionUUID->"7e0331a4-4eb2-41b3-94e5-86dcad678450"],

Cell[CellGroupData[{

Cell["matrixPower, SU(N)  generators", \
"Section",ExpressionUUID->"a915cf74-4c38-4d5c-b12e-f8ad7e845e5e"],

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"centerSUMatrix", "[", 
   RowBox[{"1", ",", "7"}], 
   "]"}]}]], "Input",ExpressionUUID->"73ac614b-2c5d-40f5-be90-f396472d355b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"randomSUMatrix", "[", "7", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"fa216d9c-67db-4ba0-bdc4-b39dbdc320b7"],

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"gaugeField", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "15"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.766972462904788*^9, 3.766972464175539*^9}, {
  3.767356782678484*^9, 3.7673567833886337`*^9}, {3.767357017701527*^9, 
  3.767357038858267*^9}, {3.76735796456426*^9, 3.767357975954447*^9}, {
  3.7673907291441927`*^9, 
  3.7673907295357113`*^9}},ExpressionUUID->"1f64a583-69b2-42a8-9963-\
49ededbbcd90"],

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "x", 
  "]"}]], "Input",ExpressionUUID->"34beec22-0d42-476b-af8f-7770315232a5"],

Cell["Take the root", \
"Text",ExpressionUUID->"f68269dd-a100-4778-9071-eed544479235"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"x", ",", "0.2"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0f55e86f-b06e-4721-8ecb-80d674dab003"],

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "z", 
  "]"}]], "Input",ExpressionUUID->"519a82eb-219d-42d4-9d0e-1d7b01982e4b"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], "-", 
    RowBox[{"SUPower", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], ",", "Infinity"}], 
  "]"}]], "Input",ExpressionUUID->"c728bb26-3493-42da-bcc3-8701efa55f4d"],

Cell[BoxData[
 RowBox[{"matrixEqual", "[", 
  RowBox[{
   RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], ",", "x"}], 
  "]"}]], "Input",ExpressionUUID->"ea8e2c02-53da-4841-83e3-be26d23b7dc0"],

Cell["Test normalization & orthogonality of the SU(N) generators", \
"Text",ExpressionUUID->"e86a9bf5-97ff-4d98-a7f3-4db728247d82"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", 
      RowBox[{"SUGenerators", "[", "4", "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"72865217-4dc5-4f64-ac67-8a517bce3460"],

Cell["Verify map from group onto adjoint tangent space and back.", \
"Text",ExpressionUUID->"d7878dd6-aabf-46de-8e29-8294d13d70c2"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nc", "=", "6"}], ",", "w", ",", "u"}], "}"}], ",", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Tr", "[", 
       RowBox[{"w", "=", 
        RowBox[{"SULog", "[", "u", "]"}]}], "]"}], "]"}], "]"}], ";", 
    RowBox[{"matrixEqual", "[", 
     RowBox[{
      RowBox[{"MatrixExp", "[", 
       RowBox[{"I", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", "*", 
           RowBox[{"Im", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"Tr", ",", 
              RowBox[{
               RowBox[{"SUGenerators", "[", "]"}], ".", "w"}]}], "]"}], 
            "]"}]}], ")"}], ".", 
         RowBox[{"SUGenerators", "[", "]"}]}]}], "]"}], ",", "u"}], "]"}]}]}],
   "]"}]], "Input",ExpressionUUID->"2c002739-06e6-4e66-8511-b9f888d1600b"],

Cell["\<\
Test SUPower and SULog versus analogous Mathematica routines.  We see that \
they are often equal, but differ in cases where a different branch in the \
complex plane is chosen.  Also verify that the inverse is correct.\
\>", "Text",ExpressionUUID->"f366ac73-a1da-41d9-98bc-75493103f053"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"randomSUMatrix", "[", "4", "]"}]}], ",", "ur"}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"ur", "=", 
       RowBox[{"SUPower", "[", 
        RowBox[{"u", ",", "0.5", ",", 
         RowBox[{"\"\<debug\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
      RowBox[{"matrixEqual", "[", 
       RowBox[{
        RowBox[{"ur", ".", "ur"}], ",", "u", ",", 
        RowBox[{"Tolerance", "\[Rule]", 
         RowBox[{"10", " ", "$MachineEpsilon"}]}], ",", 
        RowBox[{"\"\<prefix\>\"", "\[Rule]", "\"\<inverse:  \>\""}]}], "]"}], 
      ";", 
      RowBox[{"matrixEqual", "[", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"u", ",", "0.5"}], "]"}], ",", "ur", ",", 
        RowBox[{"Tolerance", "\[Rule]", 
         RowBox[{"10", " ", "$MachineEpsilon"}]}], ",", " ", 
        RowBox[{"\"\<prefix\>\"", "\[Rule]", "\"\<Mma\>\""}]}], "]"}]}]}], 
    "]"}], ",", "100"}], 
  "]"}]], "Input",ExpressionUUID->"63a94be4-0c55-48dc-a0f0-8980ea01b5a1"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"randomSUMatrix", "[", "4", "]"}]}], ",", "ul"}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"ul", "=", 
       RowBox[{"SULog", "[", 
        RowBox[{"u", ",", " ", 
         RowBox[{"\"\<debug\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
      RowBox[{"matrixEqual", "[", 
       RowBox[{
        RowBox[{"MatrixExp", "[", "ul", "]"}], ",", "u", ",", 
        RowBox[{"Tolerance", "->", 
         RowBox[{"10", " ", "$MachineEpsilon"}]}], ",", " ", 
        RowBox[{"\"\<prefix\>\"", "\[Rule]", "\"\<inverse\>\""}]}], "]"}], 
      ";", 
      RowBox[{"matrixEqual", "[", 
       RowBox[{
        RowBox[{"MatrixLog", "[", "u", "]"}], ",", "ul", ",", 
        RowBox[{"Tolerance", "->", 
         RowBox[{"10", " ", "$MachineEpsilon"}]}], ",", " ", 
        RowBox[{"\"\<prefix\>\"", "\[Rule]", "\"\<mma\>\""}]}], "]"}]}]}], 
    "]"}], ",", "100"}], 
  "]"}]], "Input",ExpressionUUID->"085fb5fe-3c68-48f9-9b35-1573ef32edb2"],

Cell["Test latticeDistance for one link", \
"Text",ExpressionUUID->"c984a395-5877-48d1-ad20-0ca2a447dfc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"u0", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"IdentityMatrix", "[", "nc", "]"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1", "=", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"This", " ", "breaks", " ", "down", " ", "for", " ", "norm"}], 
     ">", 
     RowBox[{"2", " ", "Pi"}]}], " ", "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"norm", "=", "5"}], ",", 
       RowBox[{"r", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{
           RowBox[{"nc", "^", "2"}], "-", "1"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"norm", " ", 
        RowBox[{"r", "/", 
         RowBox[{"Norm", "[", "r", "]"}]}]}]}], ";", 
      RowBox[{"Print", "[", "r", "]"}], ";", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"I", " ", 
          RowBox[{"r", ".", 
           RowBox[{"SUGenerators", "[", "]"}]}]}], "]"}], "}"}], "}"}]}]}], 
    "]"}]}], ";", 
  RowBox[{"u2", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"randomSUMatrix", "[", "]"}], "}"}], "}"}]}], 
  ";"}]}], "Input",ExpressionUUID->"e20b83ed-6afb-4071-8436-ae8861fbb20f"],

Cell["Verify u1 :", \
"Text",ExpressionUUID->"0f7ccfad-2bb3-452e-ae92-8cf493cd52cb"],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"Tr", ",", 
   RowBox[{"2", " ", 
    RowBox[{"Im", "[", 
     RowBox[{
      RowBox[{"SUGenerators", "[", "]"}], ".", 
      RowBox[{"SULog", "[", 
       RowBox[{"u1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"51e2d012-867e-4f70-b256-b1c8aa26b7da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"latticeDistance", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "u1", "]"}], ",", "u0"}], "]"}], ",", 
   RowBox[{"latticeDistance", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "u0", "]"}], ",", "u1"}], "]"}], ",", 
   RowBox[{
    RowBox[{"latticeDistanceFrom", "[", "u0", "]"}], "[", "u1", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"b25c51c3-7c57-4a4f-8131-ed1e4794de89"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"latticeDistance", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "u2", "]"}], ",", "u1"}], "]"}], ",", 
   RowBox[{"latticeDistance", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "u1", "]"}], ",", "u2"}], "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"0931436a-e036-4737-9989-88a314802068"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare Mathematica mean plaquette against chroma value", \
"Section",ExpressionUUID->"abbb4ee1-c58a-48b8-8869-b9b2684ecef8"],

Cell["Compare with chroma output xml file.", \
"Text",ExpressionUUID->"2e5d09b1-cf60-47a2-a3eb-1904ca74a7ee"],

Cell["These should match plane_ij_plaq.", \
"Text",ExpressionUUID->"2724db57-2251-429a-8d81-1befbd209daf"],

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dir1", "<", "dir2"}], ",", 
      RowBox[{"Mean", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"plaquette", "[", 
           RowBox[{"dir1", ",", "dir2", ",", 
            RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "]"}], "/", 
          "nc"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir2", ",", 
      RowBox[{"dir1", "+", "1"}], ",", "3"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"a8a9551f-5f15-4660-b650-fb1bf6b44171"],

Cell["This should match w_plaq", \
"Text",ExpressionUUID->"dbfc2abc-9dff-46d2-a9da-3541d7be0284"],

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"Mean", "[", 
   RowBox[{"Flatten", "[", "%", "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"219efdc6-9b19-4c09-b592-1fc878c6cd85"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Compare the mean plaquette against ",
 StyleBox["Teper\[CloseCurlyQuote]s",
  IgnoreSpellCheck->True],
 " results"
}], "Section",ExpressionUUID->"749b0427-f3f6-4123-953f-4dea85c49fc8"],

Cell["\"w_plaq\" is average of all plaquettes.", \
"Text",ExpressionUUID->"de356692-0883-4856-b03d-bdef43d93be1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-4/periodic-16-28-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"06e604df-e83f-4d14-9b1e-9a99bca1fa9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-4/periodic-16-33-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9ccd0e9f-b9cf-4b27-98de-1d9bfe31a58e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-3/periodic-24-21-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"3d4c948f-280e-4e8a-ad52-cb436a6edc5a"],

Cell["\<\
Pull out the average plaquette from the production lattice updates.\
\>", "Text",ExpressionUUID->"ce371329-b52e-4926-a1d1-933645646210"],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"wp", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"xmlFilter", "[", 
     RowBox[{
      RowBox[{"expr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<purgaug\>\"", ",", "\"\<doHB\>\"", ",", "\"\<MCUpdates\>\"", ",", 
        "\"\<elem\>\"", ",", "\"\<Update\>\"", ",", 
        "\"\<InlineObservables\>\"", ",", "\"\<elem\>\"", ",", 
        "\"\<Plaquette\>\"", ",", "\"\<w_plaq\>\""}], "}"}]}], "]"}], "]"}]}],
   "]"}]], "Input",ExpressionUUID->"6ea2e23f-d3e5-45b6-abb7-923d3f49d955"],

Cell["\<\
Mean and standard error, ignoring autocorrelations.  
For SU(4), 2+1 dimensions, L=16^3 lattice, beta=28 abd 33, the average \
plaquette values match Teper\[CloseCurlyQuote]s result.  See \
arXiv:hep-lat/0206027v1 24 Jun 2002.\
\>", "Text",ExpressionUUID->"befeff86-5379-41fd-b0a4-145970b5e663"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Length", "[", "wp", "]"}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"020c970c-7646-4b66-ab85-5211c6c4ada0"],

Cell["\<\
What is the effect of autocorrelations on the error estimate?  Using \
https://en.wikipedia.org/wiki/Unbiased_estimation_of_standard_deviation
Find a model for the autocorrelation function (ACF), fitting to an \
exponential:\
\>", "Text",ExpressionUUID->"b1734467-1350-4edb-a297-06f9bb6a53fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cutoff", "=", "20"}], "}"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "cutoff"}], "}"}]}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"CorrelationFunction", "[", 
          RowBox[{"wp", ",", 
           RowBox[{"{", "cutoff", "}"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"77b987bd-85ca-4981-9188-bd9e60cea850"],

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"data", ",", "5"}], "]"}], ",", 
    RowBox[{"{", "x", "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"95b5d40b-9031-43ed-99ee-b5d5d575e05b"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ff", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"0ba7ecda-95f9-48fb-bfd5-6e404ed0e15c"],

Cell["\<\
From the Wikipedia article, the correction to the standard error is \
Sqrt[gamma2/gamma1], where :\
\>", "Text",ExpressionUUID->"2b8d6915-0d04-46fa-bc2a-4b1a6c114940"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma1", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"02ad3d91-94f2-4d06-8edd-5adb96e7fdd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma2", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"77d31ad2-afff-407c-a5f7-4b1c0e8a084f"],

Cell["Since n is large, look at leading order in n :", \
"Text",ExpressionUUID->"d0c378ca-7938-4740-a816-02f68eca733f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gamma1", "[", "Infinity", "]"}], ",", 
   RowBox[{"gamma2", "[", "Infinity", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"ee283eb1-8124-4674-94ff-56b4647659d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", "ff", "]"}]}], ")"}]}], "-", "1"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "1"}]}]], "Input",ExpressionUUID->"cc76ed0f-7235-4dc5-8b40-ef8d841b3614"],

Cell["\<\
There is a modest impact on the standard error, with the error estimate now \
matching Teper\[CloseCurlyQuote]s error estimate.  Good agreement for both \
SU(3) and SU(4).\
\>", "Text",ExpressionUUID->"fa4c2483-8f54-4eeb-a742-321251006d2e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"gamma2", "[", "Infinity", "]"}], "/", 
      RowBox[{"Length", "[", "wp", "]"}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"b8586d19-45df-4201-b15d-530856de76b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polyakov loop", \
"Section",ExpressionUUID->"bfca384e-3450-4f6f-945c-733e2d635e7c"],

Cell["Test with trivial lattice.", \
"Text",ExpressionUUID->"ecf945c3-b3b4-4dc2-9382-4d28baf0ea32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6", ",", "8"}], "}"}]}], ";", 
  RowBox[{
  "makeTrivialLattice", "[", 
   "]"}]}]], "Input",ExpressionUUID->"ba8cc77a-2929-4864-a0e7-43036a36fb2a"],

Cell["\<\
Lattice with constant link in one direction.  Smeared Polyakov loop should \
give the same result as the simple Polyakov loop.\
\>", "Text",ExpressionUUID->"4d7d87eb-fbe5-455b-a634-c45a0c778336"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uu", "=", 
       RowBox[{"randomSUMatrix", "[", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Trace:  \>\"", ",", 
        RowBox[{"Tr", "[", "uu", "]"}]}], "]"}], ";", 
      RowBox[{"uu", "=", 
       RowBox[{"SUPower", "[", 
        RowBox[{"uu", ",", 
         RowBox[{"1", "/", 
          RowBox[{"latticeDimensions", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", "uu", ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"e48c5c7a-87c4-42d1-9e53-ca586dc49059"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trace:  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "0.015461479701073755`"}], "-", 
    RowBox[{"1.1037127098022697`", " ", "\[ImaginaryI]"}]}]}],
  SequenceForm["Trace:  ", 
   Complex[-0.015461479701073755`, -1.1037127098022697`]],
  Editable->
   False]], "Print",ExpressionUUID->"bfab781a-fa1b-4fe7-8796-b36949edf65f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyakovLoop", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"bff5b33d-e607-4469-a49b-f92256a07bfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.015461479701072367`"}], "-", 
  RowBox[{
  "1.1037127098022697`", " ", 
   "\[ImaginaryI]"}]}]], \
"Output",ExpressionUUID->"432ecec2-2f8d-4431-9162-890d790cd1e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyakovLoop", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"1567bf2b-c412-4ae4-ab8a-23bb535f8cce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.015461479701072367`"}], "-", 
  RowBox[{
  "1.1037127098022697`", " ", 
   "\[ImaginaryI]"}]}]], \
"Output",ExpressionUUID->"8b0d584e-344b-48f2-8d25-f02c44e8ada7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"loopThickness", "[", 
  "]"}]], "Input",ExpressionUUID->"8f264d2d-4f9f-4ce1-84d7-801e89a12a39"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "9"], " ", "beta", " ", 
  SqrtBox[
   RowBox[{
   "2", " ", 
    "\[Pi]"}]]}]], \
"Output",ExpressionUUID->"ffe1682d-264b-48ab-a031-00ad6c7b133c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Axial gauge", \
"Section",ExpressionUUID->"390bad32-1acb-49c3-85aa-9007e41649ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-4.m\>\""}]], \
"Input",ExpressionUUID->"22c9696c-7de7-4ae7-b65c-fbe9c78c0256"],

Cell[BoxData[
 TemplateBox[{
  "Get","noopen",
   "\"Cannot open \\!\\(\\*RowBox[{\\\"\\\\\\\"test-4.m\\\\\\\"\\\"}]\\).\"",
   2,116,35,31699706948576580067,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"818ec573-de5e-4090-8ccb-f6381fc6d915"],

Cell[BoxData["$Failed"], \
"Output",ExpressionUUID->"54c3e39a-7c05-4cd9-aeb9-8bcee0fcea1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"f926c3ce-659f-4a49-9d2f-c404101369ab"],

Cell[BoxData["1.`"], \
"Output",ExpressionUUID->"25a2c8b0-e3f1-4158-bcdd-af1bd7f76db7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "3", 
  "]"}]], "Input",ExpressionUUID->"2a91e4ae-13cf-4a7c-ab4d-b222df8a6e3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"fdbf45d3-6296-4a22-839d-f320b1941cec"],

Cell[BoxData["1.`"], \
"Output",ExpressionUUID->"3c075a01-c1ff-4c6d-9078-127673b0b074"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["staples", \
"Section",ExpressionUUID->"86c065e9-8bbc-45f0-924a-a3d53a13e870"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-3-5.m\>\""}]], \
"Input",ExpressionUUID->"3373f6a1-fe4f-4d7f-8400-9941e7ffd180"],

Cell[BoxData[
 TemplateBox[{
  "Get","noopen",
   "\"Cannot open \\!\\(\\*RowBox[{\\\"\\\\\\\"test-3-3-5.m\\\\\\\"\\\"}]\\).\
\"",2,120,36,31699706948576580067,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"a924ec5b-d2cd-4eb3-a952-3881742c337f"],

Cell[BoxData["$Failed"], \
"Output",ExpressionUUID->"23bfff89-509e-45e5-b6df-4da6917f0d36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xxx", "=", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"ae979c30-3ea4-4b94-be05-119ee3fac4fe"],

Cell[BoxData["1.`"], \
"Output",ExpressionUUID->"ad3907e9-4ccb-49b9-902d-235c6b04a38d"]
}, Open  ]],

Cell["Set all links to the identity", \
"Text",ExpressionUUID->"da25be9e-0061-43aa-bcc2-44c291ecfaa7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "nc", "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"nd", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"5e6b0009-27d7-40a8-84fc-0e51d9a6fdb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sumStaples", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"ead4ecb9-6735-44e0-b9f5-d5a3fd73820a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"1d65a254-3009-492e-8695-e5698fc18c24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stapleTest", "[", 
  "]"}]], "Input",ExpressionUUID->"0c7d5c04-32d5-48b1-8b6c-48c2ff086bc5"],

Cell[BoxData["1"], \
"Output",ExpressionUUID->"1d2a6c08-3ecb-4b62-a9cd-766ffab31288"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nearest stationary point for single link and sum of staples", \
"Section",ExpressionUUID->"6798086d-fa2e-4ba6-9e82-7d6af60383a8"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
staple and starting matrix.  To compare,  remove cutoffs by setting \
ignoreCutoff -> True.\
\>", "Text",ExpressionUUID->"1d3cb94f-7ba5-44cd-98af-a83fb16475e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeRandomStaple", "[", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "nd"}], "-", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"63ba71c9-e267-41e1-91a3-368d8ba0e491"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nd", "=", "3"}], ";", 
   RowBox[{"nc", "=", "3"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{"bVector", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"bb", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
    RowBox[{
    "SUGenerators", "[", 
     "]"}]}]}]}]}], \
"Input",ExpressionUUID->"a8a28067-3f69-440b-8508-7b7d70cd3ccc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "7", "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"bb", "[", "8", "]"}], 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "4", "]"}]}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "2", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "5", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "4", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"bb", "[", "7", "]"}], "2"]}], "+", 
      FractionBox[
       RowBox[{"bb", "[", "8", "]"}], 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "3", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "6", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "2", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "5", "]"}]}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "3", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "6", "]"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bb", "[", "8", "]"}], 
       SqrtBox["3"]]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"1005daf9-8573-4b97-9c15-1268422da1fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run test", \
"Subsection",ExpressionUUID->"7995b3f0-9cde-46fc-9fe0-25405eb3ac24"],

Cell["Make random staple and starting link.", \
"Text",ExpressionUUID->"98726971-28ea-4f65-a6f0-347be3ee9c96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testStaple", "=", 
   RowBox[{"makeRandomStaple", "[", "]"}]}], ";", 
  RowBox[{"uu", "=", 
   RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
  RowBox[{"sqrtU", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"uu", ",", "0.5"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"8c9fa76e-8afe-4136-91be-3a65fd3ea695"],

Cell["\<\
Explicitly find the second order expansion of the exponential.\
\>", "Text",ExpressionUUID->"3ec7fa5f-8386-4182-b929-57585b3563de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"testStaple", ".", "sqrtU", ".", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", "bVector"}], "-", 
         RowBox[{
          RowBox[{"bVector", ".", "bVector"}], "/", 
          RowBox[{"2", "!"}]}]}], "]"}], ".", "sqrtU"}], "]"}], "]"}], "]"}], 
   "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], "+", 
       RowBox[{"Re", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{"bb", "[", "i_", "]"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{"bb", "[", "i", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{
         RowBox[{"bb", "[", "i_", "]"}], "^", "n_"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{
        RowBox[{"bb", "[", "i", "]"}], "^", "n"}]}]}]}], 
    "}"}]}]}]], \
"Input",ExpressionUUID->"ded0c36d-7fa0-4fb6-9480-2dfca41845a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.931850161692474`"}], "-", 
  RowBox[{"0.08907379372022833`", " ", 
   RowBox[{"bb", "[", "1", "]"}]}], "+", 
  RowBox[{"0.3140549192613049`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "1", "]"}], "2"]}], "-", 
  RowBox[{"0.32892960604253796`", " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "+", 
  RowBox[{"0.06529954762888188`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "+", 
  RowBox[{"0.08496568858004065`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"0.6942675401803905`", " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "-", 
  RowBox[{"0.02426908696130613`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "+", 
  RowBox[{"0.0453912770171926`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "+", 
  RowBox[{"0.08394193258177289`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "3", "]"}], "2"]}], "-", 
  RowBox[{"0.7330220771851184`", " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "-", 
  RowBox[{"0.06805301478477704`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "+", 
  RowBox[{"0.21574216492672188`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "+", 
  RowBox[{"0.3140549192613049`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"0.0981114278783796`", " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.06805301478477704`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.05213150223257179`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.06529954762888188`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.08496568858004065`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "5", "]"}], "2"]}], "-", 
  RowBox[{"0.7062598683853966`", " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.21574216492672188`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.05213150223257179`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.02426908696130613`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.0453912770171926`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.08394193258177289`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"0.8731686106906862`", " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.02426908696130613`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.06529954762888188`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.21574216492672188`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.06805301478477704`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.3140549192613049`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "7", "]"}], "2"]}], "+", 
  RowBox[{"0.12580348070639713`", " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.05241333200947407`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.014011763890096523`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.03770071140149574`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.060196273694469796`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.12455879699599551`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.03929042640515659`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.0011821316023687412`", " ", 
   RowBox[{"bb", "[", "7", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.007920107687440725`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "8", "]"}], 
    "2"]}]}]], "Output",ExpressionUUID->"6c6ed3e7-df9b-4a6b-9035-aaf81b0905f6"]
}, Open  ]],

Cell["Find the stationary point, based on this :", \
"Text",ExpressionUUID->"634ef01a-48ac-4ab0-bc81-edec8040de95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"bb", "[", "i", "]"}]}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"4c2cfa2d-9841-425f-9a76-770226468312"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"bb", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", "4.792622614845076`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "2", "]"}], "\[Rule]", "8.110309493378304`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "3", "]"}], "\[Rule]", 
    RowBox[{"-", "16.646169925273572`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "4", "]"}], "\[Rule]", "8.338438773137344`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "5", "]"}], "\[Rule]", 
    RowBox[{"-", "0.5587780459836721`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "6", "]"}], "\[Rule]", "8.11006481255689`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "7", "]"}], "\[Rule]", 
    RowBox[{"-", "1.7530407563071913`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "8", "]"}], "\[Rule]", "8.66428247833971`"}]}], 
  "}"}]], "Output",ExpressionUUID->"f1dbcb43-ae5f-4d49-ace4-0131d9763ec2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v1", "=", 
  RowBox[{"sqrtU", ".", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"I", " ", "bVector"}], "/.", "sp"}], "]"}], ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"d61d7994-b021-4229-9310-5ead7ca32823"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.521012462022074`"}], "+", 
      RowBox[{"0.22107624260006392`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.04828381674753551`"}], "+", 
      RowBox[{"0.24793093389643794`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.7793801243904486`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.09185236054774867`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5464648076798783`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.015179777747879028`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.5041366260783241`"}], "-", 
      RowBox[{"0.4691479308216045`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.46962923710421245`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.07962819365026429`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.4330732116273341`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.439618801987858`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6543768914072623`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.18367441384653654`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.396527869624569`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.0017733050631067448`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"32404fa5-5e18-4a41-8e66-153e2c8e6fa9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v1", 
  "]"}]], "Input",ExpressionUUID->"2be1ed46-0052-42e1-a14e-caeeac30e74f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.13623891898797819`"}], ",", 
   RowBox[{"-", "2.449493572319234`"}], ",", "2.5857324913072124`"}], 
  "}"}]], "Output",ExpressionUUID->"903a1bfd-cd33-4ccf-bd6b-a54c3ddf0bf6"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"7dd62d34-e2e2-46c5-a65c-1f3b2ef25e72"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"u2", ",", "maxShift"}], "}"}], "=", 
  RowBox[{"linkSaddlePointStep", "[", 
   RowBox[{
    RowBox[{"sqrtU", ".", "testStaple"}], ",", "sqrtU", ",", 
    RowBox[{"ignoreCutoff", "\[Rule]", "True"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"274b3611-bfd8-4538-95f4-b1860c9486ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.1785319631460815`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.1660676199547413`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5979285164507074`"}], "+", 
        RowBox[{"0.35890546386303857`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5993056155845052`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.3083002109810575`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.8669913535031899`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.11149825726596091`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.27190596340044754`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.36152618618682214`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.1607840079082601`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.0735431719930727`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.12123846835968058`"}], "-", 
        RowBox[{"0.4021731581109469`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5130494989456207`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.21404329614460565`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.6669978862480809`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.26388914989566725`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", "23.53557778139925`"}], 
  "}"}]], "Output",ExpressionUUID->"eb7f399a-b371-4fef-bd41-c0d4a0409c57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v2", "=", 
  RowBox[{
  "u2", ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"e39c645a-2af9-49b6-8f03-3335f2e24b68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.5210124620220733`"}], "+", 
      RowBox[{"0.2210762426000598`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.04828381674760865`"}], "+", 
      RowBox[{"0.2479309338964291`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.7793801243904541`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.09185236054770271`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5464648076798853`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.015179777747883545`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.5041366260783129`"}], "-", 
      RowBox[{"0.469147930821644`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.46962923710417726`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.07962819365026721`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.4330732116272775`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.4396188019879079`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6543768914072517`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.18367441384649905`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.39652786962460973`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.0017733050630776015`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"9b7273b4-fe0d-4b86-8185-e64b0c1a2963"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v2", 
  "]"}]], "Input",ExpressionUUID->"38985cff-17be-438e-a76c-fc60c38a360f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.13623891898802112`"}], ",", 
   RowBox[{"-", "2.449493572319164`"}], ",", "2.5857324913071853`"}], 
  "}"}]], "Output",ExpressionUUID->"a4519cfd-f2d2-49c2-a478-553fa5740494"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["nearest stationary point for entire lattice", \
"Section",ExpressionUUID->"95cf531b-c774-4c9e-a701-2817af3c0b40"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
lattice.  Tested for nd=3 and SU(2), SU(3) with multiple sites, and SU(4) \
with one site.\
\>", "Text",ExpressionUUID->"682f351b-bb5d-460b-9ca5-42443640777b"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"4fd7990a-1a12-4fb8-b10a-e7f2a2023085"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Switch", " ", "order", " ", "to", " ", "verify", " ", "we", " ", "are", 
    " ", "not", " ", "dependent", " ", "on", " ", 
    RowBox[{"latticeCoordinates", "[", "]"}], " ", 
    RowBox[{"indexing", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"linearSiteIndex", "[", 
       RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", "i", ",", 
        RowBox[{
         RowBox[{"latticeVolume", "[", "]"}], "-", "i", "+", "1"}]}], "]"}]}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]}], \
"Input",ExpressionUUID->"1c3971d5-2ff0-4eb6-8bd2-e735288849a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{
   RowBox[{"bVector", "[", 
    RowBox[{"dir_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", 
        RowBox[{"dir", ",", "site", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
     RowBox[{"SUGenerators", "[", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"9b04eb0b-2c48-4bdb-9045-6c21ab7b90f0"],

Cell["\<\
Create links with second order perturbation.  Variables have same lattice \
index as links.\
\>", "Text",ExpressionUUID->"aa68c211-373b-4d0a-aa86-915f456015de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"SUPower", "[", 
        RowBox[{
         RowBox[{"gaugeField", "[", 
          RowBox[{"[", 
           RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}], ".", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"bVector", "[", 
           RowBox[{"dir", ",", "i"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"bVector", "[", 
            RowBox[{"dir", ",", "i"}], "]"}], ".", 
           RowBox[{"bVector", "[", 
            RowBox[{"dir", ",", "i"}], "]"}]}], "/", 
          RowBox[{"2", "!"}]}]}], ")"}], ".", 
       RowBox[{"SUPower", "[", 
        RowBox[{
         RowBox[{"gaugeField", "[", 
          RowBox[{"[", 
           RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"dd43032c-3c2f-47d3-b9c4-6400e3d30e4d"],

Cell["Sum of plaquettes, not taking the real part yet:", \
"Text",ExpressionUUID->"189c55ea-c7a5-40be-9a11-d6f147a69c47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coords", "=", 
          RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k2", ",", 
             RowBox[{"linearSiteIndex", "[", 
              RowBox[{"shift", "[", 
               RowBox[{"k1", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"linearSiteIndex", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"k2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
           "]"}], ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", " ", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"bb", "[", "a__", "]"}], "]"}], "\[Rule]", 
         RowBox[{"bb", "[", "a", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", 
       RowBox[{"k1", "+", "1"}], ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Average", " ", "plaquette", " ", "should", " ", "be", " ", "same", " ", 
    "as", " ", 
    RowBox[{"above", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"nc", " ", "nd", " ", 
      RowBox[{"(", 
       RowBox[{"nd", "-", "1"}], ")"}], " ", 
      RowBox[{"latticeVolume", "[", "]"}]}], ")"}]}], " ", 
   RowBox[{"Re", "[", 
    RowBox[{"rp", "/.", 
     RowBox[{
      RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"8efba561-67ca-4fc4-a003-487fb888d051"],

Cell[BoxData[
 RowBox[{"-", 
  "0.030324982909810855`"}]], \
"Output",ExpressionUUID->"93fa36ab-655d-457c-baae-4ed0899df6ce"]
}, Open  ]],

Cell["Calculate gradient and Hessian at bb[dir,i,k] = 0.", \
"Text",ExpressionUUID->"2297dbed-7bbd-4a6c-931f-ef9aff9444fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gradientA", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"rp", ",", 
         RowBox[{"bb", "[", 
          RowBox[{"dir", ",", "i", ",", "k"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{
        RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"5dac75e6-8325-4bca-bb34-883cdc84b378"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.0626111634005682`"}], ",", 
   RowBox[{"-", "0.37156530581935243`"}], ",", 
   RowBox[{"-", "1.6362007432215693`"}], ",", 
   RowBox[{"-", "0.12645382055848853`"}], ",", "1.244234104593681`", ",", 
   RowBox[{"-", "0.6182023514660486`"}], ",", 
   RowBox[{"-", "1.1261669157711514`"}], ",", 
   RowBox[{"-", "0.6791602038589706`"}], ",", 
   RowBox[{"-", "0.7280393308660296`"}], ",", "0.2471141616481487`", ",", 
   "0.16854481434403756`", ",", 
   RowBox[{"-", "0.0959754721467933`"}], ",", "0.197018843960746`", ",", 
   "0.6899487649168778`", ",", 
   RowBox[{"-", "0.45108195616503843`"}], ",", 
   RowBox[{"-", "1.1957129673125662`"}], ",", 
   RowBox[{"-", "1.6657436784202282`"}], ",", "1.2070710382841332`", ",", 
   "0.6282801451243579`", ",", "1.9031281261693564`", ",", 
   "0.5215207093187777`", ",", 
   RowBox[{"-", "1.0632004460415052`"}], ",", 
   RowBox[{"-", "1.026896690688683`"}], ",", 
   RowBox[{"-", "0.05537209579874125`"}], ",", 
   RowBox[{"-", "2.7020769085109317`"}], ",", 
   RowBox[{"-", "0.5878965728808467`"}], ",", "2.0394072492757305`", ",", 
   "1.2737693375403174`", ",", "2.3285922127998138`", ",", 
   RowBox[{"-", "0.295130654554401`"}], ",", 
   RowBox[{"-", "0.15278918256548013`"}], ",", "1.2714295057085083`", ",", 
   "1.2922397985753848`", ",", 
   RowBox[{"-", "0.2726290889758719`"}], ",", "2.410893794788483`", ",", 
   "0.4920358627920002`"}], 
  "}"}]], "Output",ExpressionUUID->"426d19b3-f6f7-4651-814c-4f3e8794c5ed"]
}, Open  ]],

Cell["\<\
For parallelization, I had to go to menu Evaluation->Parallel Kernel \
Configuration and set the number manually.  Automatic launching of additional \
kernels is broken?  Note that the parallelization is based on the leading \
dimension of the table.
Verify parallel kernels are running:\
\>", "Text",ExpressionUUID->"0a7c4866-70f9-494b-a85d-240479ff71e4"],

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "$ProcessID", 
  "]"}]], "Input",ExpressionUUID->"5c7453cd-b51a-4d4c-b5b6-46caa5f2f565"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"hessA", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"rp", ",", 
           RowBox[{"bb", "[", 
            RowBox[{"dir1", ",", "i1", ",", "k1"}], "]"}], ",", 
           RowBox[{"bb", "[", 
            RowBox[{"dir2", ",", "i2", ",", "k2"}], "]"}]}], "]"}], "/.", 
         RowBox[{
          RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir1", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i1", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir2", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"370de329-4edd-493e-96b8-a86ef4490981"],

Cell["Find the saddle point.", \
"Text",ExpressionUUID->"9ac86a7d-aec3-40c8-a515-961e6853ec19"],

Cell[BoxData[
 RowBox[{"deltaA", "=", 
  RowBox[{"-", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"hessA", ",", "gradientA"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"1900977d-1223-43a1-9fa5-06e4b30693e5"],

Cell["Equivalently, find the saddle point using the eigensystem.", \
"Text",ExpressionUUID->"ae61937e-46a3-4391-8c12-f828b145290b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valsA", ",", "ooA"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "hessA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"deltaA", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"ooA", ".", "gradientA"}]}], "/", "valsA"}], ")"}], ".", 
   "ooA"}]}]}], \
"Input",ExpressionUUID->"53e52cc9-a36b-446a-b93c-9794cc99a6e7"],

Cell["Substitute shift back into links :", \
"Text",ExpressionUUID->"a1f7a25b-b9ad-4b0c-8c5a-00b9d4137a8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SUPower", "[", 
       RowBox[{
        RowBox[{"gaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}], ".", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"I", " ", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"deltaA", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "+", 
               RowBox[{
                RowBox[{"latticeVolume", "[", "]"}], 
                RowBox[{"(", 
                 RowBox[{"dir", "-", "1"}], ")"}]}]}], ")"}]}]}]}], "]"}], 
         ".", 
         RowBox[{"SUGenerators", "[", "]"}]}]}], "]"}], ".", 
      RowBox[{"SUPower", "[", 
       RowBox[{
        RowBox[{"gaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"918e4b88-9d04-4bc6-ae24-33c7702b0c59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gaugeField", "=", "gaugeFieldA"}], "}"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"averagePlaquette", "[", "]"}], "]"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"a084fa08-f8cd-4554-b1e0-5e8a50b44070"],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"8c235b7f-b3be-45ee-b047-c0f9c6b72d5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"allLinks", "\[Rule]", "True"}], ",", 
     RowBox[{"fullMatrix", "\[Rule]", "True"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"8b06b8b1-c61d-4172-9ae3-8d57f5095087"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldA", "-", "libGaugeField"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"7e974aaa-70ad-44a3-8db6-6fbb591c8fa3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
nearest stationary point for entire lattice, one direction fixed\
\>", "Section",ExpressionUUID->"6afea612-4829-4b47-b988-53fc7c66a8ee"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
lattice in Axial gauge\
\>", "Text",ExpressionUUID->"46628854-1f58-435b-a306-efb622183479"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"cfb057c6-74fd-466a-bfff-ead6704c041b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"fDir", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"f52bc08f-d446-4d2f-9c46-ab08017a8666"],

Cell["Create lattice with minimal non-trivial links.", \
"Text",ExpressionUUID->"10698ee7-9151-48df-9226-36cd3ca8bcbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"makeTrivialLattice", "[", 
      RowBox[{"randomGauge", "\[Rule]", "False"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"setLink", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".1", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".05", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".01", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", "0.001", " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"gaugeField", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"linearSiteIndex", "[", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";"}], "*)"}], 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"8767dbd3-6ebb-462b-9a49-e5ac21db02d0"],

Cell[CellGroupData[{

Cell["Analysis", \
"Subsection",ExpressionUUID->"07fee0bf-0aa1-4b9c-98ee-45b00ef5ba02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{
   RowBox[{"bVector", "[", 
    RowBox[{"dir_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", 
        RowBox[{"dir", ",", "site", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
     RowBox[{"SUGenerators", "[", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"002ec141-0da2-4775-b9da-5bb60d049d8d"],

Cell["\<\
Constant links in one direction.  Create links with second order perturbation:\
\>", "Text",ExpressionUUID->"e2f4f19f-904d-459e-891d-1518fc4b5760"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", "gaugeField"}], ";", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", "c2"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"c2", "=", "coords"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dir", "\[Equal]", "fDir"}], ",", 
         RowBox[{
          RowBox[{"c2", "[", 
           RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       RowBox[{
        RowBox[{"uu", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", 
           RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
        "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"SUPower", "[", 
           RowBox[{
            RowBox[{"getLink", "[", 
             RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}], ".", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
            RowBox[{"I", " ", 
             RowBox[{"bVector", "[", 
              RowBox[{"dir", ",", "c2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"bVector", "[", 
               RowBox[{"dir", ",", "c2"}], "]"}], ".", 
              RowBox[{"bVector", "[", 
               RowBox[{"dir", ",", "c2"}], "]"}]}], "/", 
             RowBox[{"2", "!"}]}]}], ")"}], ".", 
          RowBox[{"SUPower", "[", 
           RowBox[{
            RowBox[{"getLink", "[", 
             RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}]}], 
         "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir", ",", "nd"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"bcda7aa1-71be-4cae-b430-adce7f3357dc"],

Cell["Sum of plaquettes, not taking the real part:", \
"Text",ExpressionUUID->"6346d6bd-ef23-4df5-b127-4ca7d79668fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coords", "=", 
          RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k2", ",", 
             RowBox[{"linearSiteIndex", "[", 
              RowBox[{"shift", "[", 
               RowBox[{"k1", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"linearSiteIndex", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"k2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
           "]"}], ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", " ", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"bb", "[", "a__", "]"}], "]"}], "\[Rule]", 
         RowBox[{"bb", "[", "a", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", 
       RowBox[{"k1", "+", "1"}], ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Average", " ", "plaquette", " ", "should", " ", "be", " ", "same", " ", 
    "as", " ", 
    RowBox[{"above", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"nc", " ", "nd", " ", 
      RowBox[{"(", 
       RowBox[{"nd", "-", "1"}], ")"}], " ", 
      RowBox[{"latticeVolume", "[", "]"}]}], ")"}]}], " ", 
   RowBox[{"Re", "[", 
    RowBox[{"rp", "/.", 
     RowBox[{
      RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"8623c371-9c30-49b9-b905-0c0fbeb5f177"],

Cell[BoxData["0.994839169077929`"], \
"Output",ExpressionUUID->"fc5e9c75-f952-43d8-bbd2-ef6922e59153"]
}, Open  ]],

Cell["Calculate gradient and Hessian at bb[dir,i,k] = 0.", \
"Text",ExpressionUUID->"5461a130-5a0c-4a0e-874b-0383d905a176"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "gradMap", "]"}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{"gradient1", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dims0", "=", "latticeDimensions"}], ",", 
        RowBox[{"gi", "=", "1"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"dims0", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"coords", "=", 
              RowBox[{"latticeCoordinates", "[", 
               RowBox[{"i", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"dir", "\[Equal]", "fDir"}], ",", "dims0", ",", 
                  "latticeDimensions"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"k", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"gradMap", "[", 
                 RowBox[{"dir", ",", "coords"}], "]"}], "=", "gi"}]}], "]"}], 
             ";", 
             RowBox[{"gi", "+=", "1"}], ";", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"D", "[", 
                RowBox[{"rp", ",", 
                 RowBox[{"bb", "[", 
                  RowBox[{"dir", ",", "coords", ",", "k"}], "]"}]}], "]"}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}]}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"dir", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"latticeVolume", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir", "\[Equal]", "fDir"}], ",", "dims0", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
        "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"2a3c7375-3548-469a-b5d5-281e585f48a3"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"hess1", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dims", "=", "latticeDimensions"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"dims", "[", 
        RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"rp", ",", 
              RowBox[{"bb", "[", 
               RowBox[{"dir1", ",", 
                RowBox[{"latticeCoordinates", "[", 
                 RowBox[{"i1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"dir1", "\[Equal]", "fDir"}], ",", "dims", ",", 
                    "latticeDimensions"}], "]"}]}], "]"}], ",", "k1"}], "]"}],
               ",", 
              RowBox[{"bb", "[", 
               RowBox[{"dir2", ",", 
                RowBox[{"latticeCoordinates", "[", 
                 RowBox[{"i2", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"dir2", "\[Equal]", "fDir"}], ",", "dims", ",", 
                    "latticeDimensions"}], "]"}]}], "]"}], ",", "k2"}], 
               "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir1", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"latticeVolume", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir1", "\[Equal]", "fDir"}], ",", "dims", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir2", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"latticeVolume", "[", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir2", "\[Equal]", "fDir"}], ",", "dims", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}], "]"}]], \
"Input",ExpressionUUID->"18aa2ca9-6c1e-44c5-bdcb-608625c9422e"],

Cell["Shifts associated with the remaining gauge freedom.", \
"Text",ExpressionUUID->"ce655314-b12d-4061-81aa-5e13e825c9ec"],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"gtf", "=", 
   RowBox[{"gaugeTransformShifts", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "]"}], ",", "fDir"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"02cb58a0-89a2-4f7f-9c83-5f4f69954120"],

Cell["The gradient is orthogonal to the gauge transform shifts :", \
"Text",ExpressionUUID->"4ab7eb36-03ff-48aa-9e64-9253a03f24b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"gtf", ".", "gradient1"}], 
  "]"}]], "Input",ExpressionUUID->"23b665a4-4f5d-4222-ad1d-71acd6b803cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], 
  "}"}]], "Output",ExpressionUUID->"b5900edc-63a4-4ea7-a2d3-f575896efb02"]
}, Open  ]],

Cell["But the Hessian is not, since it is a quadratic expansion :", \
"Text",ExpressionUUID->"f3db0435-e56c-4927-ba18-af4d04e783c9"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"gtf", ".", "hess1", ".", 
    RowBox[{"Transpose", "[", "gtf", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"f2001b9a-e668-4423-9010-5f2b493d3a57"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"proj1", "=", 
   RowBox[{"NullSpace", "[", "gtf", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b4ce1e9e-4fe8-4239-b400-df4430184709"],

Cell["Find the saddle point.", \
"Text",ExpressionUUID->"77f08dcd-7394-4a58-b203-109753c95f4d"],

Cell[BoxData[
 RowBox[{"delta1", "=", 
  RowBox[{"-", 
   RowBox[{
    RowBox[{"LinearSolve", "[", 
     RowBox[{
      RowBox[{"proj1", ".", "hess1", ".", 
       RowBox[{"Transpose", "[", "proj1", "]"}]}], ",", 
      RowBox[{"proj1", ".", "gradient1"}]}], "]"}], ".", 
    "proj1"}]}]}]], \
"Input",ExpressionUUID->"64674df4-6fb1-44e5-8f07-e0f5ddb2f77e"],

Cell["Equivalently, find the saddle point using the eigensystem.", \
"Text",ExpressionUUID->"0acb2d87-7af1-47d1-a06f-0ae34816cb0b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals1", ",", "oo1"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"proj1", ".", "hess1", ".", 
     RowBox[{"Transpose", "[", "proj1", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"delta1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"oo1", ".", "proj1", ".", "gradient1"}]}], "/", "vals1"}], 
    ")"}], ".", "oo1", ".", 
   "proj1"}]}]}], \
"Input",ExpressionUUID->"55fb71d3-fdc1-491e-bd40-877904b0ea03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.000017157667547901788`"}], ",", "0.008967081052160746`", 
   ",", "0.03076612980032677`", ",", "0.00028805219001350624`", ",", 
   RowBox[{"-", "0.0033503040247264424`"}], ",", "0.00007850922932631785`", 
   ",", 
   RowBox[{"-", "0.030516966187544257`"}], ",", 
   RowBox[{"-", "0.0002076853920562368`"}], ",", "0.0000891839570153743`", 
   ",", "0.000026047754715695717`", ",", 
   RowBox[{"-", "0.12739520372302388`"}], ",", "0.005242969640470934`", ",", 
   "0.000017854408070406014`", ",", "0.18847827621267776`", ",", 
   RowBox[{"-", "0.15129799425442514`"}]}], 
  "}"}]], "Output",ExpressionUUID->"c48beea2-dece-4ab1-b2c3-e9bf9e1b7736"]
}, Open  ]],

Cell["Substitute shift back into links :", \
"Text",ExpressionUUID->"a6d8526c-a2b4-4d74-9d9a-631926f20d04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newGaugeField", "=", "gaugeField"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", 
        RowBox[{"dims", "=", "latticeDimensions"}], ",", "c2"}], "}"}], ",", 
      RowBox[{
       RowBox[{"c2", "=", "coords"}], ";", 
       RowBox[{
        RowBox[{"c2", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"dims", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"newGaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", 
           RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
        "=", 
        RowBox[{
         RowBox[{"SUPower", "[", 
          RowBox[{
           RowBox[{"getLink", "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}], ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"I", " ", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"delta1", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "-", "1", 
               "+", 
               RowBox[{"gradMap", "[", 
                RowBox[{"dir", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"dir", "\[Equal]", "fDir"}], ",", "c2", ",", 
                   "coords"}], "]"}]}], "]"}]}]}], "]"}], ".", 
            RowBox[{"SUGenerators", "[", "]"}]}]}], "]"}], ".", 
         RowBox[{"SUPower", "[", 
          RowBox[{
           RowBox[{"getLink", "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], 
          "]"}]}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir", ",", "nd"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"dc3ccf11-2bff-4254-9dab-9892f8bc6a99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gaugeField", "=", "newGaugeField"}], "}"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"averagePlaquette", "[", "]"}], "]"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"f64fb766-7202-4259-9cb4-930b84dd83df"],

Cell[BoxData["0.9999998399806055`"], \
"Print",ExpressionUUID->"46e3e48a-6f3b-4982-86e6-86ba8b9515c8"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"099be236-9a87-4bcd-b45f-9beda62961fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "fDir"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"78e5c275-ea68-45fb-a47c-2502ebd3aecd"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"grad0", "-", 
    RowBox[{"proj1", ".", "gradient1"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"d18ec19d-90fd-425a-9a61-3b2aa995dfee"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"hess0", "-", 
     RowBox[{"proj1", ".", "hess1", ".", 
      RowBox[{"Transpose", "[", "proj1", "]"}]}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"6b17fa14-dedb-48db-9049-4b1da8063c65"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"newGaugeField", "-", "libGaugeField"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"b9ad7d9c-633a-47da-bb20-f0a193db953e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["compare lattice and link stationary point", \
"Section",ExpressionUUID->"ced7fcf1-37a7-4a9a-b384-0a391f6b2b72"],

Cell["\<\
Test single-link stationary point against the lattice-wide stationary point \
by including only single-link gradients.
Find agreement for single-site and multiple-site lattices for SU(2), SU(3), \
and SU(4).

The Hessian matrix is block-diagonal in the lattice links.  However, in the \
case of the full lattice derivative, the eigenvectors may not be, if there \
are degenerate eigenvalues.  In that case, the rescaled shifts may be \
different for the full lattice.  This issue goes away if we remove the \
rescaling.  Also, the single-link calculation does not distinguish shifts \
associated with gauge transforms, since individual link shifts cannot be \
gauge transforms.\
\>", "Text",ExpressionUUID->"e68ee23a-bc60-427d-84a6-f83d4942f773"],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"10649e5d-861d-4089-a858-95547fc22240"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"a1f37b4f-4a47-4c01-9986-c60edb08cc34"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"newGaugeField", ",", "stats"}], "}"}], "=", 
   RowBox[{"allLinkSaddlePoint", "[", 
    RowBox[{
     RowBox[{"maxCount", "->", "1"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"3ad08985-1c9d-4fb8-9895-b164c496849b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "66.20874526242476`", ",", 
   RowBox[{"-", "0.012922642225215582`"}]}], 
  "}"}]], "Print",ExpressionUUID->"0a7895f1-e07b-49ae-970d-d2880016a6c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"allLinks", "\[Rule]", "False"}], ",", 
     RowBox[{"fullMatrix", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ef934101-694c-480b-a73f-1e43c0b81dad"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Constructed hess, grad\"\>"], \
"Print",ExpressionUUID->"be555484-1fef-4459-bba1-fff59f994d27"],

Cell[BoxData["\<\"Constructed gauge\"\>"], \
"Print",ExpressionUUID->"2791690d-ad6a-48ec-aa3e-d761bfc2373c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "81.27506510529608`", ",", "4.199809534513839`", ",", 
     "0.999999999999983`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {81.27506510529608, 4.199809534513839, 
   0.999999999999983}],
  Editable->
   False]], "Print",ExpressionUUID->"efffe5cc-cc58-4eb0-9609-2d86d15f6216"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"latticeSaddlePointStep times:\\n    matrices=\"\>", 
   "\[InvisibleSpace]", "0.126889`5.253938972595219", 
   "\[InvisibleSpace]", "\<\" s, findDelta=\"\>", "\[InvisibleSpace]", 
   "0.0061040000000000001`3.936129522778814", 
   "\[InvisibleSpace]", "\<\" s, applyDelta=\"\>", "\[InvisibleSpace]", 
   "0.002863`3.6073363458535903", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "latticeSaddlePointStep times:\n    matrices=", 0.126889`5.253938972595219, 
   " s, findDelta=", 0.0061040000000000001`3.936129522778814, 
   " s, applyDelta=", 0.002863`3.6073363458535903, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"6df3715a-b876-4e9e-831c-a44ef5b80b5e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "12", ",", "3", ",", "3"}], 
  "}"}]], "Output",ExpressionUUID->"ecbc623c-8729-4281-8e77-29bc7c04284d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"newGaugeField", "-", "libGaugeField"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"c10057e4-d047-47f4-b8b9-3179812f4c68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "324"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"942ea6d3-4d95-41f2-8b78-2f75068a59ba"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Small perturbations", \
"Section",ExpressionUUID->"d2d2ebf6-4680-400d-9036-1bdc077963c3"],

Cell["\<\
Verify that small perturbations from a trivial lattice go back to the saddle \
point.
We see that it doesn\[CloseCurlyQuote]t converge without rescaleCutoff<1 or \
dampingFactor<1.  A combination works best.\
\>", "Text",ExpressionUUID->"8b6ac6f7-a0c2-4db5-a4ab-44b27ade6250"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"121a36d4-2575-465e-b601-c3d08d752766"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", " ", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"makeTrivialLattice", "[", 
   RowBox[{
    RowBox[{"randomPerturbation", "\[Rule]", "0.001"}], ",", 
    RowBox[{"randomGauge", "\[Rule]", "True"}]}], "]"}], ";", 
  RowBox[{"1", "-", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"cff751fb-1b04-49c9-98a0-9b8832bb5a86"],

Cell[BoxData["1.427363752748434`*^-7"], \
"Output",ExpressionUUID->"2851011b-3ed7-4d75-bbfd-b714e1207a49"]
}, Open  ]],

Cell["Apply one saddle-point step :", \
"Text",ExpressionUUID->"284b0cf7-e389-4496-be88-f29c3ae71452"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"gaugeField", "=", 
     RowBox[{"latticeSaddlePointStep", "[", 
      RowBox[{
       RowBox[{"allLinks", "\[Rule]", "True"}], ",", 
       RowBox[{"fullMatrix", "->", "True"}], ",", 
       RowBox[{"dampingFactor", "\[Rule]", "0.5"}], ",", 
       RowBox[{"rescaleCutoff", "\[Rule]", "0.001"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"1", "-", 
      RowBox[{"averagePlaquette", "[", "]"}]}], "]"}]}], ",", 
   RowBox[{"{", "10", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"3aeb94ad-43e1-407d-a17e-32d3ebd86a91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test ersatzLanczos[]", \
"Section",ExpressionUUID->"fcdcc68a-11ff-41be-a66e-1fc6cddb9f7a"],

Cell["\<\
Test against dense calculation using gauge configuration.  Need to understand \
errors in calculating smallest eigenvalues.\
\>", "Text",ExpressionUUID->"1e8ffd7b-8b9e-4cb6-a2df-86ce0ad89f5b"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"42c83118-af2c-4711-8a04-2e9de5e6187a"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"02e79e96-7a6a-4967-8a6b-d30828bc0530"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testCutoff", "=", "2"}], 
  ";"}]], "Input",ExpressionUUID->"de393837-9c53-4f65-811a-2a6725f851a4"],

Cell[CellGroupData[{

Cell["Project into dynamic (non-gauge-transform) subspace", \
"Subsection",ExpressionUUID->"8f8f4f06-bd6f-457c-bacd-5d4b1f5d34d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hess", ",", "grad", ",", "proj", ",", "shifts", ",", "delta", ",", 
      RowBox[{"rl", "=", 
       RowBox[{"makeRootLattice", "[", "]"}]}], ",", 
      RowBox[{"fDir", "=", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hess", ",", "grad"}], "}"}], "=", 
      RowBox[{"latticeHessian", "[", 
       RowBox[{
        RowBox[{"getLink", "[", "rl", "]"}], ",", 
        RowBox[{"fixedDir", "\[Rule]", "fDir"}]}], "]"}]}], ";", 
     RowBox[{"proj", "=", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"gaugeTransformShifts", "[", 
        RowBox[{"rl", ",", "fDir"}], "]"}], "]"}]}], ";", 
     RowBox[{"projHess0", "=", 
      RowBox[{"proj", ".", "hess", ".", 
       RowBox[{"Transpose", "[", "proj", "]"}]}]}], ";", 
     RowBox[{"projGrad0", "=", 
      RowBox[{"proj", ".", "grad"}]}], ";", 
     RowBox[{"proj0", "=", "proj"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"valuesd", ",", "ood"}], "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", 
        RowBox[{"Eigensystem", "[", "projHess0", "]"}]}], "]"}]}], ";", 
     RowBox[{"applyCutoff3", "[", 
      RowBox[{"valuesd", ",", 
       RowBox[{"ood", ".", "projGrad0"}], ",", 
       RowBox[{"ood", ".", "proj0"}], ",", "testCutoff"}], "]"}]}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"713ca18d-d44b-4325-9d09-a09e4e125171"],

Cell["\<\
Compare with Lanczos.  This case is not so interesting since we cannot \
perform this projection in a sparse-matrix approach.\
\>", "Text",ExpressionUUID->"f7c48adb-8594-4396-8825-c16a8ee96f50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"slice", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"6", ",", 
     RowBox[{"Length", "[", "projGrad0", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valuese", ",", "ooe"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Reverse", ",", 
     RowBox[{"ersatzLanczos", "[", 
      RowBox[{"projHess0", ",", 
       RowBox[{"eigenPairs", "\[Rule]", 
        RowBox[{"-", "slice"}]}], ",", 
       RowBox[{"maxIterations", "\[Rule]", "1800"}], ",", 
       RowBox[{"printDetails", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"applyCutoff3", "[", 
   RowBox[{"valuese", ",", 
    RowBox[{"ooe", ".", "projGrad0"}], ",", 
    RowBox[{"ooe", ".", "proj0"}], ",", "testCutoff"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"9c9085fa-9ed5-42b3-aa34-5d9540f3012b"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{"ood", ",", "slice"}], "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Take", "[", 
       RowBox[{"ooe", ",", "slice"}], "]"}], "]"}]}], "]"}], "-", 
   RowBox[{"IdentityMatrix", "[", "slice", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"d824ef60-0bec-4d73-8a9e-daa866b172e2"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"valuesd", ",", "slice"}], "]"}], "-", 
   RowBox[{"Take", "[", 
    RowBox[{"valuese", ",", "slice"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"df33284e-0565-4193-9308-5f4f4939c64c"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"ooe", ".", 
    RowBox[{"Transpose", "[", "ooe", "]"}]}], "-", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "valuese", "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"e44d4afc-0b23-429a-8548-c7ac91e83128"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Use full space with projection operator.", \
"Subsection",ExpressionUUID->"58f2de4b-193a-436b-907c-e74092213992"],

Cell["\<\
In this case, the nullspace of the projection operator is included in the \
eigensystem.\
\>", "Text",ExpressionUUID->"29253b9a-63cc-40cc-9df8-6d8adb3e1a04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hess", ",", "grad", ",", "proj", ",", "shifts", ",", "delta", ",", 
      RowBox[{"rl", "=", 
       RowBox[{"makeRootLattice", "[", "]"}]}], ",", 
      RowBox[{"fDir", "=", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hess", ",", "grad"}], "}"}], "=", 
      RowBox[{"latticeHessian", "[", 
       RowBox[{
        RowBox[{"getLink", "[", "rl", "]"}], ",", 
        RowBox[{"fixedDir", "\[Rule]", "fDir"}]}], "]"}]}], ";", 
     RowBox[{"proj", "=", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"gaugeTransformShifts", "[", 
        RowBox[{"rl", ",", "fDir"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"proj", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "proj", "]"}], ".", "proj"}]}], ";", 
     RowBox[{"projHess00", "=", 
      RowBox[{"proj", ".", "hess", ".", "proj"}]}], ";", 
     RowBox[{"projGrad00", "=", 
      RowBox[{"proj", ".", "grad"}]}], ";", 
     RowBox[{"proj00", "=", "proj"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"valuesdd", ",", "oodd"}], "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", 
        RowBox[{"Eigensystem", "[", "projHess00", "]"}]}], "]"}]}], ";", 
     RowBox[{"applyCutoff3", "[", 
      RowBox[{"valuesdd", ",", 
       RowBox[{"oodd", ".", "projGrad00"}], ",", 
       RowBox[{"oodd", ".", "proj00"}], ",", "testCutoff"}], "]"}]}]}], "]"}],
   ";"}]], "Input",ExpressionUUID->"46c08f3c-a26f-4a6d-8b8d-25f66411f89d"],

Cell["\<\
With the Krylov method, we never access the nullspace of the projection \
operator.  Without explicitly projecting out the nullspace, it looks like \
Lanczos will wander into the nullspace.  Perhaps the stopping criteria needs \
to be tuned?\
\>", "Text",ExpressionUUID->"9463f2c3-e538-4fcd-bbe8-6bf58ad94f59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"slicee", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"6", ",", 
     RowBox[{"Length", "[", "projGrad00", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valuesee", ",", "ooee"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Reverse", ",", 
     RowBox[{"ersatzLanczos", "[", 
      RowBox[{"projHess00", ",", 
       RowBox[{"eigenPairs", "\[Rule]", 
        RowBox[{"-", "slicee"}]}], ",", 
       RowBox[{"maxIterations", "\[Rule]", "3000"}], ",", 
       RowBox[{"printDetails", "\[Rule]", "True"}], ",", 
       RowBox[{"initialVector", "\[Rule]", "projGrad00"}], ",", 
       RowBox[{"orthoSubspace", " ", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"proj00", ".", "#"}], ")"}], "&"}], ")"}]}]}], "]"}]}], 
    "]"}]}], ";", 
  RowBox[{"applyCutoff3", "[", 
   RowBox[{"valuesee", ",", 
    RowBox[{"ooee", ".", "projGrad00"}], ",", 
    RowBox[{"ooee", ".", "proj00"}], ",", "testCutoff"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"4a27c6db-8f03-4367-8a79-4becb69b9bc8"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"ood", ".", "proj0"}], ",", "slicee"}], "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Take", "[", 
       RowBox[{"ooee", ",", "slicee"}], "]"}], "]"}]}], "]"}], "-", 
   RowBox[{"IdentityMatrix", "[", "slicee", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"eced5048-14b7-49d0-994c-aa11673a0efb"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"valuesd", ",", "slicee"}], "]"}], "-", 
   RowBox[{"Take", "[", 
    RowBox[{"valuesee", ",", "slicee"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"8313f522-e19d-446c-aa25-954274ab37f9"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"ooee", ".", 
    RowBox[{"Transpose", "[", "ooee", "]"}]}], "-", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "valuesee", "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"be850030-f405-42dc-b183-42bd2b9e5c0e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare MINRES/MINRES-QLP versus dense, no cutoff.", \
"Section",ExpressionUUID->"25560db5-08ba-4d34-aeef-0960426da3ce"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"5b561796-b3a3-49b1-a7dd-d4f6a59fa732"],

Cell[" Choose method:", \
"Text",ExpressionUUID->"cf4bc892-1a73-4fb9-b62f-6918231f7993"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Keys", "[", "minresLabels", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"minresMethod", "=", 
  RowBox[{
   RowBox[{"Keys", "[", "minresLabels", "]"}], "[", 
   RowBox[{"[", "1", "]"}], 
   "]"}]}]}], "Input",ExpressionUUID->"cfff3048-0ad8-4d05-abcb-564d85ef344a"],

Cell[CellGroupData[{

Cell["Dynamic/All", \
"Subsection",ExpressionUUID->"80597020-d0fe-4d53-a1b6-14a999f4b157"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAllDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"6b957c4f-5b3a-4f48-b0dd-965728963678"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"30928d76-8453-4ae7-8a53-b6a6326c9514"],

Cell["\<\
For projecting out the gauge transforms on a Nc=3, 4^3 lattice:
247 seconds for solving squared system using conjugate gradients.
67 seconds for default (dense?) LeastSquares
83 seconds for  LeastSquares Krylov method (tol=Automatic).
515 seconds for LeastSquares Krylov, tolerance=0.01
365 seconds for LeastSquares Krylov, tolerance=100\
\>", "Text",ExpressionUUID->"ee14b917-d38b-4055-afba-f99d19388eac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAllMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"minresMethod", ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"694c320b-dc84-4144-ab9e-09d1ea7decf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10", "^", 
          RowBox[{"-", "13"}]}]}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"minresMethod", ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"58fde015-7816-4ca8-9c3f-55150f46891e"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAllDense", "-", "gaugeFieldAllMinres"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"c32d2981-d314-4ea6-8eba-66044580ec02"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldDynamicDense", "-", "gaugeFieldDynamicMinres"}], 
     "]"}], ",", 
    RowBox[{"5", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4d0fcbf4-c322-4d6e-8ce7-14b70baa94ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axial", \
"Subsection",ExpressionUUID->"32dec57f-e017-4c52-bdc7-5dcd64d3eadc"],

Cell["Compare for the Axial-constant shifts", \
"Text",ExpressionUUID->"f3fc5478-c0c9-4ff3-88de-e5077ce3395d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"axialDirection", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "axialDirection", "]"}], ";", 
  RowBox[{"gaugeFieldAxialDense1", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"f2b1f822-1b31-4cc7-a1ae-c2d256652ac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxialMinres1", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"ignoreCutoff", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"Method", "\[Rule]", "minresMethod"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10", "^", 
          RowBox[{"-", "13"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"956cf06d-1e62-4d8f-9187-46aa5cbe7e7e"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAxialDense1", "-", "gaugeFieldAxialMinres1"}], "]"}], 
    ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"97eefe67-1b34-48cb-b39d-50517408c971"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare MINRES/MINRES-QLP versus dense", \
"Section",ExpressionUUID->"7f154c8b-cbe7-44d7-af10-ff3bf3798fa1"],

Cell["\<\
MINRES/MINRES-QLP with special handling of large shift eigenvalues, compared \
to dense calculation.\
\>", "Text",ExpressionUUID->"f5649d56-9f91-4dbe-8f11-6bba4f25a082"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"dc4b39c9-5ae3-4f1e-a16f-c9ab54be90fd"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"d981ba60-d35e-4254-901a-4955628570dd"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-8-9-3.m\>\""}]], \
"Input",ExpressionUUID->"8d7171c1-6809-40ee-840b-21d5ca1aaf6e"],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"9423ff30-cb04-4ae2-a15a-53b919221844"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"3567b284-0a38-49b4-985c-4c06a4bfd03d"],

Cell[BoxData[
 RowBox[{"-", 
  "0.0823601370523569`"}]], \
"Output",ExpressionUUID->"cb354664-9863-400c-802b-c8985be00dc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamic", \
"Subsection",ExpressionUUID->"0157dcfb-63cf-4b2e-bde1-4c021871fcb5"],

Cell["\<\
nd=3, nc=3, 12^3 crashes kernel, but nc=3, 8^3 works.

8^3 lattice 48 large shifts, need 127 N=8192, dense is 7 minutes.
trnlaso is 25 minutes.  Error is 4*10^-5.\
\>", "Text",ExpressionUUID->"e368b91a-a8b2-4807-ab42-1938cb220188"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldDynamicDense", ",", "shiftsDynamicDense"}], "}"}], "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"latticeSaddlePointStep", "[", 
      RowBox[{
       RowBox[{"fullMatrix", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"returnShifts", "\[Rule]", "True"}], ",", 
       RowBox[{"eigenCutoffMax", "\[Rule]", "2"}], ",", 
       RowBox[{"eigenCutoff2", "\[Rule]", "0.2"}]}], "]"}], ",", "2"}], 
    "]"}]}], ";", 
  RowBox[{"distanceFromDense", "=", 
   RowBox[{"latticeDistanceFrom", "[", "gaugeFieldDynamicDense", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"536f9c31-c58c-453e-97fa-7a674202e049"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Constructed hess, grad\"\>"], \
"Print",ExpressionUUID->"6fe90140-8b7e-403e-aafb-773e5dc66ce0"],

Cell[BoxData["\<\"Constructed gauge\"\>"], \
"Print",ExpressionUUID->"9e708d8a-ab77-4fe2-8c1e-7bbfacf47f6d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  {total, max, norm} = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "14", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" eigenpairs between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"994", ",", "1024"}], "}"}]}],
  SequenceForm[
  "applyCutoff3:  {total, max, norm} = ", {14, 14, 4}, " of ", 1024, 
   " eigenpairs between ", {994, 1024}],
  Editable->
   False]], "Print",ExpressionUUID->"af9a924e-f391-4df4-a116-b30b445efda1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.32015188793032`", ",", "0.3049949146381874`", ",", 
     "1.0000000000000229`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {8.32015188793032, 0.3049949146381874, 
   1.0000000000000229`}],
  Editable->
   False]], "Print",ExpressionUUID->"5f983ebf-d8d9-4cff-aec4-eecf051fa0a0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.32015188793032`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.32015188793032, " to ", 2],
  
  Editable->
   False]], "Print",ExpressionUUID->"5616b031-07ba-4ff3-bfe1-904380fde663"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"latticeSaddlePointStep times:\\n    matrices=\"\>", 
   "\[InvisibleSpace]", "1.369365`6.287034221245637", 
   "\[InvisibleSpace]", "\<\" s, findDelta=\"\>", "\[InvisibleSpace]", 
   "2.083375`6.4692824462591885", 
   "\[InvisibleSpace]", "\<\" s, applyDelta=\"\>", "\[InvisibleSpace]", 
   "0.014268`4.30487809849831", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "latticeSaddlePointStep times:\n    matrices=", 1.369365`6.287034221245637, 
   " s, findDelta=", 2.083375`6.4692824462591885, " s, applyDelta=", 
   0.014268`4.30487809849831, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"6130a87c-54f5-4fc6-8d24-d0e827666ccb"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldDynamicMinres1", ",", "shiftsDynamicMinres1"}], "}"}], 
   "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"latticeSaddlePointStep", "[", 
      RowBox[{
       RowBox[{"fullMatrix", "\[Rule]", "True"}], ",", 
       RowBox[{"dynamicPartMethod", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<MINRES\>\"", ",", 
          RowBox[{"rTolerance", "\[Rule]", 
           RowBox[{"10.0", "^", 
            RowBox[{"-", "10"}]}]}], ",", 
          RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}], ",", 
       RowBox[{"largeShiftOptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"eigenPairs", "\[Rule]", 
           RowBox[{"-", "130"}]}], ",", 
          RowBox[{"maxIterations", "\[Rule]", "5000"}], ",", 
          RowBox[{"innerInterval", "\[Rule]", "10"}], ",", 
          RowBox[{"rTolerance", "\[Rule]", 
           RowBox[{"10.0", "^", 
            RowBox[{"-", "7"}]}]}], ",", 
          RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
          RowBox[{"printsPerDecade", " ", "\[Rule]", " ", "10"}], ",", 
          RowBox[{"restartLanczos", "\[Rule]", "False"}]}], "}"}]}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", " ", 
       RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}], ",", "2"}], 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"51486604-b351-4829-8733-5524265d7cc1"],

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsDynamicDense", ",", "shiftsDynamicMinres1"}], 
  "]"}]], "Input",ExpressionUUID->"df89957d-d859-40c2-8af5-4495bb1f1ffb"],

Cell[BoxData[
 RowBox[{"distanceFromDense", "[", "gaugeFieldDynamicMinres1", 
  "]"}]], "Input",ExpressionUUID->"b14e750e-ca64-4747-8fa4-d15d8a90e9d2"],

Cell["For small systems, strategy = 3 or 4 is better.", \
"Text",ExpressionUUID->"cf331d89-2a60-4e76-9311-abdc1e01fa9a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldDynamicMinres2", ",", "shiftsDynamicMinres2"}], "}"}], 
   "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"latticeSaddlePointStep", "[", 
      RowBox[{
       RowBox[{"dynamicPartMethod", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"maxLanczosVecs", "\[Rule]", "1200"}], ",", 
          RowBox[{"maxIterations", "\[Rule]", 
           RowBox[{"400", "*", "1000"}]}], ",", 
          RowBox[{"rTolerance", "\[Rule]", 
           RowBox[{"10.0", "^", 
            RowBox[{"-", "9"}]}]}], ",", 
          RowBox[{"printDetails", "\[Rule]", "1"}]}], "}"}]}], ",", 
       RowBox[{"largeShiftOptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"eigenPairs", "\[Rule]", 
           RowBox[{"-", "40"}]}], ",", 
          RowBox[{"maxIterations", "\[Rule]", 
           RowBox[{"100", "*", "1000"}]}], ",", 
          RowBox[{"maxLanczosVecs", "\[Rule]", "1200"}], ",", 
          RowBox[{"restartStrategy", "\[Rule]", "7"}], ",", 
          RowBox[{"rTolerance", "\[Rule]", 
           RowBox[{"10.0", "^", 
            RowBox[{"-", "8"}]}]}], ",", 
          RowBox[{"printDetails", "\[Rule]", "1"}]}], "}"}]}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<External\>\"", ",", 
          RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
          RowBox[{"rTolerance", " ", "\[Rule]", " ", 
           RowBox[{"10.0", "^", 
            RowBox[{"-", "9"}]}]}], ",", 
          RowBox[{"maxLanczosVecs", "\[Rule]", "1200"}]}], "}"}]}], ",", 
       RowBox[{"eigenCutoffMax", "\[Rule]", "2"}], ",", 
       RowBox[{"eigenCutoff2", "\[Rule]", "0.2"}], ",", 
       RowBox[{"externalAction", "\[Rule]", "\"\<remote\>\""}], ",", 
       RowBox[{"remoteHost", "\[Rule]", "\"\<localhost\>\""}], ",", 
       RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"processes", "\[Rule]", "2"}], ",", 
       RowBox[{"threads", "\[Rule]", "2"}], ",", 
       RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}], ",", "2"}], 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"59dbc176-9bfa-437d-861f-c9020524c00e"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"MAXLAN:      1200, Restart:         4,   NED: -       1,      \
NEC:         1\\nMATVEC:       128,  Reorth:       128, Nloop:         1,  \
Nlocked:         0\\nTtotal:  0.043873,    T_op:  0.011676, Torth:  0.007822, \
  Tstart:  0.002267\\nGauge matrix extreme eigenvalues found:\\n  \
1.130975e+00\\nMAXLAN:      1200, Restart:         7,   NED: -      40,      \
NEC:        40\\nMATVEC:      2281,  Reorth:      2281, Nloop:        40,  \
Nlocked:        10\\nTtotal: 37.406284,    T_op: 31.906148, Torth:  4.435839, \
  Tstart:  0.951602\\nlargeShifts: ops=2281, sumNcol=2281, \
maxNcol=1\\nlargeShifts: 2281 matrix-vector ops, 2281 reorthogonalizations in \
12.77 s\\ncutoffNullSpace:  14 (max 14, norm 4) of 40 eigenpairs between [0, \
30]\\nlinearSolve:  460 iterations, 460 reorthogonalizations in 1.44 \
s\\ndynamicProject:  7767 calls (7122 usertol), 146149 matrix-vector ops, max \
itn 29\\n                 in 12.76 s\\nshifts.c:  init and i/o 0.13 s, \
calculation 14.23 s\\n\"\>",
  StripOnInput->False,
  FontColor->RGBColor[
   0, 0, 1]]], "Print",ExpressionUUID->"31d5ba15-de73-455f-a5cd-6cd4637e60cd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.32014855106824910328200089861124072808`17.07986503970809", 
   "\[InvisibleSpace]", "\<\" to \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 
   8.32014855106824910328200089861124072808`17.07986503970809, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"781bcd76-4bb4-4df2-976b-9de0a4a8ee0f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsDynamicDense", ",", "shiftsDynamicMinres2"}], 
  "]"}]], "Input",ExpressionUUID->"2df85535-385f-4fa1-93b1-a3903424b227"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.320150219499284`", ",", 
     RowBox[{"-", "4.010579919278001`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"58.55902391183659`", ",", "1.0290629348652658`*^-8"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.9999999999996497`", ",", "8.369890850771897`*^-7"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"84337b53-7635-454f-99cc-9a3787a0e1a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"distanceFromDense", "[", "gaugeFieldDynamicMinres2", 
  "]"}]], "Input",ExpressionUUID->"8d94fb95-f783-4054-b203-691917ab9a82"],

Cell[BoxData["6.746377113780374`*^-8"], \
"Output",ExpressionUUID->"d9b396b6-d37c-46cc-8b76-5df43239357a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axial", \
"Subsection",ExpressionUUID->"b590c957-6eec-4a4d-aef2-abd87409c9b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"axialDirection", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "axialDirection", "]"}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldAxialDense", ",", "shiftsAxialDense"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"27031bc6-d002-4f25-97cb-dc127f58d7b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldAxialMinres1", ",", "shiftsAxialMinres1"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", 
     RowBox[{"largeShiftOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eigenPairs", "\[Rule]", 
         RowBox[{"-", "100"}]}], ",", 
        RowBox[{"maxIterations", "\[Rule]", "5000"}], ",", 
        RowBox[{"innerInterval", "\[Rule]", "10"}], ",", 
        RowBox[{"printDetails", "\[Rule]", "True"}]}], "}"}]}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "7"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}], ",", 
     RowBox[{"debugProj", "\[Rule]", "False"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"e1c1e35e-adf6-450a-ba7c-246e4d956c9f"],

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsAxialDense", ",", "shiftsAxialMinres1"}], 
  "]"}]], "Input",ExpressionUUID->"62d31c02-62c7-436d-bc9d-3755c64e0057"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"gaugeFieldAxialDense", "-", "gaugeFieldAxialMinres1"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"1e463af5-48f3-4f10-b4cc-49f803f86f7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldAxialMinres2", ",", "shiftsAxialMinres2"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "1000"}], ",", 
        RowBox[{"maxIterations", "\[Rule]", 
         RowBox[{"400", "*", "1000"}]}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "9"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "2"}]}], "}"}]}], ",", 
     RowBox[{"largeShiftOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eigenPairs", "\[Rule]", 
         RowBox[{"-", "100"}]}], ",", 
        RowBox[{"maxIterations", "\[Rule]", 
         RowBox[{"400", "*", "1000"}]}], ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "720"}], ",", 
        RowBox[{"restartStrategy", "\[Rule]", "4"}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "7"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "2"}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<External\>\"", ",", 
        RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"rTolerance", " ", "\[Rule]", " ", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "9"}]}]}]}], "}"}]}], ",", 
     RowBox[{"fullMatrix", "\[Rule]", "False"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"4fc05328-fcbb-484d-9e04-57c21a581db6"],

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsAxialDense", ",", "shiftsAxialMinres2"}], 
  "]"}]], "Input",ExpressionUUID->"8b03f22b-81e7-4a05-8331-0de071cd8f0e"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"gaugeFieldAxialDense", "-", "gaugeFieldAxialMinres2"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"00e041bc-f0b3-452a-ab5b-58a4aeac7cd0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare dynamic and axial", \
"Subsection",ExpressionUUID->"a4dc8a29-6322-47fb-876c-68c85c089c5b"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"comparePlaquettes", "[", 
    RowBox[{"gf1_", ",", "gf2_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gaugeField", "=", "gf1"}], "}"}], ",", 
        RowBox[{"p1", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"plaquette", "[", 
              RowBox[{"dir1", ",", "dir2", ",", 
               RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir1", ",", "2", ",", "nd"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir2", ",", 
              RowBox[{"dir1", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}], 
      ";", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gaugeField", "=", "gf2"}], "}"}], ",", 
        RowBox[{"p2", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"plaquette", "[", 
              RowBox[{"dir1", ",", "dir2", ",", 
               RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir1", ",", "2", ",", "nd"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir2", ",", 
              RowBox[{"dir1", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}], 
      ";", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"p1", "-", "p2"}], "]"}], "/", 
       RowBox[{"Norm", "[", "p1", "]"}]}]}]}], "]"}]}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d2a113bc-a18a-4773-88a1-7c6ebb3fd3fe"],

Cell[BoxData[
 RowBox[{"comparePlaquettes", "[", 
  RowBox[{"gaugeFieldAxialDense", ",", "gaugeFieldDynamicDense"}], 
  "]"}]], "Input",ExpressionUUID->"88b547ae-762a-4d99-999e-54b090f4bd73"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", \
"Title",ExpressionUUID->"f174178b-2d0b-483f-87a2-8e4a9836b814"],

Cell[CellGroupData[{

Cell["Quadratic approximation errors", \
"Section",ExpressionUUID->"ce1a504e-4046-463f-a1c6-5465d81081e9"],

Cell["\<\
The shifts are approximated as a quadratic.  Use the 2-norm vs. shift \
magnitude to characterize this error.  The error is approximated by \
Norm[shift,2]^2/48, but decreases with nc as 1/nc.
Note that the 2-norm of any SU(N) matrix is 1.\
\>", "Text",ExpressionUUID->"d2626c8b-76a9-4b16-9ee5-1bca8257e6de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nc", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomDirection", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"CircularRealMatrixDistribution", "[", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "-", "1"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"cab5ffe4-a284-4099-863f-4fec92fd090c"],

Cell["\<\
For a single generator of the group, we can calculate explicitly. We get the \
same thing for all matrix norms.\
\>", "Text",ExpressionUUID->"54e08293-9c1e-4ef1-82cc-6f311b2b0c77"],

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shift", "=", 
       RowBox[{"x", " ", 
        RowBox[{
         RowBox[{"SUGenerators", "[", "nc", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
        RowBox[{"I", " ", "shift"}], "-", 
        RowBox[{
         RowBox[{"shift", ".", "shift"}], "/", 
         RowBox[{"2", "!"}]}], "-", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"I", " ", "shift"}], "]"}]}], ",", "2"}], "]"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Conjugate", "[", "x", "]"}], "\[Rule]", 
    "x"}]}]}]], \
"Input",ExpressionUUID->"0cc2495e-8286-4dea-8bc8-47a05960d15d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "xx_", "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Cos", "[", "yy", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"yy", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
         
         RowBox[{"yy", "\[Rule]", "xx"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "xx_", "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Sin", "[", "yy", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"yy", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
         
         RowBox[{"yy", "\[Rule]", "xx"}]}], ")"}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"Abs", "[", "x", "]"}], "\[Rule]", 
   "x"}]}]], "Input",ExpressionUUID->"6cd07246-c803-4be9-a726-978599e0a142"],

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "4"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"50776728-51a3-41da-bff7-dbe90f754129"],

Cell[BoxData[
 RowBox[{"1", "/", 
  "48."}]], "Input",ExpressionUUID->"bd741b8a-d16e-4c76-aa5d-07ab81e8910d"],

Cell["\<\
For (SU(2), Norm[shift]^3/48 is an exact solution.  We see that, for SU(3) \
and SU(4), there is a narrow distribution peaked near 1/48.  For SU(5) and \
above, the peak moves downward.\
\>", "Text",ExpressionUUID->"4313215d-e17f-42c0-b295-a4964cf25227"],

Cell[BoxData[
 RowBox[{"hh1", "=", 
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"hdata", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rd", "=", 
            RowBox[{"randomDirection", "[", "]"}]}], ",", 
           RowBox[{"x", "=", "0.01"}]}], "}"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"shift", "=", 
             RowBox[{"x", " ", 
              RowBox[{"rd", ".", 
               RowBox[{"SUGenerators", "[", "nc", "]"}]}]}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
               RowBox[{"I", " ", "shift"}], "-", 
               RowBox[{
                RowBox[{"shift", ".", "shift"}], "/", 
                RowBox[{"2", "!"}]}], "-", 
               RowBox[{"MatrixExp", "[", 
                RowBox[{"I", " ", "shift"}], "]"}]}], ",", "2"}], "]"}], "/", 
            
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"x", " ", "rd"}], ",", "2"}], "]"}], "^", "3"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", "10000", "}"}]}], "]"}]}], ",", "30", ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"9d1edcc2-6197-4992-9ce6-0ea222664d79"],

Cell[BoxData[
 RowBox[{"Mean", "[", "hdata", 
  "]"}]], "Input",ExpressionUUID->"ef1bc6cb-849c-4533-9bfb-ccd9f64a837d"],

Cell["Mean of the distribution for various 1/nc:", \
"Text",ExpressionUUID->"891d4f13-ef53-401f-b90c-6ea78274bbab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "20"}], ",", "0.003987207811923104`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "16"}], ",", "0.005309460586922509`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "12"}], ",", "0.007542180302737262`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "8"}], ",", "0.01195670498036167`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "6"}], ",", "0.01602903272904034`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "4"}], ",", "0.022300330376689107`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", "0.02572546202970247`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "48"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"53bef80c-9f97-4ec5-b1b9-939ece8875c1"],

Cell[BoxData[
 RowBox[{"ffcd", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{"cd", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}], ",", 
      RowBox[{"x", "^", "3"}]}], "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"31815b19-b53e-40a4-a42f-6241f30d7abb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", "ffcd"}], "]"}], "/.", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{
   "1", "/", 
    "3"}]}]}]], \
"Input",ExpressionUUID->"2aaace19-6f5b-4ac9-b70c-34eeb8363fa2"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"cd", ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.55"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
     
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<1/Nc\>\"", ",", "\"\<Mean coefficient of cubic in shift\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ffcd", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", ".55"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"37f4024b-3fa9-43d2-91fc-2faf596a7b8c"],

Cell["\<\
Plot error as a function of shift in some random shift direction\
\>", "Text",ExpressionUUID->"a9841638-1cc0-4c9d-837f-80708cb033f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxData", "=", 
   RowBox[{"2", "Pi"}]}], ";", 
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rd", "=", 
       RowBox[{"randomDirection", "[", "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"shift", "=", 
            RowBox[{"x", " ", 
             RowBox[{"If", "[", 
              RowBox[{"False", ",", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rd"}], "]"}]}]}], ",", 
           "sg"}], "}"}], ",", 
         RowBox[{
          RowBox[{"sg", "=", 
           RowBox[{"shift", ".", 
            RowBox[{"SUGenerators", "[", "nc", "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"shift", ",", "2"}], "]"}], ",", 
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
               RowBox[{"I", " ", "sg"}], "-", 
               RowBox[{
                RowBox[{"sg", ".", "sg"}], "/", 
                RowBox[{"2", "!"}]}], "-", 
               RowBox[{"MatrixExp", "[", 
                RowBox[{"I", " ", "sg"}], "]"}]}], ",", "2"}], "]"}]}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "maxData", ",", " ", 
         RowBox[{"maxData", "/", "20"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"3358cdbf-4cb3-41c7-94c6-efb75b622f72"],

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{"data", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "^", "3"}], ",", 
      RowBox[{"x", "^", "4"}], ",", 
      RowBox[{"x", "^", "5"}]}], "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"9c910dbe-cd14-4560-90d3-2c60c6db4cf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", "ff"}], "]"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "maxData"}]}]], \
"Input",ExpressionUUID->"03b5c051-ac29-4815-80fb-e7a067dd7220"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", "data", "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff", ",", 
       RowBox[{
        RowBox[{"x", "^", "3"}], "/", "48"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "maxData"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"4b8f05ff-2539-4241-a91e-bd960a53670a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Identity staple example, SU(3)", \
"Section",ExpressionUUID->"8f8d2d8e-b492-48b0-805d-82e8841dd8d0"],

Cell["\<\
Special case where the sum of staples is proportional to the identity matrix.\
\
\>", "Text",ExpressionUUID->"28d2b89d-a643-4759-87d0-909427ce7344"],

Cell[BoxData[
 RowBox[{"diagValue", "=", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], "+", 
   RowBox[{"Cos", "[", "x2", "]"}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"-", "x1"}], "-", "x2"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"0e9686d1-84ff-4098-858f-2537d91bf07c"],

Cell["Saddle Points", \
"Text",ExpressionUUID->"6a7026be-e39f-4078-b776-62a0cfb31cf9"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x1"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x2"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"6aef7fbc-166e-41a0-9cec-b12e6d47d511"],

Cell["Hessian", "Text",ExpressionUUID->"57b5fe8f-a9cc-4940-a0c1-899f3f89a168"],

Cell[BoxData[
 RowBox[{"hess", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"diagValue", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"6a5db463-290f-4dc0-9eef-53f5c7cd62a9"],

Cell[BoxData[
 RowBox[{"dh", "=", 
  RowBox[{
  "Det", "[", "hess", 
   "]"}]}]], "Input",ExpressionUUID->"b36fdec5-b58e-46cc-b7f5-fa8d24318e5a"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"Pi", " ", 
      RowBox[{"4", "/", "3"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot3D", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", " ", "limit"}], ",", " ", "limit"}], "}"}], ",", 
       RowBox[{"RegionFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2"}], "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x3", "=", 
              RowBox[{
               RowBox[{"-", "x1"}], "-", "x2"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x2"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x2", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}]}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
     
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
       "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"2de64670-829e-4921-8a2c-468d0e0b6cea"],

Cell[CellGroupData[{

Cell["Test saddle point routine", \
"Subsection",ExpressionUUID->"c708c257-8f21-4f83-9645-19f4be4c3713"],

Cell["Run this as a group", \
"Text",ExpressionUUID->"2524376c-66ab-4e92-bcac-a1757dc76aaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sqrtU1", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{
     RowBox[{"u1", "=", 
      RowBox[{"randomSUMatrix", "[", "3", "]"}]}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"phi1", "=", 
  RowBox[{
  "centerPhases", "[", "u1", 
   "]"}]}]}], "Input",ExpressionUUID->"a20f91db-d8c3-4ce1-b377-8e55df211da4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sqrtU2", ",", "maxShift"}], "}"}], "=", 
   RowBox[{"linkSaddlePointStep", "[", 
    RowBox[{"sqrtU1", ",", "sqrtU1"}], "]"}]}], ";", 
  "maxShift"}]], \
"Input",ExpressionUUID->"9636bb9c-bb6c-453a-abd0-06c6a79bc505"],

Cell[BoxData[
 RowBox[{"phi2", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"sqrtU2", ".", "sqrtU1"}], 
   "]"}]}]], "Input",ExpressionUUID->"f87007aa-68f4-4c9b-9e2b-2288cd031858"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"3", 
      RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"DensityPlot", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"phi1", ",", "2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{"phi2", ",", "2"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"DensityPlot", "[", 
      RowBox[{"dh", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}]}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ff5c7a42-33f1-42a5-9a90-835037adbb53"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Input gauge configurations", \
"Section",ExpressionUUID->"86bfae6c-4d6d-4a25-b7b0-864c8f4e6d20"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"2e729cea-afdc-4de4-a9d0-e45f71386f6b"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"9e9f081b-abbd-4cff-9d20-c688455c675e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-8-9-3.m\>\""}]], \
"Input",ExpressionUUID->"7587afb3-761a-413d-8e5e-579daa0d3740"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-12-11-3.m\>\""}]], \
"Input",ExpressionUUID->"3e61768b-0f4f-464b-8449-8fad3e6c7798"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-16-15-3.m\>\""}]], \
"Input",ExpressionUUID->"e986ad07-c948-4c03-8cda-e575a71c2b40"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-16-28-5.m\>\""}]], \
"Input",ExpressionUUID->"5c9001a9-2e55-4c31-864a-6c52d057395d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-16-31-4.m\>\""}]], \
"Input",ExpressionUUID->"ed100dac-92d1-424c-a101-6924d283c5db"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-1.m\>\""}]], \
"Input",ExpressionUUID->"53db7ba8-c629-4d00-bb4a-7a9f18d8901c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/periodic-22-42-1-cool.m\>\""}], 
  ";"}]], "Input",ExpressionUUID->"88d740d1-0a07-419a-a8d4-ef7fbfaf5fd8"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-5.m\>\""}]], \
"Input",ExpressionUUID->"dcc2d627-4ef7-4a60-8951-5b495967f3c9"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-80-5.m\>\""}]], \
"Input",ExpressionUUID->"60d71144-9c29-458f-8c63-11f9a13446f3"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-28-1.m\>\""}]], \
"Input",ExpressionUUID->"f3047582-2299-4c99-96b3-92a00ca8e127"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-33-4.m\>\""}]], \
"Input",ExpressionUUID->"35588511-034f-4f59-b7b1-a1cbbf30db9e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-37-5.m\>\""}]], \
"Input",ExpressionUUID->"6a9e6fd4-9dd9-4daa-9569-d4cc39ca2f91"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-20-150-5.m\>\""}]], \
"Input",ExpressionUUID->"ca7283e7-df2f-49ce-ad42-0a6fc8bf4636"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/winding-20-80-0-5.m\>\""}]], \
"Input",ExpressionUUID->"f09dcb5b-d116-4917-aff2-0184028aff50"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/winding-20-80-1-5.m\>\""}]], \
"Input",ExpressionUUID->"b86f3c7d-603b-4ba0-b40c-c9038a7046a6"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/winding-20-60-0-4.m\>\""}]], \
"Input",ExpressionUUID->"8267aa6e-e250-4049-b04f-87653efe314d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/winding-20-60-1-4.m\>\""}]], \
"Input",ExpressionUUID->"8f77c9e2-3f22-464d-b28f-251096700d6d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-6/periodic-18-90-1.m\>\""}]], \
"Input",ExpressionUUID->"f5cec4a6-0c14-48b6-a315-a3e91cb85b6e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-6/periodic-18-170-1.m\>\""}]], \
"Input",ExpressionUUID->"12395adf-36e9-42f0-8751-29da7027243f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"nd", ",", "nc", ",", "beta", ",", "latticeDimensions", ",", 
   RowBox[{"Dimensions", "[", "gaugeField", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"f90fbc19-e691-424e-a185-652c594a8b4a"],

Cell["Test that links are approximately SU (N)", \
"Text",ExpressionUUID->"f722cea1-30c4-4900-af00-df89fbcc4a0b"],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"badMatrices", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"gaugeField", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"SUMatrixQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"1.0", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "10"}]}]}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b997761f-f834-41b4-862e-6474cf8fce81"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plaquette distribution", \
"Section",ExpressionUUID->"ad50c69b-52fa-49f1-b2f9-aa294300b000"],

Cell["\<\
The plaquette values, if rescaled to the [0,1] interval, generally fit a Beta \
distribution, but we can equivalently use a Gamma distribution for small \
lattice spacings.\
\>", "Text",ExpressionUUID->"054aa60d-5f2e-438f-a8bb-ab5bc7ba93ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"useGammaDistribution", "=", "True"}], 
  ";"}]], "Input",ExpressionUUID->"eed81ada-37f9-434b-b9a6-dc26045be2e0"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"plaquette", "[", 
             RowBox[{"dir1", ",", "dir2", ",", 
              RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "]"}], "/", 
            "nc"}]}], ")"}], "/", 
         RowBox[{"If", "[", 
          RowBox[{"useGammaDistribution", ",", "1", ",", "2"}], "]"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"dir1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"dir2", ",", 
        RowBox[{"dir1", "+", "1"}], ",", "nd"}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b4aa5855-d2b2-4cdf-9d39-80174424a9e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "data", "]"}], ",", 
   RowBox[{"dist", "=", 
    RowBox[{"FindDistribution", "[", 
     RowBox[{"data", ",", 
      RowBox[{"TargetFunctions", "\[Rule]", 
       RowBox[{"Which", "[", 
        RowBox[{"useGammaDistribution", ",", 
         RowBox[{"{", "GammaDistribution", "}"}], ",", "True", ",", 
         RowBox[{"{", "BetaDistribution", "}"}], ",", "True", ",", "All"}], 
        "]"}]}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"80a41af7-56c8-4cde-87d9-3025ff76706a"],

Cell["Distribution for 1 - Tr(plaquette)/nc", \
"Text",ExpressionUUID->"5027c05e-179e-4daf-82a1-11b8eea98e34"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"dm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<nd\>\"", ",", "\"\<nc\>\"", ",", "\"\<beta\>\"", ",", 
       "\"\<mean\>\"", ",", "\"\<alpha\>\"", ",", "\"\<beta\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "42.", ",", "0.0650492058072443`", ",", 
       "4.0372454261752875`", ",", "0.016112274320900954`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "80.", ",", "0.03371067322265413`", ",", 
       "4.011655372432331`", ",", "0.008403182749520672`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "28.", ",", "0.1923250246554901`", ",", 
       "7.7282971359028245`", ",", "0.02488582171194133`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "33.", ",", "0.1604205616819077`", ",", 
       "7.670953223240458`", ",", "0.02091272844591148`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "150.", ",", "0.03380841583718067`", ",", 
       "7.620434296041462`", ",", "0.004436547121053944`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "6", ",", "90.", ",", "0.13525994258717414`", ",", 
       "18.387360829900825`", ",", "0.007356136850654697`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "6", ",", "170.", ",", "0.07017369456939337`", ",", 
       "18.102497926494276`", ",", "0.0038764647207436133`"}], "}"}]}], 
    "}"}]}], "]"}]], \
"Input",ExpressionUUID->"2c71e24c-1758-4d56-9b36-3a519ff2564c"],

Cell[BoxData[
 RowBox[{"Fit", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"a4fba744-c5aa-4242-9186-c7e12b7c32ba"],

Cell[BoxData[
 RowBox[{"alphaf", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "/", "y"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"d9f862ab-59ea-445a-84c5-13a6cd93b8a9"],

Cell[BoxData[
 RowBox[{"Fit", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "6"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"b5fb148f-099f-478f-bd4e-150218d52e40"],

Cell[BoxData[
 RowBox[{"betaf", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "6"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "y"}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"x", " ", "y"}], ")"}]}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"y", "^", "2"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"d6598be3-4d8f-46ab-98a7-3bb7a785b1f1"],

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"alphaf", " ", "betaf"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "Infinity", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "Infinity", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"3512c207-94b1-4353-9383-7b66e725d596"],

Cell[BoxData[
 RowBox[{"dist", "=", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"nc", "^", "2"}], "/", "2"}], ",", 
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"3", " ", "beta"}], ")"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"73f0688f-3bc6-4d5e-987a-d2ecfe0eba1a"],

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{"a1", ",", "b1"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4f9e72ca-8e2c-461f-a480-11be1383abb2"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "4"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], " ", "2", " ", "Pi"}],
          ")"}]}]}], "}"}], "&"}], ",", "dm"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4123b4ad-1aee-4ba2-af38-fbae132fc1fc"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"width", "=", "0.0025"}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"data", ",", 
       RowBox[{"{", "width", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], " ", "width", " ", 
        RowBox[{
         RowBox[{"PDF", "[", "dist", "]"}], "[", "x", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"3", " ", 
          RowBox[{"Mean", "[", "data", "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ddde5321-7bd9-49df-ae4a-3c5cddcb8338"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gauge Invariant Shifts", \
"Section",ExpressionUUID->"81386b1e-2c78-489b-af5a-f2aceecfa768"],

Cell["\<\
The gauge transforms should leave the action invariant.  Thus any small shift \
in the direction of a gauge transform should have zero gradient and zero \
second derivative.

Orthogonalizing the associated matrix creates a matrix that is roughly 50% \
dense.  This seems to be independent of the basis ordering.  For instance, \
going to checkerboard (linearSiteIndex[]) just changes the sparsity pattern. \
\
\>", "Text",ExpressionUUID->"7be3d2d0-2681-4d65-8319-b3a6d628e18f"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"08304c9f-fc06-44f7-8f6e-52e13e4e144a"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"25509c63-5aca-4a64-8df2-b3214f5a2980"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-1.m\>\""}]], \
"Input",ExpressionUUID->"aed7d32e-99c3-4103-b2ea-8835d046f9fd"],

Cell["Create trivial lattice with one non-trivial link.", \
"Text",ExpressionUUID->"2e3e6350-ee8a-4237-b197-11dd2f407ac2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"makeTrivialLattice", "[", 
      RowBox[{"randomGauge", "\[Rule]", "False"}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", 
         RowBox[{"RandomReal", "[", "]"}], " ", 
         RowBox[{
          RowBox[{"SUGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"gaugeField", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"linearSiteIndex", "[", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"39440a9d-8ba5-4dde-bd8a-99baa4176b07"],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"2dc2c384-2848-43ef-8fb2-ee1a4dac66bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"52da041f-8b8d-434a-8725-70be19a39e43"],

Cell["\<\
Timing, matrix size, density, and memory use:
See https://mathematica.stackexchange.com/questions/83721/what-are-\
sparsearray-properties-how-and-when-should-they-be-used\
\>", "Text",ExpressionUUID->"0ecd030a-d3cb-455b-87fa-30fce89ac99d"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"rl", "=", 
    RowBox[{"Chop", "[", 
     RowBox[{"makeRootLattice", "[", "]"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Dimensions", "[", 
      RowBox[{"sh", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"gaugeTransformShifts", "[", "rl", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"sh", "[", "Density", "]"}], ",", 
     RowBox[{"printMemory", "[", "sh", "]"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"76eb98b1-84a2-4e60-a9e6-6ecf06894d8a"],

Cell[CellGroupData[{

Cell["\<\
Look at sh.Transpose[sh] and distribution of right hand sides\
\>", "Subsection",ExpressionUUID->"0719dd29-b183-42ba-83a5-3cd1ab61dc20"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals", ",", "oo"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"sh", ".", 
      RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}], "]"}]}], ";", 
  RowBox[{
  "Dimensions", "[", "oo", 
   "]"}]}]], "Input",ExpressionUUID->"55cb4a2d-4c92-454c-a4df-05dc26e9b6b6"],

Cell["\<\
The matrix is fairly well-conditioned.
get 10.5 for data/3-3/periodic-6-8.175-3.m
get 24 for 3-4/periodic-16-33-4.m\
\>", "Text",ExpressionUUID->"debffc29-ae66-4e34-83ce-f513d75ec61c"],

Cell[BoxData[
 RowBox[{"condition", "[", 
  RowBox[{"sh", ".", 
   RowBox[{"Transpose", "[", "sh", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"6640c4aa-bdbe-4619-a67b-62bc39ca21fb"],

Cell["\<\
Convergence of conjugate gradients for this matrix is this to the number of \
steps:
get 0.52 for data/3-3/periodic-6-8.175-3.m
and 0.66 for second case\
\>", "Text",ExpressionUUID->"d1fb0cf0-7a57-4d56-b53d-73ab552d9ef1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sqrt", "[", "%", "]"}], "-", "1"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sqrt", "[", "%", "]"}], "+", "1"}], 
   ")"}]}]], "Input",ExpressionUUID->"fa98e71c-e7ea-4256-855e-f90255889c2a"],

Cell["Generate and store values of shifts, using flag \
\[OpenCurlyDoubleQuote]storeBB\[CloseCurlyDoubleQuote]", \
"Text",ExpressionUUID->"8094b9a4-339e-4398-ac36-b388df765fb9"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", 
     RowBox[{"largeShiftSearch", "\[Rule]", "300"}], ",", 
     RowBox[{"storeBB", "\[Rule]", "True"}]}], "]"}], ";", 
   RowBox[{
   "Dimensions", "[", "bb0", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"3a08d05f-2d18-4b59-87cc-74b18de4e037"],

Cell["\<\
Average overlap of b-vectors with each eigenvector of sh.Transpose[sh], \
eigenvectors are sorted by decreasing eigenvalue.\
\>", "Text",ExpressionUUID->"81266947-091b-497d-8d2e-53bb77c43c04"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
     RowBox[{"oo", ".", "sh", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"bb0", "/", 
          RowBox[{"Map", "[", 
           RowBox[{"Norm", ",", "bb0"}], "]"}]}], ",", "600"}], "]"}], 
       "]"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"2f8acc2b-0119-484a-8bda-ab75f24ce9ed"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
     RowBox[{"oo", ".", "sh", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Orthogonalize", "[", 
        RowBox[{"Drop", "[", 
         RowBox[{"bb0", ",", "600"}], "]"}], "]"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"2c1ad669-a47c-4048-b845-0ca12c917d6e"],

Cell["\<\
Overlap of b-vectors with subspace remains large over iterations.\
\>", "Text",ExpressionUUID->"45b28f06-9777-4720-86d8-9176d335ddc8"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"Norm", ",", 
    RowBox[{"bb0", ".", 
     RowBox[{"Transpose", "[", "sh", "]"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"9cc9bb49-f57e-4506-bc42-cad1b158ad4d"],

Cell["\<\
Fraction of independence of each b-vector from all previous b-vectors after \
transforming into the gauge transform space.  We see that the vectors are \
nearly orthogonal, to start with.  Note that the first iterations are for the \
calculation that locates the large shift eigenvectors of the Hessian.  Then \
comes the iterations associated with finding  the actual shifts.\
\>", "Text",ExpressionUUID->"d11405b7-05aa-40ff-be60-b3b3cfe9cd72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gbb0", "=", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"bb0", ",", "600"}], "]"}], ".", 
    RowBox[{"Transpose", "[", "sh", "]"}]}]}], 
  ";"}]], "Input",ExpressionUUID->"0ba10202-a15b-4ad7-8f55-1c0a7d40f764"],

Cell[BoxData[
 RowBox[{
  RowBox[{"overlaps", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"obb", "=", 
         RowBox[{"If", "[", 
          RowBox[{"False", ",", 
           RowBox[{"gbb0", "/", 
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", "gbb0"}], "]"}]}], ",", 
           RowBox[{"Orthogonalize", "[", "gbb0", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", "=", 
             RowBox[{"gbb0", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"b", "=", 
             RowBox[{"b", "/", 
              RowBox[{"Norm", "[", "b", "]"}]}]}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ob", "=", 
                  RowBox[{"obb", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"b", "=", 
                 RowBox[{"b", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ob", ".", "b"}], ")"}], " ", "ob"}]}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"Norm", "[", "b", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "gbb0", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"c1eac17e-4019-43e4-9ecc-03d9e5d90cd1"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", "overlaps", 
  "]"}]], "Input",ExpressionUUID->"d722a4e7-d4c2-44b0-83c3-0365d62da9c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare different dynamicPart[ ] methods.", \
"Subsection",ExpressionUUID->"7ec696dc-7108-4ca9-b3b5-f2021e836e11"],

Cell["\<\
Verify that this is equal to the NullSpace[ ] used in the dense calculation.\
\>", "Text",ExpressionUUID->"dc98b006-9e03-4553-ae20-cd9fb7c97fbf"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nsh", "=", 
      RowBox[{"NullSpace", "[", "sh", "]"}]}], ",", 
     RowBox[{"tvec", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"First", "[", "sh", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dynamicPart", "[", "sh", "]"}], "[", "tvec", "]"}], "-", 
     RowBox[{
      RowBox[{"Transpose", "[", "nsh", "]"}], ".", "nsh", ".", "tvec"}]}], 
    "]"}]}], "]"}]], \
"Input",ExpressionUUID->"fad809e6-63a1-4724-8739-e8157db94d1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testProjection", "[", "f_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "sh", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      "r2", ",", 
      RowBox[{"t1", "=", 
       RowBox[{"SessionTime", "[", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"r2", "=", 
      RowBox[{"f", "[", "r1", "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<timing:  \>\"", ",", 
       RowBox[{
        RowBox[{"SessionTime", "[", "]"}], "-", "t1"}], ",", " ", 
       "\"\< s\>\""}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"r2", "-", 
         RowBox[{"f", "[", "r2", "]"}]}], "]"}], ",", 
       RowBox[{"Norm", "[", 
        RowBox[{"sh", ".", "r2"}], "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"277005b6-0fa5-467a-89b2-47d426ba8194"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpOrtho", "=", 
     RowBox[{"dynamicPart", "[", "sh", "]"}]}], ")"}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"fc9a90c6-459c-494f-905b-32ab18544655"],

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpOrtho", 
  "]"}]], "Input",ExpressionUUID->"7d44c94a-06c8-4637-9dc7-489ea855785f"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLeast", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LeastSquares\>\""}]}], "]"}]}], 
    ")"}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"f5ce9c6e-51a9-4fdd-8b48-46cdca20ba92"],

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpLeast", 
  "]"}]], "Input",ExpressionUUID->"cda52ce3-5135-4684-8ba4-6058e5a9a9e2"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLinear", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LinearSolve\>\""}]}], "]"}]}], ")"}],
    ";"}], "]"}]], \
"Input",ExpressionUUID->"463f2d4e-a959-409a-a065-8c7465000bb2"],

Cell["\<\
For 3-3/periodic-22, 182s, 77MB memory, gaugeTransformShifts 132MB, trouble \
converging.  Looks like the Krylov method just stores the matrix until \
solving.\
\>", "Text",ExpressionUUID->"39d4ce56-eabc-400a-ad0d-f08908b56230"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLinear", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LinearSolve\>\"", ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Krylov\>\"", ",", 
             RowBox[{
             "\"\<Method\>\"", "\[Rule]", "\"\<ConjugateGradient\>\""}], ",", 
             
             RowBox[{"\"\<Tolerance\>\"", "\[Rule]", 
              RowBox[{"10", "^", 
               RowBox[{"-", "9"}]}]}]}], "}"}]}]}], "}"}]}]}], "]"}]}], ")"}],
    ";"}], "]"}]], \
"Input",ExpressionUUID->"8b3e902f-7dde-4eb9-bfb7-7ddb75b9018c"],

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpLinear", 
  "]"}]], "Input",ExpressionUUID->"69da07cc-cdb9-4142-833f-e650c90205e7"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"dpzLinear", "=", 
    RowBox[{"dynamicPart", "[", 
     RowBox[{"sh", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<MINRES\>\"", ",", 
         RowBox[{"printDetails", "\[Rule]", "1"}], ",", 
         RowBox[{"rTolerance", "\[Rule]", 
          RowBox[{"10", "^", 
           RowBox[{"-", "10"}]}]}]}], "}"}]}]}], "]"}]}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"65d12926-d2c3-4165-a44e-15de6aeba532"],

Cell["\<\
Faster than built-in Conjugate gradients, perhaps because we don\
\[CloseCurlyQuote]t explicitly construct the matrix.\
\>", "Text",ExpressionUUID->"4fca43ce-11f0-43d2-a39a-5f6a91c01b52"],

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpzLinear", 
  "]"}]], "Input",ExpressionUUID->"f6da0bd4-c5ea-48b8-b584-5b3c83862554"]
}, Closed]],

Cell[CellGroupData[{

Cell["Improve sparsity of gauge invariant shift matrix", \
"Subsection",ExpressionUUID->"95ec3cb4-995e-4832-baab-242e92a90d93"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "sh", 
  "]"}]], "Input",ExpressionUUID->"70061512-c3c4-4932-9a7f-4cc7ac539b76"],

Cell["\<\
Orthonormal basis of gauge transforms.  We see that we get roughly 50% \
sparsity.\
\>", "Text",ExpressionUUID->"7a750240-d253-450c-8b0e-877cf2788fdd"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"osh", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"Orthogonalize", "[", "sh", "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"6fe32da2-4f96-4c29-9b98-f8b8841583c2"],

Cell[BoxData[
 RowBox[{"osh", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"dc9a797a-d1ab-41d1-b2cb-b43a18b4a147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lastZero", "[", "x_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", "=", "None"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"j", "=", "i"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", "j"}]}], 
   "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"820ec01d-6689-42c3-b971-3f5fddd84a93"],

Cell["\<\
Try to sort rows so that Orthogonalize[..] is more sparse.  This essentially \
didn\[CloseCurlyQuote]t work. \
\>", "Text",ExpressionUUID->"a5ee9a4a-17f3-4003-9ab0-be29b294885b"],

Cell["Octahedral plus tetrahedral tessellation of the lattice.", \
"Text",ExpressionUUID->"f2a84d21-108c-4fd4-a849-387c6becb6ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "allPlanes", "]"}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "]"}], ":=", 
   RowBox[{"allPlanes", "[", "nd", "]"}]}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "nd_", "]"}], ":=", 
   RowBox[{
    RowBox[{"allPlanes", "[", "nd", "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"BitAnd", "[", 
         RowBox[{"1", ",", 
          RowBox[{"BitShiftRight", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", 
            RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "-", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"nd", "-", "1"}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "nd"}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"788ee36e-7285-481a-b584-1c6bde19ab0b"],

Cell["Cubic tessellation of the lattice", \
"Text",ExpressionUUID->"899765d0-c57a-4e06-9b66-1e954b35164d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "allPlanes", "]"}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "]"}], ":=", 
   RowBox[{"allPlanes", "[", "nd", "]"}]}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "nd_", "]"}], ":=", 
   RowBox[{
    RowBox[{"allPlanes", "[", "nd", "]"}], "=", 
    RowBox[{
    "IdentityMatrix", "[", "nd", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"e581cc7d-dc42-4af9-b3f0-c23e8e3c7906"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coordRank", "[", "coords_", "]"}], ":=", 
   RowBox[{"coordRank", "[", 
    RowBox[{"coords", ",", 
     RowBox[{"Total", "[", "latticeDimensions", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"coordRank", "[", 
    RowBox[{"coords_", ",", "top_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cc", "=", 
        RowBox[{
         RowBox[{"allPlanes", "[", "]"}], ".", "coords"}]}], ",", 
       RowBox[{"i", "=", "1"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"cc", ",", 
             RowBox[{"2", "^", "i"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "==", "0"}], "&"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"2", "^", "i"}], "<", "top"}]}], ",", 
        RowBox[{"i", "+=", "1"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"True", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"For", " ", "debugging"}], " ", "*)"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"Length", "[", "cc", "]"}]}], "+", 
         RowBox[{"lastZero", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{"cc", ",", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{"cc", ",", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}]}], "}"}]}], "]"}]}]}],
     "]"}]}]}]], \
"Input",ExpressionUUID->"cd8419d7-5396-4b69-ab57-e7436a8cfc18"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"coordRank", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "i", ",", "j"}], "}"}], ",", 
       RowBox[{"3", "*", "16"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "16"}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], 
  "]"}]], "Input",ExpressionUUID->"999f503e-92c8-48d9-a91e-0e1982afc6ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkerboardRank", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"Null", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nGauge", "[", "0", "]"}], "}"}]}], "]"}]}], ",", 
      "gindex"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"coords", "=", 
           RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"gindex", "=", 
           RowBox[{
            RowBox[{"coords2gauge", "[", "0", "]"}], "[", 
            RowBox[{"coords", ",", "ca"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", "gindex", "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ca", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
               RowBox[{"coordRank", "[", "coords", "]"}]}]}], ",", "gindex"}],
             "}"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ca", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
       RowBox[{"Sort", "[", "y", "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"59f3bfa4-f1af-40db-a051-9cdbd8aa7197"],

Cell[BoxData[
 RowBox[{"osh2", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"Orthogonalize", "[", 
     RowBox[{"sh", "[", 
      RowBox[{"[", 
       RowBox[{"checkerboardRank", "[", "]"}], "]"}], "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"4f16507b-f89f-4c78-abf3-c1cc071cd5b2"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "osh2", 
  "]"}]], "Input",ExpressionUUID->"9d35c5c2-d0b1-4172-ace3-4f11f848e40c"],

Cell[BoxData[
 RowBox[{"osh2", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"7821b034-b595-4804-a30c-b82b97ace6b9"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"sshh", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"sh", ".", 
     RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"6e48f94b-14e9-415a-b0b3-5cfb3db20060"],

Cell[BoxData[
 RowBox[{"sshh", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"99bab5d8-7e49-4ef9-99e7-ab60a603ae3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Dynamic space projection properties", \
"Subsection",ExpressionUUID->"84945386-0274-4dda-ab03-98533f727960"],

Cell["\<\
Transpose[sh].sh is symmetric positive semi-definite.  The null space \
corresponds to non-gauge shifts.  Note that Transpose[sh].sh is still quite \
sparse.\
\>", "Text",ExpressionUUID->"84e021f8-8f1d-420c-a6f4-1f0df56b234a"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "sh", "]"}], ".", "sh"}], "]"}], "]"}], "]"}],
   "]"}]], "Input",ExpressionUUID->"dfbe4a57-40b5-4515-b563-a5f395e8a110"],

Cell["\<\
Test that the gradients are orthogonal to all gauge transforms.\
\>", "Text",ExpressionUUID->"35a8f3a8-a887-49c3-8acc-3ee9001c32a4"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sh", ".", "grad0"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"7db26175-9b80-494b-8888-3409aceedff4"],

Cell["\<\
However, since the Hessian is quadratic in the shifts, it is not necessarily \
in the direction of two infinitesimal gauge transforms.\
\>", "Text",ExpressionUUID->"d9f29dfa-1e72-4448-9502-e04444a962b3"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sh", ".", "hess0", ".", 
    RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"e9d4c17e-10fa-402a-9cd0-41d585ebd3dc"],

Cell["\<\
Project onto subspace of physical degrees of freedom, this results in a dense \
matrix.\
\>", "Text",ExpressionUUID->"41e877bd-9b8d-40b2-b53d-6e2d5b129db0"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"proj", "=", 
    RowBox[{"NullSpace", "[", "sh", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"77278033-ba93-4097-a567-46cc8fc2199b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Adjoint trace identity", \
"Subsection",ExpressionUUID->"35821692-ae2e-4be9-8b36-81e36ad24ba8"],

Cell["\<\
Verify unitarity of the adjoint color matrix for some random element of \
SU(nc):  
        2 Tr[u.suGenerator[a].ConjugateTranspose[u].suGenerator[b]].  
Also, this matrix should be real-valued.  This matrix comes up in the \
analytic calculations.\
\>", "Text",ExpressionUUID->"ad643e66-0715-413a-b3f1-3f02225a0d27"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nc", "=", "3"}], ",", "u"}], "}"}], ",", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
    RowBox[{"ff", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"u", ".", "#1", ".", 
            RowBox[{"ConjugateTranspose", "[", "u", "]"}], ".", "#2"}], 
           "]"}]}], "&"}], ",", 
        RowBox[{"SUGenerators", "[", "]"}], ",", 
        RowBox[{"SUGenerators", "[", "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
    RowBox[{"ff2", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"u", ".", "u", ".", "#1", ".", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"u", ".", "u"}], "]"}], ".", "#2"}], "]"}]}], "&"}], ",", 
        RowBox[{"SUGenerators", "[", "]"}], ",", 
        RowBox[{"SUGenerators", "[", "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}]}], 
  "]"}]], "Input",ExpressionUUID->"c854da1d-f86e-42fb-b758-43d172c442bf"],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"ff", ".", 
   RowBox[{"ConjugateTranspose", "[", "ff", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"218317ee-6919-443e-9bcd-259eb72b11f8"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"ff", ".", "ff"}], "-", "ff2"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"cceea3f8-51ac-42d0-a2ed-7fb44da35128"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["String tension", \
"Section",ExpressionUUID->"b3691e17-548f-480b-94c5-a99587fee159"],

Cell["\<\
First, load base lattice configuration so lattice parameters (nc, nd, et \
cetera) are defined.\
\>", "Text",ExpressionUUID->"8f4ae613-3a2d-4efc-a07c-167a7422d02a"],

Cell["\<\
When looking at the saddle point, we need to store the original \
averagePlaquette[]\
\>", "Text",ExpressionUUID->"e8458b32-b95e-483f-bab3-8d18bfaf56f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/periodic-16-28-5.m\>\""}], ";", 
  RowBox[{"avgP", "=", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"52d38b35-9310-4834-a96c-f99622483942"],

Cell[BoxData["0.9017923927961671`"], \
"Output",ExpressionUUID->"0afaea46-0cf1-4cf2-8d1d-0854dd1db8ea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-16-28-5-a-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"e0d4d9d4-d6ed-4fd1-a6ec-5c43cbf3cd93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-16-28-5-b-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"8c255860-3eb5-40f6-be00-2a04d8dd084b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-16-28-5-e-4.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"69b3dce7-7fe8-4e0b-9a9e-4fe526ccba22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-16-28-5-f-4.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"e4a67824-559f-4149-94cd-1392b84430f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-16-28-5-i-26.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"20a30065-2bba-4f58-8152-f672490e78cf"],

Cell[BoxData["0.9934495922693427`"], \
"Output",ExpressionUUID->"01f16be6-e125-4654-a3b4-ff968737874a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/periodic-22-42-1.m\>\""}], 
  ";"}]], "Input",ExpressionUUID->"52269dbd-6fff-44cb-ac17-880b9fc6a34a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-22-42-1-a-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], 
  ";"}]], "Input",ExpressionUUID->"7518c34a-fb9f-48c3-8817-55b2d5bc2ad2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-22-42-1-b-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], 
  ";"}]], "Input",ExpressionUUID->"5309242a-4c34-4e3d-85e6-fdcd4562c7c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-22-42-1-c-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], 
  ";"}]], "Input",ExpressionUUID->"56507e3f-d2e6-484f-a4aa-066e88affd15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-4/periodic-16-37-5.m\>\""}], ";", 
  RowBox[{"avgP", "=", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"47a986a2-8578-451b-a63d-337548ecc17c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-4/step-16-37-5-b-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"51afa43f-e2eb-44c2-a014-7048c71c91fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-4/periodic-16-48-5.m\>\""}], ";", 
  RowBox[{"avgP", "=", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"bcb3e3c0-0ef1-493d-9373-ee2ccba35661"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-4/step-16-48-5-a-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"f5c6f9f4-21a1-41a1-9e39-cc3caf27ffc1"],

Cell[BoxData[
 RowBox[{"loopThickness", "[", 
  "]"}]], "Input",ExpressionUUID->"1678686a-bc4a-46ff-9c10-bb2c37a9bcfe"],

Cell["\<\
Generally, smeared results are closer to the Teper published values.\
\>", "Text",ExpressionUUID->"67bd5de3-adab-4f0e-9044-48870319d7f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tallyData", "=", 
  RowBox[{"talliesToAverageErrors", "[", 
   RowBox[{"polyakovLoopTallies", "[", "\"\<simple\>\"", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"25a9b774-f852-46f2-aef7-58df4dbc94ed"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"16", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.8823689019509896`", ",", "0.025229452170764825`"}], "}"}]}], 
   ",", 
   RowBox[{"32", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.644254628557918`", ",", "0.022357987548311465`"}], "}"}]}], 
   ",", 
   RowBox[{"48", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.38772636033340346`", ",", "0.01975173221073779`"}], "}"}]}], 
   ",", 
   RowBox[{"64", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.17673864409844364`", ",", "0.01822073581758402`"}], "}"}]}], 
   ",", 
   RowBox[{"80", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.013990034708137538`", ",", "0.010171637244338082`"}], "}"}]}],
    ",", 
   RowBox[{"96", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.06584420250988693`"}], ",", "0.017204892829320716`"}], 
     "}"}]}], ",", 
   RowBox[{"112", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.11659309342411235`"}], ",", "0.01702308862093408`"}], 
     "}"}]}], ",", 
   RowBox[{"128", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.13124269217837076`"}], ",", "0.023948138391541765`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.7873576891590287`", ",", "0.02411202733419062`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.5801932816514526`", ",", "0.015397695000344784`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["10"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.3462374378037464`", ",", "0.013830696743197774`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["17"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.15060834051017485`", ",", "0.012835654320122703`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["26"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.011005676778055204`", ",", "0.012376226485172379`"}], "}"}]}],
    ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["37"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.07654238278809128`"}], ",", "0.012227500102258947`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"80", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.13242877335860181`"}], ",", "0.009692997945993698`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["65"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.15964228275206208`"}], ",", "0.009541057880420544`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"32", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.42193356293648066`", ",", "0.020331455239687803`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["13"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.24087638445677176`", ",", "0.013425083300703747`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"32", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.08652730919821783`", ",", "0.012741798762012634`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["29"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.02714982767676321`"}], ",", "0.012379426738630843`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"32", " ", 
     SqrtBox["10"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.10021018680496864`"}], ",", "0.012223641051403576`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["53"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.13850982352914204`"}], ",", "0.012207447344773602`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"32", " ", 
     SqrtBox["17"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.15171487368249628`"}], ",", "0.017220026011274807`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"48", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.11639552412983134`", ",", "0.01822250711976566`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["34"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.07400038027329939`"}], ",", "0.012193322892394888`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"48", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.12811341306632518`"}], ",", "0.012015686718348257`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["58"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.15477069629480122`"}], ",", "0.011936799398165618`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["73"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.16450254144098275`"}], ",", "0.016831404558135032`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"64", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.06208965902072393`"}], ",", "0.017045666865471935`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["41"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.11725336486906951`"}], ",", "0.011698470451543591`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"32", " ", 
     SqrtBox["13"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.15285450744850443`"}], ",", "0.011543145264716568`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"64", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.1759556239712953`"}], ",", "0.0160833647815292`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["61"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.17318794991990055`"}], ",", "0.011243837560191034`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["74"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.18315123380507495`"}], ",", "0.011346237035069554`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["89"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.18618202983286083`"}], ",", "0.01611406714513107`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"96", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.18807042446181127`"}], ",", "0.016102730683951075`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["85"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.1937748103343941`"}], ",", "0.011624677079626876`"}], 
     "}"}]}], ",", 
   RowBox[{"160", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.19585394077498477`"}], ",", "0.016612792108905088`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"112", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.20073792190136855`"}], ",", "0.016908972729577802`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"16", " ", 
     SqrtBox["113"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.20112270925708148`"}], ",", "0.017054059281592274`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"128", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.20072686792585595`"}], ",", "0.03444429515967281`"}], 
     "}"}]}]}], 
  "\[RightAssociation]"}]], \
"Output",ExpressionUUID->"bb022837-b79a-4537-98e9-e5260da14523"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tallyData", "=", 
  RowBox[{"talliesToAverageErrors", "[", 
   RowBox[{"polyakovLoopTallies", "[", "\"\<smeared\>\"", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"8b48f09a-6d70-4b26-8e48-468d239f8271"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"16", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.6773680076884321`", ",", "0.04578082287088049`"}], "}"}]}], 
   ",", 
   RowBox[{"32", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.5021235336435536`", ",", "0.03927827633611904`"}], "}"}]}], 
   ",", 
   RowBox[{"48", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.2983130010241888`", ",", "0.03397078657072189`"}], "}"}]}], 
   ",", 
   RowBox[{"64", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.11878482501691154`", ",", "0.03221963283115166`"}], "}"}]}], 
   ",", 
   RowBox[{"80", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.016970797474039796`"}], ",", "0.033413410464862944`"}], 
     "}"}]}], ",", 
   RowBox[{"96", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.10567224383952034`"}], ",", "0.03472490132824723`"}], 
     "}"}]}], ",", 
   RowBox[{"112", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.15158451566600234`"}], ",", "0.03472908623883673`"}], 
     "}"}]}], ",", 
   RowBox[{"128", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.1656607034490696`"}], ",", "0.048467520211089674`"}], 
     "}"}]}]}], 
  "\[RightAssociation]"}]], \
"Output",ExpressionUUID->"cdf44e96-1846-43d2-994a-212c7d49ea90"]
}, Open  ]],

Cell["Teper's published string tension squared.", \
"Text",ExpressionUUID->"bb05cf4f-f2da-43b1-b9fe-e58144e6103d"],

Cell[BoxData[
 RowBox[{"squareValue", "[", 
  RowBox[{"teperTension", "[", 
   RowBox[{"nd", ",", "nc", ",", "beta", ",", "avgP"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"93d29836-d8f8-421b-a97c-8f03be6062d9"],

Cell[BoxData[
 RowBox[{"squareValue", "[", 
  RowBox[{"teperTension", "[", 
   RowBox[{"3", ",", "4", ",", "48", ",", "0.89"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"23b299b7-3bd0-49d0-ba73-8c57160bf5d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{"exponentialModel", "[", 
    RowBox[{"tallyData", ",", 
     RowBox[{"printResult", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"aa6430b1-dfc2-4a6e-9514-05ee903ee29a"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"norm", "1.4377051239755205`", "0.07758014770392548`", 
      "18.53186886756564`", "8.418860357296043`*^-6"},
     {"a2sigma", "0.015439605720179272`", "0.003218465755979471`", 
      "4.79719434376289`", "0.0048957474245939795`"},
     {"c", 
      RowBox[{"-", "0.4099031536843652`"}], "0.11306630783602763`", 
      RowBox[{"-", "3.6253342090096354`"}], "0.015134495753992963`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->
   False]], "Print",ExpressionUUID->"cfd348b0-192a-4575-a355-4e48bc1f3c2f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", "a2sigma", "]"}], "=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"a", ",", "Italic"}], "]"}], "^", "2"}], ",", "\[Sigma]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nn", "=", 
      RowBox[{"Normal", "[", "tallyData", "]"}]}], ",", "maxx", ",", "miny", 
     ",", "maxy"}], "}"}], ",", 
   RowBox[{
    RowBox[{"maxx", "=", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "nn"}], "]"}], "]"}], "+", "0.5"}]}], ";", 
    RowBox[{"maxy", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"1.5", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", "nn"}], 
       "]"}], "]"}]}], ";", 
    RowBox[{"miny", "=", 
     RowBox[{"Min", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Min", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"1.5", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", "nn"}], 
         "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ErrorListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"ErrorBar", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
          ",", "nn"}], "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"miny", ",", "maxy"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"ColumnForm", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\< = \>\"",
                     ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    "\"\<\[PlusMinus]\>\"", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "&"}], 
                  ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"ff", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<BestFitParameters\>\"", ",", 
                    "\"\<ParameterErrors\>\""}], "}"}], "]"}], "]"}]}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Beta] = \>\"", ",", 
                    RowBox[{"N", "[", "beta", "]"}], ",", 
                    "\"\<, \!\(\*SubscriptBox[\(N\), \(d\)]\) = \>\"", ",", 
                    "nd", ",", 
                    "\"\<, \!\(\*SubscriptBox[\(N\), \(c\)]\) = \>\"", ",", 
                    "nc"}], "}"}], "]"}], ",", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<lattice = \>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"latticeDimensions", ",", "\"\<, \>\""}], "]"}]}],
                     "}"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"maxx", "*", "0.9"}], ",", 
               RowBox[{"maxy", "*", "0.9"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Dashing", "[", ".02", "]"}], ",", "Gray", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"maxx", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
        ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<area enclosed (plaquettes)\>\"", ",", 
           "\"\<Polyakov loop correlator\>\""}], "}"}]}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"ff", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}]}], 
  "]"}]}], "Input",ExpressionUUID->"8497e53e-6048-4af5-9f48-fddcf95862ec"],

Cell[CellGroupData[{

Cell["Trajectories for  3-3/periodic-16-28-5.m", \
"Subsection",ExpressionUUID->"5174b2e9-6ea6-41ca-b9b2-3f5954fea1a3"],

Cell[CellGroupData[{

Cell["Single-link saddle trajectory", \
"Subsubsection",ExpressionUUID->"395d95ee-a9dc-4f68-a71f-6186484d6df0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "gaugeField", "}"}], ",", 
    RowBox[{
     RowBox[{"<<", "\"\<../data/3-3/periodic-16-28-5.m\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trajectory", "[", "\"\<la\>\"", "]"}], "=", 
      RowBox[{"allLinkSaddlePoint", "[", 
       RowBox[{"20", ",", 
        RowBox[{"dampingFactor", "\[Rule]", "0.1"}], ",", " ", 
        RowBox[{"printDetails", "\[Rule]", "2"}]}], "]"}]}]}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"2c328649-3bf9-4eed-8d40-ea209f3a7c43"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "0.000015`1.3266062568876722", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 0, " in ", 0.000015`1.3266062568876722, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"1580e2af-8b38-4129-9971-15d145a81b0f"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,53,5,
   31699993126491654841,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"6f51ffd5-93bd-4837-8072-75ddee6d0f46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "2.739167228957293`*^-15", ",", "0.9017923927961671`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.01927360959706695`", ",", "0.0018220318846420883`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015495262407023546`", ",", "0.0056077030292302835`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.005555476137363994`"}], ",", "0.002633842612476943`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"18192acd-c5d1-4dab-bc3a-74ffae0bb510"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.193761`6.654817411116989", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 1, " in ", 3.193761`6.654817411116989, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"c2f3c450-6633-411e-b63e-ed6417c0cd1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0.00029481314470794934`", ",", "0.9144509707965718`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.02959805967478106`", ",", "0.0026982858645756007`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015474351168138067`", ",", "0.0053953144918554696`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.008483291859144673`"}], ",", "0.003901009820760625`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"51f1e0f2-c6df-47ae-8a74-e04f3f89aa23"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.057679`6.635906888376542", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 2, " in ", 3.057679`6.635906888376542, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"a9916080-0066-4928-b77a-cd5137661110"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0.0005887104190525043`", ",", "0.9260837457364347`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.04445489651226746`", ",", "0.003914181832716271`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01547199603531612`", ",", "0.005208691066417284`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.01265098999015176`"}], ",", "0.005659005810423834`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"90ee4e79-fb95-49af-becf-0c56a6f4f5a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.555264`6.701386853104881", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 3, " in ", 3.555264`6.701386853104881, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"9f7a0eea-1591-4824-9a65-25b9a28de204"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "0.0008805724699377719`", ",", "0.9366807478195884`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.06524653101585542`", ",", "0.005554435135733718`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015488126744409785`", ",", "0.005043138838641173`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.018413713786794596`"}], ",", "0.008028926378511358`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ff07dcc6-c188-42ac-8ffb-04f0387723d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "2.933947`6.617967262139719", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 4, " in ", 2.933947`6.617967262139719, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"dde4f450-2c3f-4a51-a6a8-425f5cafb4c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.0011685525876776223`", ",", "0.9462318937564583`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.09347195884158035`", ",", "0.007699001278273223`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015523828532554343`", ",", "0.004895747116499139`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.026134077056433343`"}], ",", "0.011123164452702913`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"e90e13e5-e752-4394-9111-52faed45906b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "2.940614`6.618953018370335", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 5, " in ", 2.940614`6.618953018370335, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"5dfdabb5-0467-46a0-9d63-2400edaeea5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5", ",", "0.001450072804278701`", ",", "0.9547310258812304`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.13052740141481356`", ",", "0.010414249175660145`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015569618817701077`", ",", "0.004763230408048452`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.03614540495229697`"}], ",", "0.015035069526341814`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"6a0bb03e-6508-4829-a276-2e8f296a2644"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.020608`6.6306093661098675", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 6, " in ", 3.020608`6.6306093661098675, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"4e9527a7-b1c1-4057-bd67-8d5b600bac20"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6", ",", "0.0017219911889808416`", ",", "0.962181621351428`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.177384901215803`", ",", "0.013738669080254364`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015609236150943088`", ",", "0.004642240388799582`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.048700757053262`"}], ",", "0.01982337769322661`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"d507f88d-704a-44a7-a6ea-63b95390fd7e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.008981`6.628934443258608", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 7, " in ", 3.008981`6.628934443258608, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"f4bbf130-52a4-4628-962b-37cabb25e890"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "0.001980685951708851`", ",", "0.968599977548387`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.23418807511951592`", ",", "0.01764986344065051`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01563776083401299`", ",", "0.004531107438301111`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.06384395892239302`"}], ",", "0.025458241643217253`"}], 
    "}"}]}], 
  "}"}]], "Print",ExpressionUUID->"af1592ab-9770-4b03-ac06-25e0f64a17fb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "2.992232`6.626510260959467", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 8, " in ", 2.992232`6.626510260959467, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"98aa9744-c232-4309-822e-976518eeff64"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "8", ",", "0.002222789506363325`", ",", "0.9740274503050725`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.2999325231121018`", ",", "0.022069641909602075`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01564765354655617`", ",", "0.004430746163932011`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.0813341156201968`"}], ",", "0.03183802699378117`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"da5bbddc-3d27-43ce-b253-03d74ff2a3a6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.055261`6.635563314216803", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 9, " in ", 3.055261`6.635563314216803, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"1667fd84-bcf9-451d-b159-dc28ee1ada92"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "0.0024456823638999395`", ",", "0.9785334985295672`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.37249163383636963`", ",", "0.02682898323093636`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015652373945828173`", ",", "0.00434211398341392`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.10054627175381554`"}], ",", "0.03871222779988348`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"6c5055fa-7b43-4d84-8996-07d6b12e8606"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.018709`6.6303362473951815", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 10, " in ", 3.018709`6.6303362473951815, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"9a17679f-a249-48bc-a967-e6368b2452a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "0.002647895863924726`", ",", "0.9822137144367067`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.44903608946487644`", ",", "0.031730449241505886`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01565275326260643`", ",", "0.00426358453404843`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.12074590213857046`"}], ",", "0.04579708473609975`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"36d03398-e3bc-4186-87c9-1899545912b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.154864`6.649495640232245", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 11, " in ", 3.154864`6.649495640232245, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"f49c4009-b78e-40d9-9c7d-ae1a6a1bf2be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11", ",", "0.0028290479764547793`", ",", "0.9851788542255574`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.5265593543292664`", ",", "0.03660441787625656`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015641295610517202`", ",", "0.004193810307507106`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.141239271320447`"}], ",", "0.05286336618436803`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"54d82ce4-08d9-47bd-b17e-58e95510f6dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.220211`6.658399327022685", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 12, " in ", 3.220211`6.658399327022685, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"fd0bfcb1-b4f9-4a1c-90f8-a88dbf740606"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "12", ",", "0.002989981092909393`", ",", "0.987548744546147`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.6025100071089736`", ",", "0.04132939624452588`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015614496336686143`", ",", "0.004132278563445054`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.1614545595933863`"}], ",", "0.05974963998811643`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"59645e5b-cbb6-4ba3-9fa2-b8e3a4c8cc76"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "13", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.081869`6.639329172192889", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 13, " in ", 3.081869`6.639329172192889, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"c31b07d8-08d7-485b-9004-1c7ca9f85330"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "13", ",", "0.00313222540889808`", ",", "0.9894366777075427`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.6750067422183584`", ",", "0.04582133025840721`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01557150299076607`", ",", "0.0040775283350830875`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.1810066313114977`"}], ",", "0.06634527818178765`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"01e39ece-9b4f-4e81-a62f-b9cc858a5d04"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "14", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.1498870000000000001`6.648809971889303", 
   "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm[
  "Step ", 14, " in ", 3.1498870000000000001`6.648809971889303, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"41d8564e-a39c-4427-8b7f-1530d5550c7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"14", ",", "0.003257691139368238`", ",", "0.9909429116205558`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7430280071690977`", ",", "0.05005459680787277`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015511374160107505`", ",", "0.004028403788695111`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.19973604361042396`"}], ",", "0.07262062229587687`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"d91449be-a89a-471b-ac11-58b932cd966b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "15", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.126672`6.645597322291581", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 15, " in ", 3.126672`6.645597322291581, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"7e0f3b1b-a452-4378-bdf5-45dfcd23c87f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "15", ",", "0.0033685311622178695`", ",", "0.9921530319554286`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.8062149002964543`", ",", "0.054032901392527144`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015436329609887748`", ",", "0.003983933555682658`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2175876153968598`"}], ",", "0.07857641054290018`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"0a3c6cb7-0f7d-4df3-aaf2-36621ac2cc7f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "16", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.120476`6.6447358445445515", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 16, " in ", 3.120476`6.6447358445445515, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"d58e62fb-b715-42f6-a433-1f41d1c14ecc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16", ",", "0.003466721973952859`", ",", "0.9931337466317139`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.8645798534277942`", ",", "0.05778026524438669`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015348045412410482`", ",", "0.0039433233645236225`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.23458710223127135`"}], ",", "0.08424028903888407`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"1b8e61c9-d68c-46ac-8632-d26ca1b74c6c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "17", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.119441`6.644591773784351", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 17, " in ", 3.119441`6.644591773784351, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"02f9546a-6e91-4182-9fab-657423a7bf87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "17", ",", "0.0035540330235329523`", ",", "0.9939365967429012`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.9183456543004291`", ",", "0.061325694616643694`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015248995300098064`", ",", "0.003905984936646564`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.250784440845199`"}], ",", "0.08964144091478186`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"87e4f902-48fd-4a34-bfed-58260986167a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "18", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.118923`6.64451965085528", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 18, " in ", 3.118923`6.64451965085528, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"956b9b8e-bc90-4735-8291-f8c9f9a5e5dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "18", ",", "0.0036319869879719597`", ",", "0.9946005869911493`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.9678319742698047`", ",", "0.06469838470006348`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015141469294686688`", ",", "0.0038713912706246347`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2662400351953026`"}], ",", "0.09480779304594401`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"84a98d5b-0e6b-495f-b0bd-a79c9486ec33"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "19", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.130099`6.64607307163204", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 19, " in ", 3.130099`6.64607307163204, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"746f1b45-4b8c-4374-b745-dad7008e7087"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19", ",", "0.0037018622630366365`", ",", "0.995155042383003`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0134101132810165`", ",", "0.0679300148395332`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015027177308586274`", ",", "0.0038391753523526716`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2810267121578832`"}], ",", "0.09977143659825366`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"25df897a-2abb-4d88-a512-fc0bf16902b9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "20", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.1146650000000000001`6.643926340488425", 
   "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm[
  "Step ", 20, " in ", 3.1146650000000000001`6.643926340488425, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"90f36a40-f1d2-4991-98cb-e7511233584e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20", ",", "0.003764739667842865`", ",", "0.9956222859220301`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0554521990403765`", ",", "0.07105019295645403`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014907548086912173`", ",", "0.003809051635249225`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.29521425229509995`"}], ",", "0.10456223619293209`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4abc08e1-8221-460b-906a-d008a589b1f1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "gaugeField", "}"}], ",", 
    RowBox[{
     RowBox[{"<<", "\"\<../data/3-3/periodic-16-28-5.m\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trajectory", "[", "\"\<lb\>\"", "]"}], "=", 
      RowBox[{"allLinkSaddlePoint", "[", 
       RowBox[{"30", ",", 
        RowBox[{"dampingFactor", "\[Rule]", "0.05"}], ",", " ", 
        RowBox[{"printDetails", "\[Rule]", "2"}]}], "]"}]}]}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"0845a278-0f1b-40dd-8929-beb86a1ad680"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "0.000014`1.2966430335102301", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 0, " in ", 0.000014`1.2966430335102301, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"70ba1220-22a8-4bd2-b054-d10b3da195b9"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,60,7,
   31699993126491654841,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"3c732a28-fc8f-4aa6-9f08-6d7b49c41659"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "2.739167228957293`*^-15", ",", "0.9017923927961671`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.01927360959706695`", ",", "0.0018220318846420883`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015495262407023546`", ",", "0.0056077030292302835`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.005555476137363994`"}], ",", "0.002633842612476943`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ffe43670-796b-416e-805a-4d1a2e701270"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.271663`6.665283560319677", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 1, " in ", 3.271663`6.665283560319677, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"906e53b8-4918-4f27-8a16-af2b133009ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0.00014740657235397464`", ",", "0.9082488405622408`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.023974856124547243`", ",", "0.0022249321113212567`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015481346152073062`", ",", "0.005496776587323035`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.006892612194335094`"}], ",", "0.0032165581876000197`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"a531d45b-dce3-4b13-8e2d-e49479de59d0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "2.97398`6.62385304139962", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 2, " in ", 2.97398`6.62385304139962, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"6c791cf2-fbd4-4ce1-84be-f452463a3710"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "0.0002946474927583851`", ",", "0.914450461558508`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.029658106242794056`", ",", "0.0027030359399045855`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01547255848964972`", ",", "0.005393056861600864`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.008500731213792752`"}], ",", "0.003908019598455624`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"be7e8646-5b21-40e8-b226-0459e99df364"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "2.956765`6.621331806545155", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 3, " in ", 2.956765`6.621331806545155, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"ccfb8940-3d70-4a09-bdb1-0392a3f46556"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3", ",", "0.0004416228760931348`", ",", "0.920395572768294`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.03648303956057437`", ",", "0.0032667578919775802`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015468427787783377`", ",", "0.005295861208435897`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.010421558603252612`"}], ",", "0.004723251892212776`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"439ddc8c-0301-4b0f-bce5-c8c18ab9b75c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.002724`6.62803041301944", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 4, " in ", 3.002724`6.62803041301944, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"e23056d9-e9b2-420a-a471-6e5db249d69f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.0005881942686319494`", ",", "0.9260825684409099`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.04462115284161467`", ",", "0.0039265327318367`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015469434466640923`", ",", "0.005204580984715278`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.012698531219644062`"}], ",", "0.005677156433927343`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"99df24b0-a59b-4e4c-ba04-c023efc4fa3a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.028803`6.631786024616401", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 5, " in ", 3.028803`6.631786024616401, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"e6e528ff-c638-4e2c-acad-8cf87e7f9de1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "0.0007341990966411743`", ",", "0.9315101457827164`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.054256286345292476`", ",", "0.004693357716586359`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015475029036438078`", ",", "0.005118637973203815`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.015378344799357195`"}], ",", "0.006785476318744578`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"3a393e0f-e945-445a-b0c7-806262c19420"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.051027`6.634961048771389", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 6, " in ", 3.051027`6.634961048771389, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"dd35f6b3-2f1d-4904-9b05-b9390f94cea2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "0.0008794106906640857`", ",", "0.9366765694244358`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.06557701749286307`", ",", "0.005577601194675927`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015485547083694871`", ",", "0.005037691400826062`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.018507424477809953`"}], ",", "0.008062876570330625`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"1f45eacd-76bd-42c1-bc71-743def6f933b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.094202`6.641063660337459", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 7, " in ", 3.094202`6.641063660337459, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"5ef3d320-a005-41f7-9ffe-142407a1d04f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "0.0010235540218454498`", ",", "0.9415801956514546`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.07877156568434368`", ",", "0.00658857436500347`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015501534643951516`", ",", "0.004961433571704885`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.022129363200875364`"}], ",", "0.009522231140266037`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"2d7c18f9-1d9f-4a20-8bdf-cb683bc7356b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.025062`6.631249277971538", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 8, " in ", 3.025062`6.631249277971538, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"340873f0-d985-42fa-a450-1aee9a930727"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "0.0011663105880787624`", ",", "0.9462196976026624`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.09402115927093407`", ",", "0.007735283685223946`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015521414177281985`", ",", "0.0048894183371181454`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.0262877322308715`"}], ",", "0.0111762517840577`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"e71d1a31-9b14-4050-b78f-aaf91c9921ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.209902`6.657006771199816", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 9, " in ", 3.209902`6.657006771199816, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"ad0bede9-41d2-4307-aef3-bd04e0b08d8f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "0.0013073414722558404`", ",", "0.9505946217879755`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.11149386345263913`", ",", "0.009025737887247493`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01554307843353628`", ",", "0.004821097217762331`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.03102436822592171`"}], ",", "0.013036460399752106`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"f6a9aba4-f0b6-4a23-80c8-2929dd848a05"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.195728`6.655084805668538", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 10, " in ", 3.195728`6.655084805668538, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"e9aae91d-f219-4edc-bc42-3d243c3a7060"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10", ",", "0.0014462667460167166`", ",", "0.9547049617398234`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.13132602318479505`", ",", "0.010465959645223365`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015564295909983676`", ",", "0.004756087636958334`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.03637379768516612`"}], ",", "0.015111996073899686`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4aac3244-038c-4a5f-b20e-c091e459dd3f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.167078`6.651173757305088", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 11, " in ", 3.167078`6.651173757305088, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"a8dad9fd-624f-4cbd-b6f0-56b08f7e9fac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11", ",", "0.0015826606694850473`", ",", "0.9585511409357789`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.1536131967337954`", ",", "0.012058870970683252`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015583438819498616`", ",", "0.004693928869309644`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.04236352297891003`"}], ",", "0.01740761884748609`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ed42cd31-85d4-4120-88ac-b5ed2e98da5a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.09653`6.64139028975754", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 12, " in ", 3.09653`6.64139028975754, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"7e7a24df-0631-42d6-b186-5eef67ed90ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "12", ",", "0.0017160608166374397`", ",", "0.9621343115530703`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.178390564549482`", ",", "0.013801628424625685`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015601169311796491`", ",", "0.004634538794940307`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.048999184776804136`"}], ",", "0.019918786593153527`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"a42f7112-3228-4fa7-b8d9-2865df22326f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "13", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.222396`6.658693907610737", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 13, " in ", 3.222396`6.658693907610737, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"317eb4d2-ff78-485b-9d25-3a94bead9d18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "13", ",", "0.0018460502468802113`", ",", "0.9654580095082563`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.20564267191650712`", ",", "0.01569082030026626`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015615312117380613`", ",", "0.004577615642582645`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.056282557038611264`"}], ",", "0.022641897266925465`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"14f48b53-5e89-4d26-bf38-0c7b3a2f873e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "14", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.125156`6.64538669895151", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 14, " in ", 3.125156`6.64538669895151, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"d9fb4fb9-ad57-4c8b-9b63-784579475aa1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "14", ",", "0.0019722044767964235`", ",", "0.9685267539745835`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.23526525282635613`", ",", "0.017719282393263997`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015624036178416612`", ",", "0.004523367845515461`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.06419109011549351`"}], ",", "0.02556870676983088`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"b987511e-afe8-4e02-947b-af51ea9c70e3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "15", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.17695`6.652525377627672", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 15, " in ", 3.17695`6.652525377627672, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"98c3bc80-2630-4428-9235-b78f8d1a34d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15", ",", "0.002094131621129542`", ",", "0.9713468242763394`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.267080652407132`", ",", "0.019871710431822964`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01562904741272572`", ",", "0.004472038280642573`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.07267385063389836`"}], ",", "0.02867710223302279`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ac129c35-46cc-4128-8dad-3def1581f85e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "16", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.219084`6.658247307310555", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 16, " in ", 3.219084`6.658247307310555, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"d6ee9446-3d48-48a7-9250-2738b83c48aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "16", ",", "0.0022115082446299557`", ",", "0.9739267179688712`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.30084115715682025`", ",", "0.02212806568832748`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015632351172327703`", ",", "0.0044238555768387035`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.08165468957347828`"}], ",", "0.031937070007976055`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"8dfa9777-1045-4fe2-b544-b82c1c6cedea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "17", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.188143`6.654052790706033", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 17, " in ", 3.188143`6.654052790706033, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"e7b2f3d1-2c6d-4f74-89d7-462ea72d3edb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "17", ",", "0.0023240669319178064`", ",", "0.9762764954044283`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.33625135184545685`", ",", "0.024464982876318778`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01563483779699437`", ",", "0.004378574727749649`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.0910498457279865`"}], ",", "0.035314123359089046`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"5c524095-8e85-40d2-8a29-30739d608665"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "18", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.171775`6.651817369502698", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 18, " in ", 3.171775`6.651817369502698, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"730ba4a7-1dfd-4abe-ad51-37910d68a81c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "18", ",", "0.0024316291421491985`", ",", "0.9784081830636661`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.37296960419231373`", ",", "0.02685820292144399`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015636728572726626`", ",", "0.004336071658353859`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.10077050101685878`"}], ",", "0.03877324778385024`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"1301d18d-e4d0-49f9-bfab-d8795be236a6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "19", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.180916`6.653067198464615", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 19, " in ", 3.180916`6.653067198464615, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"e6c88165-a521-411e-bd55-7df468de8fec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "19", ",", "0.002534065084225735`", ",", "0.980334581758813`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.4106244464538492`", ",", "0.029283251740177756`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015637361764749128`", ",", "0.0042960146875941595`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.11072283739096808`"}], ",", "0.04227991816589132`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"a453d64e-0c00-44f9-b1b6-7be3829353ae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "20", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.152703`6.649198057848383", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 20, " in ", 3.152703`6.649198057848383, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"27611b57-b788-4ae3-be12-9127cd826540"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "20", ",", "0.0026313072888251316`", ",", "0.9820693311141476`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.44884744057508846`", ",", "0.03172052364285941`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015635060637998667`", ",", "0.004258212945767811`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.12082879351584203`"}], ",", "0.04580893260803813`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"17d00bb4-d9d4-4a6f-98a9-d6b693db94f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "21", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.134405`6.646670109269366", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 21, " in ", 3.134405`6.646670109269366, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"21cdda93-416a-4ce0-ba39-d26b40f4f494"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"21", ",", "0.002723391527166179`", ",", "0.9836274376283634`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.48727257732713936`", ",", "0.0341489255538544`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01563002241625909`", ",", "0.004222655731127146`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.13099585392970106`"}], ",", "0.049330171494281705`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"c6f27d9b-0600-46ce-8f40-4ce7452e6870"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "22", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.207319`6.656657154844906", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 22, " in ", 3.207319`6.656657154844906, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"aec5dd08-b39f-4e97-a29c-6f314ff821ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "22", ",", "0.0028104122574820504`", ",", "0.9850240161320707`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.5255821785533037`", ",", "0.03655367911911823`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015621533664040078`", ",", "0.004189272279469617`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.1411550015353604`"}], ",", "0.052824363753555426`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"8fc16867-6988-46bc-b943-6cdc88c73835"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "23", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.190915`6.65443023338789", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 23, " in ", 3.190915`6.65443023338789, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"50a193af-db4e-4c1d-8a44-d0960e94feea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "23", ",", "0.0028925116463186743`", ",", "0.9862739668507817`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.5634866873462614`", ",", "0.03892234987946505`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015608973906455817`", ",", "0.004157937542157061`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.15124493902622974`"}], ",", "0.05627577168249212`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"45ee81f5-0cc1-42e9-a058-e12f9a19428d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "24", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.229497`6.659649883279035", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 24, " in ", 3.229497`6.659649883279035, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"daae14c3-0690-449a-99be-a653ec241982"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"24", ",", "0.002969873246442758`", ",", "0.9873917363049917`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.6007379061426076`", ",", "0.04124271094590422`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015592457734589178`", ",", "0.004128438906521022`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.16121274678592643`"}], ",", "0.05966774596561307`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"e411a5ee-eb86-4a8b-a12d-73795da45e21"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "25", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.211689`6.657248482096445", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 25, " in ", 3.211689`6.657248482096445, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"5061afde-96d3-4b99-a6da-6b95d50f8c61"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "25", ",", "0.0030426987172882504`", ",", "0.9883908635693098`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.6371413449066613`", ",", "0.04350655349239431`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015571904068005286`", ",", "0.0041005819439600905`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.17102183661199716`"}], ",", "0.06298955387987996`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"550921ff-f97f-4515-a35e-e6264f53b48c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "26", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.204817`6.656318233509218", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 26, " in ", 3.204817`6.656318233509218, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"785f3ccc-1fac-4a2f-bfd0-d93905f8bfb8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"26", ",", "0.003111210391652421`", ",", "0.9892840567908959`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.6725537105970771`", ",", "0.045709707911986044`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015547176060431529`", ",", "0.004074230925410288`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.18064816203888423`"}], ",", "0.06623617360395813`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"951bd48b-6ac2-4ecd-915a-dd60931d339c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "27", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.174699`6.652217553023481", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 27, " in ", 3.174699`6.652217553023481, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"7528420a-eb65-4b7c-9523-e9880e2406af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"27", ",", "0.003175663063660076`", ",", "0.9900834053307039`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7068843307902535`", ",", "0.04785148234896309`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015518163576140314`", ",", "0.004049255930894968`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.19008033593365875`"}], ",", "0.06940723137209716`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"bbec4cab-6c9f-46a8-922c-887004bca8d2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "28", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.205564`6.656419449951563", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 28, " in ", 3.205564`6.656419449951563, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"cdf9c442-c17d-4da0-a0f6-718d1b92e0b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"28", ",", "0.003236314971472711`", ",", "0.9907998723044898`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7400696781463386`", ",", "0.0499308259604842`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015485293945038552`", ",", "0.004025543261310145`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.19930451776893504`"}], ",", "0.07250030889775638`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"654b1bd5-e2a1-449f-ba3d-f4ae6aa505ba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "29", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.253768`6.662901581493749", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 29, " in ", 3.253768`6.662901581493749, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"1b9be40a-ecc0-45c4-8a83-11e6c422904b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"29", ",", "0.003293425254688046`", ",", "0.9914433487028189`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7720913335588836`", ",", "0.05194928917527587`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015448826747940254`", ",", "0.004002958225324395`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2083199742837319`"}], ",", "0.07551703994185519`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"40d4abb0-11df-4f4e-a3ab-4f4fc9bb61de"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Step \"\>", "\[InvisibleSpace]", "30", 
   "\[InvisibleSpace]", "\<\" in \"\>", "\[InvisibleSpace]", 
   "3.221392`6.6585585736539565", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Step ", 30, " in ", 3.221392`6.6585585736539565, " seconds"],
  Editable->
   False]], "Print",ExpressionUUID->"c3cfe87b-c990-4146-acff-583a9f51ea7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", "0.003347231516843797`", ",", "0.9920223933684676`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.8029386582324268`", ",", "0.05390945585068821`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01540890845639326`", ",", "0.003981402272242433`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.21712780826200648`"}], ",", "0.07846049642440214`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"32397527-d96d-4436-a85d-7341dcdab754"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "gaugeField", "}"}], ",", 
    RowBox[{
     RowBox[{"<<", "\"\<../data/3-3/periodic-16-28-5.m\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trajectory", "[", "\"\<lc\>\"", "]"}], "=", 
      RowBox[{"allLinkSaddlePoint", "[", 
       RowBox[{"1000", ",", 
        RowBox[{"dampingFactor", "\[Rule]", "0.05"}]}], "]"}]}]}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"d90c0a49-4c69-49f2-b402-be7c2dfca2f6"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,67,8,
   31699993126491654841,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"ea201df2-1d13-4fd2-ba96-50a96ed550a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "2.739167228957293`*^-15", ",", "0.9017923927961671`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.01927360959706695`", ",", "0.0018220318846420883`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015495262407023546`", ",", "0.0056077030292302835`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.005555476137363994`"}], ",", "0.002633842612476943`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"497d9958-e9ee-41d8-b4d8-06adb6f3d0c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0.00014740657235397464`", ",", "0.9082488405622408`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.023974856124547243`", ",", "0.0022249321113212567`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015481346152073062`", ",", "0.005496776587323035`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.006892612194335094`"}], ",", "0.0032165581876000197`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"abc43c4f-3399-469c-a7da-d119704f2ae8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "0.0002946474927583851`", ",", "0.914450461558508`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.029658106242794056`", ",", "0.0027030359399045855`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01547255848964972`", ",", "0.005393056861600864`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.008500731213792752`"}], ",", "0.003908019598455624`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"264abb1d-f045-4cfa-ae92-904604822c6b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3", ",", "0.0004416228760931348`", ",", "0.920395572768294`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.03648303956057437`", ",", "0.0032667578919775802`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015468427787783377`", ",", "0.005295861208435897`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.010421558603252612`"}], ",", "0.004723251892212776`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ebb8c9a0-444b-4244-995f-f8a4866e7fa7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.0005881942686319494`", ",", "0.9260825684409099`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.04462115284161467`", ",", "0.0039265327318367`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015469434466640923`", ",", "0.005204580984715278`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.012698531219644062`"}], ",", "0.005677156433927343`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"466b4f81-b438-4708-9fef-65e85865f939"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "0.0007341990966411743`", ",", "0.9315101457827164`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.054256286345292476`", ",", "0.004693357716586359`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015475029036438078`", ",", "0.005118637973203815`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.015378344799357195`"}], ",", "0.006785476318744578`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"3a6caaa5-b732-4f17-b396-9fde2dd489c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "0.0008794106906640857`", ",", "0.9366765694244358`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.06557701749286307`", ",", "0.005577601194675927`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015485547083694871`", ",", "0.005037691400826062`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.018507424477809953`"}], ",", "0.008062876570330625`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"af333937-66aa-4c1a-afcc-feae42de47f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "0.0010235540218454498`", ",", "0.9415801956514546`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.07877156568434368`", ",", "0.00658857436500347`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015501534643951516`", ",", "0.004961433571704885`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.022129363200875364`"}], ",", "0.009522231140266037`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"5463f04a-ad95-48bf-b43e-d633f820ef8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "0.0011663105880787624`", ",", "0.9462196976026624`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.09402115927093407`", ",", "0.007735283685223946`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015521414177281985`", ",", "0.0048894183371181454`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.0262877322308715`"}], ",", "0.0111762517840577`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"8d2d78ce-1964-4b4a-a187-19eb9d248a0d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "0.0013073414722558404`", ",", "0.9505946217879755`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.11149386345263913`", ",", "0.009025737887247493`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01554307843353628`", ",", "0.004821097217762331`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.03102436822592171`"}], ",", "0.013036460399752106`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4a266288-0ab2-431c-827f-c064dc91b772"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10", ",", "0.0014462667460167166`", ",", "0.9547049617398234`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.13132602318479505`", ",", "0.010465959645223365`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015564295909983676`", ",", "0.004756087636958334`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.03637379768516612`"}], ",", "0.015111996073899686`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"143d3f2b-f3b9-4c89-94c4-bf33415629d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11", ",", "0.0015826606694850473`", ",", "0.9585511409357789`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.1536131967337954`", ",", "0.012058870970683252`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015583438819498616`", ",", "0.004693928869309644`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.04236352297891003`"}], ",", "0.01740761884748609`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"0400f0eb-8779-4fde-9658-cebc3ec3af70"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "12", ",", "0.0017160608166374397`", ",", "0.9621343115530703`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.178390564549482`", ",", "0.013801628424625685`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015601169311796491`", ",", "0.004634538794940307`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.048999184776804136`"}], ",", "0.019918786593153527`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"013a56b9-5c3e-400d-948c-cdde02a1f75d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "13", ",", "0.0018460502468802113`", ",", "0.9654580095082563`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.20564267191650712`", ",", "0.01569082030026626`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015615312117380613`", ",", "0.004577615642582645`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.056282557038611264`"}], ",", "0.022641897266925465`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"5338a764-088a-4ac9-8bf6-464bc7d17951"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "14", ",", "0.0019722044767964235`", ",", "0.9685267539745835`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.23526525282635613`", ",", "0.017719282393263997`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015624036178416612`", ",", "0.004523367845515461`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.06419109011549351`"}], ",", "0.02556870676983088`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ba89c5c7-0302-45a6-a749-fc411c6420d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15", ",", "0.002094131621129542`", ",", "0.9713468242763394`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.267080652407132`", ",", "0.019871710431822964`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01562904741272572`", ",", "0.004472038280642573`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.07267385063389836`"}], ",", "0.02867710223302279`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"09042ad3-7f3f-49c8-b605-54273e793c02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "16", ",", "0.0022115082446299557`", ",", "0.9739267179688712`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.30084115715682025`", ",", "0.02212806568832748`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015632351172327703`", ",", "0.0044238555768387035`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.08165468957347828`"}], ",", "0.031937070007976055`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"5033efdc-4508-4a38-9b5d-28af1bf5ca3f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "17", ",", "0.0023240669319178064`", ",", "0.9762764954044283`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.33625135184545685`", ",", "0.024464982876318778`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01563483779699437`", ",", "0.004378574727749649`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.0910498457279865`"}], ",", "0.035314123359089046`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"58f8e548-3391-4949-b442-7e2df08b66c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "18", ",", "0.0024316291421491985`", ",", "0.9784081830636661`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.37296960419231373`", ",", "0.02685820292144399`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015636728572726626`", ",", "0.004336071658353859`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.10077050101685878`"}], ",", "0.03877324778385024`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"39819097-aec0-4dec-b71a-63fd7d33008d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "19", ",", "0.002534065084225735`", ",", "0.980334581758813`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.4106244464538492`", ",", "0.029283251740177756`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015637361764749128`", ",", "0.0042960146875941595`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.11072283739096808`"}], ",", "0.04227991816589132`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"aaddb70f-2b9d-4526-80ca-695b00292831"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "20", ",", "0.0026313072888251316`", ",", "0.9820693311141476`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.44884744057508846`", ",", "0.03172052364285941`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015635060637998667`", ",", "0.004258212945767811`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.12082879351584203`"}], ",", "0.04580893260803813`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"784b2896-7dd9-4fa2-85f4-b9fa11ff837f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"21", ",", "0.002723391527166179`", ",", "0.9836274376283634`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.48727257732713936`", ",", "0.0341489255538544`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01563002241625909`", ",", "0.004222655731127146`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.13099585392970106`"}], ",", "0.049330171494281705`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"fc90ae23-3ee1-4906-a077-9a8632e43368"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "22", ",", "0.0028104122574820504`", ",", "0.9850240161320707`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.5255821785533037`", ",", "0.03655367911911823`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015621533664040078`", ",", "0.004189272279469617`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.1411550015353604`"}], ",", "0.052824363753555426`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"a2088383-f77c-47db-93ee-a94bdffabff1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "23", ",", "0.0028925116463186743`", ",", "0.9862739668507817`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.5634866873462614`", ",", "0.03892234987946505`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015608973906455817`", ",", "0.004157937542157061`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.15124493902622974`"}], ",", "0.05627577168249212`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"6f9b811b-1d0f-4570-b6ae-a07b3d90120f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"24", ",", "0.002969873246442758`", ",", "0.9873917363049917`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.6007379061426076`", ",", "0.04124271094590422`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015592457734589178`", ",", "0.004128438906521022`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.16121274678592643`"}], ",", "0.05966774596561307`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4c7a6231-7710-4b7b-95ab-5eef0ddb709d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "25", ",", "0.0030426987172882504`", ",", "0.9883908635693098`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.6371413449066613`", ",", "0.04350655349239431`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015571904068005286`", ",", "0.0041005819439600905`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.17102183661199716`"}], ",", "0.06298955387987996`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4f8f7639-696c-4e69-9119-c4b190fcb186"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"26", ",", "0.003111210391652421`", ",", "0.9892840567908959`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.6725537105970771`", ",", "0.045709707911986044`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015547176060431529`", ",", "0.004074230925410288`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.18064816203888423`"}], ",", "0.06623617360395813`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4dc5f72b-2cb0-42fb-b9d9-164c3d53b29e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"27", ",", "0.003175663063660076`", ",", "0.9900834053307039`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7068843307902535`", ",", "0.04785148234896309`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015518163576140314`", ",", "0.004049255930894968`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.19008033593365875`"}], ",", "0.06940723137209716`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"a2d5347a-bb4e-4e34-a41c-0698ae77bf14"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"28", ",", "0.003236314971472711`", ",", "0.9907998723044898`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7400696781463386`", ",", "0.0499308259604842`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015485293945038552`", ",", "0.004025543261310145`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.19930451776893504`"}], ",", "0.07250030889775638`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"b54ed54b-f0a5-48f2-afae-384c83a75491"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"29", ",", "0.003293425254688046`", ",", "0.9914433487028189`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.7720913335588836`", ",", "0.05194928917527587`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015448826747940254`", ",", "0.004002958225324395`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2083199742837319`"}], ",", "0.07551703994185519`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"64e01e0a-f41b-4164-a4f9-a1532e88a7b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", "0.003347231516843797`", ",", "0.9920223933684676`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.8029386582324268`", ",", "0.05390945585068821`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01540890845639326`", ",", "0.003981402272242433`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.21712780826200648`"}], ",", "0.07846049642440214`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"bc19643e-7ddb-415f-a452-4d5b7131ecae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"31", ",", "0.003397957608430987`", ",", "0.9925445309034356`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.8326128298722569`", ",", "0.05581389359195745`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015365818609698904`", ",", "0.003960795939984446`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2257290677773553`"}], ",", "0.08133311900853885`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"86da6eb2-3da0-48b8-93fd-509a484ab0e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "32", ",", "0.0034458202463477396`", ",", "0.9930164696385149`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.8611347476172414`", ",", "0.0576658433366803`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015319871477433649`", ",", "0.003941064511756477`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.23412859284450602`"}], ",", "0.08413806616762762`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"77859a6d-810b-45d3-8909-309f1402586b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"33", ",", "0.0034910247625383546`", ",", "0.993444115203354`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.8885364478845993`", ",", "0.05946893164882952`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015271352892912298`", ",", "0.003922135394442739`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.24233317858082157`"}], ",", "0.08687895378663352`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"fc5cebb7-a892-4cb2-b25d-cf4d134aecbf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "34", ",", "0.003533758054892166`", ",", "0.993832552915551`", ",", 
   RowBox[{"{", 
    RowBox[{
    "norm", ",", "0.9148517298571213`", ",", "0.061226442427543416`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01522055300849304`", ",", "0.003903939444620681`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2503490052288856`"}], ",", "0.08955879702452277`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"f493273d-96a4-497d-84a5-58befd2b3e9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "35", ",", "0.0035741917493354474`", ",", "0.9941861990372194`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.9401172557504506`", ",", "0.06294171102073676`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015167731627457305`", ",", "0.0038864179066506284`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.25818249184422154`"}], ",", "0.0921806633111603`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"f6302771-764c-4d6b-a173-23672a9c8cf6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "36", ",", "0.0036124839779961525`", ",", "0.9945089040184568`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.9643756941538731`", ",", "0.06461850921894634`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.015113105620252776`", ",", "0.003869525170378131`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.26584182065200507`"}], ",", "0.09474832293203388`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"327ce3fd-bdb6-4273-aa62-c8d63926380a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"37", ",", "0.0036487808756762758`", ",", "0.994804037495575`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "0.9876731199117444`", ",", "0.06626091192978385`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01505683643420954`", ",", "0.0038532199862680483`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.27333683256829694`"}], ",", "0.09726610642610048`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"48bbcc1c-e809-4a82-a15c-e43d1087aec7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "38", ",", "0.0036832172306282846`", ",", "0.9950745481587014`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0100530535479628`", ",", "0.06787243943851017`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014999111707833433`", ",", "0.003837465872192522`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.280675346285661`"}], ",", "0.09973748471864231`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"40998396-f7f2-4139-bc84-a3200374c6af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"39", ",", "0.003715917280656237`", ",", "0.9953230208988577`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0315586906536893`", ",", "0.06945647864750888`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014940099817616966`", ",", "0.0038222295192594127`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.2878651406544179`"}], ",", "0.1021658059769118`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"ba05f074-fe2c-4372-9ecc-e1d8743667b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"40", ",", "0.0037469959557776067`", ",", "0.995551730725027`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0522325788108176`", ",", "0.07101631502060192`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014879944511650886`", ",", "0.0038074792184853703`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.294914143679542`"}], ",", "0.10455436248429101`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"c52ddef5-f0b8-449c-9e19-c1ce96ceb764"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"41", ",", "0.003776559241774695`", ",", "0.9957626780819792`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0721160418060585`", ",", "0.07255505064417579`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01481877848997323`", ",", "0.0037931862780646976`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3018299495575328`"}], ",", "0.10690625312683444`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"6e73e0c5-a324-4b90-a04f-25200f43e840"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"42", ",", "0.003804704962308579`", ",", "0.9959576261155868`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.0912489671600403`", ",", "0.07407560068739431`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014756724200342778`", ",", "0.0037793246583629958`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.30861979274623297`"}], ",", "0.10922438464379529`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"f3822a6c-b64f-4bb3-be8e-0eea0934fabf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "43", ",", "0.0038315234868167743`", ",", "0.9961381323722216`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.1096696635230827`", ",", "0.07558069399809098`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014693894498121418`", ",", "0.0037658706552221766`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3152905364147157`"}], ",", "0.11151147694028203`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"373fad74-7c96-4aac-8dec-465d63b57887"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"44", ",", "0.003857098371463131`", ",", "0.9963055758342563`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.1274147658915268`", ",", "0.07707287155129983`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014630393799481967`", ",", "0.0037528026474945176`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3218486539275696`"}], ",", "0.11377006289959773`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"34e2fdb2-c6dd-406d-82d5-7b2dc8d07254"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"45", ",", "0.003881506939758105`", ",", "0.9964611800366043`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.144519199481824`", ",", "0.07855449786732643`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014566317919245538`", ",", "0.0037401008322839914`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3283002547095964`"}], ",", "0.11600250714481107`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"64650737-8274-4e8a-88e6-ebae8902f359"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "46", ",", "0.0039048208088431884`", ",", "0.9966060328814796`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.1610161576020128`", ",", "0.08002776015420347`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014501755439722973`", ",", "0.0037277470511350606`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.33465106878269835`"}], ",", "0.11821100385048747`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"f387fc83-6da5-4953-af5a-a5576676e9b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"47", ",", "0.0039271063668475745`", ",", "0.996741103663991`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.1769371179256796`", ",", "0.08149467773841026`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014436787964892056`", ",", "0.003715724602659252`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.340906466447814`"}], ",", "0.12039758985942839`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"adf7616a-bffd-4f73-ac04-4592ccb29ba9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"48", ",", "0.003948425206184031`", ",", "0.9968672577356261`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.1923118741511318`", ",", "0.08295710912432479`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01437149068853546`", ",", "0.003704018089752483`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.34707147039324787`"}], ",", "0.1225641531283209`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"111961c1-b96b-4e4d-af0b-336cd9b2b3e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"49", ",", "0.003968834517156362`", ",", "0.9969852691623602`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.2071685820406461`", ",", "0.08441675973539763`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014305932892609875`", ",", "0.0036926132855156545`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3531507703819806`"}], ",", "0.1247124415929862`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"fe6cfe63-33ab-4de4-85db-a4835cdaa7e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "50", ",", "0.003988387445802098`", ",", "0.997095831676047`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.2215338158128637`", ",", "0.08587518996852064`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.01424017839977921`", ",", "0.00368149701512958`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3591487393630426`"}], ",", "0.126844072020289`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"0a09c7da-f35f-4976-bd8d-6143dda1dcbc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"51", ",", "0.004007133419489025`", ",", "0.9971995681699504`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.235432631519315`", ",", "0.08733382333377084`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014174285990472966`", ",", "0.0036706570518566036`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.36506945022425574`"}], ",", "0.12896053862397286`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"4d994680-d3a7-4bb6-a1be-584aaeb1d264"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"52", ",", "0.004025118443420019`", ",", "0.9972970389493988`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.24888863485867`", ",", "0.08879395455844212`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014108309786989588`", ",", "0.0036600820252505784`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.3709166927813107`"}], ",", "0.13106322136668247`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"3aefde0f-0c4f-4ee0-ae12-aa275d599e2a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"53", ",", "0.004042385370874094`", ",", "0.9973887489157036`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.2619240514337948`", ",", "0.09025675756287493`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.014042299607107995`", ",", "0.003649761339947149`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.37669399069470927`"}], ",", "0.13315339389612058`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"837dbf24-56ee-40d3-a886-7e535aef23ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"54", ",", "0.004058974149719246`", ",", "0.9974751538339264`", ",", 
   RowBox[{"{", 
    RowBox[{"norm", ",", "1.2745597979045136`", ",", "0.0917232932384246`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "a2sigma", ",", "0.013976301289571573`", ",", "0.0036396851036510705`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"-", "0.38240461808354254`"}], ",", "0.13523223108308305`"}], 
    "}"}]}], "}"}]], \
"Print",ExpressionUUID->"0702a45d-d78e-4cae-8727-f4956888ea36"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate normal trajectory and save in file", \
"Subsubsection",ExpressionUUID->"067fa35f-5347-4dc2-90fc-2442160c00ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"label_", ",", "n_", ",", 
    RowBox[{"fixed_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "gaugeField", ",", "tallyData", ",", "ff", ",", "gaugeField0", ",", 
      "distance"}], "}"}], ",", 
    RowBox[{
     RowBox[{"<<", "\"\<../data/3-3/periodic-16-28-5.m\>\""}], ";", 
     RowBox[{"distance", "=", 
      RowBox[{"latticeDistanceFrom", "[", "gaugeField", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trajectory", "[", "label", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Starting \>\"", ",", " ", "i"}], "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"Get", "[", 
             RowBox[{
             "\"\<../data/3-3/step-16-28-5-\>\"", "<>", "label", "<>", 
              "\"\<-\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.m\>\""}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"gaugeField", "=", "gaugeField0"}]}]}], "]"}], ";", 
         RowBox[{"tallyData", "=", 
          RowBox[{"talliesToAverageErrors", "[", 
           RowBox[{"polyakovLoopTallies", "[", "\"\<smeared\>\"", "]"}], 
           "]"}]}], ";", 
         RowBox[{"ff", "=", 
          RowBox[{"exponentialModel", "[", "tallyData", "]"}]}], ";", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"distance", "[", "gaugeField", "]"}], ",", 
             RowBox[{"averagePlaquette", "[", "]"}]}], "}"}], ",", 
           RowBox[{"Inner", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "#2"}], "}"}], "&"}], 
             ",", 
             RowBox[{"ff", "[", "\"\<BestFitParameters\>\"", "]"}], ",", 
             RowBox[{"ff", "[", "\"\<ParameterErrors\>\"", "]"}], ",", 
             "List"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"fc7c8716-57dc-4020-9e3c-fb3a9c83dd11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "trajectory", "]"}], ";", 
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<a\>\"", ",", "4"}], "]"}], ";", 
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<b\>\"", ",", "4"}], "]"}], ";", 
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<c\>\"", ",", "4"}], "]"}], ";", 
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<d\>\"", ",", "4"}], "]"}], ";", 
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<e\>\"", ",", "10"}], "]"}], ";", 
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<f\>\"", ",", "10"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"b0c3d8ad-9720-4523-a563-ef1b9e8e1c7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<g\>\"", ",", "10"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"39186671-5579-42ad-85f3-e764aafe3563"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["Starting ", 0],
  Editable->
   False]], "Print",ExpressionUUID->"8635fbf4-92be-425f-892f-4f1e42d0c269"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,15,2,
   31698577899915106467,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"582d9479-767c-4a44-8c74-9b65344ae44e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Starting ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"306bf5db-61db-4902-a594-a5f46c56417d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Starting ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"1cb6f65c-3993-4c59-8fbf-97c2d447c8e3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Starting ", 3],
  Editable->
   False]], "Print",ExpressionUUID->"1a80943d-76a9-40f7-b5cd-cb1938548260"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Starting ", 4],
  Editable->
   False]], "Print",ExpressionUUID->"058d4c68-38ac-4aeb-b5d5-4d4402e92f3f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Starting ", 5],
  Editable->
   False]], "Print",ExpressionUUID->"1de681c6-5719-47fd-8ce1-19318464f389"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["Starting ", 6],
  Editable->
   False]], "Print",ExpressionUUID->"e1ceca52-028f-4e1a-a726-f12192fdb761"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["Starting ", 7],
  Editable->
   False]], "Print",ExpressionUUID->"80a983c9-545b-4515-9ab4-c3dc94dc095c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Starting ", 8],
  Editable->
   False]], "Print",ExpressionUUID->"8ae76b10-8de0-4de0-8b89-737085fa0967"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Starting ", 9],
  Editable->
   False]], "Print",ExpressionUUID->"24690662-93fa-4326-83a1-0a2effc3c9da"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["Starting ", 10],
  Editable->
   False]], "Print",ExpressionUUID->"76234161-47ee-4451-ad0a-aeef1c41500c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<h\>\"", ",", "22"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"02a8a5b8-9b6e-4e21-8e7d-c4750f8509d4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["Starting ", 0],
  Editable->
   False]], "Print",ExpressionUUID->"ff206196-bb51-4fba-bbac-597c0d36434e"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,13,1,
   31699166630720289778,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"0c6c26bc-675e-4489-9ca1-6e77aa5bb99d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Starting ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"92fa5363-8bcc-4a99-8f73-67fc62e828e1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Starting ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"9faa5431-b087-4622-bd36-b3369fcf437c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Starting ", 3],
  Editable->
   False]], "Print",ExpressionUUID->"69ecd02f-a482-4951-8dd0-e829da8bb769"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Starting ", 4],
  Editable->
   False]], "Print",ExpressionUUID->"01dc5374-c868-49f5-b876-2577b6ec2c31"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Starting ", 5],
  Editable->
   False]], "Print",ExpressionUUID->"1c11453e-d3f5-4bc4-b4ce-144b62e78d0d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["Starting ", 6],
  Editable->
   False]], "Print",ExpressionUUID->"b702991b-fb9d-48cc-8ea8-06bb80053c8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["Starting ", 7],
  Editable->
   False]], "Print",ExpressionUUID->"6a027202-1b02-407c-acf1-44ceb89b27b5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Starting ", 8],
  Editable->
   False]], "Print",ExpressionUUID->"4a87ae8d-3913-4d4a-8ac7-75b7611209a7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Starting ", 9],
  Editable->
   False]], "Print",ExpressionUUID->"a6be265d-f6f4-4d41-84c2-c5babace6258"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["Starting ", 10],
  Editable->
   False]], "Print",ExpressionUUID->"fd2c3757-e1df-470e-8d67-fb6e88a488c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "11"}],
  SequenceForm["Starting ", 11],
  Editable->
   False]], "Print",ExpressionUUID->"b532ccc2-4ca7-4a11-9095-bfacb96c9651"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "12"}],
  SequenceForm["Starting ", 12],
  Editable->
   False]], "Print",ExpressionUUID->"76c76125-f6d6-4945-9b11-8e5844127920"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "13"}],
  SequenceForm["Starting ", 13],
  Editable->
   False]], "Print",ExpressionUUID->"1d8ba2f0-fb3b-48b4-a89e-ace4b82e3961"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "14"}],
  SequenceForm["Starting ", 14],
  Editable->
   False]], "Print",ExpressionUUID->"9bd9290c-2366-49eb-90a0-e3929d2dbf1f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "15"}],
  SequenceForm["Starting ", 15],
  Editable->
   False]], "Print",ExpressionUUID->"271f4f93-59c8-486a-bc6f-1aea58a830f7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "16"}],
  SequenceForm["Starting ", 16],
  Editable->
   False]], "Print",ExpressionUUID->"4d6b1f2e-7dda-43a8-a4c0-1a81439c0687"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "17"}],
  SequenceForm["Starting ", 17],
  Editable->
   False]], "Print",ExpressionUUID->"b911b357-46b4-407a-a811-d2f0a67d9910"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "18"}],
  SequenceForm["Starting ", 18],
  Editable->
   False]], "Print",ExpressionUUID->"4c07bad6-de2b-49d0-8e59-8d8a5a1b2f2c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "19"}],
  SequenceForm["Starting ", 19],
  Editable->
   False]], "Print",ExpressionUUID->"a8ca4714-5bc4-45f4-b7f6-03565b6f7763"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["Starting ", 20],
  Editable->
   False]], "Print",ExpressionUUID->"f51bae62-a3c7-466d-8bc9-084c806d5adf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "21"}],
  SequenceForm["Starting ", 21],
  Editable->
   False]], "Print",ExpressionUUID->"10bfe275-a3d8-4784-83f2-979920a8f9e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "22"}],
  SequenceForm["Starting ", 22],
  Editable->
   False]], "Print",ExpressionUUID->"05953a61-45a3-4cf1-ae4f-a34040e2e508"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"makeTrajectory", "[", 
   RowBox[{"\"\<i\>\"", ",", "26"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"fb8773a4-00af-47e9-86e4-ebbd6820e9b1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["Starting ", 0],
  Editable->
   False]], "Print",ExpressionUUID->"7c9d4840-974a-438a-802f-d197f3c8a77a"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,14,1,
   31698577899915106467,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"983c6276-6f1b-4889-95e8-723c2e40fcff"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Starting ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"8867fac3-72bc-43de-9bbe-fb0fdf0a52f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Starting ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"41a84b0c-b4c8-45ac-b9c1-249bdd270c9a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Starting ", 3],
  Editable->
   False]], "Print",ExpressionUUID->"6872fa31-c6b1-4469-a46f-ef5388cab1f1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Starting ", 4],
  Editable->
   False]], "Print",ExpressionUUID->"3f586f40-b5c1-4fe8-a7e0-02558394dd70"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Starting ", 5],
  Editable->
   False]], "Print",ExpressionUUID->"a15674ac-7c00-4122-a8ed-a9a9f6096481"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["Starting ", 6],
  Editable->
   False]], "Print",ExpressionUUID->"b78376a9-909c-4582-8152-0c72a604d8ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["Starting ", 7],
  Editable->
   False]], "Print",ExpressionUUID->"9834fc35-e7a3-421e-a721-ec07036597cb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Starting ", 8],
  Editable->
   False]], "Print",ExpressionUUID->"098c60b8-ce5d-4de0-b9ca-841877c6e30a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Starting ", 9],
  Editable->
   False]], "Print",ExpressionUUID->"203e736f-dff5-4cbf-8cec-982259602c79"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["Starting ", 10],
  Editable->
   False]], "Print",ExpressionUUID->"0767fb58-6d6f-4b1c-b17f-4045eaef7cba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "11"}],
  SequenceForm["Starting ", 11],
  Editable->
   False]], "Print",ExpressionUUID->"a211b2bb-2c4d-4dc1-8380-37a76a21a3f6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "12"}],
  SequenceForm["Starting ", 12],
  Editable->
   False]], "Print",ExpressionUUID->"6554bc86-044a-4ddf-a5e7-7ad6ee2e7646"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "13"}],
  SequenceForm["Starting ", 13],
  Editable->
   False]], "Print",ExpressionUUID->"94f7a2a0-2c19-41a3-929d-0ae8b1173872"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "14"}],
  SequenceForm["Starting ", 14],
  Editable->
   False]], "Print",ExpressionUUID->"1528d56f-25aa-4024-ab89-ccc6c89dfed0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "15"}],
  SequenceForm["Starting ", 15],
  Editable->
   False]], "Print",ExpressionUUID->"43d5aeab-13cf-4daf-935f-0bf351feb63d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "16"}],
  SequenceForm["Starting ", 16],
  Editable->
   False]], "Print",ExpressionUUID->"455cb817-1ac4-43de-8b44-612ba1a5424f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "17"}],
  SequenceForm["Starting ", 17],
  Editable->
   False]], "Print",ExpressionUUID->"fe669c66-8eba-44a5-b846-3ed173c61de2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "18"}],
  SequenceForm["Starting ", 18],
  Editable->
   False]], "Print",ExpressionUUID->"8dabc805-0ff3-441b-8221-8146408291cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "19"}],
  SequenceForm["Starting ", 19],
  Editable->
   False]], "Print",ExpressionUUID->"9bbd7f25-f6b2-41cf-83e7-e90e248da3f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["Starting ", 20],
  Editable->
   False]], "Print",ExpressionUUID->"6b5024a7-2471-4f38-9742-71ef1f457988"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "21"}],
  SequenceForm["Starting ", 21],
  Editable->
   False]], "Print",ExpressionUUID->"f10c0303-db13-4f02-ba84-78902ee5dc20"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "22"}],
  SequenceForm["Starting ", 22],
  Editable->
   False]], "Print",ExpressionUUID->"78e82619-54c4-4243-b448-fd8169930413"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "23"}],
  SequenceForm["Starting ", 23],
  Editable->
   False]], "Print",ExpressionUUID->"0f35aa5a-4c8e-4736-b977-509fc85735bd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "24"}],
  SequenceForm["Starting ", 24],
  Editable->
   False]], "Print",ExpressionUUID->"d0c869b1-c808-44b7-96b3-db4411d596e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "25"}],
  SequenceForm["Starting ", 25],
  Editable->
   False]], "Print",ExpressionUUID->"31df35a8-2e1d-4592-8f4c-e4b82cd81702"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting \"\>", "\[InvisibleSpace]", "26"}],
  SequenceForm["Starting ", 26],
  Editable->
   False]], "Print",ExpressionUUID->"a35cea0f-7492-414d-b739-a1e0d28a3d8a"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", "=", "\"\<../data/3-3/trajectory-16-28-5.m\>\""}], "}"}], 
   ",", 
   RowBox[{
    RowBox[{"DeleteFile", "[", "f", "]"}], ";", 
    RowBox[{"Save", "[", 
     RowBox[{"f", ",", "trajectory"}], "]"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"6b48b707-a48f-4857-a221-a2b7aeb74f0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot", \
"Subsubsection",ExpressionUUID->"1fa80b69-72eb-4547-becb-28dee01ad14b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/trajectory-16-28-5.m\>\""}], 
  ";"}]], "Input",ExpressionUUID->"dfb1513e-dfb2-4b8b-a87f-988c374bdcee"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"trajectory", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", "\"\<d\>\"", ",", 
       "\"\<e\>\"", ",", "\"\<f\>\"", ",", "\"\<g\>\"", ",", " ", "\"\<h\>\"",
        ",", "\"\<i\>\"", ",", "\"\<la\>\"", ",", "\"\<lb\>\""}], "}"}]}], 
    "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "False"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", "1"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"ColorData", "[", "1", "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<disance\>\"", ",", "\"\<avg. plaquette\>\""}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}]}], 
  "]"}]], "Input",ExpressionUUID->"869bd7da-d9ce-472a-95c8-740b446c2bff"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", "2"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"trajectory", "[", "#", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "2"}], "]"}], "]"}], ">", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "3"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
       "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", "\"\<d\>\"", ",", 
       "\"\<e\>\"", ",", "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<h\>\"", 
       ",", "\"\<i\>\"", ",", "\"\<la\>\"", ",", "\"\<lb\>\""}], "}"}]}], 
    "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "False"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"ColorData", "[", "1", "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<disance\>\"", ",", "\"\<string tension\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}]}], 
  "]"}]], "Input",ExpressionUUID->"8ffdf0f1-298c-45ca-b220-ea94cc21e42f"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"maxTension", "=", "0.05"}], ",", "graphTrajectory"}], "}"}], 
   ",", "\n", 
   RowBox[{
    RowBox[{"graphTrajectory", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"label", ",", "index"}], "}"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "3"}], "]"}], "]"}]}], ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"maxTension", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                  "0"}], "]"}]}], "}"}], "&"}], ",", 
             RowBox[{"trajectory", "[", "label", "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ColorData", "[", "1", "]"}], "[", 
            RowBox[{"First", "[", "index", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.05", "]"}], ",", 
             RowBox[{"EdgeForm", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "[", "0.0015", "]"}], ",", 
                RowBox[{
                 RowBox[{"ColorData", "[", "1", "]"}], "[", 
                 RowBox[{"First", "[", "index", "]"}], "]"}]}], "}"}], "]"}], 
             ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Polygon", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], ",", 
                    "0"}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Line", "[", "x", "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"label", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", "0"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "}"}]}], 
        "]"}]}], "]"}]}], ";", "\n", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"MapIndexed", "[", 
       RowBox[{"graphTrajectory", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", "\"\<d\>\"", 
          ",", "\"\<e\>\"", ",", "\"\<f\>\"", ",", "\"\<g\>\"", ",", 
          "\"\<h\>\"", ",", "\"\<i\>\"", ",", "\"\<la\>\"", ",", 
          "\"\<lb\>\""}], "}"}]}], "]"}], ",", 
      RowBox[{"BoxRatios", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0.5"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "maxTension"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<distance\>\"", ",", "\"\<avg. plaquette\>\"", ",", " ", 
         "\"\<tension\>\""}], "}"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"If", "[", 
        RowBox[{"False", ",", "journalStyle", ",", 
         RowBox[{"{", 
          RowBox[{"FontSize", "\[Rule]", "14"}], "}"}]}], "]"}]}]}], 
     "]"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"038f9ba7-5559-44f7-a18b-08b73225300d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattice stationary point", \
"Section",ExpressionUUID->"61a1c75a-0614-448a-a52c-d8d957505390"],

Cell[CellGroupData[{

Cell["Trivial lattice", \
"Subsection",ExpressionUUID->"2fabcbdc-580e-402a-85cb-f4fa5d0892b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "5"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeTrivialLattice", "[", 
   RowBox[{"randomGauge", "\[Rule]", "True"}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"739e85c4-b726-4eed-a384-4b665563a88c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "->", "0"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"efcf3bc0-e184-4d44-85b4-46e3670ebc9a"],

Cell["\<\
Symmetries of the lattice action.   Gauge fixing removes one dimension worth. \
 Difference is 9 for SU(2), 24 for SU(3), 45 for SU(4), 72 for SU(5), \
independent of the size of the lattice.  In general, the difference is 3 \
(nc^2-1).

Also, all curvatures are negative, indicating that this a a local minimum of \
the action, since the action is 1-Re(Tr(plaquettte))/Nc.

The result is independent of gauge choice.\
\>", "Text",ExpressionUUID->"dd7a8878-8dac-410c-aa06-5f21a7ed2e89"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"proj0", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"proj0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "nd"}]}], 
  "}"}]], "Input",ExpressionUUID->"40aeb51c-410f-4668-9040-ab24bd7e2523"],

Cell["Zero curvature would indicate a gauge symmetry.  ", \
"Text",ExpressionUUID->"5af70cb0-f758-440c-9ae6-b6a824d97aeb"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Rationalize", "[", 
   RowBox[{"Chop", "[", "pairs0", "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"57e0138a-4347-4e25-bce7-1525258cd9f8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare different strategies.", \
"Subsection",ExpressionUUID->"f09fe3a3-3c1f-450f-9d4d-999ebac13ec1"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"1c021071-8d2c-4753-8598-b40dd16e21b1"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"2d348138-07c5-44d6-a83f-01ff3b46f7dd"],

Cell[BoxData[
 RowBox[{"cutoff", "=", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"Pi", " ", 
     RowBox[{".01", "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "3"}], ")"}]}]}], ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"averagePlaquette", "[", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"fc90fa43-2da6-4a7f-be1b-7cd54f8ac457"],

Cell["Find fraction of shift that is non-gauge transformation.", \
"Text",ExpressionUUID->"e9ce60aa-441d-4899-8356-1902b7f2ae9c"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"dynamicShifts", "=", 
   RowBox[{"NullSpace", "[", 
    RowBox[{"gp", "=", 
     RowBox[{"gaugeTransformShifts", "[", 
      RowBox[{"makeRootLattice", "[", "]"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"7150bd61-7bcf-4771-b277-66bda357687c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAll", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], ";", 
  RowBox[{"pairsAll", "=", "pairs0"}], ";", 
  RowBox[{"ooprojAll", "=", 
   RowBox[{"oo0", ".", "proj0"}]}], 
  ";"}]], "Input",ExpressionUUID->"3cf869a5-ad91-4ac6-9351-a58d591d8188"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
     RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", "grad0", 
  "]"}]], "Input",ExpressionUUID->"aaff5bde-219a-46e7-a5f1-b81f2e02a9d2"],

Cell["\<\
On lattices with more than one link in each direction, the diagonal is zero.  \
But off-diagonal elements are non-zero since the quadratic expansion violates \
gauge invariance.\
\>", "Text",ExpressionUUID->"63c157ed-8231-4995-a8fd-11f647769f2e"],

Cell[BoxData[
 RowBox[{"Tr", "[", 
  RowBox[{"gp", ".", "hess0", ".", 
   RowBox[{"Transpose", "[", "gp", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"63d7c4b0-1cd9-43e9-9572-dc71b2fe3068"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamic", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], ";", 
  RowBox[{"pairsDynamic", "=", "pairs0"}], ";", 
  RowBox[{"ooprojDynamic", "=", 
   RowBox[{"oo0", ".", "proj0"}]}], 
  ";"}]], "Input",ExpressionUUID->"86d74fe7-1adc-4eb5-afb1-41947b59bef0"],

Cell["Map to the shift on the full lattice:", \
"Text",ExpressionUUID->"dd874f12-c1ab-454e-975a-871f80814120"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ffdd", "=", "2"}], ";", 
  RowBox[{"Dimensions", "[", 
   RowBox[{"axialProj", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"proj", "=", 
         RowBox[{"Association", "[", "]"}]}], ",", "i", ",", "j"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"coords", "=", 
             RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"proj", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"coords2grad", "[", "ffdd", "]"}], "[", 
                RowBox[{"dir", ",", "coords", ",", "k"}], "]"}], ",", 
               RowBox[{
                RowBox[{"coords2grad", "[", 
                 RowBox[{"-", "1"}], "]"}], "[", 
                RowBox[{"dir", ",", "coords", ",", "k"}], "]"}]}], "}"}], 
             "]"}], "=", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "nd"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{
            RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"Normal", "[", "proj", "]"}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"fb6f81ff-93ce-4bba-bd8d-9be84faecccf"],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "ffdd", 
  "]"}]], "Input",ExpressionUUID->"e36c5c59-204b-48a4-a161-2345bffcf20e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxial", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "ffdd"}]}], "]"}]}], ";", 
  RowBox[{"pairsAxial", "=", "pairs0"}], ";", 
  RowBox[{"ooprojAxial", "=", 
   RowBox[{"oo0", ".", "proj0", ".", "axialProj"}]}], 
  ";"}]], "Input",ExpressionUUID->"844c2bc3-df34-4b21-8071-deb593c6bb6b"],

Cell[CellGroupData[{

Cell["Distribution of shifts", \
"Subsubsection",ExpressionUUID->"3351a8a0-4458-426b-986e-9b7034f32567"],

Cell["\<\
Need to turn on switch in function applyCutoff3 to accumulate data for this \
plot.\
\>", "Text",ExpressionUUID->"5cda3090-c9f1-42c3-9af7-0385e60e0a62"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "goodPairs0"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "badPairs0"}], "]"}]}], "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"1fc1e9d1-47ac-42d1-967f-b99d80d43ddb"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
     "pairsDynamic"}], "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"f2423630-8b43-4e1f-a7c3-6d8f8faa07fe"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsAll"}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsAxial"}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsDynamic"}], "]"}]}], "}"}], 
  "]"}]], "Input",ExpressionUUID->"a47972e2-d1c2-4964-b3cf-b66a94116325"],

Cell["\<\
Note that a Cauchy Distribution is generated by the ratio of two normally \
distributed variables.\
\>", "Text",ExpressionUUID->"d264501a-9c05-42f2-b945-84876a292caf"],

Cell[BoxData[
 RowBox[{"fitt", "=", 
  RowBox[{"FindDistribution", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], "]"}],
    "]"}]}]], "Input",ExpressionUUID->"3b8bcf26-7b15-435c-811c-f55b65932537"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "=", "0.2"}], ",", 
     RowBox[{"max", "=", "2"}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], 
        "]"}], ",", 
       RowBox[{"{", "w", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", "All"}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PDF", "[", 
         RowBox[{"fitt", ",", "x"}], "]"}], 
        RowBox[{"Length", "[", "pairsDynamic", "]"}], " ", "w"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"976d614a-d6da-4f94-9d2c-fa151b6806d7"],

Cell["\<\
We see that there is a good fit in the tails and at the peak.\
\>", "Text",ExpressionUUID->"044a8f0f-69dc-4376-a0bb-d769237fc75b"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "=", "0.2"}], ",", 
     RowBox[{"data", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
        "pairsDynamic"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"data", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Log\>\"", ",", 
         RowBox[{"{", "w", "}"}]}], "}"}], ",", 
       RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log\>\""}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     RowBox[{"LogPlot", "[", " ", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{"fitt", ",", 
            RowBox[{
             RowBox[{"Exp", "[", "x", "]"}], " ", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"w", "/", "2"}], ")"}]}]}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{"fitt", ",", 
            RowBox[{
             RowBox[{"Exp", "[", "x", "]"}], 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "w"}], "/", "2"}], ")"}]}]}]}], "]"}]}], ")"}], 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Min", "[", "data", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Max", "[", "data", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"e02b74d3-ab79-41e9-b95d-0565d9299c06"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsAll"}], "]"}], 
     ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsAxial"}], "]"}],
      ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "Automatic"}], "}"}]}], 
   ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"4c6edeb0-ef5e-4215-925a-75ff9e370f7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare shift vectors", \
"Subsubsection",ExpressionUUID->"bbb308fb-cc39-4caf-afe4-96de077d9a82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cosAngle", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", ".", "b"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", "a", "]"}], " ", 
     RowBox[{"Norm", "[", "b", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"d2f25e1c-27a2-44cb-8db3-b0b1b05fca3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "shifts", "]"}], ";", 
  RowBox[{
   RowBox[{"makeShifts", "[", 
    RowBox[{"type_", ",", "pairs_", ",", "ooproj_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "0", ",", "0"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairs"}], "]"}], 
        ".", "ooproj"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "1", ",", "0"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"applyCutoff3", "[", 
            RowBox[{"##", ",", "ooproj", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", "pairs", "]"}]}], "]"}], ".", 
        "ooproj"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "0", ",", "1"}], "]"}], "=", 
      RowBox[{"applyCutoff2", "[", 
       RowBox[{"shifts", "[", 
        RowBox[{"type", ",", "0", ",", "0"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "1", ",", "1"}], "]"}], "=", 
      RowBox[{"applyCutoff2", "[", 
       RowBox[{"shifts", "[", 
        RowBox[{"type", ",", "1", ",", "0"}], "]"}], "]"}]}], ";"}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"ce7f505f-a804-4dfb-a24a-bf9fed0fcac0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting All\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<All\>\"", ",", "pairsAll", ",", "ooprojAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting Dynamic\>\"", "]"}], ";", 
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<Dynamic\>\"", ",", "pairsDynamic", ",", "ooprojDynamic"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting Axial\>\"", "]"}], ";", 
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<Axial\>\"", ",", "pairsAxial", ",", "ooprojAxial"}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"0d094de9-7433-4499-9a5d-85103d33f3b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"typeOuter", "[", "type_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sh", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "0", ",", "1"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "1", ",", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"TableForm", "[", 
     RowBox[{"Outer", "[", 
      RowBox[{"cosAngle", ",", "sh", ",", "sh", ",", "1"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"e1016f09-e08e-4135-80f4-eaa49d3c54df"],

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<All\>\"", 
  "]"}]], "Input",ExpressionUUID->"77bac56d-fd67-44b1-b2ed-028f5e919d5b"],

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<Dynamic\>\"", 
  "]"}]], "Input",ExpressionUUID->"6b415e11-14d2-4106-8e01-f4b3640c28ff"],

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<Axial\>\"", 
  "]"}]], "Input",ExpressionUUID->"eb2b12df-e702-4116-af87-60617f7fca47"],

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<All\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"980c51ba-2e9c-4868-b0c2-29cb89e317ea"],

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Axial\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"fab3e66d-c418-4cd3-9262-6a90514a8777"],

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<All\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Axial\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b58ffdff-fc48-4dce-ab73-30d106345a3b"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<All\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"3393e1e4-bc4a-40b3-a76a-86133d8a83fb"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<Dynamic\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"fdccd8bf-b8f4-4706-a0c0-073e562863e5"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<Axial\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"b996afba-2344-46bb-b1e0-0e43a82b0974"],

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"dynamicShifts", ".", 
      RowBox[{"Transpose", "[", "dynamicShifts", "]"}]}], "-", 
     RowBox[{"IdentityMatrix", "[", "1024", "]"}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"8f9ae3cd-0ee3-474c-a637-bdabb249987c"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"{", ".05", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"770947f2-51a0-402a-9e5d-f2552a61e205"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Junk", "Section",ExpressionUUID->"6058e0d4-29e9-4c0b-bf03-5f86a5a84b13"],

Cell[BoxData[
 RowBox[{"phases", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"centerSUMatrix", "[", 
    RowBox[{"1", ",", "3"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"277532bf-3deb-4fef-b6d6-67aa25160b1a"],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"phases", ",", "16"}], 
  "]"}]], "Input",ExpressionUUID->"4078f171-a99e-4a43-b33a-fc161e2f414e"],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"lineLinks", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"e7cf3e5c-b44d-4718-be51-22cf4ce78c61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"<<", "\"\<../data/3-3/periodic-16-28-5.m\>\""}], ";", 
   RowBox[{"avgP", "=", 
    RowBox[{
    "averagePlaquette", "[", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"98aa0588-7a84-4b67-af3d-dc4870b9772f"],

Cell[BoxData["0.9017923927961671`"], \
"Output",ExpressionUUID->"68f0b82a-454a-43af-941b-7559a3d2f6a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-16-28-5-i-16.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"d917a733-847f-4184-9510-7f612fd85d4a"],

Cell[BoxData["0.9826511813080581`"], \
"Output",ExpressionUUID->"1ea74c70-5c82-4d98-8bd8-4ba71c7f9db5"]
}, Open  ]],

Cell["Only place where plotAction[] is called.", \
"Text",ExpressionUUID->"40fc700c-7eab-4933-bf2c-3b2f5f37a662"],

Cell[BoxData[
 RowBox[{"plotAction", "[", 
  RowBox[{"1", ",", "2", ",", "3", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"0.2", " ", 
       RowBox[{"nc", "^", "2"}]}]}], "}"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"c052c00b-f1d9-46f0-bd23-1bb2d83bdd87"],

Cell[BoxData[
 RowBox[{"latticeSaddlePoint", "[", "5", 
  "]"}]], "Input",ExpressionUUID->"73683594-847e-4113-a0a3-576649dddedb"],

Cell[BoxData[
 RowBox[{"stats", "=", 
  RowBox[{
  "latticeSaddlePoint", "[", "50", 
   "]"}]}]], "Input",ExpressionUUID->"b240671b-9f8c-40a1-94c1-8cac5fe8a9d1"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], "]"}], "]"}], "&"}], ",", "stats"}], 
   "]"}], "]"}]], \
"Input",ExpressionUUID->"77eed4f3-7414-4960-b3f4-a9e7e68ef686"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"norm", "/.", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
         "]"}]}]}], "}"}], "&"}], ",", "stats"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"570da784-b5f8-447e-9c5f-47ec6ef5f759"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"ampL", "/.", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
         "]"}]}]}], "}"}], "&"}], ",", "stats"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"cfd0fd2f-fb03-41e1-9542-3f338b342f15"],

Cell[BoxData[
 RowBox[{"stats", "=", 
  RowBox[{
  "latticeSaddlePoint", "[", "14", 
   "]"}]}]], "Input",ExpressionUUID->"2b12fb8b-143a-4ca9-a9a3-23fbc0a68389"],

Cell["Save resulting lattice", \
"Text",ExpressionUUID->"a97e92d4-94bc-4489-bbcb-0ef6337b72fa"],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{"\"\<periodic-3-3-22-42-1-fastcool.m\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "nd", ",", "nc", ",", "beta", ",", "latticeDimensions", ",", 
     "latticeLayout", ",", "gaugeField", ",", "linearSiteIndex"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"a18df784-83d1-4e71-bbd0-bf1f9ac17071"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{663, 605},
WindowMargins->{{0, Automatic}, {Automatic, 58}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]

