Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7673569687731447`*^9, 
  3.7673569687738857`*^9}},ExpressionUUID->"2d04608b-9946-4c28-ab78-\
bf003fc0a624"],

Cell["\<\
Disable current notebook FileOutlineCache and CellChangeTimes.  See: \
https://stackoverflow.com/questions/2816628/version-control-of-mathematica-\
notebooks \
\>", "Text",ExpressionUUID->"c8b91507-5d14-469e-9fe1-3e146e8bfa42"],

Cell[CellGroupData[{

Cell["Library", \
"Section",ExpressionUUID->"31efac24-1e46-467d-80dc-82c8a417d0ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLink", "[", 
     RowBox[{"dir_", ",", "coords_List"}], "]"}], ":=", 
    RowBox[{"gaugeField", "[", 
     RowBox[{"[", 
      RowBox[{"dir", ",", 
       RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"setLink", "[", 
     RowBox[{"dir_", ",", "coords_List", ",", "mat_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"gaugeField", "[", 
      RowBox[{"[", 
       RowBox[{"dir", ",", 
        RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], "=", 
     "mat"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeVolume", "[", "]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Times", ",", " ", "latticeDimensions"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeCoordinates", "[", "ii_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "not", " ", "necessarily", " ", "the", " ", 
     "inverse", " ", "of", " ", 
     RowBox[{"linearSiteIndex", ".", "  ", "It"}], " ", "is", " ", "simply", 
     " ", "a", " ", "way", " ", "to", " ", "iterate", " ", "over", " ", "the",
      " ", "whole", " ", 
     RowBox[{"lattice", "."}]}], " ", "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"ii", "-", "1"}]}], ",", "j"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "=", 
         RowBox[{"QuotientRemainder", "[", 
          RowBox[{"i", ",", 
           RowBox[{"latticeDimensions", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"j", "+", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nd"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shift", "[", 
    RowBox[{"dir_", ",", "coords_", ",", 
     RowBox[{"size_:", "1"}]}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Wrap", "-", "around"}], ",", " ", 
     RowBox[{
     "assuming", " ", "periodic", " ", "boundary", " ", "conditions"}]}], " ",
     "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cc", "=", "coords"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"cc", "[", 
        RowBox[{"[", "dir", "]"}], "]"}], "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cc", "[", 
            RowBox[{"[", "dir", "]"}], "]"}], "+", "size", "-", "1"}], ",", 
          RowBox[{"latticeDimensions", "[", 
           RowBox[{"[", "dir", "]"}], "]"}]}], "]"}]}]}], ";", "cc"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plaquette", "[", 
    RowBox[{"dir1_", ",", "dir2_", ",", " ", "coords_List"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{"Tr", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"getLink", "[", 
       RowBox[{"dir1", ",", "coords"}], "]"}], ".", 
      RowBox[{"getLink", "[", 
       RowBox[{"dir2", ",", 
        RowBox[{"shift", "[", 
         RowBox[{"dir1", ",", "coords"}], "]"}]}], "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"getLink", "[", 
        RowBox[{"dir1", ",", 
         RowBox[{"shift", "[", 
          RowBox[{"dir2", ",", "coords"}], "]"}]}], "]"}], "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"getLink", "[", 
        RowBox[{"dir2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"averagePlaquette", "[", "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"plaquette", "[", 
         RowBox[{"dir1", ",", "dir2", ",", 
          RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir1", ",", "2", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir2", ",", 
         RowBox[{"dir1", "-", "1"}]}], "}"}]}], "]"}], "*", 
     RowBox[{"2", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"latticeVolume", "[", "]"}], "*", "nc", "*", "nd", "*", 
        RowBox[{"(", 
         RowBox[{"nd", "-", "1"}], ")"}]}], ")"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"a8585708-e667-42f9-99e1-1656b00db9c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"randomSUMatrix", "[", "n_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mat", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"CircularUnitaryMatrixDistribution", "[", "n", "]"}], "]"}]}],
       "}"}], ",", 
     RowBox[{"mat", "/", 
      RowBox[{
       RowBox[{"Det", "[", "mat", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "n"}], ")"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"centerSUMatrix", "[", 
    RowBox[{"n_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "n", "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "Pi", " ", "I", " ", 
      RowBox[{"j", "/", "n"}]}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"matrixEqual", "[", 
    RowBox[{"m1_", ",", "m2_", ",", 
     RowBox[{"tol_:", "$MachineEpsilon"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"norm", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"m1", "-", "m2"}], "]"}], ",", "Infinity"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"norm", "<", 
        RowBox[{"tol", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Length", "[", "m1", "]"}], " ", 
           RowBox[{"Length", "[", 
            RowBox[{"m1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], ",", "True", 
       ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Matrices not equal, norm:  \>\"", ",", "norm"}], "]"}], 
        ";", "False"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"SUMatrixQ", "[", 
    RowBox[{
     RowBox[{"mat_", "?", "SquareMatrixQ"}], ",", 
     RowBox[{"tol_:", "$MachineEpsilon"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"diffs", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Det", "[", "mat", "]"}], "-", "1"}], ",", 
          RowBox[{
           RowBox[{"mat", ".", 
            RowBox[{"ConjugateTranspose", "[", "mat", "]"}]}], "-", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "mat", "]"}], "]"}]}]}], "}"}]}], ",", 
       "norm"}], "}"}], ",", 
     RowBox[{
      RowBox[{"norm", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "diffs", "]"}], ",", "Infinity"}], "]"}]}], 
      ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"norm", "<", 
         RowBox[{"tol", " ", 
          RowBox[{"Length", "[", "mat", "]"}]}]}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Not SU matrix, error:  \>\"", ",", " ", "norm"}], 
          "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Details:  \>\"", ",", "diffs"}], "]"}], ";", 
         "False"}]}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"suGenerators", "[", 
    RowBox[{"n_:", "nc"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"suGenerators", "[", "n", "]"}], "=", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Construct", " ", "the", " ", "generators", " ", "for", " ", "SU", 
       RowBox[{
        RowBox[{"(", "N", ")"}], ".", "  ", "Normalization"}], " ", 
       RowBox[{"Tr", "[", 
        RowBox[{"T_a", " ", "T_b"}], "]"}]}], " ", "=", " ", 
      RowBox[{"delta_", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], "/", "2."}]}]}], " ", "*)"}], 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "k1"}], "&&", 
               RowBox[{"j", "\[Equal]", "k2"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "k2"}], "&&", 
               RowBox[{"j", "\[Equal]", "k1"}]}], ")"}]}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", "k1"}], "&&", 
             RowBox[{"j", "\[Equal]", "k2"}]}], ",", 
            RowBox[{"I", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "k2"}], "&&", 
             RowBox[{"j", "\[Equal]", "k1"}]}], ",", 
            RowBox[{
             RowBox[{"-", "I"}], "/", "2"}], ",", "True", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"k1", "!=", "k2"}], ",", "0", ",", 
          RowBox[{"k1", "<", "i"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2", " ", "i", " ", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}], "]"}]}], ",", 
          RowBox[{"k1", "\[Equal]", "i"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "i"}], ")"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2", " ", "i", " ", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}], "]"}]}], ",", "True", ",", 
          "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "n"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"suSymmetric", "[", 
    RowBox[{"n_:", "nc"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"suSymmetric", "[", "n", "]"}], "=", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Construct", " ", "the", " ", "symmetric", " ", "coefficients", " ", 
       "d_", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], ".", "  ", "This"}], " ", 
       "tensor", " ", "is", " ", "sparse"}], ",", " ", 
      RowBox[{
      "but", " ", "we", " ", "will", " ", "be", " ", "inefficient", " ", 
       "for", " ", 
       RowBox[{"now", "."}]}]}], " ", "*)"}], 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gen", "=", 
        RowBox[{"suGenerators", "[", "n", "]"}]}], "}"}], ",", 
      RowBox[{"2", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Tr", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#1", ".", "#2"}], "+", 
              RowBox[{"#2", ".", "#1"}]}], ")"}], ".", "#3"}], "]"}], "&"}], 
         ",", "gen", ",", "gen", ",", "gen", ",", "1"}], "]"}]}]}], 
     "]"}]}]}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"9a0d4813-a1f7-4da2-b04f-c5e675ccd229"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SUPower", "[", 
    RowBox[{"mat_", ",", "power_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"values", ",", "vectors", ",", "phases", ",", "phaseSum", ",", 
       RowBox[{"fix", "=", "True"}], ",", "delta", ",", "result", ",", " ", 
       RowBox[{"debug", "=", "False"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"values", ",", "vectors"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "mat", "]"}]}], ";", 
      RowBox[{"phases", "=", 
       RowBox[{"Arg", "[", "values", "]"}]}], ";", 
      RowBox[{"phaseSum", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Plus", "@@", "phases"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Gram", "-", 
        RowBox[{"Schmidt", " ", "orthogonalization"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vectors", "=", 
       RowBox[{"Orthogonalize", "[", "vectors", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Sanity", " ", 
         RowBox[{"check", ".", "  ", 
          RowBox[{"QDP", "++"}]}], " ", "default", " ", "is", " ", "single", 
         " ", "precision"}], ",", " ", 
        RowBox[{
        "so", " ", "we", " ", "set", " ", "the", " ", "tolerance", " ", 
         RowBox[{"high", "."}]}]}], " ", "*)"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"phaseSum", "+", "Pi"}], ",", 
             RowBox[{"2", "Pi"}]}], "]"}], "-", "Pi"}], "]"}], ">", 
         RowBox[{"10", "^", 
          RowBox[{"-", "5"}]}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<phaseSum=\>\"", ",", "phaseSum"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "the", " ", "total", " ", "is", " ", "nonzero"}], 
        ",", " ", 
        RowBox[{"need", " ", "to", " ", "shift"}]}], " ", "*)"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"phaseSum", "!=", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"phases", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-=", "phaseSum"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{"fix", ",", 
           RowBox[{
            RowBox[{"fix", "=", "False"}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"phases", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", 
                  RowBox[{"phases", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ">", 
                 RowBox[{"2", "*", "Pi"}]}], ",", 
                RowBox[{
                 RowBox[{"delta", "=", 
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"phases", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"phases", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", 
                    RowBox[{"2", "*", "Pi"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "Pi"}], ")"}]}], "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"phases", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-=", 
                  RowBox[{"2", "*", "Pi", "*", "delta"}]}], ";", 
                 RowBox[{
                  RowBox[{"phases", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "+=", 
                  RowBox[{"2", "*", "Pi", "*", "delta"}]}], ";", 
                 RowBox[{"fix", "=", "True"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "mat", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "vectors", "]"}], ".", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "phases", "*", "power"}], "]"}], "]"}], ".", 
        RowBox[{"Conjugate", "[", "vectors", "]"}]}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"debug", " ", "&&", " ", 
         RowBox[{"Not", "[", 
          RowBox[{"SUMatrixQ", "[", "result", "]"}], "]"}]}], ",", 
        RowBox[{"Print", "[", "\"\<matrix power not SU\>\"", "]"}]}], "]"}], 
      ";", "result"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"centerPhases", "[", "mat_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{"Used", " ", "for", " ", "some", " ", "testing"}], " ", "*)"}], 
   " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"delta", ",", 
       RowBox[{"phases", "=", 
        RowBox[{"Arg", "[", 
         RowBox[{"Eigenvalues", "[", "mat", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"phases", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-=", 
       RowBox[{"Apply", "[", 
        RowBox[{"Plus", ",", "phases"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"phases", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"phases", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ">", 
           RowBox[{"2", "*", "Pi"}]}], ",", 
          RowBox[{
           RowBox[{"delta", "=", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"phases", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"phases", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", 
                RowBox[{"2", "*", "Pi"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"4", "*", "Pi"}], ")"}]}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"phases", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-=", 
            RowBox[{"2", "*", "Pi", "*", "delta"}]}], ";", 
           RowBox[{
            RowBox[{"phases", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "+=", 
            RowBox[{"2", "*", "Pi", "*", "delta"}]}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "phases", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "phases", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Sort", "[", 
       RowBox[{"phases", ",", 
        RowBox[{
         RowBox[{"Order", "[", 
          RowBox[{
           RowBox[{"Abs", "[", "#1", "]"}], ",", 
           RowBox[{"Abs", "[", "#2", "]"}]}], "]"}], "&"}]}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e6cd0bb7-0323-44b6-a0ca-355b22d22e02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setAxialGauge", "[", "dir_", "]"}], ":=", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Set", " ", "gauge", " ", "for", " ", "the", " ", "current", " ", 
     "lattice", " ", 
     RowBox[{"configuration", ".", "  ", "This"}], " ", "should", " ", "be", 
     " ", "exact"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "average", " ", "plaquette", " ", "should", " ", 
     "be", " ", 
     RowBox[{"unchanged", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", 
        RowBox[{"debug", "=", "False"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coords", "[", 
          RowBox[{"[", "dir", "]"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], ",", "vt", ",", 
            "ct"}], "}"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Initial", " ", "values"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"False", ",", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"getLink", "[", 
                   RowBox[{"dir", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "coords", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "}"}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"latticeDimensions", "[", 
                  RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{"v", ".", 
               RowBox[{"getLink", "[", 
                RowBox[{"dir", ",", 
                 RowBox[{"shift", "[", 
                  RowBox[{"dir", ",", "coords", ",", 
                   RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Full product:\>\"", ",", " ", "v"}], "]"}]}], 
            "]"}], ";", 
           RowBox[{"v", "=", 
            RowBox[{"SUPower", "[", 
             RowBox[{"v", ",", 
              RowBox[{"1", "/", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "dir", "]"}], "]"}]}]}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Root:\>\"", ",", " ", "v"}], "]"}]}], "]"}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Apply", " ", "gauge", " ", "choice", " ", "to", " ", "each", 
              " ", "site"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ct", "=", 
               RowBox[{"shift", "[", 
                RowBox[{"dir", ",", "coords", ",", 
                 RowBox[{"j", "-", "1"}]}], "]"}]}], ";", 
              RowBox[{"vt", "=", 
               RowBox[{
                RowBox[{"ConjugateTranspose", "[", 
                 RowBox[{"getLink", "[", 
                  RowBox[{"dir", ",", 
                   RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "ct", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], ".", "v"}]}],
               ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"setLink", "[", 
                  RowBox[{"dd", ",", 
                   RowBox[{"shift", "[", 
                    RowBox[{"dd", ",", "ct", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "In", " ", "order", " ", "to", " ", "decrease", " ", 
                    "the", " ", "floating", " ", "point", " ", "error"}], ",",
                     " ", 
                    RowBox[{
                    "just", " ", "set", " ", "the", " ", "axial", " ", 
                    "direction", " ", "link", " ", "to", " ", "the", " ", 
                    "correct", " ", 
                    RowBox[{"value", "."}]}]}], " ", "*)"}], 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dd", "\[Equal]", "dir"}], ",", "v", ",", 
                    RowBox[{
                    RowBox[{"getLink", "[", 
                    RowBox[{"dd", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dd", ",", "ct", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], ".", "vt"}]}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"setLink", "[", 
                  RowBox[{"dd", ",", "ct", ",", 
                   RowBox[{
                    RowBox[{"ConjugateTranspose", "[", "vt", "]"}], ".", 
                    RowBox[{"getLink", "[", 
                    RowBox[{"dd", ",", "ct"}], "]"}]}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"dd", ",", "nd"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", 
               RowBox[{"latticeDimensions", "[", 
                RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Verify", " ", "that", " ", "it", " ", "all", " ", "worked", " ", 
             "out"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"getLink", "[", 
                    RowBox[{"dir", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "coords", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "}"}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"latticeDimensions", "[", 
                   RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final link diff:\>\"", ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"v", "-", 
                  RowBox[{"getLink", "[", 
                   RowBox[{"dir", ",", 
                    RowBox[{"shift", "[", 
                    RowBox[{"dir", ",", "coords", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], 
               "]"}]}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9dfb6e45-5418-49e9-b50c-39540599264d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sumStaples", "[", 
    RowBox[{"dir1_", ",", "coords_"}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "a", " ", "general", " ", "matrix", " ", "in", " ", 
     "color", " ", "space"}], " ", "*)"}], " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"total", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0.0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nc", ",", "nc"}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir2", "\[NotEqual]", "dir1"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"forward", " ", "staple"}], " ", "*)"}], 
          RowBox[{
           RowBox[{"total", " ", "+=", " ", 
            RowBox[{
             RowBox[{"getLink", "[", 
              RowBox[{"dir2", ",", 
               RowBox[{"shift", "[", 
                RowBox[{"dir1", ",", "coords"}], "]"}]}], "]"}], ".", 
             RowBox[{"ConjugateTranspose", "[", 
              RowBox[{"getLink", "[", 
               RowBox[{"dir1", ",", 
                RowBox[{"shift", "[", 
                 RowBox[{"dir2", ",", "coords"}], "]"}]}], "]"}], "]"}], ".", 
             
             RowBox[{"ConjugateTranspose", "[", 
              RowBox[{"getLink", "[", 
               RowBox[{"dir2", ",", "coords"}], "]"}], "]"}]}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{" ", 
              RowBox[{"backward", " ", 
               RowBox[{"staple", ".", "  ", "Note"}], " ", "that", " ", "we", 
               " ", "simply", " ", "demand", " ", "that", " ", 
               RowBox[{"Re", "[", " ", 
                RowBox[{"Tr", "[", " ", 
                 RowBox[{"F", " ", "U"}], "]"}], "]"}]}], "]"}], ",", " ", 
             RowBox[{
             "where", " ", "F", " ", "is", " ", "the", " ", "staple"}], ",", 
             " ", 
             RowBox[{
             "gives", " ", "the", " ", "plaquette", " ", "used", " ", "in", 
              " ", "the", " ", 
              RowBox[{"action", ".", "  ", "Thus"}]}], ",", " ", 
             RowBox[{
             "we", " ", "are", " ", "free", " ", "to", " ", "take", " ", 
              "the", " ", "complex", " ", "conjugate", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"charge", " ", "congugate"}], ")"}], "."}]}]}], " ", 
            "*)"}], " ", 
           RowBox[{"total", " ", "+=", " ", 
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", 
              RowBox[{"getLink", "[", 
               RowBox[{"dir2", ",", 
                RowBox[{"shift", "[", 
                 RowBox[{"dir2", ",", 
                  RowBox[{"shift", "[", 
                   RowBox[{"dir1", ",", "coords"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], ".", 
             RowBox[{"ConjugateTranspose", "[", 
              RowBox[{"getLink", "[", 
               RowBox[{"dir1", ",", 
                RowBox[{"shift", "[", 
                 RowBox[{"dir2", ",", "coords", ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], ".", 
             RowBox[{"getLink", "[", 
              RowBox[{"dir2", ",", 
               RowBox[{"shift", "[", 
                RowBox[{"dir2", ",", "coords", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir2", ",", "nd"}], "}"}]}], "]"}], ";", "total"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stapleTest", "[", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Find", " ", "the", " ", "average", " ", "plaquette", " ", "using", " ", 
     "the", " ", "staples", " ", "times", " ", "the", " ", 
     RowBox[{"link", ".", "  ", "This"}], " ", "should", " ", "be", " ", 
     "equal", " ", "to", " ", "the", " ", "normal", " ", "average", " ", 
     RowBox[{"plaquette", ".", " ", "Each"}], " ", "plaquette", " ", 
     "contributes", " ", "to", " ", "4", " ", 
     RowBox[{"staples", "."}]}], " ", "*)"}], 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"sumStaples", "[", 
          RowBox[{"dir", ",", 
           RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], ".", 
         RowBox[{"getLink", "[", 
          RowBox[{"dir", ",", 
           RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "nd"}], "}"}]}], "]"}], "*", 
     RowBox[{"2", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"latticeVolume", "[", "]"}], "*", "nd", "*", 
        RowBox[{"(", 
         RowBox[{"nd", "-", "1"}], ")"}], "*", "nc", "*", "4"}], ")"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f1499c35-4016-4452-81ab-eca84b727821"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"saddlePointStep", "[", 
    RowBox[{"u2Staples_", ",", "u1_"}], "]"}], ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "One", " ", "iteration", " ", "of", " ", "the", " ", "saddle", " ", 
      "point", " ", 
      RowBox[{"search", ".", "  ", "Set"}], " ", "zzz", " ", "to", " ", "a", 
      " ", "large", " ", "number", " ", "to", " ", "test", " ", "this", " ", 
      "against", " ", "the", " ", "explicit", " ", 
      RowBox[{"calculation", ".", "  ", "Choose"}], " ", "\"\<cutoff\>\"", 
      " ", "to", " ", "suppress", " ", "shifts", " ", "that", " ", "are", " ",
       "too", " ", 
      RowBox[{"large", ".", "  ", "I"}], " ", "used", " ", "the", " ", 
      "sumStaples"}], "=", 
     RowBox[{
     "1", " ", "case", " ", "to", " ", "tune", " ", "\"\<cutoff.\>\""}]}], 
    "  ", "*)"}], " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zzz", "=", "1"}], ",", 
       RowBox[{"cutoff", "=", "Pi"}], ",", 
       RowBox[{"debug", "=", "False"}], ",", 
       RowBox[{"ff", "=", 
        RowBox[{"u2Staples", ".", "u1"}]}], ",", "grad", ",", "mm", ",", "oo",
        ",", "values", ",", "shifts", ",", "sqrtU", ",", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "u2Staples", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"grad", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Tr", "[", 
           RowBox[{"ff", ".", "#"}], "]"}], "&"}], ",", 
         RowBox[{"suGenerators", "[", "nc", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<grad:  \>\"", ",", "grad"}], "]"}]}], "]"}], ";", 
      RowBox[{"mm", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"Tr", "[", "ff", "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2.0", " ", 
            RowBox[{"Length", "[", "ff", "]"}]}], ")"}]}], " ", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "grad", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"suSymmetric", "[", "nc", "]"}], ".", 
          RowBox[{"Re", "[", "grad", "]"}]}], "/", "2.0"}]}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"values", ",", "oo"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{
       "Using", " ", "the", " ", "fact", " ", "that", " ", "the", " ", 
        "periodicity", " ", "of", " ", "B_a", " ", "is", " ", "4", " ", "Pi", 
        " ", "or", " ", 
        RowBox[{"less", "."}]}], " ", "*)"}], " ", 
      RowBox[{"shifts", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "Pi", " ", "zzz", "  ", 
              RowBox[{"Abs", "[", "#2", "]"}]}], "<", 
             RowBox[{"Abs", "[", "#1", "]"}]}], ",", "0", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "#1"}], "/", "#2"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#1", "/", 
                   RowBox[{"(", 
                    RowBox[{"#2", " ", "cutoff", " ", "zzz"}], ")"}]}], ")"}],
                  "^", "2"}]}], "/", "2"}], " ", "]"}]}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"oo", ".", 
            RowBox[{"Im", "[", "grad", "]"}]}], ",", "values"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<shifts:  \>\"", ",", "shifts"}], "]"}]}], "]"}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u1", ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"I", " ", 
           RowBox[{"shifts", ".", "oo", ".", 
            RowBox[{"suGenerators", "[", "nc", "]"}]}]}], "]"}]}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"Abs", "[", "shifts", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkSaddlePoint", "[", 
    RowBox[{"dir_", ",", "coords_", ",", 
     RowBox[{"maxCount_:", "20"}], ",", 
     RowBox[{"tol_:", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}]}], "]"}], ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Saddle", " ", "point", " ", "search", " ", "for", " ", "a", " ", 
     "single", " ", 
     RowBox[{"link", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"maxShift", "=", 
        RowBox[{"4", " ", "Pi"}]}], ",", 
       RowBox[{"debug", "=", "False"}], ",", 
       RowBox[{"u1", "=", 
        RowBox[{"SUPower", "[", 
         RowBox[{
          RowBox[{"getLink", "[", 
           RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}]}], ",", 
       "u2", ",", "u2SumStaples", ",", 
       RowBox[{"count", "=", "1"}], ",", "uu"}], "}"}], ",", 
     RowBox[{
      RowBox[{"u2", "=", "u1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"u2SumStaples", "=", 
       RowBox[{"u2", ".", 
        RowBox[{"sumStaples", "[", 
         RowBox[{"dir", ",", "coords"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"maxShift", ">", "tol"}], "&&", 
         RowBox[{"count", "<=", "maxCount"}]}], ",", 
        RowBox[{
         RowBox[{"count", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u1", ",", "maxShift"}], "}"}], "=", 
          RowBox[{"saddlePointStep", "[", 
           RowBox[{"u2SumStaples", ",", "u1"}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{"debug", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Max shift:  \>\"", ",", "maxShift"}], "]"}]}], 
          "]"}]}]}], "]"}], ";", 
      RowBox[{"uu", "=", 
       RowBox[{"u1", ".", "u2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"SUMatrixQ", "[", "uu", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", "\"\<Link not updated.\>\"", "]"}], ",", 
        RowBox[{"setLink", "[", 
         RowBox[{"dir", ",", "coords", ",", "uu"}], "]"}]}], "]"}], ";", 
      RowBox[{"{", "maxShift", "}"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"latticeSaddlePoint", "[", 
    RowBox[{
     RowBox[{"maxCount_:", "20"}], ",", 
     RowBox[{"tol_:", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"count", "=", "0"}], ",", 
       RowBox[{"maxShift", "=", 
        RowBox[{"4", " ", "Pi"}]}], ",", "linkShift"}], "}"}], ",", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"count", "<", "maxCount"}], "&&", 
        RowBox[{"maxShift", ">", "tol"}]}], ",", 
       RowBox[{
        RowBox[{"maxShift", "=", "0"}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", "linkShift", "}"}], "=", 
            RowBox[{"linkSaddlePoint", "[", 
             RowBox[{"dir", ",", 
              RowBox[{"latticeCoordinates", "[", "k", "]"}], ",", "1"}], 
             "]"}]}], ";", 
           RowBox[{"maxShift", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"linkShift", ",", "maxShift"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"dir", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"count", ",", " ", "maxShift", ",", 
           RowBox[{"averagePlaquette", "[", "]"}]}], "}"}], "]"}], ";", 
        RowBox[{"count", "++"}]}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"9e5d8c5f-de60-45a9-b500-e4a61b6145fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wrapIt", "[", "coords_List", "]"}], ":=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"#1", "-", "1"}], ",", "#2"}], "]"}]}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"coords", ",", "latticeDimensions"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotActionLimits", "[", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"2", " ", "beta"}], ",", "15"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotAction", "[", 
    RowBox[{"dir1_", ",", "dir2_", ",", "anchor_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coords", "=", "anchor"}], "}"}], ",", 
     RowBox[{"ListPlot3D", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "dir1", "]"}], "]"}], "=", "x1"}], ";", 
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "dir2", "]"}], "]"}], "=", "x2"}], ";", 
            RowBox[{"coords", "=", 
             RowBox[{"wrapIt", "[", "coords", "]"}]}], ";", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "+", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"x2", "+", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"beta", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"plaquette", "[", 
                   RowBox[{"dir1", ",", "dir2", ",", "coords"}], "]"}], "/", 
                  "nc"}]}], ")"}]}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "0", ",", 
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "0", ",", 
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir2", "]"}], "]"}]}], "}"}]}], "]"}], ",", "1"}],
         "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir1", "]"}], "]"}], "+", 
             RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir2", "]"}], "]"}], "+", 
             RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
          RowBox[{"plotActionLimits", "[", "]"}]}], "}"}]}]}], "]"}]}], 
    "]"}]}], ";", 
  RowBox[{
   RowBox[{"plotActionSides", "[", 
    RowBox[{"dir0_", ",", "dir1_", ",", "dir2_", ",", "anchor_List"}], "]"}], 
   ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coords", "=", "anchor"}], "}"}], ",", 
     RowBox[{"ListPlot3D", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "dir1", "]"}], "]"}], "=", "x1"}], ";", 
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "dir2", "]"}], "]"}], "=", "x2"}], ";", 
            RowBox[{"coords", "=", 
             RowBox[{"wrapIt", "[", "coords", "]"}]}], ";", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "+", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[Equal]", "1"}], ",", 
                 RowBox[{"1", "/", "2"}], ",", "0"}], "]"}]}], ",", 
              RowBox[{"x2", "+", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[Equal]", "1"}], ",", "0", ",", 
                 RowBox[{"1", "/", "2"}]}], "]"}]}], ",", 
              RowBox[{"beta", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"plaquette", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], ",", "dir1", ",", 
                    "dir0"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], ",", "dir0", ",", 
                    "dir2"}], "]"}], ",", "coords"}], "]"}], "/", "nc"}]}], 
                ")"}]}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "0", ",", 
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "0", ",", 
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir1", "]"}], "]"}], "+", 
             RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"latticeDimensions", "[", 
              RowBox[{"[", "dir2", "]"}], "]"}], "+", 
             RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
          RowBox[{"plotActionLimits", "[", "]"}]}], "}"}]}]}], "]"}]}], 
    "]"}]}], ";", 
  RowBox[{
   RowBox[{"plotAction", "[", 
    RowBox[{"dir0_", ",", "dir1_", ",", "dir2_", ",", "anchor_List"}], "]"}], 
   ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coords", "=", "anchor"}], "}"}], ",", 
     RowBox[{"ListAnimate", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "dir0", "]"}], "]"}], "=", "x0"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], ",", 
             RowBox[{"plotAction", "[", 
              RowBox[{"dir1", ",", "dir2", ",", "coords"}], "]"}], ",", 
             RowBox[{"plotActionSides", "[", 
              RowBox[{"dir0", ",", "dir1", ",", "dir2", ",", "coords"}], 
              "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x0", ",", 
            RowBox[{"latticeDimensions", "[", 
             RowBox[{"[", "dir0", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
      "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineLinks", "[", 
    RowBox[{"dir_", ",", "anchor_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coords", "=", "anchor"}], "}"}], ",", 
     RowBox[{"ColumnForm", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "dir", "]"}], "]"}], "=", "i"}], ";", 
         RowBox[{"getLink", "[", 
          RowBox[{"dir", ",", "coords"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"latticeDimensions", "[", 
           RowBox[{"[", "dir", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"b7aa2f88-b371-4297-9bcb-cb1b8f7d99ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Use", " ", "expr"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\[OpenCurlyDoubleQuote]", 
        RowBox[{"filename", ".", "xml"}], "\[CloseCurlyDoubleQuote]"}], "]"}],
       " ", "to", " ", "load", " ", "XML", " ", 
      RowBox[{"file", ".", "\[IndentingNewLine]", "To"}], " ", "explore", " ",
       "the", " ", "XML", " ", "tree"}]}], ",", 
    RowBox[{"use", ":", 
     RowBox[{
      RowBox[{"xmlFilter", "[", 
       RowBox[{
        RowBox[{"expr", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[OpenCurlyDoubleQuote]", "tag1", "\[CloseCurlyDoubleQuote]"}], 
          ",", "..."}], "}"}], ",", "True"}], "]"}], "\[IndentingNewLine]", 
      "To", " ", "extract", " ", "something"}]}], ",", 
    RowBox[{"use", ":", 
     RowBox[{"xmlFilter", "[", 
      RowBox[{
       RowBox[{"expr", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "\[OpenCurlyDoubleQuote]", "tag1", "\[CloseCurlyDoubleQuote]"}], ",",
          "..."}], "}"}]}], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"xmlFilter", "[", 
      RowBox[{"expr_String", ",", 
       RowBox[{"{", "}"}], ",", "_"}], "]"}], ":=", 
     RowBox[{"ToExpression", "[", "expr", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xmlFilter", "[", 
      RowBox[{"expr_XMLElement", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"flag_:", "False"}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"flag", ",", 
       RowBox[{"expr", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "expr"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xmlFilter", "[", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"a_", ",", "tags_", ",", "branches_"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b___"}], "}"}], ",", 
       RowBox[{"flag_:", "False"}]}], "]"}], ":=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xmlFilter", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "b", "}"}], ",", "flag"}], "]"}], "&"}], ",", 
         "branches"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "=!=", "Null"}], ")"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xmlFilter", "[", 
     RowBox[{
      RowBox[{"XMLElement", "[", 
       RowBox[{"_", ",", "tags_", ",", "branches_"}], "]"}], ",", 
      RowBox[{"{", "__", "}"}], ",", 
      RowBox[{"_", ":", "False"}]}], "]"}], ":=", "Null"}]}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ca2cbcfa-6ca5-43d3-a09e-6bd7ec5ba3e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Analysis", \
"Section",ExpressionUUID->"76e3bcbc-ac2e-4979-ae1b-903dcd5b1de9"],

Cell[CellGroupData[{

Cell["Test matrixPower, SU(N)  generators.", \
"Subsection",ExpressionUUID->"dbb30539-1695-457a-b017-3b73cf822a2d"],

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"centerSUMatrix", "[", 
   RowBox[{"7", ",", "1"}], 
   "]"}]}]], "Input",ExpressionUUID->"555344c0-e344-4398-99ab-399bb54f2c22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"randomSUMatrix", "[", "7", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"6c7d094d-cbee-4294-80eb-6a953a7e0f74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"gaugeField", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "15"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.766972462904788*^9, 3.766972464175539*^9}, {
  3.767356782678484*^9, 3.7673567833886337`*^9}, {3.767357017701527*^9, 
  3.767357038858267*^9}, {3.76735796456426*^9, 3.767357975954447*^9}, {
  3.7673907291441927`*^9, 
  3.7673907295357113`*^9}},ExpressionUUID->"cfc0aeba-e57b-47db-a6ee-\
89128e519b02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.286707907915115`"}], "-", 
      RowBox[{"0.126614078879356`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.453057885169983`"}], "+", 
      RowBox[{"0.223333477973938`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.67569375038147`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.435966104269028`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.499684810638428`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.676115691661835`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.40719085931778`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.271043479442596`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.160523325204849`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.167768090963364`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.428560137748718`"}], "-", 
      RowBox[{"0.106237903237343`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.110135458409786`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.702468574047089`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.007040038704872`"}], "+", 
      RowBox[{"0.547182321548462`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"614db75c-1efb-4cf7-b244-738694068759"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "x", 
  "]"}]], "Input",ExpressionUUID->"7c0ffab6-45e8-4dba-b792-2602745013bb"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"e0dbf00f-bb5d-4577-b9c0-cb5f91c2c990"]
}, Open  ]],

Cell["Take the root", \
"Text",ExpressionUUID->"c9017db1-49ec-4c31-8ae8-ca07d7c59fe5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"x", ",", "0.2"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9737b979-7234-403d-a77f-da741cd131e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "z", 
  "]"}]], "Input",ExpressionUUID->"1df9ed73-c862-47a0-84db-d0408348232a"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"814c246a-0b03-4c16-b160-d6134e299f81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], "-", 
    RowBox[{"SUPower", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], ",", "Infinity"}], 
  "]"}]], "Input",ExpressionUUID->"2c93c725-dd14-4d13-b4fd-b476efb9ce97"],

Cell[BoxData["2.3862737962066544`*^-15"], \
"Output",ExpressionUUID->"f5da0924-6b37-42f2-9dc8-5ad2b2d79f8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrixEqual", "[", 
  RowBox[{
   RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], ",", "x"}], 
  "]"}]], "Input",ExpressionUUID->"2db875f1-e723-407d-aefd-63d570ce6bac"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"9fb778d4-d043-446c-abc5-556615ad6851"]
}, Open  ]],

Cell["Test normalization & orthogonality of the SU (N) generators", \
"Text",ExpressionUUID->"ee74d701-9f31-481b-9378-90bddc250cff"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", 
      RowBox[{"suGenerators", "[", "4", "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"0db0eee5-a0dc-4831-bfdb-a24fefefcb4a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Axial gauge", \
"Subsection",ExpressionUUID->"a1c1bbe6-f074-406a-ac7c-c6ffc4eacbaf"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-4.m\>\""}]], \
"Input",ExpressionUUID->"ec3655d8-38b1-4a7d-b718-4b80aeeef422"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"5dd31ab0-fae4-46d2-bd92-48606c717fd6"],

Cell[BoxData["0.815348021267465`"], \
"Output",ExpressionUUID->"96356ade-20c6-470e-84f2-c7af12ba3e28"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "3", 
  "]"}]], "Input",ExpressionUUID->"89ef1a0c-4f0f-470f-8cb8-7133aac8adb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"67ae6656-91d7-4223-bc46-982774baca07"],

Cell[BoxData["0.8153483292850945`"], \
"Output",ExpressionUUID->"b382e4b5-1045-4a8b-9b31-923b2558b4fa"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test staples", \
"Subsection",ExpressionUUID->"a3cdfc84-d033-4252-a8cf-5af5f301749c"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-3-5.m\>\""}]], \
"Input",ExpressionUUID->"8a0090dd-648b-4a98-bbe4-88d68ac28f27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xxx", "=", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"8bb8d152-a1ab-4391-b0bf-f10ef2657976"],

Cell[BoxData["0.4780676533645084`"], \
"Output",ExpressionUUID->"2f84213c-e692-48ac-b402-c87ce9cdafbd"]
}, Open  ]],

Cell["Set all links to the identity", \
"Text",ExpressionUUID->"29ab58da-7987-4db3-ad7a-e1b6c642b2ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "nc", "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"nd", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"b946bfba-43dc-4c26-bf82-3da15da84f5d"],

Cell[BoxData[
 RowBox[{"sumStaples", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"b3ae56a7-b5ea-45a7-900e-faa0581cbc49"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stapleTest", "[", 
  "]"}]], "Input",ExpressionUUID->"e08438ab-1886-4139-8295-f618f20cd11a"],

Cell[BoxData["0.47806765336450835`"], \
"Output",ExpressionUUID->"9463abf1-266d-4062-b35b-5e39fe6d2f71"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Identity staple example, SU(3)", \
"Subsection",ExpressionUUID->"f4464fcb-ed0c-431c-b4f5-227baa261730"],

Cell["\<\
Special case where the sum of staples is proportional to the identity matrix.\
\
\>", "Text",ExpressionUUID->"7bd7c1f1-f796-4265-82ea-6a8e126860aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diagValue", "=", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], "+", 
   RowBox[{"Cos", "[", "x2", "]"}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"-", "x1"}], "-", "x2"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"0d67449f-c358-48e6-8b38-5d4e2f1add6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", "x1", "]"}], "+", 
  RowBox[{"Cos", "[", "x2", "]"}], "+", 
  RowBox[{"Cos", "[", 
   RowBox[{"x1", "+", "x2"}], 
   "]"}]}]], "Output",ExpressionUUID->"4eef9b96-a494-4f81-99b6-737e493d846c"]
}, Open  ]],

Cell["Saddle Points", \
"Text",ExpressionUUID->"a0464767-ca93-4581-8597-e451ffe1e8f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x1"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x2"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"af89cbe1-338e-4cef-998d-c67adf7572b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "3"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "3"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "3"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "3"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"af8b7a00-4f48-4626-b974-0fddf5b873ed"]
}, Open  ]],

Cell["Hessian", "Text",ExpressionUUID->"0954b861-0f81-43ae-8ad5-16da4ea3ea52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hess", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"diagValue", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"b24c3d88-a98a-40f7-93d2-f031ab078441"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "x1", "]"}]}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "x2", "]"}]}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"df5b0e4c-d197-487e-9c0d-9e20fcde8af6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dh", "=", 
  RowBox[{
  "Det", "[", "hess", 
   "]"}]}]], "Input",ExpressionUUID->"2ba79ffb-a384-4fbf-9f38-f1be7adf34c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], " ", 
   RowBox[{"Cos", "[", "x2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x1", "+", "x2"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "x2", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x1", "+", "x2"}], 
    "]"}]}]}]], \
"Output",ExpressionUUID->"43067a60-b854-424c-8603-8d425ac1c69b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"Pi", " ", 
      RowBox[{"4", "/", "3"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot3D", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", " ", "limit"}], ",", " ", "limit"}], "}"}], ",", 
       RowBox[{"RegionFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2"}], "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x3", "=", 
              RowBox[{
               RowBox[{"-", "x1"}], "-", "x2"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x2"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x2", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}]}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
     
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
       "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"c72af4ec-7c81-415f-8f65-8af9ecc32fa1"],

Cell[CellGroupData[{

Cell["Test saddle point routine", \
"Subsubsection",ExpressionUUID->"85019890-0681-4f49-8583-e443e57c2bc5"],

Cell["Run this as a group", \
"Text",ExpressionUUID->"04d5a4f9-1452-49f3-91d1-c4b5e635e170"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sqrtU1", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{
     RowBox[{"u1", "=", 
      RowBox[{"randomSUMatrix", "[", "3", "]"}]}], ",", "0.5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"phi1", "=", 
  RowBox[{
  "centerPhases", "[", "u1", 
   "]"}]}]}], "Input",ExpressionUUID->"a34cbdc5-1800-4656-9eb9-b9036fd77ede"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.42391752922662185`"}], ",", 
   RowBox[{"-", "2.2314878567767438`"}], ",", "2.6554053860033657`"}], 
  "}"}]], "Output",ExpressionUUID->"4ef32737-8e8e-4933-a99f-61bbd3563920"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sqrtU2", ",", "maxShift"}], "}"}], "=", 
   RowBox[{"saddlePointStep", "[", 
    RowBox[{"sqrtU1", ",", "sqrtU1"}], "]"}]}], ";", 
  "maxShift"}]], \
"Input",ExpressionUUID->"9359b299-7106-4975-a5e7-95091bf73f7b"],

Cell[BoxData["1.461588118924735`"], \
"Output",ExpressionUUID->"b0905531-6aea-4f1a-ac03-d064bf30c3f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi2", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"sqrtU2", ".", "sqrtU1"}], 
   "]"}]}]], "Input",ExpressionUUID->"455cc151-6deb-4755-9696-673d3176cb5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.17067307975431892`"}], ",", 
   RowBox[{"-", "3.006417470315977`"}], ",", "3.177090550070296`"}], 
  "}"}]], "Output",ExpressionUUID->"6b863867-81a1-4e5d-89fe-04371aa909ad"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"3", 
      RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"DensityPlot", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"phi1", ",", "2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{"phi2", ",", "2"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"DensityPlot", "[", 
      RowBox[{"dh", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}]}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"c954456b-3d8f-489a-9835-7b0476313236"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test nearest stationary point", \
"Subsection",ExpressionUUID->"ea282df4-9160-4463-8126-eaff1b79fc30"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
staple and starting matrix.  To compare,  remove the damping factors in the \
function saddlePointStep[] by setting zzz to a large number.  Don\
\[CloseCurlyQuote]t forget to set it back again, when you are done.\
\>", "Text",ExpressionUUID->"a7813421-ea59-48d0-93a1-48d9b854885f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeRandomStaple", "[", 
    RowBox[{
     RowBox[{"nd_:", "nd"}], ",", 
     RowBox[{"nc_:", "nc"}]}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "nc", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", " ", "nd"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "bb", "]"}], ";", 
  RowBox[{"bVector", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"bb", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
    RowBox[{
    "suGenerators", "[", "3", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"a1c3eed8-029f-4991-bfbf-da8c98937504"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "7", "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"bb", "[", "8", "]"}], 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "4", "]"}]}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "2", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "5", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "4", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"bb", "[", "7", "]"}], "2"]}], "+", 
      FractionBox[
       RowBox[{"bb", "[", "8", "]"}], 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "3", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "6", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "2", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "5", "]"}]}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "3", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "6", "]"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bb", "[", "8", "]"}], 
       SqrtBox["3"]]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"d8e12ff3-f4a2-4268-81b6-a945ffa74e4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run test", \
"Subsubsection",ExpressionUUID->"da7b8aa5-359a-4015-8f83-c1c7061ad4ea"],

Cell["Make random staple and starting link.", \
"Text",ExpressionUUID->"9e8bb80e-1572-4b9d-bc2b-e63fc0601168"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testStaple", "=", 
   RowBox[{"makeRandomStaple", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], ";", 
  RowBox[{"uu", "=", 
   RowBox[{"randomSUMatrix", "[", "3", "]"}]}], ";", 
  RowBox[{"sqrtU", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"uu", ",", "0.5"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9130c6e3-6caa-48da-a201-516f3848d814"],

Cell["\<\
Explicitly find the second order expansion of the exponential.\
\>", "Text",ExpressionUUID->"598ce003-f717-4a15-b9ca-f7d259cfb5c6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"testStaple", ".", "sqrtU", ".", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", "bVector"}], "-", 
         RowBox[{
          RowBox[{"bVector", ".", "bVector"}], "/", 
          RowBox[{"2", "!"}]}]}], "]"}], ".", "sqrtU"}], "]"}], "]"}], "]"}], 
   "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], "+", 
       RowBox[{"Re", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{"bb", "[", "i_", "]"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{"bb", "[", "i", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{
         RowBox[{"bb", "[", "i_", "]"}], "^", "n_"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{
        RowBox[{"bb", "[", "i", "]"}], "^", "n"}]}]}]}], 
    "}"}]}]}]], \
"Input",ExpressionUUID->"6a95ba59-19b7-49dd-9b6e-5a60dc89ad9f"],

Cell[BoxData[
 RowBox[{"0.06480721510015602`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.12821903742340007`", " ", 
   RowBox[{"bb", "[", "1", "]"}]}], "-", 
  RowBox[{"0.017530096842705692`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"0.74032458994588`", " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "+", 
  RowBox[{"0.044067467499046734`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "+", 
  RowBox[{"0.04415017909701744`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"0.18307710974403357`", " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "+", 
  RowBox[{"0.0685215523956914`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "+", 
  RowBox[{"0.20636379875421682`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "-", 
  RowBox[{"0.04282188602935076`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"1.1955226336823765`", " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "+", 
  RowBox[{"0.07577736042296279`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "+", 
  RowBox[{"0.04796607819258446`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "-", 
  RowBox[{"0.017530096842705692`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"0.7683469773000366`", " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.07577736042296279`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.09139772558091842`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.044067467499046734`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.04415017909701744`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "5", "]"}], "2"]}], "-", 
  RowBox[{"0.9795360462471192`", " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.04796607819258446`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.09139772558091842`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "-", 
  RowBox[{"0.0685215523956914`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.20636379875421682`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "-", 
  RowBox[{"0.04282188602935076`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"0.04009956035686858`", " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.0685215523956914`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.044067467499046734`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.04796607819258446`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.07577736042296279`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.017530096842705692`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "7", "]"}], "2"]}], "+", 
  RowBox[{"1.4817108975112037`", " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.23828838952348166`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.03956093672094349`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.02544236422307973`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.1055370029349256`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.027693228156459276`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.043750079438676856`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.10042669042537271`", " ", 
   RowBox[{"bb", "[", "7", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.006728894326013007`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "8", "]"}], 
    "2"]}]}]], "Output",ExpressionUUID->"64dc79fd-029e-4e29-a649-b85b1234c467"]
}, Open  ]],

Cell["Find the stationary point, based on this :", \
"Text",ExpressionUUID->"311645dc-63f3-4d62-b159-2a5da2e39cf6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"bb", "[", "i", "]"}]}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"550f4ef5-06c0-4564-ba47-23d788a873b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"bb", "[", "1", "]"}], "\[Rule]", "3.8883859183148437`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", "5.249366003196768`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "3", "]"}], "\[Rule]", 
    RowBox[{"-", "4.927835034690193`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "4", "]"}], "\[Rule]", "23.175057943245008`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "5", "]"}], "\[Rule]", "6.28661812583194`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "6", "]"}], "\[Rule]", 
    RowBox[{"-", "11.723830992667104`"}]}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "7", "]"}], "\[Rule]", "2.8457373793233165`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "8", "]"}], "\[Rule]", "7.857140243064931`"}]}], 
  "}"}]], "Output",ExpressionUUID->"6663496b-ceb7-4cd7-886d-871c03506446"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v1", "=", 
  RowBox[{"sqrtU", ".", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"I", " ", "bVector"}], "/.", "sp"}], "]"}], ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"c03163ff-9f1b-4818-bd65-86fab0e3a288"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.7476090097180903`"}], "-", 
      RowBox[{"0.22951155957908623`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.335741264180556`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.5054562066571192`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.12932578812907483`"}], "+", 
      RowBox[{"0.058922659571202074`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.4933955814756885`"}], "-", 
      RowBox[{"0.24481846300884166`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3668340714264703`"}], "-", 
      RowBox[{"0.6704165582206421`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.14886520486988583`"}], "+", 
      RowBox[{"0.3007295689378918`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.28892965125124753`"}], "+", 
      RowBox[{"0.03936482676197267`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.10207975338637645`"}], "-", 
      RowBox[{"0.19325101068579753`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.16228835165880864`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.9169876382891939`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"6b4dc889-2c2e-4246-be78-0385ce1c60ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v1", 
  "]"}]], "Input",ExpressionUUID->"c0f5bc1c-9524-457c-9b77-7b68fba52094"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1796409843003421`"}], ",", 
   RowBox[{"-", "1.9120374739044288`"}], ",", "3.091678458204771`"}], 
  "}"}]], "Output",ExpressionUUID->"a140147f-a541-4fbd-9478-4ccfb5470524"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"3fe08654-62f2-4d02-9d81-7e2b3d7a8735"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"u2", ",", "maxShift"}], "}"}], "=", 
  RowBox[{"saddlePointStep", "[", 
   RowBox[{
    RowBox[{"sqrtU", ".", "testStaple"}], ",", "sqrtU"}], 
   "]"}]}]], "Input",ExpressionUUID->"80497507-228c-4fdc-80f9-3b7206b667b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.13653527957725262`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.09344271430127482`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.18638498242262888`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.47568146206556344`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.43382351553214704`"}], "-", 
        RowBox[{"0.7234718508142421`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.13009828063605627`"}], "-", 
        RowBox[{"0.8588794300927556`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.3312192016472867`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.3374258739224083`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.08635107604282788`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.11992361599436807`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.4609487847724426`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.07452084494063346`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5655193775672323`"}], "-", 
        RowBox[{"0.4422818542946204`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5095544846271818`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.08307637233384942`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", "1.7152198809204242`"}], 
  "}"}]], "Output",ExpressionUUID->"d929d9ec-0e5c-4260-87e1-a19bd3843d16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v2", "=", 
  RowBox[{
  "u2", ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"ac7a0f4c-2d12-4266-b88c-dfe83862a927"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.19551866997240502`"}], "+", 
      RowBox[{"0.23457433474901726`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6609245706650578`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.19763814325071666`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3378406089868933`"}], "-", 
      RowBox[{"0.5627867538528791`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.1850793871964294`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.6892884244432391`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14448007317984154`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.5656073243540151`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.33902905551563495`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.18681608862934684`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5542781940117429`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.3002500677367288`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.4279854774363637`"}], "-", 
      RowBox[{"0.012655845219736728`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.11833457994329791`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.6366245112640231`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"cdeba3aa-4043-43f2-839d-c2f72736f691"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v2", 
  "]"}]], "Input",ExpressionUUID->"89631d59-895b-46fd-b2a6-708ffba5df6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.7797693846319387`"}], ",", 
   RowBox[{"-", "1.5363557587051466`"}], ",", "2.3161251433370853`"}], 
  "}"}]], "Output",ExpressionUUID->"5c0ed2db-65de-4e12-8183-a323141ffc18"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare SU(4) mean plaquette against Teper\[CloseCurlyQuote]s results", \
"Subsection",ExpressionUUID->"0e3721d3-9f9f-4aec-8b17-a0e0b5a6136f"],

Cell["\"w_plaq\" is average of all plaquettes.", \
"Text",ExpressionUUID->"ef9662a6-3428-44ce-9551-657dce9923b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<../chroma/3-4-build/mainprogs/main/periodic-16-28-out.xml\>\"", 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"93e6aeaa-35d6-415a-a5b1-2a02a3b5d13b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<../chroma/3-4-build/mainprogs/main/periodic-16-33-out.xml\>\"", 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"45f1a60c-af24-4ccf-a0a9-aec69bcc0a8a"],

Cell["\<\
Pull out the average plaquette from the production lattice updates.\
\>", "Text",ExpressionUUID->"305c15a3-7e7c-4b48-ab43-e2dc8c22f5e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"wp", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"xmlFilter", "[", 
     RowBox[{
      RowBox[{"expr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<purgaug\>\"", ",", "\"\<doHB\>\"", ",", "\"\<MCUpdates\>\"", ",", 
        "\"\<elem\>\"", ",", "\"\<Update\>\"", ",", 
        "\"\<InlineObservables\>\"", ",", "\"\<elem\>\"", ",", 
        "\"\<Plaquette\>\"", ",", "\"\<w_plaq\>\""}], "}"}]}], "]"}], "]"}]}],
   "]"}]], "Input",ExpressionUUID->"ba8f4f67-3074-4dd8-ab48-9be37129ddd0"],

Cell[BoxData["80000"], \
"Output",ExpressionUUID->"46d37a46-c830-4f72-83cf-ad5204430a92"]
}, Open  ]],

Cell["\<\
Mean and standard error, ignoring autocorrelations.  
For SU(4), 2+1 dimensions, L=16^3 lattice, beta=28 abd 33, the average \
plaquette values match Teper\[CloseCurlyQuote]s result.  See \
arXiv:hep-lat/0206027v1 24 Jun 2002.\
\>", "Text",ExpressionUUID->"14a1ebbf-69e7-46dd-953d-62dca914e78d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Length", "[", "wp", "]"}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"bb541a45-0edc-4f89-a74e-93d177e29aa1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8402045766379095`", ",", "2.2906853105782302`*^-6"}], 
  "}"}]], "Output",ExpressionUUID->"4f962fa8-e928-4860-8d75-940c4f87cfc9"]
}, Open  ]],

Cell["\<\
What is the effect of autocorrelations on the error estimate?  Using \
https://en.wikipedia.org/wiki/Unbiased_estimation_of_standard_deviation
Find a model for the autocorrelation function (ACF), fitting to an \
exponential:\
\>", "Text",ExpressionUUID->"690ba936-9f6d-46ea-ab01-8d5adf0820e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cutoff", "=", "20"}], "}"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "cutoff"}], "}"}]}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"CorrelationFunction", "[", 
          RowBox[{"wp", ",", 
           RowBox[{"{", "cutoff", "}"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"e46d7efd-f26c-49cb-9f83-eefcf3a7baee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"data", ",", "5"}], "]"}], ",", 
    RowBox[{"{", "x", "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"502f87f3-c302-4b7a-9fac-dce132715663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.27120992780493314`"}], " ", 
  "x"}]], "Output",ExpressionUUID->"ea5b9977-e2d6-460b-802f-29bd3d916365"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ff", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"0a7c8018-a533-4964-af3f-4f49342775dc"],

Cell["\<\
From the Wikipedia article, the correction to the standard error is \
Sqrt[gamma2/gamma1], where :\
\>", "Text",ExpressionUUID->"0e87aa9a-e980-43af-8632-cd793257c02e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma1", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"f8aa7823-a8c9-40da-95b3-6a5cc997ff6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma2", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"eee091d7-c009-48ab-9225-64b5ad597bf6"],

Cell["Since n is large, look at leading order in n :", \
"Text",ExpressionUUID->"ac25176b-3a8b-41fe-b9d2-4acd5856e68a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gamma1", "[", "Infinity", "]"}], ",", 
   RowBox[{"gamma2", "[", "Infinity", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"900f3d2c-1a30-4aff-a3be-1993cc8be3bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "7.419507653729886`"}], 
  "}"}]], "Output",ExpressionUUID->"eabe90bb-9259-477d-90c2-92d38b99327d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", "ff", "]"}]}], ")"}]}], "-", "1"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "1"}]}]], "Input",ExpressionUUID->"f04096b5-7675-497b-bbfb-d91a959e30e3"],

Cell[BoxData["7.419507653729886`"], \
"Output",ExpressionUUID->"4ce74d29-2536-41a7-9e21-ca02c4c63f63"]
}, Open  ]],

Cell["\<\
There is a modest impact on the standard error, with the estimate now \
matching Teper\[CloseCurlyQuote]s values.\
\>", "Text",ExpressionUUID->"b0145318-b479-46c8-9602-f7fef270df58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"gamma2", "[", "Infinity", "]"}], "/", 
      RowBox[{"Length", "[", "wp", "]"}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"4f7f5246-cce3-47d4-ad8f-4cbff69cdfd2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8402045766379095`", ",", "6.2395457644550605`*^-6"}], 
  "}"}]], "Output",ExpressionUUID->"7e7693a4-f764-447f-a387-81673d9bc8ea"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Junk", \
"Subsection",ExpressionUUID->"e924a166-cbb2-49c0-9107-c62bdb273a1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";", " ", 
  RowBox[{"s2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "I"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "I"}], ",", "0"}], "}"}]}], "}"}]}], ";", " ", 
  RowBox[{"s3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{"f", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MatrixExp", "[", 
       RowBox[{"I", " ", "theta", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a1", " ", "s1"}], "+", 
          RowBox[{"a2", " ", "s2"}], "+", 
          RowBox[{"a3", " ", "s3"}]}], ")"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"a1", "^", "2"}], "+", 
        RowBox[{"a2", "^", "2"}], "+", 
        RowBox[{"a3", "^", "2"}]}], "\[Rule]", "1"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "theta"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Cos", "[", "theta", "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "theta", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", "theta"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Cos", "[", "theta", "]"}], "-", 
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "theta", "]"}]}]}]}]}], "}"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"e1eb29bf-9dcc-4b76-b3a1-3e46eaefd7a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "theta", "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}]}], ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"a1", "+", 
        RowBox[{"\[ImaginaryI]", " ", "a2"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "a1"}], "+", "a2"}], ")"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "theta", "]"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7640901297796173`*^9, {3.764090185432784*^9, 3.764090208688999*^9}, {
   3.764090390002452*^9, 3.764090413839761*^9}, {3.7640905106279488`*^9, 
   3.764090530963612*^9}, {3.764090590495772*^9, 
   3.76409063039958*^9}},ExpressionUUID->"497a0bd8-f860-4628-b8f1-\
8500df8bab70"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-2-4.m\>\""}]], \
"Input",ExpressionUUID->"687a4d23-5895-4924-89a9-1196300c6879"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-3-5.m\>\""}]], \
"Input",ExpressionUUID->"e34fab0e-b44b-4c3d-8d25-ac88f8a55c81"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-4-1.m\>\""}]], \
"Input",ExpressionUUID->"17027b02-a754-4f33-bdcd-1cf91382dac2"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-4-trans-5.m\>\""}]], \
"Input",ExpressionUUID->"1e43abe6-8062-4359-beae-416f2c398c84"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<periodic-3-4-16-33-1.m\>\""}]], \
"Input",ExpressionUUID->"b0740f62-9370-4b30-a855-ca38d1317e9e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<periodic-3-4-16-28-1.m\>\""}]], \
"Input",ExpressionUUID->"b177112c-c694-4bc2-9057-c002b234572e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<winding-3-4-20-60-0-10.m\>\""}]], \
"Input",ExpressionUUID->"afc12508-8527-4205-991e-e5bd2a0e99cc"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<winding-3-4-20-60-1-10.m\>\""}]], \
"Input",ExpressionUUID->"2a0498d4-3117-4fe5-821f-663b74dc9582"],

Cell[BoxData[
 RowBox[{
  RowBox[{"badMatrices", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"gaugeField", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"SUMatrixQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "7"}]}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"4450b32a-06a8-4f09-8753-4dbf6a662d7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"beta", ",", "nc", ",", "nd", ",", "latticeDimensions", ",", 
   RowBox[{"Dimensions", "[", "gaugeField", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.766971654166103*^9, 3.766971666373981*^9}, {
  3.767019041979619*^9, 
  3.7670190717957973`*^9}},ExpressionUUID->"345de230-f994-4a52-b850-\
c6261e53bc8b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"40.`", ",", "4", ",", "3", ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "20", ",", "40"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "16000", ",", "4", ",", "4"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"7b32edf6-7159-4dff-bd30-31fc57a1c254"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phases", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"centerSUMatrix", "[", 
    RowBox[{"4", ",", "1"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"686d2b6b-ee73-41bc-913b-17e1265fdf07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["\[Pi]", "2"], ",", 
   FractionBox["\[Pi]", "2"], ",", 
   FractionBox["\[Pi]", "2"], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", "\[Pi]"}], "2"]}]}], 
  "}"}]], "Output",ExpressionUUID->"0a8dea0a-237e-42d1-9dee-869232eee0c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"phases", ",", "16"}], 
  "]"}]], "Input",ExpressionUUID->"7efc902e-0982-442d-9351-8caf64282079"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.57079632679489661923132169163975144225`16.", ",", 
   "1.57079632679489661923132169163975144225`16.", ",", 
   "1.57079632679489661923132169163975144225`16.", ",", 
   RowBox[{"-", "4.7123889803846898576939650749192543263`16."}]}], 
  "}"}]], "Output",ExpressionUUID->"22944976-91fa-4a34-9077-671955f5ad0f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"lineLinks", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"1d780d2a-b4a6-4278-bcc0-f75e106c6cd4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"latticeSaddlePoint", "[", "1", 
  "]"}]], "Input",ExpressionUUID->"84cd5e73-3a9a-4185-b2bd-67fec59043ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"phaseSum=\"\>", "\[InvisibleSpace]", 
   "0.00001738542873597204`"}],
  SequenceForm["phaseSum=", 0.00001738542873597204],
  Editable->
   False]], "Print",ExpressionUUID->"b8c3f386-375d-42ac-bd8a-7b4c8e073d7b"],

Cell[BoxData["$Aborted"], \
"Output",ExpressionUUID->"cf7b4edd-7065-432f-a2ef-5325ed4b8e17"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"plotAction", "[", 
  RowBox[{"3", ",", "1", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"ba76764a-4909-4732-8f1b-eeae0a1a519a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{891, 688},
WindowMargins->{{135, Automatic}, {18, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]

