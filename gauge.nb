Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7673569687731447`*^9, 
  3.7673569687738857`*^9}},ExpressionUUID->"521048f1-0f5b-40c7-9fcc-\
57a33d77e506"],

Cell["\<\
Disable current notebook FileOutlineCache and CellChangeTimes.  See: \
https://stackoverflow.com/questions/2816628/version-control-of-mathematica-\
notebooks \
\>", "Text",ExpressionUUID->"35ca5f76-e844-4a00-a9bb-a561656c5ecf"],

Cell[CellGroupData[{

Cell["Library", \
"Title",ExpressionUUID->"f375741d-7d1c-47d0-bfe3-71618e4fe201"],

Cell["\<\
For parallelization, I had to go to menu Evaluation->Parallel Kernel \
Configuration and set the number manually.  Automatic launching of additional \
kernels is broken?  Note that the parallelization is based on the leading \
dimension of the table.
Verify parallel kernels are running:\
\>", "Text",ExpressionUUID->"88d0e5ea-1d3e-4d52-a580-cb9c96ec1520"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/groups.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/xml.m\>\""}], ";", 
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b6e3936e-813f-4d67-89c4-91da0e5a71a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/lattice.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/linear-algebra.m\>\""}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"64e681c2-1f5a-4f7f-8644-87139d41dc21"],

Cell["Lattice Saddle Point", \
"Text",ExpressionUUID->"a31d566d-47d5-4d92-ac0c-ff3905ce56b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/minres1.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/minresqlp0.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/minres.m\>\""}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"13bc2c0e-f909-450a-b878-2d0e290395b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/saddle-point.m\>\""}], ";", 
  RowBox[{"<<", "\"\<mma-lib/saddle-point-single.m\>\""}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"abff722b-7fa1-4fd9-b9dc-08080e9da613"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", \
"Title",ExpressionUUID->"7e0331a4-4eb2-41b3-94e5-86dcad678450"],

Cell[CellGroupData[{

Cell["matrixPower, SU(N)  generators", \
"Section",ExpressionUUID->"a915cf74-4c38-4d5c-b12e-f8ad7e845e5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"centerSUMatrix", "[", 
   RowBox[{"1", ",", "7"}], 
   "]"}]}]], "Input",ExpressionUUID->"73ac614b-2c5d-40f5-be90-f396472d355b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "7"]]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"74113b54-4e96-446a-8db6-49558873bc08"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"randomSUMatrix", "[", "7", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"fa216d9c-67db-4ba0-bdc4-b39dbdc320b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"gaugeField", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "15"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.766972462904788*^9, 3.766972464175539*^9}, {
  3.767356782678484*^9, 3.7673567833886337`*^9}, {3.767357017701527*^9, 
  3.767357038858267*^9}, {3.76735796456426*^9, 3.767357975954447*^9}, {
  3.7673907291441927`*^9, 
  3.7673907295357113`*^9}},ExpressionUUID->"1f64a583-69b2-42a8-9963-\
49ededbbcd90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.956699371337891`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.040671166032553`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.049990065395832`"}], "-", 
      RowBox[{"0.066759899258614`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.130659118294716`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.242990866303444`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.00153985642828`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.025455404073`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.476965427398682`"}], "-", 
      RowBox[{"0.828118026256561`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.184020891785622`"}], "-", 
      RowBox[{"0.228496193885803`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.144960388541222`"}], "-", 
      RowBox[{"0.247807174921036`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.173146083950996`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.22313466668129`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.420855641365051`"}], "+", 
      RowBox[{"0.812828481197357`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"72c87ca0-f9c3-4356-ad85-4513aa8d1a05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "x", 
  "]"}]], "Input",ExpressionUUID->"34beec22-0d42-476b-af8f-7770315232a5"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"13ebbe24-af1a-4d3f-9e6d-45885e4ced68"]
}, Open  ]],

Cell["Take the root", \
"Text",ExpressionUUID->"f68269dd-a100-4778-9071-eed544479235"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"x", ",", "0.2"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0f55e86f-b06e-4721-8ecb-80d674dab003"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SUMatrixQ", "[", "z", 
  "]"}]], "Input",ExpressionUUID->"519a82eb-219d-42d4-9d0e-1d7b01982e4b"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"ab74ff2e-e90b-434e-87e6-599a0920bbe9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], "-", 
    RowBox[{"SUPower", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], ",", "Infinity"}], 
  "]"}]], "Input",ExpressionUUID->"c728bb26-3493-42da-bcc3-8701efa55f4d"],

Cell[BoxData["2.3262371608973003`*^-15"], \
"Output",ExpressionUUID->"4675e7fa-c97e-4fd5-a933-274ce2402c0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrixEqual", "[", 
  RowBox[{
   RowBox[{"z", ".", "z", ".", "z", ".", "z", ".", "z"}], ",", "x"}], 
  "]"}]], "Input",ExpressionUUID->"ea8e2c02-53da-4841-83e3-be26d23b7dc0"],

Cell[BoxData["True"], \
"Output",ExpressionUUID->"47d95cce-9c92-4dc7-ab98-6d949e47e113"]
}, Open  ]],

Cell["Test normalization & orthogonality of the SU (N) generators", \
"Text",ExpressionUUID->"e86a9bf5-97ff-4d98-a7f3-4db728247d82"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", 
      RowBox[{"suGenerators", "[", "4", "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"72865217-4dc5-4f64-ac67-8a517bce3460"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare Mathematica mean plaquette against chroma value", \
"Section",ExpressionUUID->"abbb4ee1-c58a-48b8-8869-b9b2684ecef8"],

Cell["Compare with chroma output xml file.", \
"Text",ExpressionUUID->"2e5d09b1-cf60-47a2-a3eb-1904ca74a7ee"],

Cell["These should match plane_ij_plaq.", \
"Text",ExpressionUUID->"2724db57-2251-429a-8d81-1befbd209daf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dir1", "<", "dir2"}], ",", 
      RowBox[{"Mean", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"plaquette", "[", 
           RowBox[{"dir1", ",", "dir2", ",", 
            RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "]"}], "/", 
          "nc"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir2", ",", 
      RowBox[{"dir1", "+", "1"}], ",", "3"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"a8a9551f-5f15-4660-b650-fb1bf6b44171"],

Cell["\<\
{{0.9424840512244733, 0.9432405719201301}, {0.9357560701712518}}\
\>", "Output",ExpressionUUID->"a0bcebfe-d249-4c45-801f-a29c2c79587c"]
}, Open  ]],

Cell["This should match w_plaq", \
"Text",ExpressionUUID->"dbfc2abc-9dff-46d2-a9da-3541d7be0284"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"Mean", "[", 
   RowBox[{"Flatten", "[", "%", "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"219efdc6-9b19-4c09-b592-1fc878c6cd85"],

Cell["0.9404935644386184", \
"Output",ExpressionUUID->"9284984f-4a36-41cc-951d-a513162a5ed0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Compare the mean plaquette against ",
 StyleBox["Teper\[CloseCurlyQuote]s",
  IgnoreSpellCheck->True],
 " results"
}], "Section",ExpressionUUID->"749b0427-f3f6-4123-953f-4dea85c49fc8"],

Cell["\"w_plaq\" is average of all plaquettes.", \
"Text",ExpressionUUID->"de356692-0883-4856-b03d-bdef43d93be1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-4/periodic-16-28-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"06e604df-e83f-4d14-9b1e-9a99bca1fa9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-4/periodic-16-33-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"9ccd0e9f-b9cf-4b27-98de-1d9bfe31a58e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/3-3/periodic-24-21-out.xml\>\"", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"3d4c948f-280e-4e8a-ad52-cb436a6edc5a"],

Cell["\<\
Pull out the average plaquette from the production lattice updates.\
\>", "Text",ExpressionUUID->"ce371329-b52e-4926-a1d1-933645646210"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"wp", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"xmlFilter", "[", 
     RowBox[{
      RowBox[{"expr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<purgaug\>\"", ",", "\"\<doHB\>\"", ",", "\"\<MCUpdates\>\"", ",", 
        "\"\<elem\>\"", ",", "\"\<Update\>\"", ",", 
        "\"\<InlineObservables\>\"", ",", "\"\<elem\>\"", ",", 
        "\"\<Plaquette\>\"", ",", "\"\<w_plaq\>\""}], "}"}]}], "]"}], "]"}]}],
   "]"}]], "Input",ExpressionUUID->"6ea2e23f-d3e5-45b6-abb7-923d3f49d955"],

Cell[BoxData["80000"], \
"Output",ExpressionUUID->"1278f8b4-40dc-4ecd-8035-8632d742ba5e"]
}, Open  ]],

Cell["\<\
Mean and standard error, ignoring autocorrelations.  
For SU(4), 2+1 dimensions, L=16^3 lattice, beta=28 abd 33, the average \
plaquette values match Teper\[CloseCurlyQuote]s result.  See \
arXiv:hep-lat/0206027v1 24 Jun 2002.\
\>", "Text",ExpressionUUID->"befeff86-5379-41fd-b0a4-145970b5e663"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Length", "[", "wp", "]"}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"020c970c-7646-4b66-ab85-5211c6c4ada0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8676694244789538`", ",", "1.40560374756656`*^-6"}], 
  "}"}]], "Output",ExpressionUUID->"f13ce096-b317-4dc8-999f-4d003bc4fc2d"]
}, Open  ]],

Cell["\<\
What is the effect of autocorrelations on the error estimate?  Using \
https://en.wikipedia.org/wiki/Unbiased_estimation_of_standard_deviation
Find a model for the autocorrelation function (ACF), fitting to an \
exponential:\
\>", "Text",ExpressionUUID->"b1734467-1350-4edb-a297-06f9bb6a53fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cutoff", "=", "20"}], "}"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "cutoff"}], "}"}]}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"CorrelationFunction", "[", 
          RowBox[{"wp", ",", 
           RowBox[{"{", "cutoff", "}"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
    "]"}]}], ";"}]], \
"Input",ExpressionUUID->"77b987bd-85ca-4981-9188-bd9e60cea850"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"data", ",", "5"}], "]"}], ",", 
    RowBox[{"{", "x", "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"95b5d40b-9031-43ed-99ee-b5d5d575e05b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.2872905383680901`"}], " ", 
  "x"}]], "Output",ExpressionUUID->"593abdfc-cb00-4c2b-b69d-0f6e1261ac21"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ff", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"0ba7ecda-95f9-48fb-bfd5-6e404ed0e15c"],

Cell["\<\
From the Wikipedia article, the correction to the standard error is \
Sqrt[gamma2/gamma1], where :\
\>", "Text",ExpressionUUID->"2b8d6915-0d04-46fa-bc2a-4b1a6c114940"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma1", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"02ad3d91-94f2-4d06-8edd-5adb96e7fdd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma2", "[", "n_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "n"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", "ff", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"77d31ad2-afff-407c-a5f7-4b1c0e8a084f"],

Cell["Since n is large, look at leading order in n :", \
"Text",ExpressionUUID->"d0c378ca-7938-4740-a816-02f68eca733f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gamma1", "[", "Infinity", "]"}], ",", 
   RowBox[{"gamma2", "[", "Infinity", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"ee283eb1-8124-4674-94ff-56b4647659d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "7.009409712669671`"}], 
  "}"}]], "Output",ExpressionUUID->"6f3493ce-c7b9-4e54-82de-0f26a89a2f46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", "ff", "]"}]}], ")"}]}], "-", "1"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "1"}]}]], "Input",ExpressionUUID->"cc76ed0f-7235-4dc5-8b40-ef8d841b3614"],

Cell[BoxData["7.009409712669671`"], \
"Output",ExpressionUUID->"327ecc95-a399-48cc-812f-bf6f2fe82aa1"]
}, Open  ]],

Cell["\<\
There is a modest impact on the standard error, with the error estimate now \
matching Teper\[CloseCurlyQuote]s error estimate.  Good agreement for both \
SU(3) and SU(4).\
\>", "Text",ExpressionUUID->"fa4c2483-8f54-4eeb-a742-321251006d2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "wp", "]"}], ",", 
   RowBox[{
    RowBox[{"StandardDeviation", "[", "wp", "]"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"gamma2", "[", "Infinity", "]"}], "/", 
      RowBox[{"Length", "[", "wp", "]"}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"b8586d19-45df-4201-b15d-530856de76b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8676694244789538`", ",", "3.7213766594582798`*^-6"}], 
  "}"}]], "Output",ExpressionUUID->"0c2a9ba5-5505-4e6b-8b40-e6967c69c92e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Polyakov loop", \
"Section",ExpressionUUID->"bfca384e-3450-4f6f-945c-733e2d635e7c"],

Cell["Test with trivial lattice.", \
"Text",ExpressionUUID->"ecf945c3-b3b4-4dc2-9382-4d28baf0ea32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6", ",", "8"}], "}"}]}], ";", 
  RowBox[{
  "makeTrivialLattice", "[", 
   "]"}]}]], "Input",ExpressionUUID->"ba8cc77a-2929-4864-a0e7-43036a36fb2a"],

Cell["\<\
Lattice with constant link in one direction.  Smeared Polyakov loop should \
give the same result as the simple Polyakov loop.\
\>", "Text",ExpressionUUID->"4d7d87eb-fbe5-455b-a634-c45a0c778336"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uu", "=", 
       RowBox[{"randomSUMatrix", "[", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Trace:  \>\"", ",", 
        RowBox[{"Tr", "[", "uu", "]"}]}], "]"}], ";", 
      RowBox[{"uu", "=", 
       RowBox[{"SUPower", "[", 
        RowBox[{"uu", ",", 
         RowBox[{"1", "/", 
          RowBox[{"latticeDimensions", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", "uu", ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"e48c5c7a-87c4-42d1-9e53-ca586dc49059"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trace:  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "0.9931499715202564`"}], "-", 
    RowBox[{"1.8506741973480212`", " ", "\[ImaginaryI]"}]}]}],
  SequenceForm["Trace:  ", 
   Complex[-0.9931499715202564, -1.8506741973480212`]],
  Editable->
   False]], "Print",ExpressionUUID->"f46d89d1-2605-4601-b5bb-afe8e9f76202"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyakovLoop", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"bff5b33d-e607-4469-a49b-f92256a07bfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.9931499715202567`"}], "-", 
  RowBox[{
  "1.8506741973480203`", " ", 
   "\[ImaginaryI]"}]}]], \
"Output",ExpressionUUID->"5c5ac057-2b73-4746-b2b6-59ef8c68dd04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyakovLoop", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"1567bf2b-c412-4ae4-ab8a-23bb535f8cce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.9931499715202567`"}], "-", 
  RowBox[{
  "1.8506741973480203`", " ", 
   "\[ImaginaryI]"}]}]], \
"Output",ExpressionUUID->"473f080a-427a-4662-910e-4ce9ba64ad51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"loopThickness", "[", 
  "]"}]], "Input",ExpressionUUID->"8f264d2d-4f9f-4ce1-84d7-801e89a12a39"],

Cell[BoxData["11.697598614944667`"], \
"Output",ExpressionUUID->"016e8517-097c-411e-adda-f3af00a37d86"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Axial gauge", \
"Section",ExpressionUUID->"390bad32-1acb-49c3-85aa-9007e41649ee"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-4.m\>\""}]], \
"Input",ExpressionUUID->"22c9696c-7de7-4ae7-b65c-fbe9c78c0256"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"f926c3ce-659f-4a49-9d2f-c404101369ab"],

Cell[BoxData["0.9404935644386324`"], \
"Output",ExpressionUUID->"61b0fa58-3229-4c1b-aff6-e92aff196f46"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "3", 
  "]"}]], "Input",ExpressionUUID->"2a91e4ae-13cf-4a7c-ab4d-b222df8a6e3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"averagePlaquette", "[", 
  "]"}]], "Input",ExpressionUUID->"fdbf45d3-6296-4a22-839d-f320b1941cec"],

Cell[BoxData["0.9404938721121576`"], \
"Output",ExpressionUUID->"b08d10fe-e599-4a53-8fac-37a19ce8de74"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["staples", \
"Section",ExpressionUUID->"86c065e9-8bbc-45f0-924a-a3d53a13e870"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<test-3-3-5.m\>\""}]], \
"Input",ExpressionUUID->"3373f6a1-fe4f-4d7f-8400-9941e7ffd180"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xxx", "=", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"ae979c30-3ea4-4b94-be05-119ee3fac4fe"],

Cell[BoxData["0.9404938721121576`"], \
"Output",ExpressionUUID->"df73d0e0-79c6-485c-8202-3011dab1fa75"]
}, Open  ]],

Cell["Set all links to the identity", \
"Text",ExpressionUUID->"da25be9e-0061-43aa-bcc2-44c291ecfaa7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeField", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "nc", "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"nd", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"5e6b0009-27d7-40a8-84fc-0e51d9a6fdb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sumStaples", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"ead4ecb9-6735-44e0-b9f5-d5a3fd73820a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"ea6b9e5d-310b-4f35-a6ad-91466df3b327"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stapleTest", "[", 
  "]"}]], "Input",ExpressionUUID->"0c7d5c04-32d5-48b1-8b6c-48c2ff086bc5"],

Cell[BoxData["1"], \
"Output",ExpressionUUID->"37f34192-e635-4849-817d-3bc29f147cf6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nearest stationary point for single  link and sum of staples", \
"Section",ExpressionUUID->"6798086d-fa2e-4ba6-9e82-7d6af60383a8"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
staple and starting matrix.  To compare,  remove the damping factors in the \
function saddlePointStep[] by setting rescaleCutoff to a large number and \
dampingFactor to 1.\
\>", "Text",ExpressionUUID->"1d3cb94f-7ba5-44cd-98af-a83fb16475e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], 
  ";"}]], "Input",ExpressionUUID->"a8a28067-3f69-440b-8508-7b7d70cd3ccc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeRandomStaple", "[", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "nd"}], "-", "2"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{"bVector", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"bb", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
    RowBox[{
    "suGenerators", "[", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"91a19e6a-2ac7-46fd-bc12-03dda9a4b9ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"bb", "[", "3", "]"}], "2"], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "2", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"bb", "[", "1", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"bb", "[", "2", "]"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bb", "[", "3", "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"1a969cdd-bad6-49ad-9fd7-cdf8d74ae40f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run test", \
"Subsection",ExpressionUUID->"7995b3f0-9cde-46fc-9fe0-25405eb3ac24"],

Cell["Make random staple and starting link.", \
"Text",ExpressionUUID->"98726971-28ea-4f65-a6f0-347be3ee9c96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testStaple", "=", 
   RowBox[{"makeRandomStaple", "[", "]"}]}], ";", 
  RowBox[{"uu", "=", 
   RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
  RowBox[{"sqrtU", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{"uu", ",", "0.5"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"8c9fa76e-8afe-4136-91be-3a65fd3ea695"],

Cell["\<\
Explicitly find the second order expansion of the exponential.\
\>", "Text",ExpressionUUID->"3ec7fa5f-8386-4182-b929-57585b3563de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"testStaple", ".", "sqrtU", ".", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", "bVector"}], "-", 
         RowBox[{
          RowBox[{"bVector", ".", "bVector"}], "/", 
          RowBox[{"2", "!"}]}]}], "]"}], ".", "sqrtU"}], "]"}], "]"}], "]"}], 
   "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], "+", 
       RowBox[{"Re", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{"bb", "[", "i_", "]"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{"bb", "[", "i", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"a_", " ", 
        RowBox[{
         RowBox[{"bb", "[", "i_", "]"}], "^", "n_"}]}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "a", "]"}], " ", 
       RowBox[{
        RowBox[{"bb", "[", "i", "]"}], "^", "n"}]}]}]}], 
    "}"}]}]}]], \
"Input",ExpressionUUID->"ded0c36d-7fa0-4fb6-9480-2dfca41845a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.6030275532297495`"}], "+", 
  RowBox[{"0.22039680098227182`", " ", 
   RowBox[{"bb", "[", "1", "]"}]}], "+", 
  RowBox[{"0.015288617837935316`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "1", "]"}], "2"]}], "-", 
  RowBox[{"0.0407710091245715`", " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "-", 
  RowBox[{"0.08847406444104186`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "2", "]"}]}], "+", 
  RowBox[{"0.2560891786144439`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"0.11257337848969418`", " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "-", 
  RowBox[{"0.23298831336539033`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "-", 
  RowBox[{"0.1043309231936697`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "3", "]"}]}], "+", 
  RowBox[{"0.1293790918550582`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"0.5379009306403653`", " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "-", 
  RowBox[{"0.31401150670946587`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "-", 
  RowBox[{"0.09354831246981164`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "4", "]"}]}], "+", 
  RowBox[{"0.015288617837935316`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{"0.555600156261005`", " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.31401150670946587`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.14407229353870987`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "-", 
  RowBox[{"0.08847406444104186`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "5", "]"}]}], "+", 
  RowBox[{"0.2560891786144439`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "5", "]"}], "2"]}], "-", 
  RowBox[{"0.18050557750477675`", " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "-", 
  RowBox[{"0.09354831246981164`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.14407229353870987`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.23298831336539033`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "-", 
  RowBox[{"0.1043309231936697`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "6", "]"}]}], "+", 
  RowBox[{"0.1293790918550582`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"0.8032798011194755`", " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.23298831336539033`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.08847406444104186`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.09354831246981164`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "-", 
  RowBox[{"0.31401150670946587`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "7", "]"}]}], "+", 
  RowBox[{"0.015288617837935316`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "7", "]"}], "2"]}], "+", 
  RowBox[{"0.15860880758372364`", " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.12047097318133473`", " ", 
   RowBox[{"bb", "[", "1", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.13451586543954497`", " ", 
   RowBox[{"bb", "[", "2", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.05108052492133582`", " ", 
   RowBox[{"bb", "[", "3", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.16636035491468185`", " ", 
   RowBox[{"bb", "[", "4", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.054010143386680975`", " ", 
   RowBox[{"bb", "[", "5", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "-", 
  RowBox[{"0.18129462792735007`", " ", 
   RowBox[{"bb", "[", "6", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.1463122053991444`", " ", 
   RowBox[{"bb", "[", "7", "]"}], " ", 
   RowBox[{"bb", "[", "8", "]"}]}], "+", 
  RowBox[{"0.2518826410336897`", " ", 
   SuperscriptBox[
    RowBox[{"bb", "[", "8", "]"}], 
    "2"]}]}]], "Output",ExpressionUUID->"be45b2e2-45d1-4915-955e-d1b6e9366965"]
}, Open  ]],

Cell["Find the stationary point, based on this :", \
"Text",ExpressionUUID->"634ef01a-48ac-4ab0-bc81-edec8040de95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"bb", "[", "i", "]"}]}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"4c2cfa2d-9841-425f-9a76-770226468312"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"bb", "[", "1", "]"}], "\[Rule]", "1.3623040829546842`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "2", "]"}], "\[Rule]", "1.8328728207904819`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "3", "]"}], "\[Rule]", "2.451217683590129`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "4", "]"}], "\[Rule]", "0.989808334724233`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "5", "]"}], "\[Rule]", "1.6805147702777736`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "6", "]"}], "\[Rule]", "1.2794214633970735`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "7", "]"}], "\[Rule]", "1.393498831375975`"}], ",", 
   RowBox[{
    RowBox[{"bb", "[", "8", "]"}], "\[Rule]", 
    RowBox[{"-", "0.5246179222097134`"}]}]}], 
  "}"}]], "Output",ExpressionUUID->"05d27b23-0491-462f-9681-bcea4e4a5f1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v1", "=", 
  RowBox[{"sqrtU", ".", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"I", " ", "bVector"}], "/.", "sp"}], "]"}], ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"d61d7994-b021-4229-9310-5ead7ca32823"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.10500072610684753`"}], "+", 
      RowBox[{"0.7471764929913395`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3763926601157129`"}], "+", 
      RowBox[{"0.2925191236190155`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3688040432177538`"}], "+", 
      RowBox[{"0.25970529696680233`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.02584670585333751`"}], "-", 
      RowBox[{"0.08708563702894037`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.6883507084853985`"}], "-", 
      RowBox[{"0.12434768985769185`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6437551089184221`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.2967125772796471`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.6152590791443152`"}], "-", 
      RowBox[{"0.2095386384142107`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3214403876383704`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.4244386399443151`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12998427043169897`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.5264806094239949`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"60199a2e-1cab-4666-8053-3cfecc0bda42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v1", 
  "]"}]], "Input",ExpressionUUID->"2be1ed46-0052-42e1-a14e-caeeac30e74f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6879403773840286`", ",", "2.094201568014401`", ",", 
   RowBox[{"-", "2.7821419453984295`"}]}], 
  "}"}]], "Output",ExpressionUUID->"f494d0bf-2c84-4de1-a4a3-add56adbb778"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"7dd62d34-e2e2-46c5-a65c-1f3b2ef25e72"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"u2", ",", "maxShift"}], "}"}], "=", 
  RowBox[{"linkSaddlePointStep", "[", 
   RowBox[{
    RowBox[{"sqrtU", ".", "testStaple"}], ",", "sqrtU", ",", 
    RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
    RowBox[{"dampingFactor", "\[Rule]", "1"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"274b3611-bfd8-4538-95f4-b1860c9486ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.4089145174283525`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.2508983043608513`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.03787668071595404`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.34276788224772575`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6106612329971187`"}], "+", 
        RowBox[{"0.5272640256806607`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.020235257317930966`"}], "+", 
        RowBox[{"0.2596879030558513`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6052322433259413`"}], "-", 
        RowBox[{"0.6189600529708443`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.07200228837862936`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.42136775185216835`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.8376513614860717`"}], "+", 
        RowBox[{"0.018217636329927456`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.048289528556046776`"}], "+", 
        RowBox[{"0.3596193012814569`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.002413105997776055`"}], "+", 
        RowBox[{"0.40785361445523044`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", "3.1814300260567525`"}], 
  "}"}]], "Output",ExpressionUUID->"182ae453-34cb-4487-a374-b866c3dff6ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v2", "=", 
  RowBox[{
  "u2", ".", 
   "sqrtU"}]}]], \
"Input",ExpressionUUID->"e39c645a-2af9-49b6-8f03-3335f2e24b68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.10500072610684626`"}], "+", 
      RowBox[{"0.7471764929913391`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.37639266011571504`"}], "+", 
      RowBox[{"0.29251912361901605`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.36880404321775234`"}], "+", 
      RowBox[{"0.2597052969668021`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.025846705853336843`"}], "-", 
      RowBox[{"0.08708563702894212`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.6883507084853975`"}], "-", 
      RowBox[{"0.12434768985769076`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6437551089184234`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.2967125772796465`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.6152590791443151`"}], "-", 
      RowBox[{"0.20953863841421153`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.32144038763836913`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.4244386399443155`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.1299842704316965`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.5264806094239953`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"6dfd1477-198d-461f-bc50-af515641454c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centerPhases", "[", "v2", 
  "]"}]], "Input",ExpressionUUID->"38985cff-17be-438e-a76c-fc60c38a360f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6879403773840297`", ",", "2.0942015680144004`", ",", 
   RowBox[{"-", "2.78214194539843`"}]}], 
  "}"}]], "Output",ExpressionUUID->"a6e757f5-4088-4b5f-8593-daecf5d86328"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nearest stationary point for entire lattice", \
"Section",ExpressionUUID->"95cf531b-c774-4c9e-a701-2817af3c0b40"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
lattice.  Tested for nd=3 and SU(2), SU(3) with multiple sites, and SU(4) \
with one site.\
\>", "Text",ExpressionUUID->"682f351b-bb5d-460b-9ca5-42443640777b"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"4fd7990a-1a12-4fb8-b10a-e7f2a2023085"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Switch", " ", "order", " ", "to", " ", "verify", " ", "we", " ", "are", 
    " ", "not", " ", "dependent", " ", "on", " ", 
    RowBox[{"latticeCoordinates", "[", "]"}], " ", 
    RowBox[{"indexing", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"linearSiteIndex", "[", 
       RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", "i", ",", 
        RowBox[{
         RowBox[{"latticeVolume", "[", "]"}], "-", "i", "+", "1"}]}], "]"}]}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]}], \
"Input",ExpressionUUID->"1c3971d5-2ff0-4eb6-8bd2-e735288849a3"],

Cell[BoxData["0.11416926656338111`"], \
"Output",ExpressionUUID->"e4c12253-8d44-4dd0-9664-fbc76b2497ee"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{
   RowBox[{"bVector", "[", 
    RowBox[{"dir_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", 
        RowBox[{"dir", ",", "site", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
     RowBox[{"suGenerators", "[", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"9b04eb0b-2c48-4bdb-9045-6c21ab7b90f0"],

Cell["\<\
Create links with second order perturbation.  Variables have same lattice \
index as links.\
\>", "Text",ExpressionUUID->"aa68c211-373b-4d0a-aa86-915f456015de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"SUPower", "[", 
        RowBox[{
         RowBox[{"gaugeField", "[", 
          RowBox[{"[", 
           RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}], ".", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"bVector", "[", 
           RowBox[{"dir", ",", "i"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"bVector", "[", 
            RowBox[{"dir", ",", "i"}], "]"}], ".", 
           RowBox[{"bVector", "[", 
            RowBox[{"dir", ",", "i"}], "]"}]}], "/", 
          RowBox[{"2", "!"}]}]}], ")"}], ".", 
       RowBox[{"SUPower", "[", 
        RowBox[{
         RowBox[{"gaugeField", "[", 
          RowBox[{"[", 
           RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"dd43032c-3c2f-47d3-b9c4-6400e3d30e4d"],

Cell["Sum of plaquettes, not taking the real part yet:", \
"Text",ExpressionUUID->"189c55ea-c7a5-40be-9a11-d6f147a69c47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coords", "=", 
          RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k2", ",", 
             RowBox[{"linearSiteIndex", "[", 
              RowBox[{"shift", "[", 
               RowBox[{"k1", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"linearSiteIndex", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"k2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
           "]"}], ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", " ", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"bb", "[", "a__", "]"}], "]"}], "\[Rule]", 
         RowBox[{"bb", "[", "a", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", 
       RowBox[{"k1", "+", "1"}], ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Average", " ", "plaquette", " ", "should", " ", "be", " ", "same", " ", 
    "as", " ", 
    RowBox[{"above", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"nc", " ", "nd", " ", 
      RowBox[{"(", 
       RowBox[{"nd", "-", "1"}], ")"}], " ", 
      RowBox[{"latticeVolume", "[", "]"}]}], ")"}]}], " ", 
   RowBox[{"Re", "[", 
    RowBox[{"rp", "/.", 
     RowBox[{
      RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"8efba561-67ca-4fc4-a003-487fb888d051"],

Cell[BoxData["0.11416926656338114`"], \
"Output",ExpressionUUID->"a9fcc8fe-9117-41fb-9d44-a2f20d9469be"]
}, Open  ]],

Cell["Calculate gradient and Hessian at bb[dir,i,k] = 0.", \
"Text",ExpressionUUID->"2297dbed-7bbd-4a6c-931f-ef9aff9444fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gradientA", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"rp", ",", 
         RowBox[{"bb", "[", 
          RowBox[{"dir", ",", "i", ",", "k"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{
        RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"5dac75e6-8325-4bca-bb34-883cdc84b378"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.9613934189939415`"}], ",", "0.7130435221205562`", ",", 
   RowBox[{"-", "1.3848562467901921`"}], ",", 
   RowBox[{"-", "1.552778113098801`"}], ",", "1.3221479320157425`", ",", 
   "0.5163367992685648`", ",", 
   RowBox[{"-", "0.23188761995299334`"}], ",", 
   RowBox[{"-", "0.8355629067701222`"}], ",", 
   RowBox[{"-", "1.2247563775530619`"}], ",", 
   RowBox[{"-", "1.7454169141268485`"}], ",", 
   RowBox[{"-", "0.7618714796016414`"}], ",", "0.5523341758810053`", ",", 
   "0.3634441662326592`", ",", "0.5229265506690954`", ",", 
   "1.0086392043519554`", ",", 
   RowBox[{"-", "1.3957836346057952`"}], ",", 
   RowBox[{"-", "1.533446854676221`"}], ",", 
   RowBox[{"-", "0.6769656172817621`"}], ",", 
   RowBox[{"-", "0.5995330070258998`"}], ",", 
   RowBox[{"-", "0.5157225694247162`"}], ",", 
   RowBox[{"-", "1.1571744453171262`"}], ",", 
   RowBox[{"-", "0.3594153269901214`"}], ",", 
   RowBox[{"-", "0.21400136781105605`"}], ",", "0.5261651911457685`", ",", 
   "1.2372290828794106`", ",", 
   RowBox[{"-", "0.3413541921992934`"}], ",", 
   RowBox[{"-", "0.04504390857577878`"}], ",", 
   RowBox[{"-", "0.7494161023670388`"}], ",", 
   RowBox[{"-", "1.1959605802047162`"}], ",", 
   RowBox[{"-", "0.7883579366739335`"}], ",", "0.41291652632649234`", ",", 
   RowBox[{"-", "0.2303607543868518`"}], ",", 
   RowBox[{"-", "0.28352593388725983`"}], ",", "0.7382626028392358`", ",", 
   RowBox[{"-", "0.11178337964875001`"}], ",", "0.9579829333263359`"}], 
  "}"}]], "Output",ExpressionUUID->"5cf95978-7ead-435e-932c-060771e39f73"]
}, Open  ]],

Cell["\<\
For parallelization, I had to go to menu Evaluation->Parallel Kernel \
Configuration and set the number manually.  Automatic launching of additional \
kernels is broken?  Note that the parallelization is based on the leading \
dimension of the table.
Verify parallel kernels are running:\
\>", "Text",ExpressionUUID->"0a7c4866-70f9-494b-a85d-240479ff71e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "$ProcessID", 
  "]"}]], "Input",ExpressionUUID->"5c7453cd-b51a-4d4c-b5b6-46caa5f2f565"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "25215", ",", "25218", ",", "25237", ",", "25273", ",", "25322", ",", 
   "25379"}], 
  "}"}]], "Output",ExpressionUUID->"661a59c7-2868-4c24-87aa-61f2160d13f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"hessA", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"rp", ",", 
           RowBox[{"bb", "[", 
            RowBox[{"dir1", ",", "i1", ",", "k1"}], "]"}], ",", 
           RowBox[{"bb", "[", 
            RowBox[{"dir2", ",", "i2", ",", "k2"}], "]"}]}], "]"}], "/.", 
         RowBox[{
          RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir1", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i1", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dir2", ",", "nd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"370de329-4edd-493e-96b8-a86ef4490981"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"36", ",", "36"}], 
  "}"}]], "Output",ExpressionUUID->"a6de1acd-efe2-4df2-be5d-a3856204b057"]
}, Open  ]],

Cell["Find the saddle point.", \
"Text",ExpressionUUID->"9ac86a7d-aec3-40c8-a515-961e6853ec19"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deltaA", "=", 
  RowBox[{"-", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"hessA", ",", "gradientA"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"1900977d-1223-43a1-9fa5-06e4b30693e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.441156126210855`"}], ",", 
   RowBox[{"-", "4.737071413476111`"}], ",", 
   RowBox[{"-", "6.66922316881648`"}], ",", 
   RowBox[{"-", "3.733701727580017`"}], ",", "5.759680421584879`", ",", 
   RowBox[{"-", "0.8665209377116804`"}], ",", "8.334011432492499`", ",", 
   RowBox[{"-", "8.428145043456734`"}], ",", "3.623806173380947`", ",", 
   RowBox[{"-", "3.935365811809498`"}], ",", 
   RowBox[{"-", "1.9055241011156003`"}], ",", "17.604692949585825`", ",", 
   "15.18469013577376`", ",", 
   RowBox[{"-", "4.554859480323707`"}], ",", 
   RowBox[{"-", "4.655628146632598`"}], ",", 
   RowBox[{"-", "2.3341381126106455`"}], ",", 
   RowBox[{"-", "12.505956290676245`"}], ",", 
   RowBox[{"-", "4.890773176228168`"}], ",", 
   RowBox[{"-", "1.0902470300281812`"}], ",", "5.744909853246197`", ",", 
   "5.715438856776931`", ",", 
   RowBox[{"-", "11.153685153845236`"}], ",", "12.25200489171736`", ",", 
   RowBox[{"-", "5.160865279177129`"}], ",", 
   RowBox[{"-", "3.3588404441547004`"}], ",", "6.364354931212894`", ",", 
   "0.4466719392357028`", ",", "3.8241290010061055`", ",", 
   "7.794746141308727`", ",", "1.3409608996891118`", ",", 
   RowBox[{"-", "9.567366697208154`"}], ",", "0.07844654225632038`", ",", 
   RowBox[{"-", "10.489411882336146`"}], ",", "0.9184281860191998`", ",", 
   "11.658681696884987`", ",", 
   RowBox[{"-", "14.788797101093285`"}]}], 
  "}"}]], "Output",ExpressionUUID->"4c8258c4-126e-4910-813b-7ff9edbdcf1d"]
}, Open  ]],

Cell["Equivalently, find the saddle point using the eigensystem.", \
"Text",ExpressionUUID->"ae61937e-46a3-4391-8c12-f828b145290b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valsA", ",", "ooA"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "hessA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"deltaA", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"ooA", ".", "gradientA"}]}], "/", "valsA"}], ")"}], ".", 
   "ooA"}]}]}], \
"Input",ExpressionUUID->"53e52cc9-a36b-446a-b93c-9794cc99a6e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.4411561262108492`"}], ",", 
   RowBox[{"-", "4.737071413476346`"}], ",", 
   RowBox[{"-", "6.669223168816291`"}], ",", 
   RowBox[{"-", "3.733701727580136`"}], ",", "5.759680421585121`", ",", 
   RowBox[{"-", "0.8665209377116658`"}], ",", "8.334011432492543`", ",", 
   RowBox[{"-", "8.428145043456752`"}], ",", "3.623806173380842`", ",", 
   RowBox[{"-", "3.935365811809547`"}], ",", 
   RowBox[{"-", "1.9055241011155262`"}], ",", "17.604692949585992`", ",", 
   "15.184690135774034`", ",", 
   RowBox[{"-", "4.554859480323921`"}], ",", 
   RowBox[{"-", "4.655628146632778`"}], ",", 
   RowBox[{"-", "2.3341381126105993`"}], ",", 
   RowBox[{"-", "12.5059562906763`"}], ",", 
   RowBox[{"-", "4.890773176228042`"}], ",", 
   RowBox[{"-", "1.090247030028235`"}], ",", "5.744909853246438`", ",", 
   "5.7154388567769`", ",", 
   RowBox[{"-", "11.153685153845302`"}], ",", "12.252004891717572`", ",", 
   RowBox[{"-", "5.160865279177198`"}], ",", 
   RowBox[{"-", "3.358840444154718`"}], ",", "6.36435493121324`", ",", 
   "0.4466719392357962`", ",", "3.824129001006345`", ",", 
   "7.794746141308737`", ",", "1.3409608996889544`", ",", 
   RowBox[{"-", "9.567366697208346`"}], ",", "0.07844654225630891`", ",", 
   RowBox[{"-", "10.489411882336148`"}], ",", "0.9184281860192016`", ",", 
   "11.658681696885072`", ",", 
   RowBox[{"-", "14.788797101093328`"}]}], 
  "}"}]], "Output",ExpressionUUID->"4f1de07e-8769-4fc0-bd47-f62b01710258"]
}, Open  ]],

Cell["Substitute shift back into links :", \
"Text",ExpressionUUID->"a1f7a25b-b9ad-4b0c-8c5a-00b9d4137a8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SUPower", "[", 
       RowBox[{
        RowBox[{"gaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}], ".", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"I", " ", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"deltaA", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "+", 
               RowBox[{
                RowBox[{"latticeVolume", "[", "]"}], 
                RowBox[{"(", 
                 RowBox[{"dir", "-", "1"}], ")"}]}]}], ")"}]}]}]}], "]"}], 
         ".", 
         RowBox[{"suGenerators", "[", "]"}]}]}], "]"}], ".", 
      RowBox[{"SUPower", "[", 
       RowBox[{
        RowBox[{"gaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", "i"}], "]"}], "]"}], ",", "0.5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dir", ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"918e4b88-9d04-4bc6-ae24-33c7702b0c59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gaugeField", "=", "gaugeFieldA"}], "}"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"averagePlaquette", "[", "]"}], "]"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"a084fa08-f8cd-4554-b1e0-5e8a50b44070"],

Cell[BoxData["0.009002121593084556`"], \
"Print",ExpressionUUID->"0cc3078a-b89e-42c0-8eb5-7958cda77b09"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"8c235b7f-b3be-45ee-b047-c0f9c6b72d5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"cutoffValue", "\[Rule]", "1"}], ",", 
     RowBox[{"allLinks", "\[Rule]", "True"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"8b06b8b1-c61d-4172-9ae3-8d57f5095087"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0150880000000000002`2.7728441724579613", ",", 
     "0.021215`4.477158033934629", ",", "0.001074`3.181519279195531", ",", 
     "0.000909`3.1090788810539616"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0150880000000000002`2.7728441724579613, 0.021215`4.477158033934629, 
    0.001074`3.181519279195531, 0.000909`3.1090788810539616}],
  Editable->
   False]], "Print",ExpressionUUID->"20fbf296-29f7-480a-b6a2-fbfe89d2885a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldA", "-", "libGaugeField"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"7e974aaa-70ad-44a3-8db6-6fbb591c8fa3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "48"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"09a14fe1-6612-4c7e-b344-8b24d651d61c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
nearest stationary point for entire lattice, one direction fixed\
\>", "Section",ExpressionUUID->"6afea612-4829-4b47-b988-53fc7c66a8ee"],

Cell["\<\
Test stationary point routine against an explicit calculation for a random \
lattice in Axial gauge\
\>", "Text",ExpressionUUID->"46628854-1f58-435b-a306-efb622183479"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"cfb057c6-74fd-466a-bfff-ead6704c041b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"fDir", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"f52bc08f-d446-4d2f-9c46-ab08017a8666"],

Cell[BoxData["0.15582975480479755`"], \
"Output",ExpressionUUID->"1e6ccfa0-400e-47c6-a6ed-ec764f6123b7"]
}, Open  ]],

Cell["Create lattice with minimal non-trivial links.", \
"Text",ExpressionUUID->"10698ee7-9151-48df-9226-36cd3ca8bcbd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"makeTrivialLattice", "[", 
      RowBox[{"randomGauge", "\[Rule]", "False"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".3", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"setLink", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".1", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".05", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", ".01", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", "0.001", " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"gaugeField", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"linearSiteIndex", "[", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"setAxialGauge", "[", "fDir", "]"}], ";"}], "*)"}], 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"8767dbd3-6ebb-462b-9a49-e5ac21db02d0"],

Cell[BoxData["0.9948391690779286`"], \
"Output",ExpressionUUID->"0a96ccfd-5359-43a6-89f4-76298a714082"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", \
"Subsection",ExpressionUUID->"07fee0bf-0aa1-4b9c-98ee-45b00ef5ba02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"bb", ",", "bVector"}], "]"}], ";", 
  RowBox[{
   RowBox[{"bVector", "[", 
    RowBox[{"dir_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bb", "[", 
        RowBox[{"dir", ",", "site", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ".", 
     RowBox[{"suGenerators", "[", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"002ec141-0da2-4775-b9da-5bb60d049d8d"],

Cell["\<\
Constant links in one direction.  Create links with second order perturbation:\
\>", "Text",ExpressionUUID->"e2f4f19f-904d-459e-891d-1518fc4b5760"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", "gaugeField"}], ";", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", "c2"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"c2", "=", "coords"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dir", "\[Equal]", "fDir"}], ",", 
         RowBox[{
          RowBox[{"c2", "[", 
           RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       RowBox[{
        RowBox[{"uu", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", 
           RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
        "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"SUPower", "[", 
           RowBox[{
            RowBox[{"getLink", "[", 
             RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}], ".", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
            RowBox[{"I", " ", 
             RowBox[{"bVector", "[", 
              RowBox[{"dir", ",", "c2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"bVector", "[", 
               RowBox[{"dir", ",", "c2"}], "]"}], ".", 
              RowBox[{"bVector", "[", 
               RowBox[{"dir", ",", "c2"}], "]"}]}], "/", 
             RowBox[{"2", "!"}]}]}], ")"}], ".", 
          RowBox[{"SUPower", "[", 
           RowBox[{
            RowBox[{"getLink", "[", 
             RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}]}], 
         "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir", ",", "nd"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"bcda7aa1-71be-4cae-b430-adce7f3357dc"],

Cell["Sum of plaquettes, not taking the real part:", \
"Text",ExpressionUUID->"6346d6bd-ef23-4df5-b127-4ca7d79668fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coords", "=", 
          RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k1", ",", 
             RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"uu", "[", 
           RowBox[{"[", 
            RowBox[{"k2", ",", 
             RowBox[{"linearSiteIndex", "[", 
              RowBox[{"shift", "[", 
               RowBox[{"k1", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
          ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"linearSiteIndex", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"k2", ",", "coords"}], "]"}], "]"}]}], "]"}], "]"}], 
           "]"}], ".", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"uu", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", " ", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"bb", "[", "a__", "]"}], "]"}], "\[Rule]", 
         RowBox[{"bb", "[", "a", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", 
       RowBox[{"k1", "+", "1"}], ",", "nd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Average", " ", "plaquette", " ", "should", " ", "be", " ", "same", " ", 
    "as", " ", 
    RowBox[{"above", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"nc", " ", "nd", " ", 
      RowBox[{"(", 
       RowBox[{"nd", "-", "1"}], ")"}], " ", 
      RowBox[{"latticeVolume", "[", "]"}]}], ")"}]}], " ", 
   RowBox[{"Re", "[", 
    RowBox[{"rp", "/.", 
     RowBox[{
      RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"8623c371-9c30-49b9-b905-0c0fbeb5f177"],

Cell[BoxData["0.15582975480479755`"], \
"Output",ExpressionUUID->"2ad7f7cf-4f40-48ff-8321-20f86b0f6a33"]
}, Open  ]],

Cell["Calculate gradient and Hessian at bb[dir,i,k] = 0.", \
"Text",ExpressionUUID->"5461a130-5a0c-4a0e-874b-0383d905a176"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "gradMap", "]"}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{"gradient1", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dims0", "=", "latticeDimensions"}], ",", 
        RowBox[{"gi", "=", "1"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"dims0", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"coords", "=", 
              RowBox[{"latticeCoordinates", "[", 
               RowBox[{"i", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"dir", "\[Equal]", "fDir"}], ",", "dims0", ",", 
                  "latticeDimensions"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"k", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"gradMap", "[", 
                 RowBox[{"dir", ",", "coords"}], "]"}], "=", "gi"}]}], "]"}], 
             ";", 
             RowBox[{"gi", "+=", "1"}], ";", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"D", "[", 
                RowBox[{"rp", ",", 
                 RowBox[{"bb", "[", 
                  RowBox[{"dir", ",", "coords", ",", "k"}], "]"}]}], "]"}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}]}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"dir", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"latticeVolume", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir", "\[Equal]", "fDir"}], ",", "dims0", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], 
        "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"2a3c7375-3548-469a-b5d5-281e585f48a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8798723243559731`", ",", "0.5121227302940211`", ",", 
   RowBox[{"-", "3.2666861933084155`"}], ",", 
   RowBox[{"-", "1.8516824896904`"}], ",", 
   RowBox[{"-", "0.08781558465665656`"}], ",", 
   RowBox[{"-", "2.7309444313300015`"}], ",", "0.03679926184752236`", ",", 
   "0.06174629420049804`", ",", "4.527036659061427`", ",", 
   RowBox[{"-", "1.2145344555902158`"}], ",", "0.7266342772803858`", ",", 
   RowBox[{"-", "0.30506749959232987`"}], ",", 
   RowBox[{"-", "0.12829274506400346`"}], ",", 
   RowBox[{"-", "0.1824918834078817`"}], ",", "0.22506150745188935`", ",", 
   "1.8199238953465102`", ",", 
   RowBox[{"-", "2.307186351339411`"}], ",", "1.1654000039122672`", ",", 
   RowBox[{"-", "0.39482062471076984`"}], ",", 
   RowBox[{"-", "1.1911754590133445`"}], ",", "1.1703574074505965`", ",", 
   "1.374692992589769`", ",", 
   RowBox[{"-", "1.120325729807948`"}], ",", "0.6659542707359168`", ",", 
   RowBox[{"-", "0.10373172577898182`"}], ",", 
   RowBox[{"-", "0.27082091814944653`"}], ",", "0.8323206237271201`", ",", 
   "0.20733549077401714`", ",", 
   RowBox[{"-", "1.0836853392043837`"}], ",", "1.3647179007867234`", ",", 
   "0.6079238834616093`", ",", 
   RowBox[{"-", "2.275246505840215`"}], ",", "0.9461219338642237`", ",", 
   RowBox[{"-", "1.452775985071432`"}], ",", 
   RowBox[{"-", "2.0524855828980098`"}], ",", "1.3623073295312458`", ",", 
   RowBox[{"-", "0.7477871428620934`"}], ",", 
   RowBox[{"-", "1.3620283024547382`"}], ",", 
   RowBox[{"-", "0.48644866852623503`"}], ",", 
   RowBox[{"-", "0.7620453238707271`"}], ",", "0.05854627079664432`", ",", 
   RowBox[{"-", "0.211210110600443`"}], ",", 
   RowBox[{"-", "0.7592532878025265`"}], ",", 
   RowBox[{"-", "1.923452956006344`"}], ",", 
   RowBox[{"-", "0.1923712571293717`"}], ",", "0.4122187376931572`", ",", 
   "1.1521494110909352`", ",", 
   RowBox[{"-", "1.1060237928761198`"}], ",", "1.4213964530353285`", ",", 
   RowBox[{"-", "1.6763049363057383`"}], ",", "1.2506343432488025`", ",", 
   RowBox[{"-", "0.2892250606880275`"}], ",", 
   RowBox[{"-", "1.1715237646393581`"}], ",", 
   RowBox[{"-", "0.7145463669346246`"}], ",", 
   RowBox[{"-", "1.4074990997770587`"}], ",", 
   RowBox[{"-", "1.0620493308743444`"}], ",", 
   RowBox[{"-", "0.41065678870514377`"}], ",", 
   RowBox[{"-", "0.3817192371099659`"}], ",", "1.441695747071046`", ",", 
   RowBox[{"-", "1.2660360097672219`"}]}], 
  "}"}]], "Output",ExpressionUUID->"7b4a1b14-b86d-42ad-b796-b8c6aae36a44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"hess1", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dims", "=", "latticeDimensions"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"dims", "[", 
        RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"rp", ",", 
              RowBox[{"bb", "[", 
               RowBox[{"dir1", ",", 
                RowBox[{"latticeCoordinates", "[", 
                 RowBox[{"i1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"dir1", "\[Equal]", "fDir"}], ",", "dims", ",", 
                    "latticeDimensions"}], "]"}]}], "]"}], ",", "k1"}], "]"}],
               ",", 
              RowBox[{"bb", "[", 
               RowBox[{"dir2", ",", 
                RowBox[{"latticeCoordinates", "[", 
                 RowBox[{"i2", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"dir2", "\[Equal]", "fDir"}], ",", "dims", ",", 
                    "latticeDimensions"}], "]"}]}], "]"}], ",", "k2"}], 
               "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"bb", "[", "__", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir1", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"latticeVolume", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir1", "\[Equal]", "fDir"}], ",", "dims", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"dir2", ",", "nd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"latticeVolume", "[", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dir2", "\[Equal]", "fDir"}], ",", "dims", ",", 
               "latticeDimensions"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k2", ",", 
            RowBox[{
             RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}], "]"}]], \
"Input",ExpressionUUID->"18aa2ca9-6c1e-44c5-bdcb-608625c9422e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60", ",", "60"}], 
  "}"}]], "Output",ExpressionUUID->"69d6c970-dde0-44ef-9a01-29ad1994bf8d"]
}, Open  ]],

Cell["Shifts associated with the remaining gauge freedom.", \
"Text",ExpressionUUID->"ce655314-b12d-4061-81aa-5e13e825c9ec"],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"gtf", "=", 
   RowBox[{"gaugeTransformShifts", "[", 
    RowBox[{
     RowBox[{"makeRootLattice", "[", "]"}], ",", "fDir"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"02cb58a0-89a2-4f7f-9c83-5f4f69954120"],

Cell["The gradient is orthogonal to the gauge transform shifts :", \
"Text",ExpressionUUID->"4ab7eb36-03ff-48aa-9e64-9253a03f24b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"gtf", ".", "gradient1"}], 
  "]"}]], "Input",ExpressionUUID->"23b665a4-4f5d-4222-ad1d-71acd6b803cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",ExpressionUUID->"fea972ce-a4c9-4700-9a65-97547d192d91"]
}, Open  ]],

Cell["But the Hessian is not, since it is a quadratic expansion :", \
"Text",ExpressionUUID->"f3db0435-e56c-4927-ba18-af4d04e783c9"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"gtf", ".", "hess1", ".", 
    RowBox[{"Transpose", "[", "gtf", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"f2001b9a-e668-4423-9010-5f2b493d3a57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"proj1", "=", 
   RowBox[{"NullSpace", "[", "gtf", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b4ce1e9e-4fe8-4239-b400-df4430184709"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"48", ",", "60"}], 
  "}"}]], "Output",ExpressionUUID->"b79abe8b-f8f7-428c-b582-d9a074da96e8"]
}, Open  ]],

Cell["Find the saddle point.", \
"Text",ExpressionUUID->"77f08dcd-7394-4a58-b203-109753c95f4d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delta1", "=", 
  RowBox[{"-", 
   RowBox[{
    RowBox[{"LinearSolve", "[", 
     RowBox[{
      RowBox[{"proj1", ".", "hess1", ".", 
       RowBox[{"Transpose", "[", "proj1", "]"}]}], ",", 
      RowBox[{"proj1", ".", "gradient1"}]}], "]"}], ".", 
    "proj1"}]}]}]], \
"Input",ExpressionUUID->"64674df4-6fb1-44e5-8f07-e0f5ddb2f77e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.8374716778593734`", ",", "3.1707982503389682`", ",", 
   "0.3655696322532653`", ",", 
   RowBox[{"-", "6.089548163423396`"}], ",", "0.11547996244880696`", ",", 
   RowBox[{"-", "1.5916828901388538`"}], ",", "2.623626445793073`", ",", 
   "8.575807150855507`", ",", "5.052854461438134`", ",", 
   RowBox[{"-", "0.42992898779528765`"}], ",", 
   RowBox[{"-", "1.867424347468895`"}], ",", 
   RowBox[{"-", "0.011211338946981427`"}], ",", "0.33053981429731355`", ",", 
   RowBox[{"-", "2.0128812049102014`"}], ",", "7.9813246496517385`", ",", 
   "0.870355324817968`", ",", 
   RowBox[{"-", "5.564244429946447`"}], ",", 
   RowBox[{"-", "1.830856362553783`"}], ",", "5.109767361839844`", ",", 
   "0.21224059482906776`", ",", "6.593149285454266`", ",", 
   "0.9880598996975325`", ",", "5.468442715547914`", ",", 
   RowBox[{"-", "2.021571957718005`"}], ",", "0.10328450415611991`", ",", 
   RowBox[{"-", "4.989996489405151`"}], ",", "9.342673781867031`", ",", 
   "0.6389577455315096`", ",", 
   RowBox[{"-", "4.151902468482231`"}], ",", "2.1568507539144135`", ",", 
   RowBox[{"-", "0.5608673231812501`"}], ",", 
   RowBox[{"-", "6.459862607319321`"}], ",", 
   RowBox[{"-", "4.665106755364703`"}], ",", 
   RowBox[{"-", "4.338876703292392`"}], ",", 
   RowBox[{"-", "0.7275261550339159`"}], ",", 
   RowBox[{"-", "5.216716559107892`"}], ",", 
   RowBox[{"-", "6.463586508439215`"}], ",", 
   RowBox[{"-", "1.8035271170834348`"}], ",", 
   RowBox[{"-", "2.281928337691573`"}], ",", 
   RowBox[{"-", "3.1206537587071526`"}], ",", "7.986753721682814`", ",", 
   RowBox[{"-", "3.6696014294187935`"}], ",", 
   RowBox[{"-", "6.369131659434746`"}], ",", 
   RowBox[{"-", "2.0532738777462876`"}], ",", "4.098148576412428`", ",", 
   RowBox[{"-", "1.107956447336512`"}], ",", 
   RowBox[{"-", "4.270881956401723`"}], ",", "1.7412535529826754`", ",", 
   RowBox[{"-", "9.131650567315578`"}], ",", 
   RowBox[{"-", "1.4640747636401983`"}], ",", "4.860089254589794`", ",", 
   "2.6763928492709708`", ",", 
   RowBox[{"-", "1.9094404660963968`"}], ",", "1.7457043603484317`", ",", 
   "3.3719058249621283`", ",", "5.290296757866749`", ",", 
   RowBox[{"-", "5.702063074424381`"}], ",", 
   RowBox[{"-", "0.01622557540830914`"}], ",", "3.950789847414725`", ",", 
   RowBox[{"-", "2.456989230760517`"}]}], 
  "}"}]], "Output",ExpressionUUID->"fbbf3c32-09ba-4469-b13f-a99c74a48b68"]
}, Open  ]],

Cell["Equivalently, find the saddle point using the eigensystem.", \
"Text",ExpressionUUID->"0acb2d87-7af1-47d1-a06f-0ae34816cb0b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals1", ",", "oo1"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"proj1", ".", "hess1", ".", 
     RowBox[{"Transpose", "[", "proj1", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"delta1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"oo1", ".", "proj1", ".", "gradient1"}]}], "/", "vals1"}], 
    ")"}], ".", "oo1", ".", 
   "proj1"}]}]}], \
"Input",ExpressionUUID->"55fb71d3-fdc1-491e-bd40-877904b0ea03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.837471677859321`", ",", "3.1707982503389958`", ",", 
   "0.3655696322532749`", ",", 
   RowBox[{"-", "6.089548163423403`"}], ",", "0.11547996244881475`", ",", 
   RowBox[{"-", "1.59168289013883`"}], ",", "2.6236264457930645`", ",", 
   "8.575807150855482`", ",", "5.052854461438122`", ",", 
   RowBox[{"-", "0.42992898779531924`"}], ",", 
   RowBox[{"-", "1.8674243474689`"}], ",", 
   RowBox[{"-", "0.011211338946968139`"}], ",", "0.33053981429737816`", ",", 
   RowBox[{"-", "2.012881204910228`"}], ",", "7.981324649651726`", ",", 
   "0.8703553248179083`", ",", 
   RowBox[{"-", "5.564244429946364`"}], ",", 
   RowBox[{"-", "1.8308563625538161`"}], ",", "5.109767361839822`", ",", 
   "0.2122405948290574`", ",", "6.593149285454259`", ",", 
   "0.9880598996975349`", ",", "5.4684427155479325`", ",", 
   RowBox[{"-", "2.021571957718001`"}], ",", "0.1032845041561403`", ",", 
   RowBox[{"-", "4.98999648940515`"}], ",", "9.342673781867028`", ",", 
   "0.6389577455315318`", ",", 
   RowBox[{"-", "4.151902468482233`"}], ",", "2.156850753914366`", ",", 
   RowBox[{"-", "0.5608673231812128`"}], ",", 
   RowBox[{"-", "6.459862607319263`"}], ",", 
   RowBox[{"-", "4.665106755364666`"}], ",", 
   RowBox[{"-", "4.338876703292384`"}], ",", 
   RowBox[{"-", "0.7275261550339758`"}], ",", 
   RowBox[{"-", "5.216716559107895`"}], ",", 
   RowBox[{"-", "6.463586508439182`"}], ",", 
   RowBox[{"-", "1.8035271170834348`"}], ",", 
   RowBox[{"-", "2.2819283376916144`"}], ",", 
   RowBox[{"-", "3.120653758707191`"}], ",", "7.98675372168281`", ",", 
   RowBox[{"-", "3.669601429418798`"}], ",", 
   RowBox[{"-", "6.3691316594347835`"}], ",", 
   RowBox[{"-", "2.0532738777463178`"}], ",", "4.098148576412414`", ",", 
   RowBox[{"-", "1.1079564473365062`"}], ",", 
   RowBox[{"-", "4.270881956401716`"}], ",", "1.7412535529827042`", ",", 
   RowBox[{"-", "9.131650567315617`"}], ",", 
   RowBox[{"-", "1.4640747636401967`"}], ",", "4.86008925458977`", ",", 
   "2.676392849270949`", ",", 
   RowBox[{"-", "1.909440466096377`"}], ",", "1.745704360348427`", ",", 
   "3.3719058249621328`", ",", "5.290296757866731`", ",", 
   RowBox[{"-", "5.702063074424328`"}], ",", 
   RowBox[{"-", "0.016225575408370184`"}], ",", "3.9507898474146614`", ",", 
   RowBox[{"-", "2.4569892307604646`"}]}], 
  "}"}]], "Output",ExpressionUUID->"ad86c876-9df1-4b37-b9f7-a7e1b66a8451"]
}, Open  ]],

Cell["Substitute shift back into links :", \
"Text",ExpressionUUID->"a6d8526c-a2b4-4d74-9d9a-631926f20d04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newGaugeField", "=", "gaugeField"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}]}], ",", 
        RowBox[{"dims", "=", "latticeDimensions"}], ",", "c2"}], "}"}], ",", 
      RowBox[{
       RowBox[{"c2", "=", "coords"}], ";", 
       RowBox[{
        RowBox[{"c2", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"dims", "[", 
         RowBox[{"[", "fDir", "]"}], "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"newGaugeField", "[", 
         RowBox[{"[", 
          RowBox[{"dir", ",", 
           RowBox[{"linearSiteIndex", "[", "coords", "]"}]}], "]"}], "]"}], 
        "=", 
        RowBox[{
         RowBox[{"SUPower", "[", 
          RowBox[{
           RowBox[{"getLink", "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], "]"}], ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"I", " ", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"delta1", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}], "-", "1", 
               "+", 
               RowBox[{"gradMap", "[", 
                RowBox[{"dir", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"dir", "\[Equal]", "fDir"}], ",", "c2", ",", 
                   "coords"}], "]"}]}], "]"}]}]}], "]"}], ".", 
            RowBox[{"suGenerators", "[", "]"}]}]}], "]"}], ".", 
         RowBox[{"SUPower", "[", 
          RowBox[{
           RowBox[{"getLink", "[", 
            RowBox[{"dir", ",", "coords"}], "]"}], ",", "0.5"}], 
          "]"}]}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"dir", ",", "nd"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"dc3ccf11-2bff-4254-9dab-9892f8bc6a99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gaugeField", "=", "newGaugeField"}], "}"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"averagePlaquette", "[", "]"}], "]"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"f64fb766-7202-4259-9cb4-930b84dd83df"],

Cell[BoxData["0.0057037764007532386`"], \
"Print",ExpressionUUID->"d0e80b91-9c14-407e-8fa2-27d5236d0938"]
}, Open  ]],

Cell["\<\
Now, compare this with the library routine (with damping factors removed) :\
\>", "Text",ExpressionUUID->"099be236-9a87-4bcd-b45f-9beda62961fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "fDir"}], ",", 
     RowBox[{"dampingFactor", "\[Rule]", "1"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"78e5c275-ea68-45fb-a47c-2502ebd3aecd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0388150000000000003`2.8821820919001615", ",", 
     "0.052721`4.872498637095547", ",", "0.027566`4.59088874964835", ",", 
     "0.001605`3.3559900345728852"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0388150000000000003`2.8821820919001615, 0.052721`4.872498637095547, 
    0.027566`4.59088874964835, 0.001605`3.3559900345728852}],
  Editable->
   False]], "Print",ExpressionUUID->"9614b710-ab59-4e26-8237-5a222dd9ba36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"grad0", "-", 
    RowBox[{"proj1", ".", "gradient1"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"d18ec19d-90fd-425a-9a61-3b2aa995dfee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "48"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"a47316f4-eb78-41c9-9aa3-5f57caf69fce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"hess0", "-", 
     RowBox[{"proj1", ".", "hess1", ".", 
      RowBox[{"Transpose", "[", "proj1", "]"}]}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"6b17fa14-dedb-48db-9049-4b1da8063c65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2304"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"373baa43-91ef-40cc-a4ad-239e20d41a61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"newGaugeField", "-", "libGaugeField"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"b9ad7d9c-633a-47da-bb20-f0a193db953e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "96"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"49d7c775-a71f-4bd1-9107-dbeb79cbcbee"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["compare lattice and link stationary point", \
"Section",ExpressionUUID->"ced7fcf1-37a7-4a9a-b384-0a391f6b2b72"],

Cell["\<\
Test single-link stationary point against the lattice-wide stationary point \
by including only single-link gradients.
Find agreement for single site and multiple -site lattices for SU(2), SU(3), \
and SU(4).

The Hessian matrix is block-diagonal in the lattice links.  However, in the \
case of the full lattice derivative, the eigenvectors may not be, if there \
are degenerate eigenvalues.  In that case, the rescaled shifts may be \
different for the full lattice.  This issue goes away if we remove the \
rescaling. \
\>", "Text",ExpressionUUID->"e68ee23a-bc60-427d-84a6-f83d4942f773"],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"10649e5d-861d-4089-a858-95547fc22240"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"a1f37b4f-4a47-4c01-9986-c60edb08cc34"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"newGaugeField", ",", "stats"}], "}"}], "=", 
   RowBox[{"latticeSaddlePoint", "[", 
    RowBox[{
     RowBox[{"maxCount", "->", "1"}], ",", 
     RowBox[{"updateGaugeField", "\[Rule]", "False"}], ",", 
     RowBox[{"makeHess0", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"3ad08985-1c9d-4fb8-9895-b164c496849b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "283.5015551461338`", ",", "0.023703982478033993`"}], 
  "}"}]], "Print",ExpressionUUID->"30f220ec-08e7-4b69-b719-0dafa7ce910d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"allLinks", "\[Rule]", "False"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ef934101-694c-480b-a73f-1e43c0b81dad"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"72484fa7-92cd-4b59-af72-e3b723756489"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.1371709999999999993`2.828384814801965", ",", 
     "0.184454`5.416403075443564", ",", "0.006642`3.9728138690943604", ",", 
     "0.00303`3.631957626334299"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.1371709999999999993`2.828384814801965, 0.184454`5.416403075443564, 
    0.006642`3.9728138690943604, 0.00303`3.631957626334299}],
  Editable->
   False]], "Print",ExpressionUUID->"b666cfc0-4ae4-4b6d-99b0-7ee66335cd41"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "12", ",", "3", ",", "3"}], 
  "}"}]], "Output",ExpressionUUID->"796cf42a-fbbf-4a29-9084-56993e1f68d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"libGaugeField", "-", "newGaugeField"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"bf2cf889-68e5-4c5d-906f-f7f8d7b90b22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "324"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"430fe7e9-6ac2-4ec7-9d7f-d633785f222c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Small perturbations", \
"Section",ExpressionUUID->"d2d2ebf6-4680-400d-9036-1bdc077963c3"],

Cell["\<\
Verify that small perturbations from a trivial lattice go back to the saddle \
point.
We see that it doesn\[CloseCurlyQuote]t converge without \
rescaleCutoff<Infinity or dampingFactor<1.  A combination works best.\
\>", "Text",ExpressionUUID->"8b6ac6f7-a0c2-4db5-a4ab-44b27ade6250"],

Cell["Create Random lattice :", \
"Text",ExpressionUUID->"121a36d4-2575-465e-b601-c3d08d752766"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "3"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";", 
  RowBox[{"makeTrivialLattice", "[", 
   RowBox[{
    RowBox[{"randomPerturbation", "\[Rule]", "0.001"}], ",", 
    RowBox[{"randomGauge", "\[Rule]", "True"}]}], "]"}], ";", 
  RowBox[{"1", "-", 
   RowBox[{
   "averagePlaquette", "[", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"cff751fb-1b04-49c9-98a0-9b8832bb5a86"],

Cell[BoxData["1.5346633086554817`*^-7"], \
"Output",ExpressionUUID->"c7e7b380-953e-487c-95e9-2ed38d713cf5"]
}, Open  ]],

Cell["Apply one saddle-point step :", \
"Text",ExpressionUUID->"284b0cf7-e389-4496-be88-f29c3ae71452"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"gaugeField", "=", 
     RowBox[{"latticeSaddlePointStep", "[", 
      RowBox[{
       RowBox[{"allLinks", "\[Rule]", "False"}], ",", 
       RowBox[{"dampingFactor", "\[Rule]", "0.5"}], ",", 
       RowBox[{"rescaleCutoff", "\[Rule]", "0.001"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"1", "-", 
      RowBox[{"averagePlaquette", "[", "]"}]}], "]"}]}], ",", 
   RowBox[{"{", "20", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"3aeb94ad-43e1-407d-a17e-32d3ebd86a91"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"81052514-b6b4-40f0-9124-12e585f4ec9d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0450999999999999999`2.822420306670385", ",", 
     "0.060378`4.931393720905468", ",", "0.001298`3.2637896902963446", ",", 
     "0.001101`3.1923023168037457"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0450999999999999999`2.822420306670385, 0.060378`4.931393720905468, 
    0.001298`3.2637896902963446, 0.001101`3.1923023168037457}],
  Editable->
   False]], "Print",ExpressionUUID->"fe3bdf75-473a-45fe-b02e-4353ba875e99"],

Cell[BoxData["1.2236136548438026`*^-8"], \
"Print",ExpressionUUID->"40b4573d-ecf6-40d0-968c-759beca95e84"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"d6ae7d48-eb7b-4ae3-a281-13e2e41e299f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.042507`2.796704219808451", ",", "0.056295`4.900984821300757", ",", 
     "0.001153`3.2123443051266927", ",", "0.001021`3.159540739918904"}], 
    "}"}]}],
  SequenceForm[
  "times:  ", {
   0.042507`2.796704219808451, 0.056295`4.900984821300757, 
    0.001153`3.2123443051266927, 0.001021`3.159540739918904}],
  Editable->
   False]], "Print",ExpressionUUID->"60f49d2b-3336-4301-b32a-253e64e24190"],

Cell[BoxData["3.059044795250543`*^-9"], \
"Print",ExpressionUUID->"3235f461-b8d3-488d-8f45-fbd3e6b37584"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"62b5b8bb-4e8f-42a7-917c-22d940ae9334"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0446340000000000001`2.81790957388445", ",", 
     "0.05922`4.922983400885274", ",", "0.001218`3.2361622861288506", ",", 
     "0.001049`3.1712904860255517"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0446340000000000001`2.81790957388445, 0.05922`4.922983400885274, 
    0.001218`3.2361622861288506, 0.001049`3.1712904860255517}],
  Editable->
   False]], "Print",ExpressionUUID->"e49824ae-f576-4298-960b-322b758b2e0a"],

Cell[BoxData["7.647731337101504`*^-10"], \
"Print",ExpressionUUID->"ffb335a3-7a9b-4997-bff6-339a8ce75ac1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"31d42e5e-9cf7-4b98-9fa1-71b0d7497a79"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0483359999999999996`2.85251447272163", ",", 
     "0.064616`4.960855067705266", ",", "0.001478`3.320189431890801", ",", 
     "0.00135`3.2808487663270003"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0483359999999999996`2.85251447272163, 0.064616`4.960855067705266, 
    0.001478`3.320189431890801, 0.00135`3.2808487663270003}],
  Editable->
   False]], "Print",ExpressionUUID->"4cc92087-5891-4314-be3c-3b6b1004cd6c"],

Cell[BoxData["1.9120527383620356`*^-10"], \
"Print",ExpressionUUID->"1feae53a-450c-4f14-ba71-18e1048458b0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"6c752efd-fac6-4a1e-90aa-1c0be3552704"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0451850000000000002`2.823238051409122", ",", 
     "0.060069`4.929165399912581", ",", "0.001235`3.2421819554276783", ",", 
     "0.001129`3.203208939756962"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0451850000000000002`2.823238051409122, 0.060069`4.929165399912581, 
    0.001235`3.2421819554276783, 0.001129`3.203208939756962}],
  Editable->
   False]], "Print",ExpressionUUID->"4e3639c5-0f04-4d67-baa1-41c412c235b3"],

Cell[BoxData["4.781330886771684`*^-11"], \
"Print",ExpressionUUID->"31e9524d-6438-4978-a150-ca8fbf3dba67"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"ea19c7be-5cdb-4742-b630-53981d19c01d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0477870000000000002`2.8475535317781384", ",", 
     "0.063206`4.951273304646148", ",", "0.00126`3.250885542949557", ",", 
     "0.001126`3.2020533883473212"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0477870000000000002`2.8475535317781384, 0.063206`4.951273304646148, 
    0.00126`3.250885542949557, 0.001126`3.2020533883473212}],
  Editable->
   False]], "Print",ExpressionUUID->"24b2b7c5-7e1c-481e-aae8-e8d4f10be3df"],

Cell[BoxData["1.1965539670200087`*^-11"], \
"Print",ExpressionUUID->"c13690ff-c706-4189-a5bb-cd8400cd29a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"258d1013-8ad1-4951-bdab-4008514c12dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0464079999999999998`2.8348366172519674", ",", 
     "0.06142`4.938824809939044", ",", "0.001251`3.2477723075254135", ",", 
     "0.00114`3.2074198491684665"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0464079999999999998`2.8348366172519674, 0.06142`4.938824809939044, 
    0.001251`3.2477723075254135, 0.00114`3.2074198491684665}],
  Editable->
   False]], "Print",ExpressionUUID->"5cac43d0-b7a7-42f2-9fdc-28e803487746"],

Cell[BoxData["3.003708393123361`*^-12"], \
"Print",ExpressionUUID->"5fa7208c-6bad-4ce4-a930-ba74939a067d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"62d35fa7-fa00-484d-96f0-5cbdccf82922"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0476559999999999998`2.8463613518832127", ",", 
     "0.062802`4.948488472383411", ",", "0.001234`3.2418301575292165", ",", 
     "0.001153`3.2123443051266927"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0476559999999999998`2.8463613518832127, 0.062802`4.948488472383411, 
    0.001234`3.2418301575292165, 0.001153`3.2123443051266927}],
  Editable->
   False]], "Print",ExpressionUUID->"acf0c9c0-0811-4523-8c4c-8922079d6b98"],

Cell[BoxData["7.635003740347202`*^-13"], \
"Print",ExpressionUUID->"c11e30fd-09b0-4b02-bb55-9751274ce397"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"970ec115-5d21-460a-a1f8-7ea79589f02f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.051318`2.8785134872051903", ",", "0.067842`4.982013640384905", ",", 
     "0.001607`3.3565308745953386", ",", "0.00179`3.403368028811887"}], 
    "}"}]}],
  SequenceForm[
  "times:  ", {
   0.051318`2.8785134872051903, 0.067842`4.982013640384905, 
    0.001607`3.3565308745953386, 0.00179`3.403368028811887}],
  Editable->
   False]], "Print",ExpressionUUID->"3bcbf4e6-4630-49bd-896b-76364cc3c0d1"],

Cell[BoxData["2.0317081350640365`*^-13"], \
"Print",ExpressionUUID->"c8dc3824-99e3-4285-a602-f03b7e4394a4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"41856846-b62d-4118-9ba9-e36496d6b45e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0485179999999999999`2.8541466549493277", ",", 
     "0.064467`4.959852458429941", ",", "0.001349`3.280526947503898", ",", 
     "0.001339`3.277295574844003"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0485179999999999999`2.8541466549493277, 0.064467`4.959852458429941, 
    0.001349`3.280526947503898, 0.001339`3.277295574844003}],
  Editable->
   False]], "Print",ExpressionUUID->"2f1d9cfb-e755-4c12-979c-14ddd516fc7b"],

Cell[BoxData["6.306066779870889`*^-14"], \
"Print",ExpressionUUID->"41a2997f-fb5f-48ce-b349-abbb501acc07"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"9fbbef89-a850-4f46-a2dd-0946c2783d99"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0476190000000000004`2.8460240357638047", ",", 
     "0.063196`4.951204588251975", ",", "0.001186`3.2245996868602376", ",", 
     "0.001123`3.200894754093452"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0476190000000000004`2.8460240357638047, 0.063196`4.951204588251975, 
    0.001186`3.2245996868602376, 0.001123`3.200894754093452}],
  Editable->
   False]], "Print",ExpressionUUID->"15cbdf3a-cb34-4f95-a7d7-4cccef88c740"],

Cell[BoxData["2.7644553313166398`*^-14"], \
"Print",ExpressionUUID->"adaa5d6a-6655-4975-ba37-db55b6d9f761"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"a8c8d924-d3c4-4cfc-8ccd-54e46b77d635"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0507099999999999999`2.8733373753402964", ",", 
     "0.067086`4.97714689568914", ",", "0.001168`3.2179578406083746", ",", 
     "0.001105`3.1938772758531235"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0507099999999999999`2.8733373753402964, 0.067086`4.97714689568914, 
    0.001168`3.2179578406083746, 0.001105`3.1938772758531235}],
  Editable->
   False]], "Print",ExpressionUUID->"0be83471-c7b9-40b9-913a-77e8238a8d9a"],

Cell[BoxData["1.8762769116165146`*^-14"], \
"Print",ExpressionUUID->"b1bcff16-d51f-475e-b4e6-b65d8b662e11"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"376d4b6b-e4d5-47d7-b6d3-9ea052b2b789"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0512080000000000001`2.87758157898016", ",", 
     "0.067372`4.978994437808558", ",", "0.001722`3.38654814494963", ",", 
     "0.001871`3.422588785332004"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0512080000000000001`2.87758157898016, 0.067372`4.978994437808558, 
    0.001722`3.38654814494963, 0.001871`3.422588785332004}],
  Editable->
   False]], "Print",ExpressionUUID->"779ae723-e107-4bed-97cb-45d8f2dd43a9"],

Cell[BoxData["1.7430501486614958`*^-14"], \
"Print",ExpressionUUID->"ced32798-53b1-4b53-b1a6-eab7af00f4ea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"5d27f5fc-fea9-45e1-97f6-c6c71c043f54"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0438049999999999999`2.809767449462652", ",", 
     "0.058675`4.918968096102624", ",", "0.001077`3.1827307011299757", ",", 
     "0.000974`3.1390739547106095"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0438049999999999999`2.809767449462652, 0.058675`4.918968096102624, 
    0.001077`3.1827307011299757, 0.000974`3.1390739547106095}],
  Editable->
   False]], "Print",ExpressionUUID->"bcfcb674-0f5c-4cb0-be45-2fc02bba4f6f"],

Cell[BoxData["1.6209256159527285`*^-14"], \
"Print",ExpressionUUID->"40dde15e-14ff-4767-8231-6a8063f5b925"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"7e7a6675-20e0-41b2-8f87-0e39a1e519e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0466220000000000004`2.836834664829259", ",", 
     "0.062676`4.947616269716613", ",", "0.001091`3.1883397484203355", ",", 
     "0.001004`3.1522487106409947"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0466220000000000004`2.836834664829259, 0.062676`4.947616269716613, 
    0.001091`3.1883397484203355, 0.001004`3.1522487106409947}],
  Editable->
   False]], "Print",ExpressionUUID->"5559953f-3816-408f-bd5a-602288aeb7e4"],

Cell[BoxData["1.6653345369377348`*^-14"], \
"Print",ExpressionUUID->"29115422-b128-4aaf-a33f-80c772c9db64"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"92009c60-8220-4687-813a-69b174d0b9bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.057545`2.928251359191861", ",", "0.075375`5.027742322980202", ",", 
     "0.001335`3.275996263532588", ",", "0.001269`3.2539766199266986"}], 
    "}"}]}],
  SequenceForm[
  "times:  ", {
   0.057545`2.928251359191861, 0.075375`5.027742322980202, 
    0.001335`3.275996263532588, 0.001269`3.2539766199266986}],
  Editable->
   False]], "Print",ExpressionUUID->"4409fd01-d95f-4644-bb7c-d1cf02c05a1a"],

Cell[BoxData["1.6653345369377348`*^-14"], \
"Print",ExpressionUUID->"cbe6fcb3-f501-4e74-b7fa-b71ba48ab13c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"4f40e5bd-63e1-45ab-9f74-f411991810ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0585779999999999997`2.935978304487073", ",", 
     "0.076044`5.031579951004859", ",", "0.001377`3.2894489380889174", ",", 
     "0.00129`3.2611047081312425"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0585779999999999997`2.935978304487073, 0.076044`5.031579951004859, 
    0.001377`3.2894489380889174, 0.00129`3.2611047081312425}],
  Editable->
   False]], "Print",ExpressionUUID->"5e1eabff-670c-43a3-9138-407c28c98d18"],

Cell[BoxData["1.6209256159527285`*^-14"], \
"Print",ExpressionUUID->"59955517-dd9a-4f36-b53c-00428074cf12"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"0a4bfe11-a800-41e3-bf24-7eb73ca32e5b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0592839999999999999`2.9411812633959684", ",", 
     "0.077307`5.038733818059935", ",", "0.001384`3.2916510879527334", ",", 
     "0.001298`3.2637896902963446"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0592839999999999999`2.9411812633959684, 0.077307`5.038733818059935, 
    0.001384`3.2916510879527334, 0.001298`3.2637896902963446}],
  Editable->
   False]], "Print",ExpressionUUID->"d4500447-7d50-4c17-8914-8c6d94036ed3"],

Cell[BoxData["1.6431300764452317`*^-14"], \
"Print",ExpressionUUID->"e0f5ad4a-f580-4718-9aad-f86a35940939"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"fa1a7688-7db1-4842-8113-82d3c1050cd3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0432639999999999997`2.8043704347179474", ",", 
     "0.057899`4.913186060726402", ",", "0.001075`3.1819234620836183", ",", 
     "0.000992`3.1470266699861726"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0432639999999999997`2.8043704347179474, 0.057899`4.913186060726402, 
    0.001075`3.1819234620836183, 0.000992`3.1470266699861726}],
  Editable->
   False]], "Print",ExpressionUUID->"14458a26-0c26-4d8e-a62f-3e01d78db568"],

Cell[BoxData["1.5987211554602254`*^-14"], \
"Print",ExpressionUUID->"c1720224-e0ff-4a38-afb0-9c511da7cac1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"5f1ff792-5f44-430a-8c89-873404752ca5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0435920000000000001`2.807650559688478", ",", 
     "0.057569`4.91070368345781", ",", "0.001427`3.304938970946641", ",", 
     "0.001235`3.2421819554276783"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   0.0435920000000000001`2.807650559688478, 0.057569`4.91070368345781, 
    0.001427`3.304938970946641, 0.001235`3.2421819554276783}],
  Editable->
   False]], "Print",ExpressionUUID->"34113bec-fd9d-4819-8839-12f4fbc4b08c"],

Cell[BoxData["1.6653345369377348`*^-14"], \
"Print",ExpressionUUID->"136d2d46-0ab3-4739-a843-a25febd0b6f3"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test ersatzLanczos[]", \
"Section",ExpressionUUID->"fcdcc68a-11ff-41be-a66e-1fc6cddb9f7a"],

Cell["\<\
Test against dense calculation using gauge configuration.  Need to understand \
errors in calculating smallest eigenvalues.\
\>", "Text",ExpressionUUID->"1e8ffd7b-8b9e-4cb6-a2df-86ce0ad89f5b"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"42c83118-af2c-4711-8a04-2e9de5e6187a"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"02e79e96-7a6a-4967-8a6b-d30828bc0530"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testCutoff", "=", "2"}], 
  ";"}]], "Input",ExpressionUUID->"de393837-9c53-4f65-811a-2a6725f851a4"],

Cell[CellGroupData[{

Cell["Project into dynamic (non-gauge-transform) subspace", \
"Subsection",ExpressionUUID->"8f8f4f06-bd6f-457c-bacd-5d4b1f5d34d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hess", ",", "grad", ",", "proj", ",", "shifts", ",", "delta", ",", 
      RowBox[{"rl", "=", 
       RowBox[{"makeRootLattice", "[", "]"}]}], ",", 
      RowBox[{"fDir", "=", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hess", ",", "grad"}], "}"}], "=", 
      RowBox[{"latticeHessian", "[", 
       RowBox[{
        RowBox[{"getLink", "[", "rl", "]"}], ",", 
        RowBox[{"fixedDir", "\[Rule]", "fDir"}]}], "]"}]}], ";", 
     RowBox[{"proj", "=", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"gaugeTransformShifts", "[", 
        RowBox[{"rl", ",", "fDir"}], "]"}], "]"}]}], ";", 
     RowBox[{"projHess0", "=", 
      RowBox[{"proj", ".", "hess", ".", 
       RowBox[{"Transpose", "[", "proj", "]"}]}]}], ";", 
     RowBox[{"projGrad0", "=", 
      RowBox[{"proj", ".", "grad"}]}], ";", 
     RowBox[{"proj0", "=", "proj"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"valuesd", ",", "ood"}], "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", 
        RowBox[{"Eigensystem", "[", "projHess0", "]"}]}], "]"}]}], ";", 
     RowBox[{"applyCutoff3", "[", 
      RowBox[{"valuesd", ",", 
       RowBox[{"ood", ".", "projGrad0"}], ",", 
       RowBox[{"ood", ".", "proj0"}], ",", "testCutoff"}], "]"}]}]}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"713ca18d-d44b-4325-9d09-a09e4e125171"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "24", 
   "\[InvisibleSpace]", "\<\" zeros, between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["applyCutoff3:  ", 4, " of ", 24, " zeros, between ", {1, 5}],
  Editable->
   False]], "Print",ExpressionUUID->"2d70c676-f032-4db0-b66e-bf41f79d8359"]
}, Open  ]],

Cell["\<\
Compare with Lanczos.  This case is not so interesting since we cannot \
perform this projection in a sparse-matrix approach.\
\>", "Text",ExpressionUUID->"f7c48adb-8594-4396-8825-c16a8ee96f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"slice", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"6", ",", 
     RowBox[{"Length", "[", "projGrad0", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valuese", ",", "ooe"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Reverse", ",", 
     RowBox[{"ersatzLanczos", "[", 
      RowBox[{"projHess0", ",", 
       RowBox[{"eigenPairs", "\[Rule]", 
        RowBox[{"-", "slice"}]}], ",", 
       RowBox[{"maxIterations", "\[Rule]", "1800"}], ",", 
       RowBox[{"printDetails", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"applyCutoff3", "[", 
   RowBox[{"valuese", ",", 
    RowBox[{"ooe", ".", "projGrad0"}], ",", 
    RowBox[{"ooe", ".", "proj0"}], ",", "testCutoff"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"9c9085fa-9ed5-42b3-aa34-5d9540f3012b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "24"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 3, " itn=", 24],
  Editable->
   False]], "Print",ExpressionUUID->"a923d70e-0acc-4092-bce8-ff5b4cddcd57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.340048920906173`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.340048920906173],
  Editable->
   False]], "Print",ExpressionUUID->"5bd4a6c8-71bb-44e5-aff1-5c5c7cf15a69"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.0002049999999999998`1.082057617176141", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.000587`1.2379118617040183", "\[InvisibleSpace]", "\<\", total=\"\>", 
   "\[InvisibleSpace]", "0.003525`3.6976741191594096"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.0002049999999999998`1.082057617176141, ", orthogonalization=", 
   0.000587`1.2379118617040183, ", total=", 0.003525`3.6976741191594096],
  Editable->
   False]], "Print",ExpressionUUID->"edca1ffb-502e-42ed-a87a-ce1f735775fb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Reasonable accuracy achieved, given machine \
epsilon\"\>"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", 
   "Reasonable accuracy achieved, given machine epsilon"],
  Editable->
   False]], "Print",ExpressionUUID->"0fd442c1-8d39-4b0a-b230-e489111cb110"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" zeros, between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["applyCutoff3:  ", 4, " of ", 6, " zeros, between ", {1, 5}],
  Editable->
   False]], "Print",ExpressionUUID->"312c60cd-f8a0-459d-af3a-d70f9511680f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{"ood", ",", "slice"}], "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Take", "[", 
       RowBox[{"ooe", ",", "slice"}], "]"}], "]"}]}], "]"}], "-", 
   RowBox[{"IdentityMatrix", "[", "slice", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"d824ef60-0bec-4d73-8a9e-daa866b172e2"],

Cell[BoxData["1.6060325409817694`*^-14"], \
"Output",ExpressionUUID->"6b7bc2b0-c8ba-44e1-b609-0486c32728b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"valuesd", ",", "slice"}], "]"}], "-", 
   RowBox[{"Take", "[", 
    RowBox[{"valuese", ",", "slice"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"df33284e-0565-4193-9308-5f4f4939c64c"],

Cell[BoxData["1.4158744573982094`*^-15"], \
"Output",ExpressionUUID->"28c3e03d-ef4c-4116-b96f-76a3b2efee1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"ooe", ".", 
    RowBox[{"Transpose", "[", "ooe", "]"}]}], "-", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "valuese", "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"e44d4afc-0b23-429a-8548-c7ac91e83128"],

Cell[BoxData["2.1868896916329464`*^-15"], \
"Output",ExpressionUUID->"d9e676a4-f964-44ba-9868-9ada12dbdcfc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Use full space with projection operator.", \
"Subsection",ExpressionUUID->"58f2de4b-193a-436b-907c-e74092213992"],

Cell["\<\
In this case, the nullspace of the projection operator is included in the \
eigensystem.\
\>", "Text",ExpressionUUID->"29253b9a-63cc-40cc-9df8-6d8adb3e1a04"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hess", ",", "grad", ",", "proj", ",", "shifts", ",", "delta", ",", 
      RowBox[{"rl", "=", 
       RowBox[{"makeRootLattice", "[", "]"}]}], ",", 
      RowBox[{"fDir", "=", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hess", ",", "grad"}], "}"}], "=", 
      RowBox[{"latticeHessian", "[", 
       RowBox[{
        RowBox[{"getLink", "[", "rl", "]"}], ",", 
        RowBox[{"fixedDir", "\[Rule]", "fDir"}]}], "]"}]}], ";", 
     RowBox[{"proj", "=", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"gaugeTransformShifts", "[", 
        RowBox[{"rl", ",", "fDir"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"proj", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "proj", "]"}], ".", "proj"}]}], ";", 
     RowBox[{"projHess00", "=", 
      RowBox[{"proj", ".", "hess", ".", "proj"}]}], ";", 
     RowBox[{"projGrad00", "=", 
      RowBox[{"proj", ".", "grad"}]}], ";", 
     RowBox[{"proj00", "=", "proj"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"valuesdd", ",", "oodd"}], "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", 
        RowBox[{"Eigensystem", "[", "projHess00", "]"}]}], "]"}]}], ";", 
     RowBox[{"applyCutoff3", "[", 
      RowBox[{"valuesdd", ",", 
       RowBox[{"oodd", ".", "projGrad00"}], ",", 
       RowBox[{"oodd", ".", "proj00"}], ",", "testCutoff"}], "]"}]}]}], "]"}],
   ";"}]], "Input",ExpressionUUID->"46c08f3c-a26f-4a6d-8b8d-25f66411f89d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "36", 
   "\[InvisibleSpace]", "\<\" zeros, between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"13", ",", "17"}], "}"}]}],
  SequenceForm["applyCutoff3:  ", 4, " of ", 36, " zeros, between ", {13, 17}],
  Editable->
   False]], "Print",ExpressionUUID->"846d63ba-b50a-4e11-a35b-cb75854ef277"]
}, Open  ]],

Cell["\<\
With the Krylov method, we never access the nullspace of the projection \
operator.  Without explicitly projecting out the nullspace, it looks like \
Lanczos will wander into the nullspace.  Perhaps the stopping criteria needs \
to be tuned?\
\>", "Text",ExpressionUUID->"9463f2c3-e538-4fcd-bbe8-6bf58ad94f59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"slicee", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"6", ",", 
     RowBox[{"Length", "[", "projGrad00", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"valuesee", ",", "ooee"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Reverse", ",", 
     RowBox[{"ersatzLanczos", "[", 
      RowBox[{"projHess00", ",", 
       RowBox[{"eigenPairs", "\[Rule]", 
        RowBox[{"-", "slicee"}]}], ",", 
       RowBox[{"maxIterations", "\[Rule]", "3000"}], ",", 
       RowBox[{"printDetails", "\[Rule]", "True"}], ",", 
       RowBox[{"initialVector", "\[Rule]", "projGrad00"}], ",", 
       RowBox[{"orthoSubspace", " ", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"proj00", ".", "#"}], ")"}], "&"}], ")"}]}]}], "]"}]}], 
    "]"}]}], ";", 
  RowBox[{"applyCutoff3", "[", 
   RowBox[{"valuesee", ",", 
    RowBox[{"ooee", ".", "projGrad00"}], ",", 
    RowBox[{"ooee", ".", "proj00"}], ",", "testCutoff"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"4a27c6db-8f03-4367-8a79-4becb69b9bc8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "24"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 3, " itn=", 24],
  Editable->
   False]], "Print",ExpressionUUID->"75e8f70a-773c-402e-b8b1-af4577ec7114"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.3329009854893243`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.3329009854893243`],
  Editable->
   False]], "Print",ExpressionUUID->"cd1b6165-3825-4b61-9983-703173618436"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.000118`0.8421857634265125", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.000349`1.0120991874155851", "\[InvisibleSpace]", "\<\", total=\"\>", 
   "\[InvisibleSpace]", "0.002235`3.499792525299947"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.000118`0.8421857634265125, ", orthogonalization=", 
   0.000349`1.0120991874155851, ", total=", 0.002235`3.499792525299947],
  Editable->
   False]], "Print",ExpressionUUID->"06767e95-7569-49ca-abd7-6dae00ba0bf1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Reasonable accuracy achieved, given machine \
epsilon\"\>"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", 
   "Reasonable accuracy achieved, given machine epsilon"],
  Editable->
   False]], "Print",ExpressionUUID->"a1647371-d17f-4216-b506-32e751d12def"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" zeros, between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["applyCutoff3:  ", 4, " of ", 6, " zeros, between ", {1, 5}],
  Editable->
   False]], "Print",ExpressionUUID->"37581199-88e0-4ec5-8527-91ae04026ab2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"ood", ".", "proj0"}], ",", "slicee"}], "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Take", "[", 
       RowBox[{"ooee", ",", "slicee"}], "]"}], "]"}]}], "]"}], "-", 
   RowBox[{"IdentityMatrix", "[", "slicee", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"eced5048-14b7-49d0-994c-aa11673a0efb"],

Cell[BoxData["6.563741562571862`*^-15"], \
"Output",ExpressionUUID->"f5ad0fbb-b0dd-4819-ab37-4516f1f8547b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"valuesd", ",", "slicee"}], "]"}], "-", 
   RowBox[{"Take", "[", 
    RowBox[{"valuesee", ",", "slicee"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"8313f522-e19d-446c-aa25-954274ab37f9"],

Cell[BoxData["6.4018582627671775`*^-16"], \
"Output",ExpressionUUID->"e6300e7d-aaa9-4d06-abbf-bd41f311d6a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"ooee", ".", 
    RowBox[{"Transpose", "[", "ooee", "]"}]}], "-", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "valuesee", "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"be850030-f405-42dc-b183-42bd2b9e5c0e"],

Cell[BoxData["1.1891160409676073`*^-15"], \
"Output",ExpressionUUID->"2c0ee33f-e807-4f58-915c-97b952b7e522"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare MINRES/MINRES-QLP versus dense, no cutoff.", \
"Section",ExpressionUUID->"25560db5-08ba-4d34-aeef-0960426da3ce"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"5b561796-b3a3-49b1-a7dd-d4f6a59fa732"],

Cell[" Choose method:", \
"Text",ExpressionUUID->"cf4bc892-1a73-4fb9-b62f-6918231f7993"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Keys", "[", "minresLabels", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"minresMethod", "=", 
  RowBox[{
   RowBox[{"Keys", "[", "minresLabels", "]"}], "[", 
   RowBox[{"[", "1", "]"}], 
   "]"}]}]}], "Input",ExpressionUUID->"cfff3048-0ad8-4d05-abcb-564d85ef344a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"MINRES\"\>", ",", "\<\"MINRES1\"\>", ",", "\<\"MINRES-QLP\"\>",
    ",", "\<\"MINRES-QLP0\"\>"}], 
  "}"}]], "Print",ExpressionUUID->"4aafc5de-e04f-4b09-8009-2d967ffa8af8"],

Cell[BoxData["\<\"MINRES\"\>"], \
"Output",ExpressionUUID->"931f554b-8c3f-4368-a6aa-b1e4e56e35fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamic/All", \
"Subsection",ExpressionUUID->"80597020-d0fe-4d53-a1b6-14a999f4b157"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAllDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"6b957c4f-5b3a-4f48-b0dd-965728963678"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "256.129535242073`", ",", "2184.7766184170455`", ",", 
     "1.0000000000029745`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {256.129535242073, 2184.7766184170455`, 
   1.0000000000029745`}],
  Editable->
   False]], "Print",ExpressionUUID->"2f644039-d4c7-495b-a2bf-c670d0ed0070"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1266120000000000005`3.2918120423118915", ",", 
     "2.520555`6.552011176271864", ",", "0.665494`5.97365914212257", ",", 
     "0.019303`4.436139808507943"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1266120000000000005`3.2918120423118915, 2.520555`6.552011176271864, 
    0.665494`5.97365914212257, 0.019303`4.436139808507943}],
  Editable->
   False]], "Print",ExpressionUUID->"5c4fed06-9ac9-4692-a2a1-b09f46c734b9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicDense", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"30928d76-8453-4ae7-8a53-b6a6326c9514"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "48.387675526904104`", ",", "366.9506648570862`", ",", 
     "0.9999999999982808`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {48.387675526904104`, 366.9506648570862, 
   0.9999999999982808}],
  Editable->
   False]], "Print",ExpressionUUID->"8ddb117f-0e43-442c-b6e0-58fbc0429b8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1590810000000000012`3.298392717751474", ",", 
     "2.564305`6.559484677001408", ",", "1.133141`6.204798951571764", ",", 
     "0.016874`4.377733042603177"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1590810000000000012`3.298392717751474, 2.564305`6.559484677001408, 
    1.133141`6.204798951571764, 0.016874`4.377733042603177}],
  Editable->
   False]], "Print",ExpressionUUID->"70894e13-193e-4cfa-8036-9bed3895ebe7"]
}, Open  ]]
}, Open  ]],

Cell["\<\
For projecting out the gauge transforms on a Nc=3, 4^3 lattice:
247 seconds for solving squared system using conjugate gradients.
67 seconds for default (dense?) LeastSquares
83 seconds for  LeastSquares Krylov method (tol=Automatic).
515 seconds for LeastSquares Krylov, tolerance=0.01
365 seconds for LeastSquares Krylov, tolerance=100\
\>", "Text",ExpressionUUID->"ee14b917-d38b-4055-afba-f99d19388eac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAllMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"minresMethod", ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"694c320b-dc84-4144-ab9e-09d1ea7decf6"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "160"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 160],
  Editable->
   False]], "Print",ExpressionUUID->"5a51f481-39d1-4950-97ae-7ca81304fe5e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.575405771131492`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.575405771131492],
  Editable->
   False]], "Print",ExpressionUUID->"6c6c1122-c652-4d4e-a4b9-059540ec4a22"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.0161069999999999997`2.1534096738589654", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.0305490000000000005`2.1303620179993352", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.068422`4.9857107624525785"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.0161069999999999997`2.1534096738589654, ", orthogonalization=", 
   0.0305490000000000005`2.1303620179993352, ", total=", 
   0.068422`4.9857107624525785],
  Editable->
   False]], "Print",ExpressionUUID->"8137b50d-8da3-4652-9947-87c369bd9b63"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"4bfe053d-5191-486a-b0ea-e17efede55af"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "16", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 0, " of ", 16, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"9acb7b82-b5a1-4047-9370-e15a88d1d6d3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "0.0042880000000000006`0.5525763956476523", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0029029999999999998`0.42612341383218083", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.1845300000000000007`2.1866442936674613", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "6.989935`6.99498813505513"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   0.0042880000000000006`0.5525763956476523, ", small shifts=", 
   0.0029029999999999998`0.42612341383218083, ", A=", 
   0.1845300000000000007`2.1866442936674613, ", total=", 
   6.989935`6.99498813505513],
  Editable->
   False]], "Print",ExpressionUUID->"8ef59e88-dc76-499c-b2b3-56b24fe69eb9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1504449999999999999`3.2966521216088043", ",", 
     "2.552813`6.557534000633666", ",", "6.99668`6.995407009315629", ",", 
     "0.017821`4.401447068032104"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1504449999999999999`3.2966521216088043, 2.552813`6.557534000633666, 
    6.99668`6.995407009315629, 0.017821`4.401447068032104}],
  Editable->
   False]], "Print",ExpressionUUID->"366ffab3-89ce-468d-819c-1555ff02af96"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamicMinres", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10", "^", 
          RowBox[{"-", "13"}]}]}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"minresMethod", ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"58fde015-7816-4ca8-9c3f-55150f46891e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"399.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     398576.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"MINRES\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[398576., 3], " (bytes) for ", "MINRES"],
  Editable->
   False]], "Print",ExpressionUUID->"2f46f226-dbcb-4b64-b67e-e7642c6e4989"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "160"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 160],
  Editable->
   False]], "Print",ExpressionUUID->"c611fb23-85fe-4798-9404-967345f70e32"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.561478675712225`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.561478675712225],
  Editable->
   False]], "Print",ExpressionUUID->"ff8ce7c5-32b1-49f1-b1c2-687994c9dfbc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.8941819999999999999`3.8978209383916442", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.040404`2.2517893819478014", "\[InvisibleSpace]", "\<\", total=\"\>", 
   "\[InvisibleSpace]", "0.952781`6.129508085856007"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.8941819999999999999`3.8978209383916442, ", orthogonalization=", 
   0.040404`2.2517893819478014, ", total=", 0.952781`6.129508085856007],
  Editable->
   False]], "Print",ExpressionUUID->"6fb84da2-8ba7-4087-8943-89980bf60171"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"6ff95faf-31a9-4672-ba66-00d3725ac38b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "16", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 0, " of ", 16, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"3d7046e8-fe46-4867-bf96-8134be635bcf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "4.0378170000000000008`3.880443789408381", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0017219999999999997`0.614226438226708", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.0981459999999999999`2.2667476651884275", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "5.888128`6.920492240243205"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   4.0378170000000000008`3.880443789408381, ", small shifts=", 
   0.0017219999999999997`0.614226438226708, ", A=", 
   0.0981459999999999999`2.2667476651884275, ", total=", 
   5.888128`6.920492240243205],
  Editable->
   False]], "Print",ExpressionUUID->"8e74d8e6-d894-4d76-91cd-f6dc5f27243d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1516890000000000004`3.296903281777475", ",", 
     "2.569645`6.560388126925814", ",", "6.090384`6.935159673687122", ",", 
     "0.023917`4.529221701360947"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1516890000000000004`3.296903281777475, 2.569645`6.560388126925814, 
    6.090384`6.935159673687122, 0.023917`4.529221701360947}],
  Editable->
   False]], "Print",ExpressionUUID->"158fca1c-c98c-486a-a575-62f600428fef"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAllDense", "-", "gaugeFieldAllMinres"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"c32d2981-d314-4ea6-8eba-66044580ec02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1728"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"d415929c-2bde-44ed-8ece-0e32770eee5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldDynamicDense", "-", "gaugeFieldDynamicMinres"}], 
     "]"}], ",", 
    RowBox[{"5", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4d0fcbf4-c322-4d6e-8ce7-14b70baa94ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1728"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"aa2b65b9-45ba-4c51-9961-ef685eb74911"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Axial", \
"Subsection",ExpressionUUID->"32dec57f-e017-4c52-bdc7-5dcd64d3eadc"],

Cell["Compare for the Axial-constant shifts", \
"Text",ExpressionUUID->"f3fc5478-c0c9-4ff3-88de-e5077ce3395d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"axialDirection", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "axialDirection", "]"}], ";", 
  RowBox[{"gaugeFieldAxialDense1", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"f2b1f822-1b31-4cc7-a1ae-c2d256652ac8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "162.13252049785092`", ",", "1094.5412611333888`", ",", 
     "0.9999999999996594`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {162.13252049785092`, 1094.5412611333888`, 
   0.9999999999996594}],
  Editable->
   False]], "Print",ExpressionUUID->"32ce5b03-2e7c-44dd-8b14-2223aa16ce2f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1187590000000000008`3.290205342470444", ",", 
     "2.460016`6.541452929605745", ",", "0.984245`6.143618215068275", ",", 
     "0.017305`4.388686601462139"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1187590000000000008`3.290205342470444, 2.460016`6.541452929605745, 
    0.984245`6.143618215068275, 0.017305`4.388686601462139}],
  Editable->
   False]], "Print",ExpressionUUID->"eefe2e01-21ae-4ef6-83c9-17c9f6a771ea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxialMinres1", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"rescaleCutoff", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"Method", "\[Rule]", "minresMethod"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10", "^", 
          RowBox[{"-", "13"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"956cf06d-1e62-4d8f-9187-46aa5cbe7e7e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"280.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     280176.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"MINRES\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[280176., 3], " (bytes) for ", "MINRES"],
  Editable->
   False]], "Print",ExpressionUUID->"af8190d5-7d60-4dee-99af-4a1f99b3d18d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "160"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 160],
  Editable->
   False]], "Print",ExpressionUUID->"9c7bbe61-563d-4ec2-8354-dc51ddd0a692"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "6.244077762402285`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 6.244077762402285],
  Editable->
   False]], "Print",ExpressionUUID->"f2e9a812-dfec-4deb-a560-29c00c4039ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.5104909999999999999`3.6543831050176236", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0.0260579999999999991`2.06130609925796", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.551928`5.892397424760158"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.5104909999999999999`3.6543831050176236, ", orthogonalization=", 
   0.0260579999999999991`2.06130609925796, ", total=", 
   0.551928`5.892397424760158],
  Editable->
   False]], "Print",ExpressionUUID->"718cd940-a49f-48ed-9b33-1f19985b4be8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"f8807593-74b4-4946-bdbb-0a814842f852"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "16", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 0, " of ", 16, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"7dc320a1-3951-428a-b99c-51eee9b65f5e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "767"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 767],
  Editable->
   False]], "Print",ExpressionUUID->"40db5b82-5b9f-4cd9-965d-2b89987c467f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "87.70466107372667`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "5.416811608016989`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 87.70466107372667, " Acond=", 5.416811608016989],
  Editable->
   False]], "Print",ExpressionUUID->"c437c2b9-12f4-4c27-8dfd-737ade20f6b9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "1.263308439525156`*^-9", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "1094.5412615310831`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 1.263308439525156*^-9, " ynorm=", 
   1094.5412615310831`],
  Editable->
   False]], "Print",ExpressionUUID->"23c2277f-7730-4b43-b4f7-54155329c967"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "1.3862182050904344`*^-9"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 1.3862182050904344`*^-9],
  Editable->
   False]], "Print",ExpressionUUID->"1566b3b6-395e-449f-a56a-917871bf8c4a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "2.5003249999999999993`3.663716097168243", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "1.5457100000000000011`3.153817654829973", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "4.441369`6.798031854772037"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   2.5003249999999999993`3.663716097168243, ", orthogonalization=", 
   1.5457100000000000011`3.153817654829973, ", total=", 
   4.441369`6.798031854772037],
  Editable->
   False]], "Print",ExpressionUUID->"68b47b9f-ca4c-42d8-bfe1-87e321ddb571"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"f92d5128-5cae-4c3a-b78e-a3da5ee7d229"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "2.9070069999999999989`3.6454781268199827", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.0020199999999999996`0.5693756421061283", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.0744520000000000001`2.0543756525121286", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "5.001193`6.849588612471177"}],
  SequenceForm[
  "findDelta time (seconds):  dynamic part=", 
   2.9070069999999999989`3.6454781268199827, ", small shifts=", 
   0.0020199999999999996`0.5693756421061283, ", A=", 
   0.0744520000000000001`2.0543756525121286, ", total=", 
   5.001193`6.849588612471177],
  Editable->
   False]], "Print",ExpressionUUID->"af7c548f-3cd1-44b3-8c5f-361553665655"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1110660000000000006`3.2886255933634856", ",", 
     "2.447032`6.539154646518703", ",", "5.161008`6.863249530095737", ",", 
     "0.019619`4.443191865017106"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1110660000000000006`3.2886255933634856, 2.447032`6.539154646518703, 
    5.161008`6.863249530095737, 0.019619`4.443191865017106}],
  Editable->
   False]], "Print",ExpressionUUID->"658bd27c-be31-4c47-8159-1f66140bc2c5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"gaugeFieldAxialDense1", "-", "gaugeFieldAxialMinres1"}], "]"}], 
    ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"97eefe67-1b34-48cb-b39d-50517408c971"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1728"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"30e4117d-d411-4f55-b9d1-3d2c8428c7e7"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare MINRES/MINRES-QLP versus dense", \
"Section",ExpressionUUID->"7f154c8b-cbe7-44d7-af10-ff3bf3798fa1"],

Cell["\<\
MINRES/MINRES-QLP with special handling of large shift eigenvalues, compared \
to dense calculation.\
\>", "Text",ExpressionUUID->"f5649d56-9f91-4dbe-8f11-6bba4f25a082"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"dc4b39c9-5ae3-4f1e-a16f-c9ab54be90fd"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"d981ba60-d35e-4254-901a-4955628570dd"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-8-9-3.m\>\""}]], \
"Input",ExpressionUUID->"8d7171c1-6809-40ee-840b-21d5ca1aaf6e"],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"9423ff30-cb04-4ae2-a15a-53b919221844"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "5"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"3567b284-0a38-49b4-985c-4c06a4bfd03d"],

Cell[BoxData[
 RowBox[{"-", 
  "0.0261698772709728`"}]], \
"Output",ExpressionUUID->"30656111-2224-430f-991c-97df62ebcdee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamic", \
"Subsection",ExpressionUUID->"0157dcfb-63cf-4b2e-bde1-4c021871fcb5"],

Cell["\<\
nd=3, nc=3, 12^3 crashes kernel, but nc=3, 8^3 works.

8^3 lattice 48 large shifts, need 127 N=8192, dense is 7 minutes.
trnlaso is 25 minutes.  Error is 4*10^-5.\
\>", "Text",ExpressionUUID->"e368b91a-a8b2-4807-ab42-1938cb220188"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldDynamicDense", ",", "shiftsDynamicDense"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"fullMatrix", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"536f9c31-c58c-453e-97fa-7a674202e049"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Constructed hess, grad\"\>"], \
"Print",ExpressionUUID->"36865041-c5ab-4162-b4f3-6ce7ab4525ca"],

Cell[BoxData["\<\"Constructed gauge\"\>"], \
"Print",ExpressionUUID->"5b450749-2a3a-4692-913b-36561c3f3aa5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "14", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" zeros, between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"994", ",", "1024"}], "}"}]}],
  SequenceForm[
  "applyCutoff3:  ", 14, " of ", 1024, " zeros, between ", {994, 1024}],
  Editable->
   False]], "Print",ExpressionUUID->"0edf70a3-c876-450d-9de1-bbfe4faad0ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.320151887931429`", ",", "58.55902361053902`", ",", 
     "0.9999999999998614`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {8.320151887931429, 58.55902361053902, 
   0.9999999999998614}],
  Editable->
   False]], "Print",ExpressionUUID->"61b64897-b89d-4bf4-8b38-c043ad86ed53"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.320151887931429`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.320151887931429, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"592db73a-e9d8-4250-9d62-6884717cca96"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"latticeSaddlePointStep times:\\n    matrices=\"\>", 
   "\[InvisibleSpace]", "2.262941`6.505188228893011", 
   "\[InvisibleSpace]", "\<\" s, findDelta=\"\>", "\[InvisibleSpace]", 
   "1.816319`6.409707123830455", 
   "\[InvisibleSpace]", "\<\" s, applyDelta=\"\>", "\[InvisibleSpace]", 
   "0.037527`4.724858845071553", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "latticeSaddlePointStep times:\n    matrices=", 2.262941`6.505188228893011, 
   " s, findDelta=", 1.816319`6.409707123830455, " s, applyDelta=", 
   0.037527`4.724858845071553, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"29f9988d-03e4-4ce8-b69d-a86d3350135b"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldDynamicMinres1", ",", "shiftsDynamicMinres1"}], "}"}], 
   "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"fullMatrix", "\[Rule]", "True"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "10"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}], ",", 
     RowBox[{"largeShiftOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eigenPairs", "\[Rule]", 
         RowBox[{"-", "130"}]}], ",", 
        RowBox[{"maxIterations", "\[Rule]", "5000"}], ",", 
        RowBox[{"innerInterval", "\[Rule]", "10"}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "7"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"printsPerDecade", " ", "\[Rule]", " ", "10"}], ",", 
        RowBox[{"restartLanczos", "\[Rule]", "False"}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", " ", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"51486604-b351-4829-8733-5524265d7cc1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsDynamicDense", ",", "shiftsDynamicMinres1"}], 
  "]"}]], "Input",ExpressionUUID->"df89957d-d859-40c2-8af5-4495bb1f1ffb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.320152014340525`", ",", "3.0386499427770275`*^-8"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"58.559023432459334`", ",", 
     RowBox[{"-", "6.081721348749625`*^-9"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9999999999999493`", ",", "3.185504425530386`*^-7"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"a8ddc83c-3941-48e8-8a8e-d0855285cbab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Norm", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"gaugeFieldDynamicDense", "-", "gaugeFieldDynamicMinres1"}], 
    "]"}], "]"}], "/", 
  RowBox[{"Norm", "[", 
   RowBox[{"Flatten", "[", "gaugeFieldDynamicDense", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"b14e750e-ca64-4747-8fa4-d15d8a90e9d2"],

Cell[BoxData["1.3083425787153141`*^-7"], \
"Output",ExpressionUUID->"dcc26e52-1d13-49e8-93ab-b917d144ed79"]
}, Open  ]],

Cell["For small systems, strategy = 3 or 4 is better.", \
"Text",ExpressionUUID->"cf331d89-2a60-4e76-9311-abdc1e01fa9a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldDynamicMinres2", ",", "shiftsDynamicMinres2"}], "}"}], 
   "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "1200"}], ",", 
        RowBox[{"maxIterations", "\[Rule]", 
         RowBox[{"400", "*", "1000"}]}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "9"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "1"}]}], "}"}]}], ",", 
     RowBox[{"largeShiftOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eigenPairs", "\[Rule]", 
         RowBox[{"-", "40"}]}], ",", 
        RowBox[{"maxIterations", "\[Rule]", 
         RowBox[{"100", "*", "1000"}]}], ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "1200"}], ",", 
        RowBox[{"restartStrategy", "\[Rule]", "4"}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "7"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "1"}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<External\>\"", ",", 
        RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"rTolerance", " ", "\[Rule]", " ", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "9"}]}]}], ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "1200"}]}], "}"}]}], ",", 
     RowBox[{"externalAction", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"printDetails", "\[Rule]", "2"}], ",", " ", 
     RowBox[{"processes", "\[Rule]", "2"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"59dbc176-9bfa-437d-861f-c9020524c00e"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"MAXLAN:      1200, Restart:         4,   NED: -       1,      \
NEC:         1\\nMATVEC:       128,  Reorth:       128, Nloop:         1,  \
Nlocked:         0\\nTtotal:  0.052693,    T_op:  0.012121, Torth:  0.005402, \
  Tstart:  0.006091\\nGauge matrix extreme eigenvalues found:\\n  \
1.130975e+00\\nMAXLAN:      1200, Restart:         4,   NED: -      40,      \
NEC:        40\\nMATVEC:      1200,  Reorth:      1780, Nloop:         1,  \
Nlocked:         0\\nTtotal: 33.402821,    T_op: 18.172523, Torth: 14.499421, \
  Tstart:  0.300220\\nlargeShifts: ops=1200, sumNcol=1200, \
maxNcol=1\\nlargeShifts: 1200 matrix-vector ops, 1780 reorthogonalizations in \
11.72 s\\ncutoffNullSpace:  14 of 40 zeros between [0, 30]\\nlinearSolve:  \
460 iterations, 460 reorthogonalizations in 1.68 s\\ndynamicProject:  5104 \
calls (2977 usertol), 103611 matrix-vector ops, max itn 29\\n                 \
in 10.19 s\\nMatrix hessian ops=2864, localTime=0.30 s, mpiTime=0.07 s\\n    \
global 3.1 GFLOP/s, stream=14.0 GB/s\\nMatrix gauge ops=129259, \
localTime=2.76 s, mpiTime=1.60 s\\n    global 2.3 GFLOP/s, stream=10.6 \
GB/s\\nMatrix gaugeT ops=129259, localTime=2.75 s, mpiTime=0.54 s\\n    \
global 2.3 GFLOP/s, stream=11.0 GB/s\\nshifts.c:  init and i/o 0.15 s, \
calculation 13.42 s\\n\"\>",
  StripOnInput->False,
  FontColor->RGBColor[
   0, 0, 1]]], "Print",ExpressionUUID->"940da0fb-244d-44b2-babe-5b4ec34239cb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.32015161217837645732936776632704752505`17.079864852600373", 
   "\[InvisibleSpace]", "\<\" to \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 
   8.32015161217837645732936776632704752505`17.079864852600373, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"dbc93a34-e0ec-40bf-bfa7-897752177de3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"latticeSaddlePointStep times:\\n    matrices=\"\>", 
   "\[InvisibleSpace]", "1.23645`6.242691556731374", 
   "\[InvisibleSpace]", "\<\" s, findDelta=\"\>", "\[InvisibleSpace]", 
   "14.188566`7.302453502538426", 
   "\[InvisibleSpace]", "\<\" s, applyDelta=\"\>", "\[InvisibleSpace]", 
   "0.136544`5.285787619011213", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "latticeSaddlePointStep times:\n    matrices=", 1.23645`6.242691556731374, 
   " s, findDelta=", 14.188566`7.302453502538426, " s, applyDelta=", 
   0.136544`5.285787619011213, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"ea9a310c-9bcd-4ad4-ac17-6d0c10f51ab0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsDynamicDense", ",", "shiftsDynamicMinres2"}], 
  "]"}]], "Input",ExpressionUUID->"4672c11f-8950-4503-91f1-e28501cf7638"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.320151750054903`", ",", 
     RowBox[{"-", "3.314279184429836`*^-8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"58.55902658065254`", ",", "1.014399841903213`*^-7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9999999999995474`", ",", "9.514598542656163`*^-7"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"e73c0c5e-d758-44a3-9311-2983d6e0b437"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Norm", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"gaugeFieldDynamicDense", "-", "gaugeFieldDynamicMinres2"}], 
    "]"}], "]"}], "/", 
  RowBox[{"Norm", "[", 
   RowBox[{"Flatten", "[", "gaugeFieldDynamicDense", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"39c9283e-457a-4349-8fa1-24512c337fda"],

Cell[BoxData["3.913683812282171`*^-7"], \
"Output",ExpressionUUID->"667fd374-7329-48bc-b099-db4062b8bd87"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Axial", \
"Subsection",ExpressionUUID->"b590c957-6eec-4a4d-aef2-abd87409c9b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"axialDirection", "=", "2"}], ";", 
  RowBox[{"setAxialGauge", "[", "axialDirection", "]"}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldAxialDense", ",", "shiftsAxialDense"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"27031bc6-d002-4f25-97cb-dc127f58d7b9"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Constructed hess, grad\"\>"], \
"Print",ExpressionUUID->"8e0b79ad-38f8-4368-bca4-20ef2e3e5d3d"],

Cell[BoxData["\<\"Constructed gauge\"\>"], \
"Print",ExpressionUUID->"450a90c8-559d-4d61-ba7e-11bb91caf9c3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "18", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" zeros, between \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"980", ",", "1024"}], "}"}]}],
  SequenceForm[
  "applyCutoff3:  ", 18, " of ", 1024, " zeros, between ", {980, 1024}],
  Editable->
   False]], "Print",ExpressionUUID->"53ed3f46-7edd-44bd-b701-cb3369f194d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shifts norms and rescale:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "9.950408275075418`", ",", "57.67113802450228`", ",", 
     "1.0000000000001141`"}], "}"}]}],
  SequenceForm[
  "shifts norms and rescale:  ", {9.950408275075418, 57.67113802450228, 
   1.0000000000001141`}],
  Editable->
   False]], "Print",ExpressionUUID->"c410ae46-2558-436c-8bb0-0898fe9e97cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "9.950408275075418`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 9.950408275075418, " to ", 2],
  Editable->
   False]], "Print",ExpressionUUID->"0718881e-f0b5-4c9b-9e3b-449a5a586d80"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"latticeSaddlePointStep times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.386646`6.292480601032696", ",", "0.84798`6.078900607173534", ",", 
     "0.025437`4.555980887816519"}], "}"}]}],
  SequenceForm[
  "latticeSaddlePointStep times:  ", {
   1.386646`6.292480601032696, 0.84798`6.078900607173534, 
    0.025437`4.555980887816519}],
  Editable->
   False]], "Print",ExpressionUUID->"c7cb854d-abca-4e41-82d8-386b83732b46"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldAxialMinres1", ",", "shiftsAxialMinres1"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", 
     RowBox[{"largeShiftOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eigenPairs", "\[Rule]", 
         RowBox[{"-", "100"}]}], ",", 
        RowBox[{"maxIterations", "\[Rule]", "5000"}], ",", 
        RowBox[{"innerInterval", "\[Rule]", "10"}], ",", 
        RowBox[{"printDetails", "\[Rule]", "True"}]}], "}"}]}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<MINRES\>\"", ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "7"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "False"}]}], "}"}]}], ",", 
     RowBox[{"debugProj", "\[Rule]", "False"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"e1c1e35e-adf6-450a-ba7c-246e4d956c9f"],

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsAxialDense", ",", "shiftsAxialMinres1"}], 
  "]"}]], "Input",ExpressionUUID->"62d31c02-62c7-436d-bc9d-3755c64e0057"],

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"gaugeFieldAxialDense", "-", "gaugeFieldAxialMinres1"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"1e463af5-48f3-4f10-b4cc-49f803f86f7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gaugeFieldAxialMinres2", ",", "shiftsAxialMinres2"}], "}"}], "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "axialDirection"}], ",", 
     RowBox[{"dynamicPartMethod", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "1000"}], ",", 
        RowBox[{"maxIterations", "\[Rule]", 
         RowBox[{"400", "*", "1000"}]}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "9"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "2"}]}], "}"}]}], ",", 
     RowBox[{"largeShiftOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eigenPairs", "\[Rule]", 
         RowBox[{"-", "100"}]}], ",", 
        RowBox[{"maxIterations", "\[Rule]", 
         RowBox[{"400", "*", "1000"}]}], ",", 
        RowBox[{"maxLanczosVecs", "\[Rule]", "720"}], ",", 
        RowBox[{"restartStrategy", "\[Rule]", "4"}], ",", 
        RowBox[{"rTolerance", "\[Rule]", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "7"}]}]}], ",", 
        RowBox[{"printDetails", "\[Rule]", "2"}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<External\>\"", ",", 
        RowBox[{"printDetails", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"rTolerance", " ", "\[Rule]", " ", 
         RowBox[{"10.0", "^", 
          RowBox[{"-", "9"}]}]}]}], "}"}]}], ",", 
     RowBox[{"fullMatrix", "\[Rule]", "False"}], ",", 
     RowBox[{"returnShifts", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"4fc05328-fcbb-484d-9e04-57c21a581db6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compareVectors", "[", 
  RowBox[{"shiftsAxialDense", ",", "shiftsAxialMinres2"}], 
  "]"}]], "Input",ExpressionUUID->"8b03f22b-81e7-4a05-8331-0de071cd8f0e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"9.950407382366219`", ",", 
     RowBox[{"-", "1.7943170482759285`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"57.67114631014239`", ",", "2.8734087864634716`*^-7"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.9999999999976332`", ",", "2.175671594654445`*^-6"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"aeb0f5c1-734b-4476-bbad-4cec6871cf68"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"gaugeFieldAxialDense", "-", "gaugeFieldAxialMinres2"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"00e041bc-f0b3-452a-ab5b-58a4aeac7cd0"],

Cell[BoxData["0.000018725489509754987`"], \
"Output",ExpressionUUID->"e2fe5c1f-9667-471d-9efe-16f61d018652"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare dynamic and axial", \
"Subsection",ExpressionUUID->"a4dc8a29-6322-47fb-876c-68c85c089c5b"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"comparePlaquettes", "[", 
    RowBox[{"gf1_", ",", "gf2_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gaugeField", "=", "gf1"}], "}"}], ",", 
        RowBox[{"p1", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"plaquette", "[", 
              RowBox[{"dir1", ",", "dir2", ",", 
               RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir1", ",", "2", ",", "nd"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir2", ",", 
              RowBox[{"dir1", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}], 
      ";", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gaugeField", "=", "gf2"}], "}"}], ",", 
        RowBox[{"p2", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"plaquette", "[", 
              RowBox[{"dir1", ",", "dir2", ",", 
               RowBox[{"latticeCoordinates", "[", "k", "]"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir1", ",", "2", ",", "nd"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dir2", ",", 
              RowBox[{"dir1", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}], 
      ";", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"p1", "-", "p2"}], "]"}], "/", 
       RowBox[{"Norm", "[", "p1", "]"}]}]}]}], "]"}]}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d2a113bc-a18a-4773-88a1-7c6ebb3fd3fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"comparePlaquettes", "[", 
  RowBox[{"gaugeFieldAxialDense", ",", "gaugeFieldDynamicDense"}], 
  "]"}]], "Input",ExpressionUUID->"88b547ae-762a-4d99-999e-54b090f4bd73"],

Cell[BoxData["0.3054565617575611`"], \
"Output",ExpressionUUID->"7d3e342d-593f-49e8-856f-3446e84d0b11"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", \
"Title",ExpressionUUID->"f174178b-2d0b-483f-87a2-8e4a9836b814"],

Cell[CellGroupData[{

Cell["Quadratic approximation errors", \
"Section",ExpressionUUID->"ce1a504e-4046-463f-a1c6-5465d81081e9"],

Cell["\<\
The shifts are approximated as a quadratic.  Use the 2-norm vs. shift \
magnitude to characterize this error.  The error is approximated by \
Norm[shift,2]^2/48, but decreases with nc as 1/nc.
Note that the 2-norm of any SU(N) matrix is 1.\
\>", "Text",ExpressionUUID->"d2626c8b-76a9-4b16-9ee5-1bca8257e6de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nc", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomDirection", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"CircularRealMatrixDistribution", "[", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "-", "1"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"cab5ffe4-a284-4099-863f-4fec92fd090c"],

Cell["\<\
For a single generator of the group, we can calculate explicitly. We get the \
same thing for all matrix norms.\
\>", "Text",ExpressionUUID->"54e08293-9c1e-4ef1-82cc-6f311b2b0c77"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shift", "=", 
       RowBox[{"x", " ", 
        RowBox[{
         RowBox[{"suGenerators", "[", "nc", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
        RowBox[{"I", " ", "shift"}], "-", 
        RowBox[{
         RowBox[{"shift", ".", "shift"}], "/", 
         RowBox[{"2", "!"}]}], "-", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"I", " ", "shift"}], "]"}]}], ",", "2"}], "]"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Conjugate", "[", "x", "]"}], "\[Rule]", 
    "x"}]}]}]], \
"Input",ExpressionUUID->"0cc2495e-8286-4dea-8bc8-47a05960d15d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  SqrtBox[
   RowBox[{"128", "+", 
    SuperscriptBox["x", "4"], "-", 
    RowBox[{"128", " ", 
     RowBox[{"Cos", "[", 
      FractionBox["x", "2"], "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      FractionBox["x", "2"], "]"}]}], "-", 
    RowBox[{"64", " ", "x", " ", 
     RowBox[{"Sin", "[", 
      FractionBox["x", "2"], 
      "]"}]}]}]]}]], \
"Output",ExpressionUUID->"47d97b29-ecdf-4122-a0d3-0fa9a302a7e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "xx_", "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Cos", "[", "yy", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"yy", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
         
         RowBox[{"yy", "\[Rule]", "xx"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "xx_", "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Sin", "[", "yy", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"yy", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
         
         RowBox[{"yy", "\[Rule]", "xx"}]}], ")"}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"Abs", "[", "x", "]"}], "\[Rule]", 
   "x"}]}]], "Input",ExpressionUUID->"6cd07246-c803-4be9-a726-978599e0a142"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   SuperscriptBox["x", "4"]], 
  RowBox[{"8", " ", 
   SqrtBox[
    "3"]}]]], \
"Output",ExpressionUUID->"aae1de2e-cb63-4219-b375-73ce713f4767"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "4"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"50776728-51a3-41da-bff7-dbe90f754129"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    SqrtBox[
     SuperscriptBox["x", "6"]], "48"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "2"],
    SeriesData[$CellContext`x, 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {
   Rational[1, 48] ($CellContext`x^6)^Rational[1, 2]}, 0, 2, 1],
  Editable->
   False]], "Output",ExpressionUUID->"91d2da21-8c59-48d0-9b9f-7469b072f54f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "/", 
  "48."}]], "Input",ExpressionUUID->"bd741b8a-d16e-4c76-aa5d-07ab81e8910d"],

Cell[BoxData["0.020833333333333332`"], \
"Output",ExpressionUUID->"88ff2c9f-a981-4482-902c-f84f032c4457"]
}, Open  ]],

Cell["\<\
For (SU(2), Norm[shift]^3/48 is an exact solution.  We see that, for SU(3) \
and SU(4), there is a narrow distribution peaked near 1/48.  For SU(5) and \
above, the peak moves downward.\
\>", "Text",ExpressionUUID->"4313215d-e17f-42c0-b295-a4964cf25227"],

Cell[BoxData[
 RowBox[{"hh1", "=", 
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"hdata", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rd", "=", 
            RowBox[{"randomDirection", "[", "]"}]}], ",", 
           RowBox[{"x", "=", "0.01"}]}], "}"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"shift", "=", 
             RowBox[{"x", " ", 
              RowBox[{"rd", ".", 
               RowBox[{"suGenerators", "[", "nc", "]"}]}]}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
               RowBox[{"I", " ", "shift"}], "-", 
               RowBox[{
                RowBox[{"shift", ".", "shift"}], "/", 
                RowBox[{"2", "!"}]}], "-", 
               RowBox[{"MatrixExp", "[", 
                RowBox[{"I", " ", "shift"}], "]"}]}], ",", "2"}], "]"}], "/", 
            
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"x", " ", "rd"}], ",", "2"}], "]"}], "^", "3"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", "10000", "}"}]}], "]"}]}], ",", "30", ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"9d1edcc2-6197-4992-9ce6-0ea222664d79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", "hdata", 
  "]"}]], "Input",ExpressionUUID->"ef1bc6cb-849c-4533-9bfb-ccd9f64a837d"],

Cell[BoxData["0.020833323594354396`"], \
"Output",ExpressionUUID->"d8014790-be7d-4da3-97f0-ce1aae875e19"]
}, Open  ]],

Cell["Mean of the distribution for various 1/nc:", \
"Text",ExpressionUUID->"891d4f13-ef53-401f-b90c-6ea78274bbab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "20"}], ",", "0.003987207811923104`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "16"}], ",", "0.005309460586922509`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "12"}], ",", "0.007542180302737262`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "8"}], ",", "0.01195670498036167`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "6"}], ",", "0.01602903272904034`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "4"}], ",", "0.022300330376689107`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", "0.02572546202970247`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "48"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"53bef80c-9f97-4ec5-b1b9-939ece8875c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ffcd", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{"cd", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}], ",", 
      RowBox[{"x", "^", "3"}]}], "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"31815b19-b53e-40a4-a42f-6241f30d7abb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.08634097400326857`", " ", "x"}], "+", 
  RowBox[{"0.10693822305642084`", " ", 
   SuperscriptBox["x", "2"]}], "-", 
  RowBox[{"0.39313154558847596`", " ", 
   SuperscriptBox["x", 
    "3"]}]}]], "Output",ExpressionUUID->"923fc552-2b86-4790-a962-645de9c7e267"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", "ffcd"}], "]"}], "/.", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{
   "1", "/", 
    "3"}]}]}]], \
"Input",ExpressionUUID->"2aaace19-6f5b-4ac9-b70c-34eeb8363fa2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.028780324667756187`", ",", "0.01188202478404676`", ",", 
   RowBox[{"-", "0.014560427614387998`"}]}], 
  "}"}]], "Output",ExpressionUUID->"8895eba2-554a-4c66-ba45-cfa339bbe7f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"cd", ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.55"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
     
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<1/Nc\>\"", ",", "\"\<Mean coefficient of cubic in shift\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{"ffcd", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", ".55"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"37f4024b-3fa9-43d2-91fc-2faf596a7b8c"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{0.05, 0.003987207811923104}, {0.0625, 
       0.005309460586922509}, {0.08333333333333333, 0.007542180302737262}, {
       0.125, 0.01195670498036167}, {0.16666666666666666`, 
       0.01602903272904034}, {0.25, 0.022300330376689107`}, {
       0.3333333333333333, 0.02572546202970247}, {0.5, 
       0.020833333333333332`}}]}, {}}, {}, {}, {}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJwV13k4Vd0XB3BpIDMpKUKkDJVKpvBtMGQOoVSSKY0qQyKkiZL5cg9FlFJe
UuoV0q/SG5KoXO65A7mSkCilAfHb/jrP5zn7OXuftfdZax01nyAXf2EhISGp
aUJCU9er12JOVS3YbG4cx86Z6FQwd/mgVB+qpAmfxtEr1j0j5q5dhWmWSgbo
/Cl/4H33TLTs+XJ8uZIVdi+xLHLvmot0tZT9akruUAtSHw1sX4LgWIHvQqUA
iP7JPX21ZS18V130nq8UhlnxI3Fzn1pix4WOjnlK53HF953ErCw3RM595blY
jInU+q3PtmgFoKQsQiJEOR+Lvq5wNzM+gttPrvY8zroJCecZAUuUQ/FwfMl7
ycRiDNU6i/2DCBRWX8jzlLyH3ifq268JojEmd8/7nvQDUC8YzXrtsWjd4Z07
Nv0htExHRqqWnkWIxfOUoy8qISlZ7lJtcB5KL9zT9tdUQ12uYPnGnfGI/5iz
OfnSExw+PqhZtPkizE4a/M9V4xkOnkgKlpt/CY+cy3er5dUgolvksvmfRCz8
lcw7K/wf2kwaXD7fSEZM77T3t0+/wIxd1V+N76ZAs8Uwv36sFh90t/kjOhV3
E+vMonbUo8xVqNBHPw3mjKE93+mX6GDIvp45lIY7+496T5q+gvKgs8dYWjrU
ExN6Gv/XiPXSzbERxgzwbu3TYRg3YaCqIejGWwZCGfm237Kb0e/7bvS0WwbE
eip+iyS+wc6imx4nOBl41edg3IW3YKnMcNxmm4nl/RbbjYfeYvkZrpBTaSbS
ZETNjpa8Q1iTosZfWSZ6F/2W/OHVAu29mou7fZlY7/rgmocKC50zG+4l3mNi
RuNZDbvFLDRyewoKy5iot3C7ab6Ehc3Fgo9P7zOxxeDn7SU6LIxZHHX+9i8T
uxWN7n03YMHE4XeTTRUT0e8fPUl2ZEG38oYvp4aJxwee8+uiWOBNRH0/1sKE
ydl384z4LLht0ChJHmYi967Hf787WLBw3qBx6DsTwu38o5UCFj4KBwjZ/mDi
5dpPjSafWFhjV/tp2k8mtn0aO202zIL4ka5j+/8wEWq7ZGijaCsKxS5ELBKi
cFcmvM5BvxVZZ5Kd5CQpLMlRDve91ArPs7EyWksoqI7eu7U7uRW5cZ16Q8RK
HlacHWmtKPaYzH6gSUFeNshkK9UKNa+T9mbLKAifezpuUdCKkBkhGlY6FDoP
+sZqVreivnz7rbWrKFwxvX2x73Mr5pVNTCaYUqCyzB59HGzFcUePbevMKDB+
vv0s+NaK/IdBo33ECXdH7bm/WuHw9f1CS1CI0LCXfjW9DfJjj1uGN1DwkBhK
L17YBruwIwq61hTk+Po5QXZt2D29dHCuM4U7A1F/jBzbsPfYe68CYpu/tW7C
zm1YRENvtQuFU4u2S2W4t+F6XMpPO1cKg95RMVV72vA37KhsuBuFho8v9swM
b8PXzFWnyrZTiB1y17xc0IZOXtGGu3tIPITyTvsVtkFOjcvW9qFQIdPXsbyo
DSM7jZsLiAdXRTKflrbhXUWcINOXws6Qq6I9VW3gCvkxgv0pGP351K/3tg06
7xaskd5H4avwidLav21oOxG7tTmIQvRlTMYKsaHXvUlC/wgFCf1ZTmbT2RDj
7dWhiJf5pw/eF2Vj9WHWVa+jFLzrSpbnz2EjUHv9nu5jFN4kdP0TqcXGjtE9
Vi2hFLw0bo8Z6LKRrGsWsiKMwkB1kN3wCjbw+cTsC8Sig+P9gfpszJeav9/0
OIX1WxS03cFGUV/P9Cvh5LzI29/Sc2Nj5++mLPNICuYlcr8/e7DhP1xjlkLc
aMmxLvRkYyB8vo2AuDcs4JOyNxuhOr0ZsSfJeeKc0hQ/wMY+zQWij6IopOT8
W/DxFBus4HpH2VMUjmiq5GcXs1F/0NHf7iyFzKEfwamlbFSc8tuQTFxd0WAV
X8bGbte6fe+IRe3CBkIr2GjWD77qfo5CXtBrQ+f/2Fjf65vrfp68f0Vkkwif
jJe93a8fT+FnrHP+RAcblTIJCYeIleyWhowIyHxNleE3iAPb3yl++MSGRNxf
wzkXKAgJa/v/7zsb6r3Ktj3Eq+zosRBxGgkHa6r3J1DYJn+n6YAUDQePI4sp
4uj2M/k+sjTqhQ6w/iNuCFppvUWBRnuylbLSJQo+jPNpOuo0snIzN9YQx+/a
6b9Yk4ZsTJFYP/EdzdVGilo0zBaJq8gmUhitaG+ftZLGY6pMdxdxWru+VpcJ
DfvobN4AccVNsXHajEbYVvlZ0kkUOoI6m5rX09jexz2pR6wtfCnksRWNTU6O
TkeJazQ/PKFcaFwXb4rrJ+4dqkhLdqNxll0iL5JMQaoyyf/8NhpKPtwvi4k9
7UzEQ7xoHLqveG4b8XBQqrvTfhp5VqusHxFXDCx0m3OIxmqFxrI3xNH7brqy
g2ior/sd+5F4tu+jLbtDaayMmmEnmUKh6b2lk3o4DcvL3RaqxIydbxw+RdB4
IuF+bTWxqvtH26BTNFr7BuLciHveBdmsOUPjqJucTABxsdOo9a9zxPIvx0KJ
jWykLWMSaDAu9f9NJ554kbVpUxKNCks3+WvE/23U2CiSSsPUxTmplNjJ1BjJ
mTQO+/8trieWr3xu5ppFQ+FgiTOLmLvW0VThCll/7eD298R5ZbQJL5dGcvCz
F33EASt9ja/m0/AKWZLxnVi3+IuhbwGNlPoF9ePEw8vCDZYW0lA9ku81M5XE
Y3HimtJiGoGVPuXyxBZXFVYHl5L7O3KOLyQWU7qmZ1hGw3jLvitqxG8o3ZVj
D2iUUbUaS4kz5j5c/uQhjST9f2V0iT3TNuieqaLRoL7WW49YVbpR2/oxjX0B
VnP0iXsS3LXEn9LYO96rZUhcLCpY2lxDxn9UKjAmPnbugGb6C/K8xV2x64iN
hH9qeNST+cqMnpsST0SfUl/4iqwnUzXQjPj5mNji96/Jel9nHZlyfHiG6vU3
ZD6PAv7UeMcRFZW9LTTmrl1fPPU8+WNFyjptNNQCDr2fmo87qK80RJP49OuE
Ta0n78CTBfd5JH41kUem1hvQa6N4vIPc/7Kzaep9dP1ZCusEJP4Hm5On3veb
wGve5AeyP+YtD6biUe7VJ/+8h+yfb6DZYuKTvOA5cX00NPhJWkrEG7dNyNoN
0DC/ZXViLrFoa7yM9BCNyrpkXSniJuc50i3faGSY7N80i5jRlCPJ/EGDJdT2
+G/K1HlfJrHjFzlfC1ou/yBWqS8TUxmlERy3p72fuNvCbPaHcTLeOvZ0J3HR
szqRwkka2TtWJ7QSGzziz1g5kwOrqM11j4nHDfdO/y7CwcqEktG7xDUPvk17
KMZB+MD11OvEjndmTZrLcLDmtkX/eWL/fL0/jgs5MBJ3t7KaGu/YEOG4iAP6
aJzcmqnvY9x33EGNg6jXXZoqxHx35qT9Ug54vgrLRsj3tlViYqbdGg4+SIRf
oojLKplxtgYclC/8kxVDLLN31WxbYw6SVQqG/IlfPfOTsAEHrrPCg/WINx5/
JWdtx8GyLQrt1SQ/5Gn4M6wcOVgh0quTSzzxdmKulTMHJve7aqKJq3RXK1p6
cODf7/bSjHhVF6WyyZcDkdY1RvdJflJ1CNBFJAcxl1/nRJL8Fj06WWIezUH/
NbMgZ2J+YdZK81gOdl1lx2sSM4VfrzaL48Dl+AVGE8mfUhVrjNelc5B0vVty
HvHfxdOsDP/hwPBLePxpko8932TXGdzhYLZlPN+euCJK38bgHgeC1Gfh84hD
6L32ax9ycFOs7EIhye8DiU0ua55zEBF+UfJZHDmfvy/vXsnjYKulYs5bUj/o
7f0S4+0czJ1u0MAgbq0yqqrv5MC5WcTDg/jNyVZ5nx4ONqQ3JHNJ/akTkm5g
fOPgZ31jFOcMhQeip/VHRbh4/Pm5XWUsif++N4JaMS6sUleFHCMubViUnC7J
hYPl1nFt4qJLj/p053DRTFfoZJP6lyczkrt7ERf/lEzMOhpDIXF+4OwX+lzU
SEWVCpF6efFEeXmqIRfzrqxrKSX1NJ47w8/LhItuw1J3L+KzV/L/9wtcjGX/
e7KS1N8IVV6wth0XE1KwDIwg39syx47kPVx437GoL5yq70b69z2TuLjcsCDz
Dukf9NSEtiqmcrE9x7PYjlhVrPEHO52Ljefjl/WSfkOI72vglsUFI/uOiwrx
s5j0SqcCLkxeqx8+f5icn7rhJxZVXOR5lj0zPEDynfu9xhU9XJTP9eZp+lHQ
R9ShL71csEp8Su+SfkhjmY1U8WcuFu107TMmnjHa6aT1jYu1YxNJtqR/epEj
06I+zkXApph8P28KVh+DOPPleOCNqX+I3Elhc8iKHmFzHqQkJ2iDrWR/EmeL
/V3Pw46r9U/yST+3rbB7+a9NPGR8tf8mThzIzQ79bMMDp/m0fgfpBy+sF5nJ
cuMhN/b6uggnUq8lOtVvHOJBsazCPsWWgsON1D3WOWQ+q9UR+uspuLT94CeM
85AIH+FdWiS+18/quk7y0OtwmVFI+t9rR+RPLhDmY//VL/HflpJ6IKa/8LYI
H5/EO5hnSL+chuDttXJ81IsNOuapU3h761urkBYfynkNatXKFLZEDjaFuvGh
qhXmGSVL5lftfbr7Dh/RDzIVNH8xIbEoLt3nHh/yFKPEgPT3jQs1A/wf8DGD
rXHRaoQJewU/8QNVfAwGjM/zI/8H9lKdbmG1fAw0xcVkDhGPs/svdfCR9ET6
Ev2JmK6Tr5JqxzH17rS3bCZsUwoD5YPaUTWS68Ek/yt94/VDlrodGEjeb/pj
HxMnnBX8avgdYExeuOaqyIR446orKlfeIy1/XOJzeSasmdWdvks7kWfYnVe1
JRMcK1nfn9GdoH3fagm6MnBotr31n/ZO7MzJ+dvhnYE/UL6WbyDAAuZLyq+d
gZvzPsQuNxLgzvjxddN5DLh8ubWn0lgA0WNnF+TTDBRl66u9NRVA6dLDRG4L
A54jdnlCmwS4G3V+s0UDA1VFEbm7nQQId6+T/l7OQMRcOls5UIDyDlb342QG
NAdyIm7vE8DHzHKORSID72p8PdceEID/z5zolxcZ0D4ypOhwWADNigbRd+cY
4DbMyjoZQpyUP8yJZMDk1Fom75QATSuHFV7sZaDHfSxs72kBZiVskoA/A2nL
n7l/PyOA1M9h0wofBvq59vPE4wQIGTvgemsXA9lr/TJMEgUoel67NcaVASsJ
7dDaJAFW5Ijqft/CwHDX0FaXFLL+87cQ4Mgg+xEpvz9dgIPxwkq2Ngz8DNjw
Y4QhgHx+dXeVFQPXzERYsZkCnH7J6tO2YMBR/vV9SUqA6ml2OtkbGBjtT0vP
yiK2UbktCgb+D+/yMY4=
        "]]},
      Annotation[#, "Charting`Private`Tag$7383#1"]& ]}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Mean coefficient of cubic in shift\"", TraditionalForm], 
     None}, {
     FormBox["\"1/Nc\"", TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.55}, {0, 0.02572546202970247}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{
   Automatic, 
    Automatic}]], \
"Output",ExpressionUUID->"71832933-11e7-4561-a5cc-8fc53bffcc29"]
}, Open  ]],

Cell["\<\
Plot error as a function of shift in some random shift direction\
\>", "Text",ExpressionUUID->"a9841638-1cc0-4c9d-837f-80708cb033f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxData", "=", 
   RowBox[{"2", "Pi"}]}], ";", 
  RowBox[{"data", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rd", "=", 
       RowBox[{"randomDirection", "[", "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"shift", "=", 
            RowBox[{"x", " ", 
             RowBox[{"If", "[", 
              RowBox[{"False", ",", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{
                  RowBox[{"nc", "^", "2"}], "-", "1"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rd"}], "]"}]}]}], ",", 
           "sg"}], "}"}], ",", 
         RowBox[{
          RowBox[{"sg", "=", 
           RowBox[{"shift", ".", 
            RowBox[{"suGenerators", "[", "nc", "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"shift", ",", "2"}], "]"}], ",", 
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "nc", "]"}], "+", 
               RowBox[{"I", " ", "sg"}], "-", 
               RowBox[{
                RowBox[{"sg", ".", "sg"}], "/", 
                RowBox[{"2", "!"}]}], "-", 
               RowBox[{"MatrixExp", "[", 
                RowBox[{"I", " ", "sg"}], "]"}]}], ",", "2"}], "]"}]}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "maxData", ",", " ", 
         RowBox[{"maxData", "/", "20"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"3358cdbf-4cb3-41c7-94c6-efb75b622f72"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{"data", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "^", "3"}], ",", 
      RowBox[{"x", "^", "4"}], ",", 
      RowBox[{"x", "^", "5"}]}], "}"}], ",", "x"}], 
   "]"}]}]], "Input",ExpressionUUID->"9c910dbe-cd14-4560-90d3-2c60c6db4cf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.02670146319345156`", " ", 
   SuperscriptBox["x", "3"]}], "-", 
  RowBox[{"0.00032340571702165583`", " ", 
   SuperscriptBox["x", "4"]}], "-", 
  RowBox[{"0.00008985401327101418`", " ", 
   SuperscriptBox["x", 
    "5"]}]}]], "Output",ExpressionUUID->"23155eeb-06c6-45ef-abda-fd2e208ab946"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", "ff"}], "]"}], "/.", 
  RowBox[{
  "x", "\[Rule]", 
   "maxData"}]}]], \
"Input",ExpressionUUID->"03b5c051-ac29-4815-80fb-e7a067dd7220"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.623303644360007`", ",", 
   RowBox[{"-", "0.5040425108844688`"}], ",", 
   RowBox[{"-", "0.8799070981724241`"}]}], 
  "}"}]], "Output",ExpressionUUID->"7649fe68-0946-4d3c-a665-72a3efb1dc8c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", "data", "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff", ",", 
       RowBox[{
        RowBox[{"x", "^", "3"}], "/", "48"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "maxData"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"4b8f05ff-2539-4241-a91e-bd960a53670a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Identity staple example, SU(3)", \
"Section",ExpressionUUID->"8f8d2d8e-b492-48b0-805d-82e8841dd8d0"],

Cell["\<\
Special case where the sum of staples is proportional to the identity matrix.\
\
\>", "Text",ExpressionUUID->"28d2b89d-a643-4759-87d0-909427ce7344"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diagValue", "=", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], "+", 
   RowBox[{"Cos", "[", "x2", "]"}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"-", "x1"}], "-", "x2"}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"0e9686d1-84ff-4098-858f-2537d91bf07c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", "x1", "]"}], "+", 
  RowBox[{"Cos", "[", "x2", "]"}], "+", 
  RowBox[{"Cos", "[", 
   RowBox[{"x1", "+", "x2"}], 
   "]"}]}]], "Output",ExpressionUUID->"da2dffed-da79-4641-afb5-19b77b861a07"]
}, Open  ]],

Cell["Saddle Points", \
"Text",ExpressionUUID->"6a7026be-e39f-4078-b776-62a0cfb31cf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x1"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"diagValue", ",", "x2"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"6aef7fbc-166e-41a0-9cec-b12e6d47d511"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "3"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "3"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "3"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "3"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "2", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"ec0ddc4a-4ddb-4ef4-8726-5700b0ef47d9"]
}, Open  ]],

Cell["Hessian", "Text",ExpressionUUID->"57b5fe8f-a9cc-4940-a0c1-899f3f89a168"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hess", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"diagValue", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"6a5db463-290f-4dc0-9eef-53f5c7cd62a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "x1", "]"}]}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "x2", "]"}]}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "+", "x2"}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"cc6b19c5-6ba8-425e-b35e-35aaea7d9696"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dh", "=", 
  RowBox[{
  "Det", "[", "hess", 
   "]"}]}]], "Input",ExpressionUUID->"b36fdec5-b58e-46cc-b7f5-fa8d24318e5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], " ", 
   RowBox[{"Cos", "[", "x2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "x1", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x1", "+", "x2"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "x2", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x1", "+", "x2"}], 
    "]"}]}]}]], \
"Output",ExpressionUUID->"c24d9b87-c779-4d5f-a4e2-c0e2a1c4b6ec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"Pi", " ", 
      RowBox[{"4", "/", "3"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot3D", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", " ", "limit"}], ",", " ", "limit"}], "}"}], ",", 
       RowBox[{"RegionFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2"}], "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x3", "=", 
              RowBox[{
               RowBox[{"-", "x1"}], "-", "x2"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x2"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x1", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", "Pi"}]}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x2", "-", "x3"}], "]"}], "<", 
              RowBox[{"2", " ", "Pi"}]}]}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
     
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2", ",", "diagValue"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
       "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"2de64670-829e-4921-8a2c-468d0e0b6cea"],

Cell[CellGroupData[{

Cell["Test saddle point routine", \
"Subsection",ExpressionUUID->"c708c257-8f21-4f83-9645-19f4be4c3713"],

Cell["Run this as a group", \
"Text",ExpressionUUID->"2524376c-66ab-4e92-bcac-a1757dc76aaf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sqrtU1", "=", 
   RowBox[{"SUPower", "[", 
    RowBox[{
     RowBox[{"u1", "=", 
      RowBox[{"randomSUMatrix", "[", "3", "]"}]}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"phi1", "=", 
  RowBox[{
  "centerPhases", "[", "u1", 
   "]"}]}]}], "Input",ExpressionUUID->"a20f91db-d8c3-4ce1-b377-8e55df211da4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.06974390073237449`", ",", "2.728340774947629`", ",", 
   RowBox[{"-", "2.7980846756800033`"}]}], 
  "}"}]], "Output",ExpressionUUID->"e45e6140-00ae-4ae9-81c7-9977adcd9acf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sqrtU2", ",", "maxShift"}], "}"}], "=", 
   RowBox[{"linkSaddlePointStep", "[", 
    RowBox[{"sqrtU1", ",", "sqrtU1"}], "]"}]}], ";", 
  "maxShift"}]], \
"Input",ExpressionUUID->"9636bb9c-bb6c-453a-abd0-06c6a79bc505"],

Cell[BoxData["0.0011188031184552747`"], \
"Output",ExpressionUUID->"00529e3d-d3d2-496a-9171-114425db72c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi2", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"sqrtU2", ".", "sqrtU1"}], 
   "]"}]}]], "Input",ExpressionUUID->"f87007aa-68f4-4c9b-9e2b-2288cd031858"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.035517783849593663`", ",", "1.3638372512287065`", ",", 
   RowBox[{"-", "1.3993550350783002`"}]}], 
  "}"}]], "Output",ExpressionUUID->"2866062d-90a9-4d6e-ba47-85ce7f96703a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"limit", "=", 
     RowBox[{"3", 
      RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"DensityPlot", "[", 
      RowBox[{"diagValue", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"phi1", ",", "2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{"phi2", ",", "2"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", "y2"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y1", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y2", ",", 
              RowBox[{"-", "Pi"}], ",", "Pi", ",", "Pi"}], "}"}]}], "]"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"DensityPlot", "[", 
      RowBox[{"dh", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", 
         RowBox[{"-", "limit"}], ",", "limit"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}]}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ff5c7a42-33f1-42a5-9a90-835037adbb53"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Input gauge configurations", \
"Section",ExpressionUUID->"86bfae6c-4d6d-4a25-b7b0-864c8f4e6d20"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"2e729cea-afdc-4de4-a9d0-e45f71386f6b"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"9e9f081b-abbd-4cff-9d20-c688455c675e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-8-9-3.m\>\""}]], \
"Input",ExpressionUUID->"7587afb3-761a-413d-8e5e-579daa0d3740"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-12-11-3.m\>\""}]], \
"Input",ExpressionUUID->"3e61768b-0f4f-464b-8449-8fad3e6c7798"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-16-15-3.m\>\""}]], \
"Input",ExpressionUUID->"e986ad07-c948-4c03-8cda-e575a71c2b40"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-16-28-5.m\>\""}]], \
"Input",ExpressionUUID->"5c9001a9-2e55-4c31-864a-6c52d057395d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-16-31-4.m\>\""}]], \
"Input",ExpressionUUID->"ed100dac-92d1-424c-a101-6924d283c5db"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-1.m\>\""}]], \
"Input",ExpressionUUID->"53db7ba8-c629-4d00-bb4a-7a9f18d8901c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/periodic-22-42-1-cool.m\>\""}], 
  ";"}]], "Input",ExpressionUUID->"88d740d1-0a07-419a-a8d4-ef7fbfaf5fd8"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-5.m\>\""}]], \
"Input",ExpressionUUID->"dcc2d627-4ef7-4a60-8951-5b495967f3c9"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-80-5.m\>\""}]], \
"Input",ExpressionUUID->"60d71144-9c29-458f-8c63-11f9a13446f3"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-28-1.m\>\""}]], \
"Input",ExpressionUUID->"f3047582-2299-4c99-96b3-92a00ca8e127"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-16-33-4.m\>\""}]], \
"Input",ExpressionUUID->"35588511-034f-4f59-b7b1-a1cbbf30db9e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/periodic-20-150-5.m\>\""}]], \
"Input",ExpressionUUID->"ca7283e7-df2f-49ce-ad42-0a6fc8bf4636"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/winding-20-80-0-5.m\>\""}]], \
"Input",ExpressionUUID->"f09dcb5b-d116-4917-aff2-0184028aff50"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/winding-20-80-1-5.m\>\""}]], \
"Input",ExpressionUUID->"b86f3c7d-603b-4ba0-b40c-c9038a7046a6"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/winding-20-60-0-4.m\>\""}]], \
"Input",ExpressionUUID->"8267aa6e-e250-4049-b04f-87653efe314d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-4/winding-20-60-1-4.m\>\""}]], \
"Input",ExpressionUUID->"8f77c9e2-3f22-464d-b28f-251096700d6d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-6/periodic-18-90-1.m\>\""}]], \
"Input",ExpressionUUID->"f5cec4a6-0c14-48b6-a315-a3e91cb85b6e"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-6/periodic-18-170-1.m\>\""}]], \
"Input",ExpressionUUID->"12395adf-36e9-42f0-8751-29da7027243f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"nd", ",", "nc", ",", "beta", ",", "latticeDimensions", ",", 
   RowBox[{"Dimensions", "[", "gaugeField", "]"}]}], 
  "}"}]], "Input",ExpressionUUID->"f90fbc19-e691-424e-a185-652c594a8b4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3", ",", "8.175000190734863`", ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "216", ",", "3", ",", "3"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"5b2f7fdd-4ba3-4afd-bb9d-a1e8e2817e8a"]
}, Open  ]],

Cell["Test that links are approximately SU (N)", \
"Text",ExpressionUUID->"f722cea1-30c4-4900-af00-df89fbcc4a0b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"badMatrices", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"gaugeField", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"SUMatrixQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"1.0", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "10"}]}]}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b997761f-f834-41b4-862e-6474cf8fce81"],

Cell[BoxData["0"], \
"Output",ExpressionUUID->"aa2b8576-80a9-4f99-98fc-fa836f6b670e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plaquette distribution", \
"Section",ExpressionUUID->"ad50c69b-52fa-49f1-b2f9-aa294300b000"],

Cell["\<\
The plaquette values, if rescaled to the [0,1] interval, generally fit a Beta \
distribution, but we can equivalently use a Gamma distribution for small \
lattice spacings.\
\>", "Text",ExpressionUUID->"054aa60d-5f2e-438f-a8bb-ab5bc7ba93ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"useGammaDistribution", "=", "True"}], 
  ";"}]], "Input",ExpressionUUID->"eed81ada-37f9-434b-b9a6-dc26045be2e0"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"plaquette", "[", 
             RowBox[{"dir1", ",", "dir2", ",", 
              RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "]"}], "/", 
            "nc"}]}], ")"}], "/", 
         RowBox[{"If", "[", 
          RowBox[{"useGammaDistribution", ",", "1", ",", "2"}], "]"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"dir1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"dir2", ",", 
        RowBox[{"dir1", "+", "1"}], ",", "nd"}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b4aa5855-d2b2-4cdf-9d39-80174424a9e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "data", "]"}], ",", 
   RowBox[{"dist", "=", 
    RowBox[{"FindDistribution", "[", 
     RowBox[{"data", ",", 
      RowBox[{"TargetFunctions", "\[Rule]", 
       RowBox[{"Which", "[", 
        RowBox[{"useGammaDistribution", ",", 
         RowBox[{"{", "GammaDistribution", "}"}], ",", "True", ",", 
         RowBox[{"{", "BetaDistribution", "}"}], ",", "True", ",", "All"}], 
        "]"}]}]}], "]"}]}]}], 
  "}"}]], "Input",ExpressionUUID->"80a41af7-56c8-4cde-87d9-3025ff76706a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0650492058072443`", ",", 
   RowBox[{"GammaDistribution", "[", 
    RowBox[{"4.0372454262987585`", ",", "0.016112274320493006`"}], "]"}]}], 
  "}"}]], "Output",ExpressionUUID->"8057795b-aef6-4977-875b-8618be413fc6"]
}, Open  ]],

Cell["Distribution for 1 - Tr(plaquette)/nc", \
"Text",ExpressionUUID->"5027c05e-179e-4daf-82a1-11b8eea98e34"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"dm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<nd\>\"", ",", "\"\<nc\>\"", ",", "\"\<beta\>\"", ",", 
       "\"\<mean\>\"", ",", "\"\<alpha\>\"", ",", "\"\<beta\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "42.", ",", "0.0650492058072443`", ",", 
       "4.0372454261752875`", ",", "0.016112274320900954`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "80.", ",", "0.03371067322265413`", ",", 
       "4.011655372432331`", ",", "0.008403182749520672`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "28.", ",", "0.1923250246554901`", ",", 
       "7.7282971359028245`", ",", "0.02488582171194133`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "33.", ",", "0.1604205616819077`", ",", 
       "7.670953223240458`", ",", "0.02091272844591148`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "150.", ",", "0.03380841583718067`", ",", 
       "7.620434296041462`", ",", "0.004436547121053944`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "6", ",", "90.", ",", "0.13525994258717414`", ",", 
       "18.387360829900825`", ",", "0.007356136850654697`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "6", ",", "170.", ",", "0.07017369456939337`", ",", 
       "18.102497926494276`", ",", "0.0038764647207436133`"}], "}"}]}], 
    "}"}]}], "]"}]], \
"Input",ExpressionUUID->"2c71e24c-1758-4d56-9b36-3a519ff2564c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"nd\"\>", "\<\"nc\"\>", "\<\"beta\"\>", "\<\"mean\"\>", "\<\"alpha\"\
\>", "\<\"beta\"\>"},
    {"3", "3", "42.`", "0.0650492058072443`", "4.0372454261752875`", 
     "0.016112274320900954`"},
    {"3", "3", "80.`", "0.03371067322265413`", "4.011655372432331`", 
     "0.008403182749520672`"},
    {"3", "4", "28.`", "0.1923250246554901`", "7.7282971359028245`", 
     "0.02488582171194133`"},
    {"3", "4", "33.`", "0.1604205616819077`", "7.670953223240458`", 
     "0.02091272844591148`"},
    {"3", "4", "150.`", "0.03380841583718067`", "7.620434296041462`", 
     "0.004436547121053944`"},
    {"3", "6", "90.`", "0.13525994258717414`", "18.387360829900825`", 
     "0.007356136850654697`"},
    {"3", "6", "170.`", "0.07017369456939337`", "18.102497926494276`", 
     "0.0038764647207436133`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"0f78403b-b7d3-413b-a874-e2bfb268bd39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fit", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"a4fba744-c5aa-4242-9186-c7e12b7c32ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.9570128098970327`"}], "+", 
  RowBox[{"2.1922544672143394`", " ", "x"}], "-", 
  RowBox[{
  "0.01302459307696784`", " ", 
   "y"}]}]], "Output",ExpressionUUID->"d674eced-fe0e-41f5-a447-7253d1ad75a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaf", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "/", "y"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"d9f862ab-59ea-445a-84c5-13a6cd93b8a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "0.38372636384000197`"}], " ", "x"}], "+", 
  RowBox[{"0.5678259467308348`", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  FractionBox[
   RowBox[{"0.33676599859447814`", " ", 
    SuperscriptBox["x", "2"]}], 
   "y"]}]], "Output",ExpressionUUID->"446754b9-80fc-4618-9918-1a03895cdf3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fit", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "6"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"b5fb148f-099f-478f-bd4e-150218d52e40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.2764959070649417`"}], "-", 
  RowBox[{"0.003449168587259936`", " ", "x"}], "-", 
  RowBox[{
  "1.0265824185785946`", " ", 
   "y"}]}]], "Output",ExpressionUUID->"a2dba603-8cd9-418f-9318-cf4a63341420"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"betaf", "=", 
  RowBox[{"Fit", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "6"}], "}"}], "]"}], "]"}], "&"}], ",", 
      
      RowBox[{"Rest", "[", "dm", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "y"}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"x", " ", "y"}], ")"}]}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"y", "^", "2"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"d6598be3-4d8f-46ab-98a7-3bb7a785b1f1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1.271846550539407`", 
   SuperscriptBox["y", "2"]], "+", 
  FractionBox["0.655794521122695`", "y"], "-", 
  FractionBox["0.01909058801264915`", 
   RowBox[{
   "x", " ", 
    "y"}]]}]], "Output",ExpressionUUID->"1cca3f50-cf9c-4325-a178-f67f8b2a1f30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"alphaf", " ", "betaf"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "Infinity", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "Infinity", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"3512c207-94b1-4353-9383-7b66e725d596"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    InterpretationBox[
     RowBox[{
      RowBox[{"0.3723771448173887`", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"0.26248577822853797`", " ", "x"}], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", 
         FractionBox["1", "x"], "]"}], "0"],
       SeriesData[$CellContext`x, 
        DirectedInfinity[1], {}, -2, 0, 1],
       Editable->False]}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {0.3723771448173887, -0.26248577822853797`}, -2, 0,
       1],
     Editable->False], "y"], "+", 
   FractionBox[
    InterpretationBox[
     RowBox[{
      RowBox[{"0.9430367684350571`", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"0.4944701131367715`", " ", "x"}], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", 
         FractionBox["1", "x"], "]"}], "0"],
       SeriesData[$CellContext`x, 
        DirectedInfinity[1], {}, -2, 0, 1],
       Editable->False]}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {0.9430367684350571, -0.4944701131367715}, -2, 0, 
      1],
     Editable->False], 
    SuperscriptBox["y", "2"]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "y"], "]"}], "3"],
    SeriesData[$CellContext`y, 
     DirectedInfinity[1], {}, 1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`y, 
   DirectedInfinity[1], {
    SeriesData[$CellContext`x, 
     DirectedInfinity[1], {0.3723771448173887, -0.26248577822853797`}, -2, 0, 
     1], 
    SeriesData[$CellContext`x, 
     DirectedInfinity[1], {0.9430367684350571, -0.4944701131367715}, -2, 0, 
     1]}, 1, 3, 1],
  Editable->
   False]], "Output",ExpressionUUID->"df688d8e-4a7c-45e1-aa64-aa0012b24890"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dist", "=", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"nc", "^", "2"}], "/", "2"}], ",", 
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"3", " ", "beta"}], ")"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"73f0688f-3bc6-4d5e-987a-d2ecfe0eba1a"],

Cell[BoxData[
 RowBox[{"GammaDistribution", "[", 
  RowBox[{
   FractionBox["9", "2"], ",", "0.015873015873015872`"}], 
  "]"}]], "Output",ExpressionUUID->"cf27ef7f-49a5-4e78-a723-270a46544975"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{"a1", ",", "b1"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4f9e72ca-8e2c-461f-a480-11be1383abb2"],

Cell[BoxData[
 RowBox[{"a1", " ", 
  "b1"}]], "Output",ExpressionUUID->"1ee43809-da81-4eaa-a595-729d9a6ed4df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "4"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], " ", "2", " ", "Pi"}],
          ")"}]}]}], "}"}], "&"}], ",", "dm"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4123b4ad-1aee-4ba2-af38-fbae132fc1fc"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"nc\"\>", "\<\"beta\"\>", "\<\"mean\"\>", 
     FractionBox[
      SuperscriptBox["\<\"nc\"\>", "2"], 
      RowBox[{"3", " ", "\<\"beta\"\>"}]], 
     FractionBox[
      SuperscriptBox["\<\"nc\"\>", "4"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\<\"beta\"\>", "2"], " ", "\[Pi]"}]]},
    {"3", "42.`", "0.0650492058072443`", "0.07142857142857142`", 
     "0.0073081351419747856`"},
    {"3", "80.`", "0.03371067322265413`", "0.0375`", "0.0020143047485068`"},
    {"4", "28.`", "0.1923250246554901`", "0.19047619047619047`", 
     "0.05196896100959848`"},
    {"4", "33.`", "0.1604205616819077`", "0.16161616161616163`", 
     "0.03741383418872838`"},
    {"4", "150.`", "0.03380841583718067`", "0.035555555555555556`", 
     "0.0018108295747344535`"},
    {"6", "90.`", "0.13525994258717414`", "0.13333333333333333`", 
     "0.025464790894703257`"},
    {"6", "170.`", "0.07017369456939337`", "0.07058823529411765`", 
     "0.0071371905275811895`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"8b3520c7-583e-4eed-afb3-6355e8dbf1da"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"width", "=", "0.0025"}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"data", ",", 
       RowBox[{"{", "width", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], " ", "width", " ", 
        RowBox[{
         RowBox[{"PDF", "[", "dist", "]"}], "[", "x", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"3", " ", 
          RowBox[{"Mean", "[", "data", "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"ddde5321-7bd9-49df-ae4a-3c5cddcb8338"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gauge Invariant Shifts", \
"Section",ExpressionUUID->"81386b1e-2c78-489b-af5a-f2aceecfa768"],

Cell["\<\
The gauge transforms should leave the action invariant.  Thus any small shift \
in the direction of a gauge transform should have zero gradient and zero \
second derivative.

Orthogonalizing the associated matrix creates a matrix that is roughly 50% \
dense.  This seems to be independent of the basis ordering.  For instance, \
going to checkerboard (linearSiteIndex[]) just changes the sparsity pattern. \
\
\>", "Text",ExpressionUUID->"7be3d2d0-2681-4d65-8319-b3a6d628e18f"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"08304c9f-fc06-44f7-8f6e-52e13e4e144a"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"25509c63-5aca-4a64-8df2-b3214f5a2980"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-22-42-1.m\>\""}]], \
"Input",ExpressionUUID->"aed7d32e-99c3-4103-b2ea-8835d046f9fd"],

Cell["Create trivial lattice with one non-trivial link.", \
"Text",ExpressionUUID->"2e3e6350-ee8a-4237-b197-11dd2f407ac2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"makeTrivialLattice", "[", 
      RowBox[{"randomGauge", "\[Rule]", "False"}], "]"}], ";", 
     RowBox[{"setLink", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"I", " ", "Pi", " ", 
         RowBox[{"RandomReal", "[", "]"}], " ", 
         RowBox[{
          RowBox[{"suGenerators", "[", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"gaugeField", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dir", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"IdentityMatrix", "[", "nc", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "nd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"linearSiteIndex", "[", 
         RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"39440a9d-8ba5-4dde-bd8a-99baa4176b07"],

Cell[BoxData["0.8642381170346707`"], \
"Output",ExpressionUUID->"e2e95621-1f25-4f30-afb4-90c00e3735ef"]
}, Open  ]],

Cell["Create random lattice :", \
"Text",ExpressionUUID->"2dc2c384-2848-43ef-8fb2-ee1a4dac66bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "2"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ";", 
  RowBox[{"gaugeField", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"randomSUMatrix", "[", "]"}], ",", 
     RowBox[{"{", "nd", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"latticeVolume", "[", "]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "linearSiteIndex", "]"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"linearSiteIndex", "[", 
      RowBox[{"latticeCoordinates", "[", "i", "]"}], "]"}], "=", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"latticeVolume", "[", "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]], "Input",ExpressionUUID->"52da041f-8b8d-434a-8725-70be19a39e43"],

Cell[BoxData[
 RowBox[{"-", 
  "0.07774365679510266`"}]], \
"Output",ExpressionUUID->"5c1e3335-3b6d-4579-8fae-f2552cb8e184"]
}, Open  ]],

Cell["\<\
Timing, matrix size, density, and memory use:
See https://mathematica.stackexchange.com/questions/83721/what-are-\
sparsearray-properties-how-and-when-should-they-be-used\
\>", "Text",ExpressionUUID->"0ecd030a-d3cb-455b-87fa-30fce89ac99d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"rl", "=", 
    RowBox[{"Chop", "[", 
     RowBox[{"makeRootLattice", "[", "]"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Dimensions", "[", 
      RowBox[{"sh", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"gaugeTransformShifts", "[", "rl", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"sh", "[", "Density", "]"}], ",", 
     RowBox[{"printMemory", "[", "sh", "]"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"76eb98b1-84a2-4e60-a9e6-6ecf06894d8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.075404`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"512", ",", "1536"}], "}"}], ",", "0.03125`", ",", 
     TagBox[
      InterpretationBox[
       RowBox[{"\<\"792.\"\>", "\[Times]", 
        SuperscriptBox["10", "\<\"3\"\>"]}],
       791728.,
       AutoDelete->True],
      EngineeringForm[#, 3]& ]}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"d4a18632-bc9f-4ab0-bbc8-3c9a237b4c43"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Look at sh.Transpose[sh] and distribution of right hand sides\
\>", "Subsection",ExpressionUUID->"0719dd29-b183-42ba-83a5-3cd1ab61dc20"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals", ",", "oo"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"sh", ".", 
      RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}], "]"}]}], ";", 
  RowBox[{
  "Dimensions", "[", "oo", 
   "]"}]}]], "Input",ExpressionUUID->"55cb4a2d-4c92-454c-a4df-05dc26e9b6b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"512", ",", "512"}], 
  "}"}]], "Output",ExpressionUUID->"e324f633-b16b-4a07-b565-0e4bc51f79d5"]
}, Open  ]],

Cell["\<\
The matrix is fairly well-conditioned.
get 10.5 for data/3-3/periodic-6-8.175-3.m
get 24 for 3-4/periodic-16-33-4.m\
\>", "Text",ExpressionUUID->"debffc29-ae66-4e34-83ce-f513d75ec61c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"condition", "[", 
  RowBox[{"sh", ".", 
   RowBox[{"Transpose", "[", "sh", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"6640c4aa-bdbe-4619-a67b-62bc39ca21fb"],

Cell[BoxData["10.5140938244315`"], \
"Output",ExpressionUUID->"e9d64651-e6ff-4a32-b447-323c55730624"]
}, Open  ]],

Cell["\<\
Convergence of conjugate gradients for this matrix is this to the number of \
steps:
get 0.52 for data/3-3/periodic-6-8.175-3.m
and 0.66 for second case\
\>", "Text",ExpressionUUID->"d1fb0cf0-7a57-4d56-b53d-73ab552d9ef1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sqrt", "[", "%", "]"}], "-", "1"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sqrt", "[", "%", "]"}], "+", "1"}], 
   ")"}]}]], "Input",ExpressionUUID->"fa98e71c-e7ea-4256-855e-f90255889c2a"],

Cell[BoxData["0.5285847742026885`"], \
"Output",ExpressionUUID->"0a9d3427-5e12-407c-ad39-ce97f0cf54c1"]
}, Open  ]],

Cell["Generate and store values of shifts, using flag \
\[OpenCurlyDoubleQuote]storeBB\[CloseCurlyDoubleQuote]", \
"Text",ExpressionUUID->"8094b9a4-339e-4398-ac36-b388df765fb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MINRES\>\""}], ",", 
     RowBox[{"largeShiftSearch", "\[Rule]", "300"}], ",", 
     RowBox[{"storeBB", "\[Rule]", "True"}]}], "]"}], ";", 
   RowBox[{
   "Dimensions", "[", "bb0", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"3a08d05f-2d18-4b59-87cc-74b18de4e037"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"1.56\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.563872*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"1.34\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"6\"\>"]}],
     1.342192*^6,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[1.563872*^6, 3], ", gaugeTransform shifts ", 
   EngineeringForm[1.342192*^6, 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"a7fdd194-0501-4b99-a17f-127bcdd93530"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"istop=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\" itn=\"\>", "\[InvisibleSpace]", "600"}],
  SequenceForm["Exit ersatzLanczos.  ", "istop=", 6, " itn=", 600],
  Editable->
   False]], "Print",ExpressionUUID->"112ed0ab-3fac-45fd-9f16-41ac80b8ca6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"Anorm=\"\>", "\[InvisibleSpace]", 
   "2.6312634638406625`"}],
  SequenceForm["Exit ersatzLanczos.  ", "Anorm=", 2.6312634638406625`],
  Editable->
   False]], "Print",ExpressionUUID->"7c389605-5c7e-4ab4-aa46-d3bb57e48851"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.9672809999999999999`3.3579164045939702", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "2.755896000000000001`3.5115965762397017", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "3.892043`6.740692627619357"}],
  SequenceForm[
  "Exit ersatzLanczos.  ", "time (seconds): M=", 0, ", A=", 
   0.9672809999999999999`3.3579164045939702, ", orthogonalization=", 
   2.755896000000000001`3.5115965762397017, ", total=", 
   3.892043`6.740692627619357],
  Editable->
   False]], "Print",ExpressionUUID->"3517ac9a-a15f-4aeb-a4f4-dea84781cdfd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit ersatzLanczos.  \"\>", 
   "\[InvisibleSpace]", "\<\"The iteration limit was reached\"\>"}],
  SequenceForm["Exit ersatzLanczos.  ", "The iteration limit was reached"],
  Editable->
   False]], "Print",ExpressionUUID->"3d3f6d5e-434e-4c13-8a9f-e2ae33434e0a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoffNullSpace:  \"\>", "\[InvisibleSpace]", "18", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "300", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["cutoffNullSpace:  ", 18, " of ", 300, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"fd70a695-4d6f-4b4f-98d6-b9aeccddaf64"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "1542"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 1542],
  Editable->
   False]], "Print",ExpressionUUID->"aa610087-e8cc-44fa-acfc-b13c12b4958f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "105.74123527955436`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "2.166197170277021`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 105.74123527955436`, " Acond=", 
   2.166197170277021],
  Editable->
   False]], "Print",ExpressionUUID->"feae5f7a-4d4b-4281-843c-43a0408a42ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "1.1903059924392521`*^-10", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "100.0627018406592`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 1.1903059924392521`*^-10, " ynorm=", 
   100.0627018406592],
  Editable->
   False]], "Print",ExpressionUUID->"ffb292ca-9d4c-49a7-b6f5-1b360a0a7e41"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "1.5466884891025703`*^-10"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 1.5466884891025703`*^-10],
  Editable->
   False]], "Print",ExpressionUUID->"a6fa3925-7327-468f-849d-5f741ee2f939"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "2.8008780000000000004`3.4097248164533918", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "16.1264200000000000025`3.8689385949238977", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "26.023481`7.565880386828367"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   2.8008780000000000004`3.4097248164533918, ", orthogonalization=", 
   16.1264200000000000025`3.8689385949238977, ", total=", 
   26.023481`7.565880386828367],
  Editable->
   False]], "Print",ExpressionUUID->"70345357-4e21-4011-b70a-0069b1359c9f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"3facfc86-658b-4620-8396-23497d150f67"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"findDelta.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds):  dynamic part=\"\>", 
   "\[InvisibleSpace]", "2.3606390000000000013`3.192117279116268", 
   "\[InvisibleSpace]", "\<\", small shifts=\"\>", "\[InvisibleSpace]", 
   "0.330711000000000002`2.4810351545846356", 
   "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.9246410000000000012`2.785263363623661", 
   "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "30.264913`7.631454427652538"}],
  SequenceForm[
  "findDelta.  ", "time (seconds):  dynamic part=", 
   2.3606390000000000013`3.192117279116268, ", small shifts=", 
   0.330711000000000002`2.4810351545846356, ", A=", 
   0.9246410000000000012`2.785263363623661, ", total=", 
   30.264913`7.631454427652538],
  Editable->
   False]], "Print",ExpressionUUID->"e33e475c-223f-4af1-8efb-852ac8bd2a98"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.39406916812216`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.39406916812216, " to ", 2],
  
  Editable->
   False]], "Print",ExpressionUUID->"e1a5b13f-bb48-4d12-9d7d-acb8299f9e4b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.6125469999999999964`3.370981609903725", ",", 
     "10.239222`7.160781957016425", ",", "30.90546`7.640550209891046", ",", 
     "0.06479`4.962022977777321"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   8.6125469999999999964`3.370981609903725, 10.239222`7.160781957016425, 
    30.90546`7.640550209891046, 0.06479`4.962022977777321}],
  Editable->
   False]], "Print",ExpressionUUID->"5358a527-2182-4bf5-b674-b1bdbc0ed432"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2145", ",", "5184"}], 
  "}"}]], "Output",ExpressionUUID->"790efcbb-6651-4ea1-b2a7-7cab776cec26"]
}, Open  ]],

Cell["\<\
Average overlap of b-vectors with each eigenvector of sh.Transpose[sh], \
eigenvectors are sorted by decreasing eigenvalue.\
\>", "Text",ExpressionUUID->"81266947-091b-497d-8d2e-53bb77c43c04"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
     RowBox[{"oo", ".", "sh", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"bb0", "/", 
          RowBox[{"Map", "[", 
           RowBox[{"Norm", ",", "bb0"}], "]"}]}], ",", "600"}], "]"}], 
       "]"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"2f8acc2b-0119-484a-8bda-ab75f24ce9ed"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
     RowBox[{"oo", ".", "sh", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Orthogonalize", "[", 
        RowBox[{"Drop", "[", 
         RowBox[{"bb0", ",", "600"}], "]"}], "]"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"2c1ad669-a47c-4048-b845-0ca12c917d6e"],

Cell["\<\
Overlap of b-vectors with subspace remains large over iterations.\
\>", "Text",ExpressionUUID->"45b28f06-9777-4720-86d8-9176d335ddc8"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"Norm", ",", 
    RowBox[{"bb0", ".", 
     RowBox[{"Transpose", "[", "sh", "]"}]}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"9cc9bb49-f57e-4506-bc42-cad1b158ad4d"],

Cell["\<\
Fraction of independence of each b-vector from all previous b-vectors after \
transforming into the gauge transform space.  We see that the vectors are \
nearly orthogonal, to start with.  Note that the first iterations are for the \
calculation that locates the large shift eigenvectors of the Hessian.  Then \
comes the iterations associated with finding  the actual shifts.\
\>", "Text",ExpressionUUID->"d11405b7-05aa-40ff-be60-b3b3cfe9cd72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gbb0", "=", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"bb0", ",", "600"}], "]"}], ".", 
    RowBox[{"Transpose", "[", "sh", "]"}]}]}], 
  ";"}]], "Input",ExpressionUUID->"0ba10202-a15b-4ad7-8f55-1c0a7d40f764"],

Cell[BoxData[
 RowBox[{
  RowBox[{"overlaps", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"obb", "=", 
         RowBox[{"If", "[", 
          RowBox[{"False", ",", 
           RowBox[{"gbb0", "/", 
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", "gbb0"}], "]"}]}], ",", 
           RowBox[{"Orthogonalize", "[", "gbb0", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", "=", 
             RowBox[{"gbb0", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"b", "=", 
             RowBox[{"b", "/", 
              RowBox[{"Norm", "[", "b", "]"}]}]}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ob", "=", 
                  RowBox[{"obb", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"b", "=", 
                 RowBox[{"b", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ob", ".", "b"}], ")"}], " ", "ob"}]}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"Norm", "[", "b", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "gbb0", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"c1eac17e-4019-43e4-9ecc-03d9e5d90cd1"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", "overlaps", 
  "]"}]], "Input",ExpressionUUID->"d722a4e7-d4c2-44b0-83c3-0365d62da9c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare different dynamicPart[ ] methods.", \
"Subsection",ExpressionUUID->"7ec696dc-7108-4ca9-b3b5-f2021e836e11"],

Cell["\<\
Verify that this is equal to the NullSpace[ ] used in the dense calculation.\
\>", "Text",ExpressionUUID->"dc98b006-9e03-4553-ae20-cd9fb7c97fbf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nsh", "=", 
      RowBox[{"NullSpace", "[", "sh", "]"}]}], ",", 
     RowBox[{"tvec", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"First", "[", "sh", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dynamicPart", "[", "sh", "]"}], "[", "tvec", "]"}], "-", 
     RowBox[{
      RowBox[{"Transpose", "[", "nsh", "]"}], ".", "nsh", ".", "tvec"}]}], 
    "]"}]}], "]"}]], \
"Input",ExpressionUUID->"fad809e6-63a1-4724-8739-e8157db94d1c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"792.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     791728.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[791728., 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"4edecf27-5921-4ef5-8d12-317cf25d9061"],

Cell[BoxData["1.7923106055269107`*^-11"], \
"Output",ExpressionUUID->"9c10082f-223e-48a2-a7a3-f05eae6b8606"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"testProjection", "[", "f_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "sh", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      "r2", ",", 
      RowBox[{"t1", "=", 
       RowBox[{"SessionTime", "[", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"r2", "=", 
      RowBox[{"f", "[", "r1", "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<timing:  \>\"", ",", 
       RowBox[{
        RowBox[{"SessionTime", "[", "]"}], "-", "t1"}], ",", " ", 
       "\"\< s\>\""}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"r2", "-", 
         RowBox[{"f", "[", "r2", "]"}]}], "]"}], ",", 
       RowBox[{"Norm", "[", 
        RowBox[{"sh", ".", "r2"}], "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"277005b6-0fa5-467a-89b2-47d426ba8194"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpOrtho", "=", 
     RowBox[{"dynamicPart", "[", "sh", "]"}]}], ")"}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"fc9a90c6-459c-494f-905b-32ab18544655"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"792.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     791728.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "Automatic"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[791728., 3], " (bytes) for ", Automatic],
  Editable->
   False]], "Print",ExpressionUUID->"55956166-4524-48bf-b97c-7debc7365b49"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001099`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"bfb49632-2d93-4831-89c5-cf3ce46ea2bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpOrtho", 
  "]"}]], "Input",ExpressionUUID->"7d44c94a-06c8-4637-9dc7-489ea855785f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.068667`4.987263071702004", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.068667`4.987263071702004, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"37dd8e59-345b-47bf-8499-1bd1efa01f9a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.791186658804096`*^-11", ",", "2.7445081424997256`*^-11"}], 
  "}"}]], "Output",ExpressionUUID->"01a7da0e-ab9a-480f-bd14-4feafaf291d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLeast", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LeastSquares\>\""}]}], "]"}]}], 
    ")"}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"f5ce9c6e-51a9-4fdd-8b48-46cdca20ba92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"793.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     792504.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"792.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     791728.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"LeastSquares\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[792504., 3], ", gaugeTransform shifts ", 
   EngineeringForm[791728., 3], " (bytes) for ", "LeastSquares"],
  Editable->
   False]], "Print",ExpressionUUID->"3af80ab1-8137-4437-b0f9-094636b62cb7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.003181`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"8882824c-babb-4b88-985c-732be38dd461"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpLeast", 
  "]"}]], "Input",ExpressionUUID->"cda52ce3-5135-4684-8ba4-6058e5a9a9e2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.061601`4.940102760174288", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.061601`4.940102760174288, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"a00955bc-e525-493e-bb9c-9bae500476a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0370524302661805`*^-15", ",", "7.121662130057804`*^-7"}], 
  "}"}]], "Output",ExpressionUUID->"7942209b-ad09-45c3-9fbc-e5c90f84bcf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLinear", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LinearSolve\>\""}]}], "]"}]}], ")"}],
    ";"}], "]"}]], \
"Input",ExpressionUUID->"463f2d4e-a959-409a-a065-8c7465000bb2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"465.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     464608.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"792.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     791728.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"LinearSolve\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[464608., 3], ", gaugeTransform shifts ", 
   EngineeringForm[791728., 3], " (bytes) for ", "LinearSolve"],
  Editable->
   False]], "Print",ExpressionUUID->"4211f0d5-6ce5-4108-ba99-9b2d991f82d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.069831`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"17b79ba7-adab-4531-84f9-68c62d3a6ec6"]
}, Open  ]],

Cell["\<\
For 3-3/periodic-22, 182s, 77MB memory, gaugeTransformShifts 132MB, trouble \
converging.  Looks like the Krylov method just stores the matrix until \
solving.\
\>", "Text",ExpressionUUID->"39d4ce56-eabc-400a-ad0d-f08908b56230"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dpLinear", "=", 
     RowBox[{"dynamicPart", "[", 
      RowBox[{"sh", ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LinearSolve\>\"", ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Krylov\>\"", ",", 
             RowBox[{
             "\"\<Method\>\"", "\[Rule]", "\"\<ConjugateGradient\>\""}], ",", 
             
             RowBox[{"\"\<Tolerance\>\"", "\[Rule]", 
              RowBox[{"10", "^", 
               RowBox[{"-", "9"}]}]}]}], "}"}]}]}], "}"}]}]}], "]"}]}], ")"}],
    ";"}], "]"}]], \
"Input",ExpressionUUID->"8b3e902f-7dde-4eb9-bfb7-7ddb75b9018c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"465.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     465008.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"792.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     791728.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"LinearSolve\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[465008., 3], ", gaugeTransform shifts ", 
   EngineeringForm[791728., 3], " (bytes) for ", "LinearSolve"],
  Editable->
   False]], "Print",ExpressionUUID->"bce45eb3-78ee-4645-9ed3-d205a4abe500"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.013464`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"98b586bb-8ca4-41c0-bc67-fb566ed426f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpLinear", 
  "]"}]], "Input",ExpressionUUID->"69da07cc-cdb9-4142-833f-e650c90205e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.03618`4.708983560355784", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.03618`4.708983560355784, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"b19abf3f-5c11-4255-a1c2-e21841004500"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.649225693547494`*^-9", ",", "1.6565312417206247`*^-8"}], 
  "}"}]], "Output",ExpressionUUID->"6aba2f82-84df-44ce-9185-f8bda0dc3e6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"dpzLinear", "=", 
    RowBox[{"dynamicPart", "[", 
     RowBox[{"sh", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<MINRES\>\"", ",", 
         RowBox[{"printDetails", "\[Rule]", "1"}], ",", 
         RowBox[{"rTolerance", "\[Rule]", 
          RowBox[{"10", "^", 
           RowBox[{"-", "10"}]}]}]}], "}"}]}]}], "]"}]}], ";"}], 
  "]"}]], "Input",ExpressionUUID->"65d12926-d2c3-4165-a44e-15de6aeba532"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dynamicPart memory:  \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox["\<\"0.\"\>",
     0.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], 
   "\[InvisibleSpace]", "\<\", gaugeTransform shifts \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     RowBox[{"\<\"792.\"\>", "\[Times]", 
      SuperscriptBox["10", "\<\"3\"\>"]}],
     791728.,
     AutoDelete->True],
    EngineeringForm[#, 3]& ], "\[InvisibleSpace]", "\<\" (bytes) for \"\>", 
   "\[InvisibleSpace]", "\<\"MINRES\"\>"}],
  SequenceForm["dynamicPart memory:  ", 
   EngineeringForm[0., 3], ", gaugeTransform shifts ", 
   EngineeringForm[791728., 3], " (bytes) for ", "MINRES"],
  Editable->
   False]], "Print",ExpressionUUID->"99a39aaf-c999-4047-a07f-b4a0aa1eebab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000991`", ",", "Null"}], 
  "}"}]], "Output",ExpressionUUID->"6505ef58-1e1b-492e-bafc-2ce493f54fe5"]
}, Open  ]],

Cell["\<\
Faster than built-in Conjugate gradients, perhaps because we don\
\[CloseCurlyQuote]t explicitly construct the matrix.\
\>", "Text",ExpressionUUID->"4fca43ce-11f0-43d2-a39a-5f6a91c01b52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testProjection", "[", "dpzLinear", 
  "]"}]], "Input",ExpressionUUID->"f6da0bd4-c5ea-48b8-b584-5b3c83862554"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "30"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 30],
  Editable->
   False]], "Print",ExpressionUUID->"6a7477a1-832e-41f0-9b0e-dca6ad538b2f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "48.675646302313126`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "1.6385802619571688`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 48.675646302313126`, " Acond=", 
   1.6385802619571688`],
  Editable->
   False]], "Print",ExpressionUUID->"59260e0a-344e-47fd-b9bc-28125ada742a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "2.340957792483452`*^-8", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "6.005776150741782`"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 2.340957792483452*^-8, " ynorm=", 
   6.005776150741782],
  Editable->
   False]], "Print",ExpressionUUID->"20c798b2-c661-4f01-82cf-193522916bcc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "2.2689906673656336`*^-7"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 2.2689906673656336`*^-7],
  Editable->
   False]], "Print",ExpressionUUID->"e1924da8-4daf-4c78-8c58-bfad2175abae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.0366040000000000002`3.23692228979108", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.045358`4.807168894507998"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   0.0366040000000000002`3.23692228979108, ", orthogonalization=", 0, 
   ", total=", 0.045358`4.807168894507998],
  Editable->
   False]], "Print",ExpressionUUID->"c2f10f3b-c3e5-45b3-b9eb-1074d559ab99"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"92b723cf-9086-4555-9604-bd451d1d206c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"timing:  \"\>", "\[InvisibleSpace]", 
   "0.047404`4.826329987283144", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["timing:  ", 0.047404`4.826329987283144, " s"],
  Editable->
   False]], "Print",ExpressionUUID->"f9b8b6cf-6b8d-4171-8f50-215d56d00aee"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"istop=\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" itn=\"\>", 
   "\[InvisibleSpace]", "30"}],
  SequenceForm["Exit minres.  ", "istop=", 1, " itn=", 30],
  Editable->
   False]], "Print",ExpressionUUID->"af4aad1a-96ed-4159-b6e0-0c9216ce8fc1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Anorm=\"\>", 
   "\[InvisibleSpace]", "37.757051863096684`", 
   "\[InvisibleSpace]", "\<\" Acond=\"\>", "\[InvisibleSpace]", 
   "1.1662328379304945`"}],
  SequenceForm[
  "Exit minres.  ", "Anorm=", 37.757051863096684`, " Acond=", 
   1.1662328379304945`],
  Editable->
   False]], "Print",ExpressionUUID->"2710e7a6-f1c1-4617-9150-427dae7d25d3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"rnorm=\"\>", 
   "\[InvisibleSpace]", "3.6216226753853473`*^-17", 
   "\[InvisibleSpace]", "\<\" ynorm=\"\>", "\[InvisibleSpace]", 
   "1.2002408877823506`*^-8"}],
  SequenceForm[
  "Exit minres.  ", "rnorm=", 3.6216226753853473`*^-17, " ynorm=", 
   1.2002408877823506`*^-8],
  Editable->
   False]], "Print",ExpressionUUID->"dc542468-ed44-4c9a-a155-a413425c7b6e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", "\[InvisibleSpace]", "\<\"Arnorm=\"\>", 
   "\[InvisibleSpace]", "4.1841992337841675`*^-16"}],
  SequenceForm["Exit minres.  ", "Arnorm=", 4.1841992337841675`*^-16],
  Editable->
   False]], "Print",ExpressionUUID->"6c6203b3-49f2-4d9e-8a20-d9e17950e353"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"time (seconds): M=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", A=\"\>", "\[InvisibleSpace]", 
   "0.028925`3.1346671107361175", 
   "\[InvisibleSpace]", "\<\", orthogonalization=\"\>", "\[InvisibleSpace]", 
   "0", "\[InvisibleSpace]", "\<\", total=\"\>", "\[InvisibleSpace]", 
   "0.034947`4.693924897817364"}],
  SequenceForm[
  "Exit minres.  ", "time (seconds): M=", 0, ", A=", 
   0.028925`3.1346671107361175, ", orthogonalization=", 0, ", total=", 
   0.034947`4.693924897817364],
  Editable->
   False]], "Print",ExpressionUUID->"a352fd0d-de1a-43a6-8dc8-3e8c58318ea3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Exit minres.  \"\>", 
   "\[InvisibleSpace]", "\<\"A solution to Ax=b was found, given rtol\"\>"}],
  SequenceForm["Exit minres.  ", "A solution to Ax=b was found, given rtol"],
  Editable->
   False]], "Print",ExpressionUUID->"ae739616-f7ec-429b-b19c-cf7c97c6f7da"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.5705184846471784`*^-8", ",", "2.3409577692489536`*^-8"}], 
  "}"}]], "Output",ExpressionUUID->"6934c6e9-cb5c-414d-9686-be3a872cf14d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Improve sparsity of gauge invariant shift matrix", \
"Subsection",ExpressionUUID->"95ec3cb4-995e-4832-baab-242e92a90d93"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "sh", 
  "]"}]], "Input",ExpressionUUID->"70061512-c3c4-4932-9a7f-4cc7ac539b76"],

Cell["\<\
Orthonormal basis of gauge transforms.  We see that we get roughly 50% \
sparsity.\
\>", "Text",ExpressionUUID->"7a750240-d253-450c-8b0e-877cf2788fdd"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"osh", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"Orthogonalize", "[", "sh", "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"6fe32da2-4f96-4c29-9b98-f8b8841583c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"osh", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"dc9a797a-d1ab-41d1-b2cb-b43a18b4a147"],

Cell[BoxData["0.5576131687242798`"], \
"Output",ExpressionUUID->"b78906d1-b142-448f-bf61-7fdb0fd9f59d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lastZero", "[", "x_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", "=", "None"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"j", "=", "i"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", "j"}]}], 
   "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"820ec01d-6689-42c3-b971-3f5fddd84a93"],

Cell["\<\
Try to sort rows so that Orthogonalize[..] is more sparse.  This essentially \
didn\[CloseCurlyQuote]t work. \
\>", "Text",ExpressionUUID->"a5ee9a4a-17f3-4003-9ab0-be29b294885b"],

Cell["Octahedral plus tetrahedral tessellation of the lattice.", \
"Text",ExpressionUUID->"f2a84d21-108c-4fd4-a849-387c6becb6ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "allPlanes", "]"}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "]"}], ":=", 
   RowBox[{"allPlanes", "[", "nd", "]"}]}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "nd_", "]"}], ":=", 
   RowBox[{
    RowBox[{"allPlanes", "[", "nd", "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"BitAnd", "[", 
         RowBox[{"1", ",", 
          RowBox[{"BitShiftRight", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", 
            RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}]}], "-", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"nd", "-", "1"}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "nd"}], "}"}]}], 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"788ee36e-7285-481a-b584-1c6bde19ab0b"],

Cell["Cubic tessellation of the lattice", \
"Text",ExpressionUUID->"899765d0-c57a-4e06-9b66-1e954b35164d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "allPlanes", "]"}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "]"}], ":=", 
   RowBox[{"allPlanes", "[", "nd", "]"}]}], ";", 
  RowBox[{
   RowBox[{"allPlanes", "[", "nd_", "]"}], ":=", 
   RowBox[{
    RowBox[{"allPlanes", "[", "nd", "]"}], "=", 
    RowBox[{
    "IdentityMatrix", "[", "nd", 
     "]"}]}]}]}]], \
"Input",ExpressionUUID->"e581cc7d-dc42-4af9-b3f0-c23e8e3c7906"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coordRank", "[", "coords_", "]"}], ":=", 
   RowBox[{"coordRank", "[", 
    RowBox[{"coords", ",", 
     RowBox[{"Total", "[", "latticeDimensions", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"coordRank", "[", 
    RowBox[{"coords_", ",", "top_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cc", "=", 
        RowBox[{
         RowBox[{"allPlanes", "[", "]"}], ".", "coords"}]}], ",", 
       RowBox[{"i", "=", "1"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"cc", ",", 
             RowBox[{"2", "^", "i"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "==", "0"}], "&"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"2", "^", "i"}], "<", "top"}]}], ",", 
        RowBox[{"i", "+=", "1"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"True", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"For", " ", "debugging"}], " ", "*)"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"Length", "[", "cc", "]"}]}], "+", 
         RowBox[{"lastZero", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{"cc", ",", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{"cc", ",", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}]}], "}"}]}], "]"}]}]}],
     "]"}]}]}]], \
"Input",ExpressionUUID->"cd8419d7-5396-4b69-ab57-e7436a8cfc18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"coordRank", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "i", ",", "j"}], "}"}], ",", 
       RowBox[{"3", "*", "16"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "16"}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], 
  "]"}]], "Input",ExpressionUUID->"999f503e-92c8-48d9-a91e-0e1982afc6ca"],

Cell[BoxData[
 TagBox[GridBox[{
    {"12", "4", "22", "4", "24", "4", "10", "4", "12", "4", "17", "4", "19", 
     "4", "10", "4"},
    {"4", "22", "4", "8", "4", "24", "4", "8", "4", "17", "4", "8", "4", "19",
      "4", "8"},
    {"22", "4", "12", "4", "10", "4", "24", "4", "17", "4", "12", "4", "10", 
     "4", "19", "4"},
    {"4", "8", "4", "12", "4", "8", "4", "24", "4", "8", "4", "12", "4", "8", 
     "4", "19"},
    {"23", "4", "10", "4", "12", "4", "17", "4", "24", "4", "10", "4", "12", 
     "4", "18", "4"},
    {"4", "23", "4", "8", "4", "17", "4", "8", "4", "24", "4", "8", "4", "18",
      "4", "8"},
    {"10", "4", "23", "4", "17", "4", "12", "4", "10", "4", "24", "4", "18", 
     "4", "12", "4"},
    {"4", "8", "4", "23", "4", "8", "4", "12", "4", "8", "4", "24", "4", "8", 
     "4", "12"},
    {"12", "4", "17", "4", "23", "4", "10", "4", "12", "4", "18", "4", "24", 
     "4", "10", "4"},
    {"4", "17", "4", "8", "4", "23", "4", "8", "4", "18", "4", "8", "4", "24",
      "4", "8"},
    {"17", "4", "12", "4", "10", "4", "23", "4", "18", "4", "12", "4", "10", 
     "4", "24", "4"},
    {"4", "8", "4", "12", "4", "8", "4", "23", "4", "8", "4", "12", "4", "8", 
     "4", "24"},
    {"20", "4", "10", "4", "12", "4", "18", "4", "23", "4", "10", "4", "12", 
     "4", "21", "4"},
    {"4", "20", "4", "8", "4", "18", "4", "8", "4", "23", "4", "8", "4", "21",
      "4", "8"},
    {"10", "4", "20", "4", "18", "4", "12", "4", "10", "4", "23", "4", "21", 
     "4", "12", "4"},
    {"4", "8", "4", "20", "4", "8", "4", "12", "4", "8", "4", "23", "4", "8", 
     "4", "12"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableDepth -> 
    2]]]], "Output",ExpressionUUID->"8a467f31-e5fc-4af8-894b-f590024db317"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkerboardRank", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"Null", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nGauge", "[", "0", "]"}], "}"}]}], "]"}]}], ",", 
      "gindex"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"coords", "=", 
           RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"gindex", "=", 
           RowBox[{
            RowBox[{"coords2gauge", "[", "0", "]"}], "[", 
            RowBox[{"coords", ",", "ca"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", "gindex", "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ca", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"nc", "^", "2"}], "-", "1"}], ")"}], 
               RowBox[{"coordRank", "[", "coords", "]"}]}]}], ",", "gindex"}],
             "}"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ca", ",", 
         RowBox[{
          RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
       RowBox[{"Sort", "[", "y", "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"59f3bfa4-f1af-40db-a051-9cdbd8aa7197"],

Cell[BoxData[
 RowBox[{"osh2", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"Orthogonalize", "[", 
     RowBox[{"sh", "[", 
      RowBox[{"[", 
       RowBox[{"checkerboardRank", "[", "]"}], "]"}], "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"4f16507b-f89f-4c78-abf3-c1cc071cd5b2"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "osh2", 
  "]"}]], "Input",ExpressionUUID->"9d35c5c2-d0b1-4172-ace3-4f11f848e40c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"osh2", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"7821b034-b595-4804-a30c-b82b97ace6b9"],

Cell[BoxData["0.3985259130658436`"], \
"Output",ExpressionUUID->"a3a853f5-bb3d-4df5-9387-145ac0f3f50a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"sshh", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"sh", ".", 
     RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"6e48f94b-14e9-415a-b0b3-5cfb3db20060"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sshh", "[", "Density", 
  "]"}]], "Input",ExpressionUUID->"99bab5d8-7e49-4ef9-99e7-ab60a603ae3f"],

Cell[BoxData["0.028356481481481483`"], \
"Output",ExpressionUUID->"0a74d64e-ccd5-452f-851a-485ecc3aac25"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dynamic space projection properties", \
"Subsection",ExpressionUUID->"84945386-0274-4dda-ab03-98533f727960"],

Cell["\<\
Transpose[sh].sh is symmetric positive semi-definite.  The null space \
corresponds to non-gauge shifts.  Note that Transpose[sh].sh is still quite \
sparse.\
\>", "Text",ExpressionUUID->"84e021f8-8f1d-420c-a6f4-1f0df56b234a"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "sh", "]"}], ".", "sh"}], "]"}], "]"}], "]"}],
   "]"}]], "Input",ExpressionUUID->"dfbe4a57-40b5-4515-b563-a5f395e8a110"],

Cell["\<\
Test that the gradients are orthogonal to all gauge transforms.\
\>", "Text",ExpressionUUID->"35a8f3a8-a887-49c3-8acc-3ee9001c32a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sh", ".", "grad0"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"7db26175-9b80-494b-8888-3409aceedff4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "6"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"2e91342b-7e8f-4e92-92a7-6f6963d1a639"]
}, Open  ]],

Cell["\<\
However, since the Hessian is quadratic in the shifts, it is not necessarily \
in the direction of two infinitesimal gauge transforms.\
\>", "Text",ExpressionUUID->"d9f29dfa-1e72-4448-9502-e04444a962b3"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sh", ".", "hess0", ".", 
    RowBox[{"Transpose", "[", "sh", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"e9d4c17e-10fa-402a-9cd0-41d585ebd3dc"],

Cell["\<\
Project onto subspace of physical degrees of freedom, this results in a dense \
matrix.\
\>", "Text",ExpressionUUID->"41e877bd-9b8d-40b2-b53d-6e2d5b129db0"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"proj", "=", 
    RowBox[{"NullSpace", "[", "sh", "]"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"77278033-ba93-4097-a567-46cc8fc2199b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Adjoint trace identity", \
"Subsection",ExpressionUUID->"35821692-ae2e-4be9-8b36-81e36ad24ba8"],

Cell["\<\
Verify unitarity of the adjoint color matrix for some random element of \
SU(nc):  
        2 Tr[u.suGenerator[a].ConjugateTranspose[u].suGenerator[b]].  
Also, this matrix should be real-valued.  This matrix comes up in the \
analytic calculations.\
\>", "Text",ExpressionUUID->"ad643e66-0715-413a-b3f1-3f02225a0d27"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nc", "=", "3"}], ",", "u"}], "}"}], ",", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"randomSUMatrix", "[", "]"}]}], ";", 
    RowBox[{"ff", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"u", ".", "#1", ".", 
            RowBox[{"ConjugateTranspose", "[", "u", "]"}], ".", "#2"}], 
           "]"}]}], "&"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
    RowBox[{"ff2", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"u", ".", "u", ".", "#1", ".", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"u", ".", "u"}], "]"}], ".", "#2"}], "]"}]}], "&"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", 
        RowBox[{"suGenerators", "[", "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}]}], "]"}]], \
"Input",ExpressionUUID->"c854da1d-f86e-42fb-b758-43d172c442bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"ff", ".", 
   RowBox[{"ConjugateTranspose", "[", "ff", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"218317ee-6919-443e-9bcd-259eb72b11f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.0000000000000009`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1.0000000000000007`", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1.0000000000000002`", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1.0000000000000007`", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1.0000000000000007`", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1.0000000000000004`", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1.0000000000000007`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1.0000000000000007`"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"0c932a93-95fb-4185-b459-168631d25887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"ff", ".", "ff"}], "-", "ff2"}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"cceea3f8-51ac-42d0-a2ed-7fb44da35128"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "64"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"0a2a91f3-b03e-4dce-bd09-5179404bb7e7"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["String tension", \
"Section",ExpressionUUID->"b3691e17-548f-480b-94c5-a99587fee159"],

Cell["\<\
First, load base lattice configuration so lattice parameters (nc, nd, et \
cetera) are defined.\
\>", "Text",ExpressionUUID->"8f4ae613-3a2d-4efc-a07c-167a7422d02a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/periodic-22-42-1.m\>\""}], 
  ";"}]], "Input",ExpressionUUID->"52269dbd-6fff-44cb-ac17-880b9fc6a34a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-22-42-1-a-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], 
  ";"}]], "Input",ExpressionUUID->"7518c34a-fb9f-48c3-8817-55b2d5bc2ad2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<../data/3-3/step-22-42-1-b-1.m\>\""}], ";", 
  RowBox[{"gaugeField", "=", "gaugeField0"}], 
  ";"}]], "Input",ExpressionUUID->"5309242a-4c34-4e3d-85e6-fdcd4562c7c4"],

Cell["\<\
For nc = 3, 12^3 or less has no signal, 16^3 lattice is borderline, 22^3 \
lattice looks great. \
\>", "Text",ExpressionUUID->"de65fe7c-7012-4326-8b74-30e0a9afa082"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"loopThickness", "[", 
  "]"}]], "Input",ExpressionUUID->"1678686a-bc4a-46ff-9c10-bb2c37a9bcfe"],

Cell[BoxData["8.633941834840112`"], \
"Output",ExpressionUUID->"36f29396-5789-4ce2-990c-ee1b526ca0d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tallyData", "=", 
  RowBox[{"talliesToAverageErrors", "[", 
   RowBox[{"polyakovLoopTallies", "[", "\"\<simple\>\"", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"25a9b774-f852-46f2-aef7-58df4dbc94ed"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.24363481857853053`", ",", "0.01817006224519487`"}], "}"}]}], 
   ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.12167346326290565`", ",", "0.017904861021039775`"}], "}"}]}], 
   ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.044060377695260625`", ",", "0.01721870926812224`"}], "}"}]}], 
   ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.02629955243320237`", ",", "0.017740869421659835`"}], "}"}]}], 
   ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.008352787734131095`", ",", "0.010029806918661862`"}], "}"}]}],
    ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.008632783578754756`"}], ",", "0.017430015678315543`"}], 
     "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.019492699947200706`"}], ",", "0.016875374173841877`"}], 
     "}"}]}], ",", 
   RowBox[{"8", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.013738256385804434`"}], ",", "0.023337483586440753`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["2"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.1834752064157692`", ",", "0.01835524168229198`"}], "}"}]}], 
   ",", 
   RowBox[{
    SqrtBox["5"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.11002584147947582`", ",", "0.012683428061290039`"}], "}"}]}], 
   ",", 
   RowBox[{
    SqrtBox["10"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.053451622728601864`", ",", "0.012487054873522259`"}], "}"}]}],
    ",", 
   RowBox[{
    SqrtBox["17"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.028966453378095867`", ",", "0.012139913826373794`"}], "}"}]}],
    ",", 
   RowBox[{
    SqrtBox["26"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.013968968643797503`", ",", "0.012044326654864027`"}], "}"}]}],
    ",", 
   RowBox[{
    SqrtBox["37"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.02420073670007522`"}], ",", "0.011927487069735742`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"5", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.023119979179508098`"}], ",", "0.009761986900137591`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["65"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.02853383136621009`"}], ",", "0.009677352337022656`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0684224100882127`", ",", "0.01725027467963202`"}], "}"}]}], 
   ",", 
   RowBox[{
    SqrtBox["13"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.05366930618099003`", ",", "0.012541311134964497`"}], "}"}]}], 
   ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.026131084334762696`", ",", "0.012180341217120791`"}], "}"}]}],
    ",", 
   RowBox[{
    SqrtBox["29"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.01017821175682547`"}], ",", "0.01207513990963763`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox["10"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.030524744743874573`"}], ",", "0.011947080014040573`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["53"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.02816770785672396`"}], ",", "0.012038440546322856`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox["17"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.04597391336538884`"}], ",", "0.016782956993871365`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"3", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.02371086361368573`", ",", "0.01745604810165613`"}], "}"}]}], 
   ",", 
   RowBox[{
    SqrtBox["34"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.019689302202731813`"}], ",", "0.011964422846962398`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"3", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.04571102847560278`"}], ",", "0.011792846236006363`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["58"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.03043162948180345`"}], ",", "0.011745194411022857`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["73"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.05578783723082223`"}], ",", "0.016396719531778292`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"4", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.012860826601841006`", ",", "0.016749595712224428`"}], "}"}]}],
    ",", 
   RowBox[{
    SqrtBox["41"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.02947180201845959`"}], ",", "0.012189551236414065`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox["13"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.032049932577474016`"}], ",", "0.012016072166856254`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"4", " ", 
     SqrtBox["5"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.03428077790432953`"}], ",", "0.01661151224757143`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["61"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.04133915514454195`"}], ",", "0.011808695652741907`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["74"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.0400991997852295`"}], ",", "0.011614670245249288`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["89"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.024113499427637398`"}], ",", "0.01746937758434774`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"6", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.034098339260662094`"}], ",", "0.017007707063329585`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["85"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.04870467151824962`"}], ",", "0.01153823558725413`"}], 
     "}"}]}], ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.05800654348231131`"}], ",", "0.016980499012561073`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"7", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.08574846106879072`"}], ",", "0.01691718795386253`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["113"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.08618900544755648`"}], ",", "0.017026391214490563`"}], 
     "}"}]}], ",", 
   RowBox[{
    RowBox[{"8", " ", 
     SqrtBox["2"]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.07431792470712191`"}], ",", "0.034168432990880564`"}], 
     "}"}]}]}], 
  "\[RightAssociation]"}]], \
"Output",ExpressionUUID->"acefd266-6820-4437-a500-146721682212"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tallyData", "=", 
  RowBox[{"talliesToAverageErrors", "[", 
   RowBox[{"polyakovLoopTallies", "[", "\"\<smeared\>\"", "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"8b48f09a-6d70-4b26-8e48-468d239f8271"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.004828924563671501`", ",", "0.000358280320394419`"}], "}"}]}],
    ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.003988827092397045`", ",", "0.00036533909570020027`"}], 
     "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.003287500412600498`", ",", "0.0003381295417263034`"}], 
     "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.002817201890075163`", ",", "0.0003103030423066245`"}], 
     "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0025037602542355816`", ",", "0.0002977428618618992`"}], 
     "}"}]}], ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.002218012107428527`", ",", "0.00028755891934456536`"}], 
     "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0019755689994240696`", ",", "0.0002878264601839187`"}], 
     "}"}]}], ",", 
   RowBox[{"8", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0015818137657083126`", ",", "0.0003108399952637829`"}], 
     "}"}]}], ",", 
   RowBox[{"9", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0014324684466650562`", ",", "0.0003229860962717575`"}], 
     "}"}]}], ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.001210210594684135`", ",", "0.000306065574318693`"}], "}"}]}],
    ",", 
   RowBox[{"11", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0012579056697598168`", ",", "0.0004468209615566053`"}], 
     "}"}]}], ",", 
   RowBox[{
    SqrtBox["221"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0017381824991772566`", ",", "0.0004624756114239414`"}], 
     "}"}]}]}], 
  "\[RightAssociation]"}]], \
"Output",ExpressionUUID->"a340ebd9-9e85-4b0b-900c-d786ee5f574f"]
}, Open  ]],

Cell["Only place where exponentialModel[...] is called", \
"Text",ExpressionUUID->"e4bc659b-642b-4180-9ebe-3a8c2a5ccb14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{"exponentialModel", "[", 
    RowBox[{"tallyData", ",", 
     RowBox[{"printResult", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"aa6430b1-dfc2-4a6e-9514-05ee903ee29a"],

Cell[BoxData[
 TemplateBox[{
  "NonlinearModelFit","sszero",
   "\"The step size in the search has become less than the tolerance \
prescribed by the PrecisionGoal option, but the gradient is larger than the \
tolerance specified by the AccuracyGoal option. There is a possibility that \
the method has stalled at a point that is not a local minimum.\"",2,293,46,
   31688487663599700943,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"b1bcd20f-eaaa-4927-86f2-af8378aaf347"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"norm", "0.5971783533138502`", "0.06322985004820002`", 
      "9.44456380742042`", "1.2584138350572218`*^-11"},
     {"aw", "0.8252647825706356`", "0.05995098378962651`", 
      "13.765658716570279`", "1.4785433718768638`*^-16"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->
   False]], "Print",ExpressionUUID->"118efc25-7938-48ea-abf6-4b4f1daf21f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nn", "=", 
      RowBox[{"Normal", "[", "tallyData", "]"}]}], ",", "maxx", ",", "miny", 
     ",", "maxy"}], "}"}], ",", 
   RowBox[{
    RowBox[{"maxx", "=", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "nn"}], "]"}], "]"}], "+", "0.5"}]}], ";", 
    RowBox[{"maxy", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"1.5", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", "nn"}], 
       "]"}], "]"}]}], ";", 
    RowBox[{"miny", "=", 
     RowBox[{"Min", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Min", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"1.5", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", "nn"}], 
         "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ErrorListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"ErrorBar", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
          ",", "nn"}], "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"miny", ",", "maxy"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"ColumnForm", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\< = \>\"",
                     ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    "\"\<\[PlusMinus]\>\"", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "&"}], 
                  ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"ff", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<BestFitParameters\>\"", ",", 
                    "\"\<ParameterErrors\>\""}], "}"}], "]"}], "]"}]}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Beta] = \>\"", ",", 
                    RowBox[{"N", "[", "beta", "]"}], ",", 
                    "\"\<, \!\(\*SubscriptBox[\(N\), \(d\)]\) = \>\"", ",", 
                    "nd", ",", 
                    "\"\<, \!\(\*SubscriptBox[\(N\), \(c\)]\) = \>\"", ",", 
                    "nc"}], "}"}], "]"}], ",", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<lattice = \>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"latticeDimensions", ",", "\"\<, \>\""}], "]"}]}],
                     "}"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"maxx", "*", "0.9"}], ",", 
               RowBox[{"maxy", "*", "0.9"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Dashing", "[", ".02", "]"}], ",", "Gray", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"maxx", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
        ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<separation (links)\>\"", ",", 
           "\"\<Polyakov loop correlator\>\""}], "}"}]}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"ff", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"8497e53e-6048-4af5-9f48-fddcf95862ec"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQEf7FMkfv/J0T9vDxVwsApv/PlXdT+Uz+GQ5NHw
SaR/GZQv4OBYmCbm+m4WlC/icFnHwNBFuhHKl3BgD1SfKbCucT+EL+NQf0Lp
85Ovk6F8BYcZVTz9Z5V69p+1rk+bt+Cb/Y646VNla47br/gyfXb5Y0aHk633
/JZr7bEPjr5lFeHD6fBNX/g6U9xqe/a369P46wQcIqcfOp64cq79N32h+NRU
EQcvtfvWh2f32FveSd68P0TCYcLLlZ+ET8zYf4BLnuGYh4zDZOvrnYfXTN9/
YVei/QN5BQfR6QZMP83nQu1nc1hQtKRXsWWj/efIRBftGzwOFWEbRburVkPd
I+ggdK8xSfrQLPvPN1csyegSdZhxhKU04EbLfoj7JB2clCd/fOA4f//L32UK
V+VkHQ7yGz74d33Ofoh7gfZZ7u950rl8/82c+2fKfgg4vM2Tl1/pPsN+0eLN
vE+DxB1Yz2htydOcsv/Pu+RM46tSDrd49s7IT1++v+DIXMveMjmHg8t7RSs0
5+9fLLJuRbuYooNM+3UDywlroO4Xc7jjbvP2WFiXPcP/+TPPzJF0eGntrX5b
d95+iH9kHAz2tnjczFiwH+IfRYflHN/YHXoX7s8o8RPfZCvv4LHj+L10raX7
/RjNfyWbKDpc3Rdx/2H7kv2O7UnHjO4pOcy12tNrunEG1P0KDpeefkwPK124
f5beBMWMAiWHt8tWTbv4fgU0flUcyk5lz+PYvHZ/cMj6mV1nlB3KOH4Wz/m8
db/ZhUsVi5xUHSZwrumvFtgGdb+aQ+5K+Qf1bJv3AwAkkyEq
       
       "]], {{LineBox[{{1., 0.2618048808237254}, {1., 0.22546475633333565`}}],
         LineBox[{
         Offset[{1.5, 0}, {1., 0.2618048808237254}], 
          Offset[{-1.5, 0}, {1., 0.2618048808237254}]}], 
        LineBox[{
         Offset[{1.5, 0}, {1., 0.22546475633333565`}], 
          Offset[{-1.5, 0}, {1., 0.22546475633333565`}]}]}, {
        LineBox[{{2., 0.13957832428394543`}, {2., 0.10376860224186588`}}], 
        LineBox[{
         Offset[{1.5, 0}, {2., 0.13957832428394543`}], 
          Offset[{-1.5, 0}, {2., 0.13957832428394543`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {2., 0.10376860224186588`}], 
          Offset[{-1.5, 0}, {2., 0.10376860224186588`}]}]}, {
        LineBox[{{3., 0.06127908696338286}, {3., 0.026841668427138386`}}], 
        LineBox[{
         Offset[{1.5, 0}, {3., 0.06127908696338286}], 
          Offset[{-1.5, 0}, {3., 0.06127908696338286}]}], 
        LineBox[{
         Offset[{1.5, 0}, {3., 0.026841668427138386`}], 
          Offset[{-1.5, 0}, {3., 0.026841668427138386`}]}]}, {
        LineBox[{{4., 0.044040421854862205`}, {4., 0.008558683011542535}}], 
        LineBox[{
         Offset[{1.5, 0}, {4., 0.044040421854862205`}], 
          Offset[{-1.5, 0}, {4., 0.044040421854862205`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {4., 0.008558683011542535}], 
          Offset[{-1.5, 0}, {4., 0.008558683011542535}]}]}, {
        LineBox[{{5., 0.018382594652792957`}, {5., -0.0016770191845307675`}}],
         LineBox[{
         Offset[{1.5, 0}, {5., 0.018382594652792957`}], 
          Offset[{-1.5, 0}, {5., 0.018382594652792957`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5., -0.0016770191845307675`}], 
          Offset[{-1.5, 0}, {5., -0.0016770191845307675`}]}]}, {
        LineBox[{{6., 0.008797232099560787}, {6., -0.0260627992570703}}], 
        LineBox[{
         Offset[{1.5, 0}, {6., 0.008797232099560787}], 
          Offset[{-1.5, 0}, {6., 0.008797232099560787}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6., -0.0260627992570703}], 
          Offset[{-1.5, 0}, {6., -0.0260627992570703}]}]}, {
        LineBox[{{7., -0.0026173257733588286`}, {7., -0.03636807412104258}}], 
        LineBox[{
         Offset[{1.5, 0}, {7., -0.0026173257733588286`}], 
          Offset[{-1.5, 0}, {7., -0.0026173257733588286`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7., -0.03636807412104258}], 
          Offset[{-1.5, 0}, {7., -0.03636807412104258}]}]}, {
        LineBox[{{8., 0.009599227200636318}, {8., -0.037075739972245184`}}], 
        LineBox[{
         Offset[{1.5, 0}, {8., 0.009599227200636318}], 
          Offset[{-1.5, 0}, {8., 0.009599227200636318}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8., -0.037075739972245184`}], 
          Offset[{-1.5, 0}, {8., -0.037075739972245184`}]}]}, {
        LineBox[{{1.4142135623730951`, 0.20183044809806117`}, {
         1.4142135623730951`, 0.16511996473347723`}}], 
        LineBox[{
         Offset[{1.5, 0}, {1.4142135623730951`, 0.20183044809806117`}], 
          Offset[{-1.5, 0}, {1.4142135623730951`, 0.20183044809806117`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {1.4142135623730951`, 0.16511996473347723`}], 
          Offset[{-1.5, 0}, {1.4142135623730951`, 0.16511996473347723`}]}]}, {
        LineBox[{{2.23606797749979, 0.12270926954076586`}, {2.23606797749979, 
         0.09734241341818578}}], 
        LineBox[{
         Offset[{1.5, 0}, {2.23606797749979, 0.12270926954076586`}], 
          Offset[{-1.5, 0}, {2.23606797749979, 0.12270926954076586`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {2.23606797749979, 0.09734241341818578}], 
          Offset[{-1.5, 0}, {2.23606797749979, 0.09734241341818578}]}]}, {
        LineBox[{{3.1622776601683795`, 0.06593867760212413}, {
         3.1622776601683795`, 0.040964567855079605`}}], 
        LineBox[{
         Offset[{1.5, 0}, {3.1622776601683795`, 0.06593867760212413}], 
          Offset[{-1.5, 0}, {3.1622776601683795`, 0.06593867760212413}]}], 
        LineBox[{
         Offset[{1.5, 0}, {3.1622776601683795`, 0.040964567855079605`}], 
          Offset[{-1.5, 0}, {3.1622776601683795`, 
           0.040964567855079605`}]}]}, {
        LineBox[{{4.123105625617661, 0.04110636720446966}, {4.123105625617661,
          0.016826539551722072`}}], 
        LineBox[{
         Offset[{1.5, 0}, {4.123105625617661, 0.04110636720446966}], 
          Offset[{-1.5, 0}, {4.123105625617661, 0.04110636720446966}]}], 
        LineBox[{
         Offset[{1.5, 0}, {4.123105625617661, 0.016826539551722072`}], 
          Offset[{-1.5, 0}, {4.123105625617661, 0.016826539551722072`}]}]}, {
        LineBox[{{5.0990195135927845`, 0.026013295298661532`}, {
         5.0990195135927845`, 0.0019246419889334763`}}], 
        LineBox[{
         Offset[{1.5, 0}, {5.0990195135927845`, 0.026013295298661532`}], 
          Offset[{-1.5, 0}, {5.0990195135927845`, 0.026013295298661532`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5.0990195135927845`, 0.0019246419889334763`}], 
          Offset[{-1.5, 0}, {5.0990195135927845`, 
           0.0019246419889334763`}]}]}, {
        LineBox[{{6.082762530298219, -0.012273249630339478`}, {
         6.082762530298219, -0.036128223769810966`}}], 
        LineBox[{
         Offset[{1.5, 0}, {6.082762530298219, -0.012273249630339478`}], 
          Offset[{-1.5, 0}, {6.082762530298219, -0.012273249630339478`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6.082762530298219, -0.036128223769810966`}], 
          Offset[{-1.5, 0}, {6.082762530298219, -0.036128223769810966`}]}]}, {
        LineBox[{{7.0710678118654755`, -0.013357992279370507`}, {
         7.0710678118654755`, -0.03288196607964569}}], 
        LineBox[{
         Offset[{1.5, 0}, {7.0710678118654755`, -0.013357992279370507`}], 
          Offset[{-1.5, 0}, {7.0710678118654755`, -0.013357992279370507`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7.0710678118654755`, -0.03288196607964569}], 
          Offset[{-1.5, 0}, {7.0710678118654755`, -0.03288196607964569}]}]}, {
        LineBox[{{8.06225774829855, -0.018856479029187433`}, {
         8.06225774829855, -0.038211183703232746`}}], 
        LineBox[{
         Offset[{1.5, 0}, {8.06225774829855, -0.018856479029187433`}], 
          Offset[{-1.5, 0}, {8.06225774829855, -0.018856479029187433`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8.06225774829855, -0.038211183703232746`}], 
          Offset[{-1.5, 0}, {8.06225774829855, -0.038211183703232746`}]}]}, {
        LineBox[{{2.8284271247461903`, 0.08567268476784473}, {
         2.8284271247461903`, 0.051172135408580684`}}], 
        LineBox[{
         Offset[{1.5, 0}, {2.8284271247461903`, 0.08567268476784473}], 
          Offset[{-1.5, 0}, {2.8284271247461903`, 0.08567268476784473}]}], 
        LineBox[{
         Offset[{1.5, 0}, {2.8284271247461903`, 0.051172135408580684`}], 
          Offset[{-1.5, 0}, {2.8284271247461903`, 
           0.051172135408580684`}]}]}, {
        LineBox[{{3.605551275463989, 0.06621061731595453}, {3.605551275463989,
          0.04112799504602553}}], 
        LineBox[{
         Offset[{1.5, 0}, {3.605551275463989, 0.06621061731595453}], 
          Offset[{-1.5, 0}, {3.605551275463989, 0.06621061731595453}]}], 
        LineBox[{
         Offset[{1.5, 0}, {3.605551275463989, 0.04112799504602553}], 
          Offset[{-1.5, 0}, {3.605551275463989, 0.04112799504602553}]}]}, {
        LineBox[{{4.47213595499958, 0.038311425551883486`}, {4.47213595499958,
          0.013950743117641905`}}], 
        LineBox[{
         Offset[{1.5, 0}, {4.47213595499958, 0.038311425551883486`}], 
          Offset[{-1.5, 0}, {4.47213595499958, 0.038311425551883486`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {4.47213595499958, 0.013950743117641905`}], 
          Offset[{-1.5, 0}, {4.47213595499958, 0.013950743117641905`}]}]}, {
        LineBox[{{5.385164807134504, 0.0018969281528121596`}, {
         5.385164807134504, -0.022253351666463098`}}], 
        LineBox[{
         Offset[{1.5, 0}, {5.385164807134504, 0.0018969281528121596`}], 
          Offset[{-1.5, 0}, {5.385164807134504, 0.0018969281528121596`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5.385164807134504, -0.022253351666463098`}], 
          Offset[{-1.5, 0}, {5.385164807134504, -0.022253351666463098`}]}]}, {
        LineBox[{{6.324555320336759, -0.018577664729834}, {
         6.324555320336759, -0.042471824757915146`}}], 
        LineBox[{
         Offset[{1.5, 0}, {6.324555320336759, -0.018577664729834}], 
          Offset[{-1.5, 0}, {6.324555320336759, -0.018577664729834}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6.324555320336759, -0.042471824757915146`}], 
          Offset[{-1.5, 0}, {6.324555320336759, -0.042471824757915146`}]}]}, {
        LineBox[{{7.280109889280518, -0.016129267310401103`}, {
         7.280109889280518, -0.040206148403046815`}}], 
        LineBox[{
         Offset[{1.5, 0}, {7.280109889280518, -0.016129267310401103`}], 
          Offset[{-1.5, 0}, {7.280109889280518, -0.016129267310401103`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7.280109889280518, -0.040206148403046815`}], 
          Offset[{-1.5, 0}, {7.280109889280518, -0.040206148403046815`}]}]}, {
        LineBox[{{8.246211251235321, -0.029190956371517477`}, {
         8.246211251235321, -0.06275687035926021}}], 
        LineBox[{
         Offset[{1.5, 0}, {8.246211251235321, -0.029190956371517477`}], 
          Offset[{-1.5, 0}, {8.246211251235321, -0.029190956371517477`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8.246211251235321, -0.06275687035926021}], 
          Offset[{-1.5, 0}, {8.246211251235321, -0.06275687035926021}]}]}, {
        LineBox[{{4.242640687119285, 0.041166911715341856`}, {
         4.242640687119285, 0.0062548155120296}}], 
        LineBox[{
         Offset[{1.5, 0}, {4.242640687119285, 0.041166911715341856`}], 
          Offset[{-1.5, 0}, {4.242640687119285, 0.041166911715341856`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {4.242640687119285, 0.0062548155120296}], 
          Offset[{-1.5, 0}, {4.242640687119285, 0.0062548155120296}]}]}, {
        LineBox[{{5.830951894845301, -0.007724879355769414}, {
         5.830951894845301, -0.031653725049694215`}}], 
        LineBox[{
         Offset[{1.5, 0}, {5.830951894845301, -0.007724879355769414}], 
          Offset[{-1.5, 0}, {5.830951894845301, -0.007724879355769414}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5.830951894845301, -0.031653725049694215`}], 
          Offset[{-1.5, 0}, {5.830951894845301, -0.031653725049694215`}]}]}, {
        LineBox[{{6.708203932499369, -0.03391818223959642}, {
         6.708203932499369, -0.05750387471160914}}], 
        LineBox[{
         Offset[{1.5, 0}, {6.708203932499369, -0.03391818223959642}], 
          Offset[{-1.5, 0}, {6.708203932499369, -0.03391818223959642}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6.708203932499369, -0.05750387471160914}], 
          Offset[{-1.5, 0}, {6.708203932499369, -0.05750387471160914}]}]}, {
        LineBox[{{7.615773105863909, -0.01868643507078059}, {
         7.615773105863909, -0.04217682389282631}}], 
        LineBox[{
         Offset[{1.5, 0}, {7.615773105863909, -0.01868643507078059}], 
          Offset[{-1.5, 0}, {7.615773105863909, -0.01868643507078059}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7.615773105863909, -0.04217682389282631}], 
          Offset[{-1.5, 0}, {7.615773105863909, -0.04217682389282631}]}]}, {
        LineBox[{{8.54400374531753, -0.03939111769904394}, {
         8.54400374531753, -0.07218455676260052}}], 
        LineBox[{
         Offset[{1.5, 0}, {8.54400374531753, -0.03939111769904394}], 
          Offset[{-1.5, 0}, {8.54400374531753, -0.03939111769904394}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8.54400374531753, -0.07218455676260052}], 
          Offset[{-1.5, 0}, {8.54400374531753, -0.07218455676260052}]}]}, {
        LineBox[{{5.656854249492381, 0.029610422314065434`}, {
         5.656854249492381, -0.0038887691103834214`}}], 
        LineBox[{
         Offset[{1.5, 0}, {5.656854249492381, 0.029610422314065434`}], 
          Offset[{-1.5, 0}, {5.656854249492381, 0.029610422314065434`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5.656854249492381, -0.0038887691103834214`}], 
          Offset[{-1.5, 0}, {
           5.656854249492381, -0.0038887691103834214`}]}]}, {
        LineBox[{{6.4031242374328485`, -0.017282250782045525`}, {
         6.4031242374328485`, -0.041661353254873655`}}], 
        LineBox[{
         Offset[{1.5, 0}, {6.4031242374328485`, -0.017282250782045525`}], 
          Offset[{-1.5, 0}, {6.4031242374328485`, -0.017282250782045525`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6.4031242374328485`, -0.041661353254873655`}], 
          Offset[{-1.5, 0}, {
           6.4031242374328485`, -0.041661353254873655`}]}]}, {
        LineBox[{{7.211102550927978, -0.020033860410617763`}, {
         7.211102550927978, -0.04406600474433027}}], 
        LineBox[{
         Offset[{1.5, 0}, {7.211102550927978, -0.020033860410617763`}], 
          Offset[{-1.5, 0}, {7.211102550927978, -0.020033860410617763`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7.211102550927978, -0.04406600474433027}], 
          Offset[{-1.5, 0}, {7.211102550927978, -0.04406600474433027}]}]}, {
        LineBox[{{8.94427190999916, -0.017669265656758103`}, {
         8.94427190999916, -0.050892290151900964`}}], 
        LineBox[{
         Offset[{1.5, 0}, {8.94427190999916, -0.017669265656758103`}], 
          Offset[{-1.5, 0}, {8.94427190999916, -0.017669265656758103`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8.94427190999916, -0.050892290151900964`}], 
          Offset[{-1.5, 0}, {8.94427190999916, -0.050892290151900964`}]}]}, {
        LineBox[{{7.810249675906654, -0.029530459491800044`}, {
         7.810249675906654, -0.05314785079728386}}], 
        LineBox[{
         Offset[{1.5, 0}, {7.810249675906654, -0.029530459491800044`}], 
          Offset[{-1.5, 0}, {7.810249675906654, -0.029530459491800044`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7.810249675906654, -0.05314785079728386}], 
          Offset[{-1.5, 0}, {7.810249675906654, -0.05314785079728386}]}]}, {
        LineBox[{{8.602325267042627, -0.028484529539980215`}, {
         8.602325267042627, -0.05171387003047879}}], 
        LineBox[{
         Offset[{1.5, 0}, {8.602325267042627, -0.028484529539980215`}], 
          Offset[{-1.5, 0}, {8.602325267042627, -0.028484529539980215`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8.602325267042627, -0.05171387003047879}], 
          Offset[{-1.5, 0}, {8.602325267042627, -0.05171387003047879}]}]}, {
        LineBox[{{9.433981132056603, -0.006644121843289656}, {
         9.433981132056603, -0.04158287701198514}}], 
        LineBox[{
         Offset[{1.5, 0}, {9.433981132056603, -0.006644121843289656}], 
          Offset[{-1.5, 0}, {9.433981132056603, -0.006644121843289656}]}], 
        LineBox[{
         Offset[{1.5, 0}, {9.433981132056603, -0.04158287701198514}], 
          Offset[{-1.5, 0}, {9.433981132056603, -0.04158287701198514}]}]}, {
        LineBox[{{8.48528137423857, -0.01709063219733251}, {
         8.48528137423857, -0.05110604632399168}}], 
        LineBox[{
         Offset[{1.5, 0}, {8.48528137423857, -0.01709063219733251}], 
          Offset[{-1.5, 0}, {8.48528137423857, -0.01709063219733251}]}], 
        LineBox[{
         Offset[{1.5, 0}, {8.48528137423857, -0.05110604632399168}], 
          Offset[{-1.5, 0}, {8.48528137423857, -0.05110604632399168}]}]}, {
        LineBox[{{9.219544457292887, -0.037166435930995494`}, {
         9.219544457292887, -0.06024290710550375}}], 
        LineBox[{
         Offset[{1.5, 0}, {9.219544457292887, -0.037166435930995494`}], 
          Offset[{-1.5, 0}, {9.219544457292887, -0.037166435930995494`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {9.219544457292887, -0.06024290710550375}], 
          Offset[{-1.5, 0}, {9.219544457292887, -0.06024290710550375}]}]}, {
        LineBox[{{10., -0.041026044469750236`}, {10., -0.07498704249487238}}],
         LineBox[{
         Offset[{1.5, 0}, {10., -0.041026044469750236`}], 
          Offset[{-1.5, 0}, {10., -0.041026044469750236`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {10., -0.07498704249487238}], 
          Offset[{-1.5, 0}, {10., -0.07498704249487238}]}]}, {
        LineBox[{{9.899494936611665, -0.06883127311492819}, {
         9.899494936611665, -0.10266564902265325`}}], 
        LineBox[{
         Offset[{1.5, 0}, {9.899494936611665, -0.06883127311492819}], 
          Offset[{-1.5, 0}, {9.899494936611665, -0.06883127311492819}]}], 
        LineBox[{
         Offset[{1.5, 0}, {9.899494936611665, -0.10266564902265325`}], 
          Offset[{-1.5, 0}, {9.899494936611665, -0.10266564902265325`}]}]}, {
        LineBox[{{10.63014581273465, -0.06916261423306591}, {
         10.63014581273465, -0.10321539666204704`}}], 
        LineBox[{
         Offset[{1.5, 0}, {10.63014581273465, -0.06916261423306591}], 
          Offset[{-1.5, 0}, {10.63014581273465, -0.06916261423306591}]}], 
        LineBox[{
         Offset[{1.5, 0}, {10.63014581273465, -0.10321539666204704`}], 
          Offset[{-1.5, 0}, {10.63014581273465, -0.10321539666204704`}]}]}, {
        LineBox[{{11.313708498984761`, -0.040149491716241346`}, {
         11.313708498984761`, -0.10848635769800247`}}], 
        LineBox[{
         Offset[{1.5, 0}, {11.313708498984761`, -0.040149491716241346`}], 
          Offset[{-1.5, 0}, {11.313708498984761`, -0.040149491716241346`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {11.313708498984761`, -0.10848635769800247`}], 
          Offset[{-1.5, 0}, {
           11.313708498984761`, -0.10848635769800247`}]}]}}}, {}}, {}, {}, \
{}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJwVj3c0FY4bxm3Zm2vf6173ZiZEIe9LRUIJISMjM6FEl/qiJBklhVAhyWgZ
UUYkI1kVoVDZo6yQIopfv7+e85zPcz7nPCS3AEsPJgYGBi9GBob/Z+gHi64N
lUR9ipLrJRGpURhiap1eLfSDr0GmTmd4RiHjaatGVWEYmE0rOE2tj8Aab9vH
9MIrwKhdUDE9PAIPdNvuxxZmgLqT3UJgwQgwWbZdP1/4GMgF4sKXtUdA1cn0
UlhhDYzlFdQWOQ1Do1v8+bOFb0Avt8udK3EQGqPO/N665S3c6NBbGAsehIY8
n5Nfi95C3pzU5m6HQaifMnY9VPIOyi9dMP9BGwSXHZF3xPo7YGN58YJ63QA4
1+mfW/j8HuIMXmnnLn8Bx85yyB35AP0OMSdHT32GQwv3X3DPDYD/50Rt1bw+
4OU9tZWiOAhuMQHrh673QbOi3j1dz0FoftIneyW8D3Tc38YeGxiEyOgeQwXb
Pkj0DVV09xoCI3e+WjGOPjg9kPGzznYYJkqDHBoCesGgcSI+bPsonD07sZ91
70fovRpSsfR7AvymT2d1knpAPts80UdsEuRqS3laBXog8Imc94DmJKxaP7j3
lrEHuHvaxZoDJuEbTtL+DHeDgQSJfmt8Eih8hAuTd7vhwb2WbYadX8HcuC5z
mdoNZyslSq8WTAHL8yq3Wu0ukBmtfqxoOwcFRQ0HBM90QuSCwAMZ+hyY0S0c
S3w7YXLDM08wdQ7iM/ftdHTqhGIpgazVD3Ows/bOoR7shF02HomtNt9hRNG4
02pTJ5SNRe/YpjQP9IaN9ND0Dui33SLVo7gAUiuZXvtj3gFF/9ywsOIPiDvn
KKoe2A57NjvP/t3+A4xWujjsHdvBU1D/94TxDyD00xuuG7VD/sQaf6XHDyjP
bT6kJdkOilfp6JT9A5jJBxN3v2oDtSH/rFzCEqzmE00DpdpAN9LJSYv9J/Df
2YLVH1rAskmnz3bsF4ysqtWcCnkN64WH6eeWfkFKQbL8jPtreJgaInKfZRns
Wglvgw6+BhafZwdXKcsQpEW//0zxNTzjUm+97bEM7JZPBNa+NIHEQYXnwxPL
sKuukuescROMfBLL8P22AmmPJyX/yr+CkwtLLhFzq+Dy0VrClrcBbkiaJTiu
r4J26ZPXr9broWpPzvMdvGsQsPZR2eB7PbDcPCi6pLIGe5QWl5w66uGGYWGb
t98ajO1PdFBNqofqJC8ty5k1iHu+N5UkWQ/sWv1c8lN/gPeNtwy3Zh1knKl9
1jq+Dp2RPozVfLVQzN62cGNpHb5v8vjIt/ICGpM/KB9l3oCK5vny4KEXMFU4
e3eNuAGNXxpc6SUvQGtU8qqy4wZsb53ts7B+AW9NQ7wS3m+A9bf5OIuMGjiX
QOC+78yAPYbiZ6h61fDEubP6uBkjjnx5yuTzoBIi5ek5gdaMmENh+KiRUgkH
p6XiQhwZ8XN14Fb+c5Uwf9rbNuo4I4aILuj/PVQJqgkbC7cuM6Jz/TuFfKZK
uF+tQmtrZ0SJ9apOFecKuCMed03BnAltP84dyaWUw5UuQ88Jc2ZcYTZNPDxQ
Bt2t9V1HDzHjT0VlNnxbBhL1hgbDjszo5VE3qf6iDAqKDaU++zKju+Tz1zsz
y6D+iuH7zlhmDAn1m584UgbLxob6Na+YUUaxsyB8pBRcqw1Ek3eyYIZ7j/mF
xSewLRebDFRY0V7lXeeSRglsr3E8m67JiuHrNb8XqCWg0xOitqDLivXOYysr
4iWArCU37+xjxW5mgjOFoQT2eZACNrxY8WeI6J/v7cXgIs9EqLnLin1x8YLW
3sVwObfBZzuBDcsupxnomhXBaK4RzxZmdtw0PszuH/IIlGsi46lc7Hjuv63V
Aq6PIKj7BYeMEDsa+p661WzyCNiYtdl4yOzIv3PxVoDkI9jsQtuYMvzHr+V/
v1P7EI5LbFrIi2THTCYxtwtcD+FXQku3DNMmZDsfxzxQfB84Q8xu8zJyIMHq
lWSTaj60vnTLDtvEgfseag6xSudDHEdo3gwfB5rpUPSsuPKB41ZucasMBwpu
TCWKfs2DTS/WG6P1ODBXJvey/t08YGcpmV2nc6BVLc8nTvE8YEkUge9zHBhf
YfFpP38urOcPDL/7zInNyg+F/cg5wDIvXDwwxolXyVmkeKEc4NxuGj47w4kT
7B8cnzHngEhzuQTXX0788NRaXXPsLih/TbQykuZCd7lYhfbcu3B4865X1U5c
aKHdPn5U6S6UFeQX3B/gwg4n+r5vkA2+908EXBjiRlrSVWUdQhYoC+66ePwr
Nwr+2ls5tp4Jc2dEbh2a58aWY9++5YxnQqBZVRONgQdt3O7/cC7NhDPfmWXa
ZXlQYU9+T/uBTIjZltou7MyDnbEs7r6XM+BeXY1C3hceNOgNHd8nfBsG+jjH
mvt5semlJE3bIR3EgsrPKYzw4sP6Bb9F43Sw4HWXjvvGi6y3th6u1kyHesMa
G9MVXvQKDZ4/y5sOeQ8DWt6I8KHx4+SZgvo08A/rLnxvwYcfjr2JK1ZJg3Vi
ZujnJj7MFwmNU+JNBb6yNPaQw/xoLZ0wlPQrGd4yROiEOPGj+MYjc/PxZEgw
9/ALceXHufu+y8LdycA9ubUrxIcfHRZHO9+WJAOnRFtmaCg/JtAyHKf9koHt
3N9tZ9P58XmqR3nN1yRYN3VzD+/jR5ff3QMhX6/DzKhSXdRhAYyIiLZZ4LkG
XiYR5egkgNeNl56/Z7gGI4XvH/9xEcAAO4EdL34kQm9o6M0gbwFk5j/oUNqX
CI18r0+50wVw5fiql0heImToulF3pwhgyu3pnyWYCPuT0uKZOwUwY6zba+tq
AhQZstpE7hXEV4RnbJJyl+FN/le1BDNBfL9P16mA8zJMc7dz3bQQROp6pb7J
j3igfbxeV2IniBdd41xfNcZDli9RZdhbEO8pVbnmesfD1WRdFowVxOLZI5a/
SuMgYOLkk78tgjh+meuDv10sbIkb4A01FUL3uwodZ3qi4dHGVZ7AA0Lo1KLt
3VYfDZuDDbh9rYRQYFfSPqXiaCC63ONwchBCt/Ut1YT4aODXOsZi4CuEhW+U
lwsMomF++OfvTfFCqB7xnDe55CIU7+AZT2v9xys9h/B2FKh/031eYSKM1gYS
qsE3I+EY3T7Mz1wYtzwMkDa4HAnZrKEgd1AY9wz2jYmFRwK/3LOGeDthXFzr
7h93jYTv9mrtR7yEUXY/KYxJMRIetVO+sFwUxo6t3mHa1eeBWsyzYfFSGGX2
SNTZfT0HkvRBw29aIkjvv192+3k4/GJJ+DarI4JcaikTynfDoeO6XuKivggO
pVOo72PCIbow/cuakQiuF8TFONiEw/y4VQivrQherhD55bUYBo3WzY816CI4
QpmMsFMNA3/1EkJ4uQjqdmTFkJ+ehZezkXOC20XReK53++RqCNgkZ9p16Yqi
9K2gqbTJEJjRqapPAlEcz666dLg7BMRjFm4IG4tiYLSqLXthCATKuYCojShq
1LBwCLuFANl2Z6J4kChK6TW8m2ynQ/TL5a3EYlGcSH3uo/T4NJglHQ9W2SyG
waxk2fcpQYD7bJg/KYnhjtun1XdEB4EmI16L2SKGrbNaYo9OB4F0gNDjUS0x
VCJqbH1qGwRz+6rG0veIoZ4KZ6GVRBAkMm2yZjsqhjRCKaEq+xR0n8xRH8wQ
w4KXjvT5ikBwsOj/nihEQLNWYRst9pOwyGbtliBGQP1NHonav09AXM2b7nhJ
Ao7MHzLdPX0CKhTrKqPJBGRZtJA+9+4ECLMWXPhPg4DWFYOK59JOwNvKYDFv
KwKK1NPepSufACQLACQR0HnrgarJSn+g/jJOmBUUx3vreddqK3wh9JVqY56o
OLJWHJ8+m+ML7ckiq84S4nh4viN5b4IvnNQY9XhPEkeGrMB7gu6+UH0ifGe5
mjjm8JMdvPl9wXK6bObcfnG0+33Ng+/4MYgYIpkKx4njwc8DncuqPtDbusau
yyiBv/cLXSkc8oS36YFyu1klkNO8Q+3BG09o9P6mZ84hgRR255ynVZ5QxPbx
pLOABKb+OP5yLdkTog2ffLpAkkCTnVx+u/Z5gmaVd1G7gQTeYiwxeVruAVfv
99gciZRAkV9cbG0Z7mAUU5R7nlkSOVP3n5dNdoObXkujdHZJtP9vnPNXlBvM
Ge2Q8+eSRPUG8lJvsBuksDZk2gtJ4kU9nZoGWzcYi/yQqkGWxJFDIgLKUm4Q
GfY3dtxQEv9aegpDviu8CDT1N4mUxKhckS7FJhfQdprUEmCUQo3mMyYK+46A
0aH07Q0sUhjoN6EvoXEEbMxNdYI3SeE9Nlq9lNQRCNpZtLOPTwo5JWv0bOac
4Ik0fXe2jBQK/k5ISE9yApUBNsutelLYfcxys82wI5CdqX4H6VLI3R9iYx7r
AHyuHjnXZqUw9sqN4QubDkO9XX5s0oIU0tX9xvt+2EGQxbeAlJ9SKKeyuIyD
dtALfnrpf6WwMPclv+EzO7grE9xzh0ca/Zc543g97EDzcxR7sYo0EkPeXWx8
ZQuHbe/5vvWTRq5Fpt1GSTaQYz6qwTUnjU9KRB07HayB/8j1L80L0vhq6O0M
0cwawv0NLkX/lMZnN18m/6dnDfZXs/oZ/0rjlTxBVjtpaxDsdDi/wiWDG00H
3DMHrSDSuvvtuIIMjh7wknT1tAIXh1c+Lz1kMI1Rsy3iP0uQ8cnPCv4igwOs
4Uq7WixgKpbiRxyWQe2kvLzkagt49iBbp21MBjWenn/2vcgC9s/c6iHOyKCP
kSu9/oYFhAckcrWvyuDEp5Nlfe4WMBAcSpcjyKLGrR8jzUwWkBFpeuCdpSxW
OdPrFuP2g9Tt7+ubm2Wx8N66gWOLKcRX/ykmt8tijs/TjJQnprD6meOoTIcs
xq7l3Ru+ZQq90pTXQr2yaOsjQC/xN4WkLLur65OyGPAmK0pVxBQudg7xTTET
MU6WRLzmsQ/+dJvcqSUT0Sgwu+6akAlMfZKsO3aUiL3KsrqB2UYQsdK7tseD
iJOZQxLkRCMQFrmhRfIiotz+Fu3hcCOA/fyPPh4jIrdtKsNFRyNIfsmSujuQ
iKeJl8p8CEagnzt7XOY8EetPfljIvL4HrvvXEt5n/vPd9HoclLgbdBiPntjR
T8S/qZnYWGQI2dLeGXqfifjS1MfK6I4hbNLxa4UBInYPSOr3JBpCTyCdYjRC
RNVdD06IBxrCibH4XsspIoqRguR0thlC3usyPL5KxAMjV1O6agxAIIFNIEuC
hMy+d1xkexG+SjwoYXEgIWMHWv500odHDR4vxx1J+Eb56Y1AI304eZz0rukI
CXPZVniZtujDak3aTIwbCZ1MU9xsGfSB2/USjecYCRd/7OLtz9kJavnuGSKh
JDT+GeqgMacHIRqysdRUEvIs5RA+XtUFDrNkl71dJCSaWI7zsuyAP3+0GIk9
JPQO+fNOYGE7zD/uy17+QEKh+SgKeWA79PLJjub1k5CzIHjwRMV2yOu678E6
QsJT9Jjj5X7bwdCh9lj9PAkNyd/PTvZrw5ljU0F6vHK4felof2ytFszEYKya
iRxyb093v1ekCSU7lKTUTOUweCSq9namJpyeEinaYi6HUX8uyuZc0QQGs+lu
1YNyWETMf9nnqwnCfDeIKoflMPXnFaPZzZqglzJdruAjhypPf4Xk5GrA5ewb
E3KxcriXY1Fio0AdVKpmdom0/Osvptzle9TAYvlKxWKrHJqW0mS1mtUgUHOL
Ske7HLZPD7RYPFeDisKTovEdcujOuu19TrYa7M759ZWhVw7NMkT6a/3VwP4y
Q8LMhBw6PLTXauFUg0tHhHsbWMjoIe92/VOSKgwz6R0PRDJukVhTmX6lBB9A
votuSMa01jr7tkIlaP2PVydsNxl5p+nNL1KV4MmvIfaYvWR8sO0OddBHCaKm
LuZkWJDRmnefGgufElDfv+tvdiHjUkJEeaejIhzLPmoie56MbP0dqnxsCvAD
4qntdWQs8S7bMRxPBdGLDrLNDWTk+35zOjCUCjqtSoTGV2R0E79SKORFhXPW
7RzVLWQUCLDXijSkAq8Pz+zDTjLWPdu2LLAqD5uvXy2NHyZjE/H4wwVfeXAa
S0JTRgp60yVMnO0p8Drmtn0rUvDNup5fmLMc7LUnb7tnSMEm5T77MwfloFXp
AV/4bgq6v5ZYOb9LDtrfljdu3UvBeu01YglNDjqEu1TTD1Dwb3W0ScI8CXrv
cDB7H6Hgd9abS3pRJJiqOP2Q9b9/PtZb45qlROD9ZvEHyylY/Jmj9KODDLhU
ybYYVlIwzehTRY2hDJTGz6Xsfk7BfJP+iAoFGbBTvbxlby0FFX62cs8sS8Pd
U6/dDrymYPPHU3tMUqRBe31ni9NHClZEVNLfdEmBi5DSjTPLFKwpIwzGOktC
6U5WtTJteaxsWlzyKCSA+624gaQd8uhzapO03S0CCP/mu3JKVx7/rHxctYsh
QFCZxJQ6yCPTQ3wQ7UYALSW1eyVG8uj61fN2ohgBKgkOhKJD8njcaojrUJQY
1P4oZnhwSh4jd3g2WnmLQtt9x86sInl0mvcZHLIVhgd8LQKnS+Tx8GCx8dm9
whAXvM3SrFQep8OUbEk7hGGvAW/XyjN5zCOc3ZsoIQxNvbXdB1/I450sjYiV
L0JQz07uZX4jj1XtigVTnkJQ4fFtwGtKHjWkBVMkzgtCLun0zBZ5KiaPVFWP
dPODzSVFWVUaFV8H4DL/a35gmx04qKxAxSeP/OL2VfKDd4Vx+WYVKn4Ov5Ay
mMEPygfEI0nbqOgZmqub6MUPpf9ViwntoaLY45vX2Ff5oO4j065f7lTcd/nt
xJQzL3y5cjW9+h4Va7UM4sy9uWAmYvVxWh4VV6M+XDS34oLVkx71QQX/fLuz
0pz0uYBgozut/IiKJ55deP9YmAssZSb1Mkqp2KxRhjz1nNBcqD8UVv9vz6bq
XyPLCU/ezVJhiIrBPtKKiRObIEbArKxOkoYj8sYMF7PYQD1yidojTcNY6UPb
lC+zwafF2+lfZWkY/H7q52gIG6h2z4bzUWj49A9xOMqSDbpvXDVxUqbhgEfU
hzg2NpCV6hpY0aOhZ1ihxK2TrPCMas+hdoSGtx842ftbsYBLKtN/u1xo6M1l
f5bbkAU4Nj2cs3H75z/7OrRSjQUcv611hXnS8BMP7TPwsgDjo4zMNn8aCjg/
6fnTwgxmW4c1vCJoeO30Qpnybmb4lR2bd+Y8De/Ecb97osEMWYLq4gkXaJha
qs1gTGaGxR+R62WXaDjdkUJPZ2KGtGeUFqZEGi5opPiO1zGBIe2Nruj1f3/N
ub/3lzDBdGpwoUIyDbenmCkOZDOBfmhTkkUaDZ2H9qTzRDLB5Dd/NvebNGyP
yXu6I5AJEu3FQum3aciTJutwyo0JdNpqp+MyaUhskg6vsmSCUV3vI5l3aOhU
IibEt4sJ/gcaRe/O
        "]]},
      Annotation[#, "Charting`Private`Tag$61870#1"]& ]}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    InsetBox[
     FormBox[
      InterpretationBox[
       GridBox[{{
          
          TemplateBox[{
           "norm", "\" = \"", "0.5971783533138502`", "\"\[PlusMinus]\"", 
            "0.06322985004820002`"}, "RowDefault"]}, {
          
          TemplateBox[{
           "aw", "\" = \"", "0.8252647825706356`", "\"\[PlusMinus]\"", 
            "0.05995098378962651`"}, "RowDefault"]}, {
          TemplateBox[{
           "\"\[Beta] = \"", "28.`", 
            "\", \\!\\(\\*SubscriptBox[\\(N\\), \\(d\\)]\\) = \"", "3", 
            "\", \\!\\(\\*SubscriptBox[\\(N\\), \\(c\\)]\\) = \"", "3"}, 
           "RowDefault"]}, {
          TemplateBox[{"\"lattice = \"", 
            
            TemplateBox[{", ", "\", \"", "16", "16", "16"}, 
             "RowWithSeparators"]}, "RowDefault"]}}, ColumnAlignments -> Left,
         GridBaseline -> {Baseline, {1, 1}}], 
       ColumnForm[{
         Row[{$CellContext`norm, " = ", 0.5971783533138502, "\[PlusMinus]", 
           0.06322985004820002}], 
         Row[{$CellContext`aw, " = ", 0.8252647825706356, "\[PlusMinus]", 
           0.05995098378962651}], 
         Row[{
          "\[Beta] = ", 28., ", \!\(\*SubscriptBox[\(N\), \(d\)]\) = ", 3, 
           ", \!\(\*SubscriptBox[\(N\), \(c\)]\) = ", 3}], 
         Row[{"lattice = ", 
           Row[{16, 16, 16}, ", "]}]}], Editable -> False], 
      TraditionalForm], {10.632337649086285`, 0.24380092075169055`}, {1, 1}], 
    
    Dashing[0.02], 
    GrayLevel[0.5], 
    LineBox[{{0, 0}, {11.813708498984761`, 0}}]},
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Polyakov loop correlator\"", TraditionalForm], None}, {
     FormBox["\"separation (links)\"", TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 11.813708498984761`}, {-0.12557057419344275`, 
    0.27088991194632284`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{
   Automatic, 
    Automatic}]], \
"Output",ExpressionUUID->"cf4a73fe-b2b6-492b-bf9c-cdeca75486ae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattice stationary point", \
"Section",ExpressionUUID->"61a1c75a-0614-448a-a52c-d8d957505390"],

Cell[CellGroupData[{

Cell["Trivial lattice", \
"Subsection",ExpressionUUID->"2fabcbdc-580e-402a-85cb-f4fa5d0892b2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";", 
  RowBox[{"nc", "=", "5"}], ";", 
  RowBox[{"latticeDimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeTrivialLattice", "[", 
   RowBox[{"randomGauge", "\[Rule]", "True"}], "]"}], ";", 
  RowBox[{
  "averagePlaquette", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"739e85c4-b726-4eed-a384-4b665563a88c"],

Cell[BoxData["1.0000000000000002`"], \
"Output",ExpressionUUID->"80e32c4a-8009-45cb-98a7-9b00fe68b126"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"libGaugeField", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "->", "0"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"efcf3bc0-e184-4d44-85b4-46e3670ebc9a"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1000000"}],
  SequenceForm["cutoff:  ", 1000000],
  Editable->
   False]], "Print",ExpressionUUID->"9d58668d-5d28-484b-987e-8f7abf8bbafe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "3.0946810000000000006`3.880708402957223", ",", 
     "3.408215`6.68304198133523", ",", "0.345241`5.688637363717612", ",", 
     "0.004637`3.816752093727798"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   3.0946810000000000006`3.880708402957223, 3.408215`6.68304198133523, 
    0.345241`5.688637363717612, 0.004637`3.816752093727798}],
  Editable->
   False]], "Print",ExpressionUUID->"fdf6e918-817a-4b43-b7c3-1aacc2703415"]
}, Open  ]]
}, Open  ]],

Cell["\<\
Symmetries of the lattice action.   Gauge fixing removes one dimension worth. \
 Difference is 9 for SU(2), 24 for SU(3), 45 for SU(4), 72 for SU(5), \
independent of the size of the lattice.  In general, the difference is 3 \
(nc^2-1).

Also, all curvatures are negative, indicating that this a a local minimum of \
the action, since the action is 1-Re(Tr(plaquettte))/Nc.

The result is independent of gauge choice.\
\>", "Text",ExpressionUUID->"dd7a8878-8dac-410c-aa06-5f21a7ed2e89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"proj0", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"proj0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "nd"}]}], 
  "}"}]], "Input",ExpressionUUID->"40aeb51c-410f-4668-9040-ab24bd7e2523"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"576", ",", "192"}], 
  "}"}]], "Output",ExpressionUUID->"7e11a7dc-5920-414b-b723-0d4f468454d1"]
}, Open  ]],

Cell["Zero curvature would indicate a gauge symmetry.  ", \
"Text",ExpressionUUID->"5af70cb0-f758-440c-9ae6-b6a824d97aeb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Rationalize", "[", 
   RowBox[{"Chop", "[", "pairs0", "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"57e0138a-4347-4e25-bce7-1525258cd9f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", "0"}], "}"}], ",", "48"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", "0"}], "}"}], ",", "144"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", "144"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "72"}], "}"}]}], 
  "}"}]], "Output",ExpressionUUID->"6895b0a7-a187-4b8c-9fac-da2e160342ad"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare different strategies.", \
"Subsection",ExpressionUUID->"f09fe3a3-3c1f-450f-9d4d-999ebac13ec1"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-4-7.5-3.m\>\""}]], \
"Input",ExpressionUUID->"1c021071-8d2c-4753-8598-b40dd16e21b1"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<../data/3-3/periodic-6-8.175-3.m\>\""}]], \
"Input",ExpressionUUID->"2d348138-07c5-44d6-a83f-01ff3b46f7dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cutoff", "=", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"Pi", " ", 
     RowBox[{".01", "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "3"}], ")"}]}]}], ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"averagePlaquette", "[", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"fc90fa43-2da6-4a7f-be1b-7cd54f8ac457"],

Cell[BoxData["0.6349438216895237`"], \
"Output",ExpressionUUID->"f2f44fc1-de70-49db-b777-60aebe384f4e"]
}, Open  ]],

Cell["Find fraction of shift that is non-gauge transformation.", \
"Text",ExpressionUUID->"e9ce60aa-441d-4899-8356-1902b7f2ae9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"dynamicShifts", "=", 
   RowBox[{"NullSpace", "[", 
    RowBox[{"gp", "=", 
     RowBox[{"gaugeTransformShifts", "[", 
      RowBox[{"makeRootLattice", "[", "]"}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"7150bd61-7bcf-4771-b277-66bda357687c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3456", ",", "5184"}], 
  "}"}]], "Output",ExpressionUUID->"99606795-400d-4841-8202-ef4839667c1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAll", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}], ";", 
  RowBox[{"pairsAll", "=", "pairs0"}], ";", 
  RowBox[{"ooprojAll", "=", 
   RowBox[{"oo0", ".", "proj0"}]}], 
  ";"}]], "Input",ExpressionUUID->"3cf869a5-ad91-4ac6-9351-a58d591d8188"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "282", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "5184", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 282, " of ", 5184, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"16d93f47-dd8b-4510-b636-7ba62f46aaf4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.840350994239852`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2.`"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 8.840350994239852, " to ", 2.],
  Editable->
   False]], "Print",ExpressionUUID->"6e4a4b82-8fb9-4463-b13c-f49dab65122f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.1846810000000000022`3.3488517623106486", ",", 
     "9.774267`7.1405991961462965", ",", "22.737878`7.507264929780372", ",", 
     "0.069742`4.994009395367354"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   8.1846810000000000022`3.3488517623106486, 9.774267`7.1405991961462965, 
    22.737878`7.507264929780372, 0.069742`4.994009395367354}],
  Editable->
   False]], "Print",ExpressionUUID->"2eafdf5c-edf0-4908-97e3-ed13800d87ae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
     RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", "grad0", 
  "]"}]], "Input",ExpressionUUID->"aaff5bde-219a-46e7-a5f1-b81f2e02a9d2"],

Cell[BoxData["0.9999999999999999`"], \
"Output",ExpressionUUID->"98e0a7b1-dd76-42ef-84e4-81dd8abc5fde"]
}, Open  ]],

Cell["\<\
On lattices with more than one link in each direction, the diagonal is zero.  \
But off-diagonal elements are non-zero since the quadratic expansion violates \
gauge invariance.\
\>", "Text",ExpressionUUID->"63c157ed-8231-4995-a8fd-11f647769f2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tr", "[", 
  RowBox[{"gp", ".", "hess0", ".", 
   RowBox[{"Transpose", "[", "gp", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"63d7c4b0-1cd9-43e9-9572-dc71b2fe3068"],

Cell[BoxData["1.0137664034739584`*^-13"], \
"Output",ExpressionUUID->"5da7869e-c1d2-495a-8a3a-90d7ac5d5b34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldDynamic", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "0"}]}], "]"}]}], ";", 
  RowBox[{"pairsDynamic", "=", "pairs0"}], ";", 
  RowBox[{"ooprojDynamic", "=", 
   RowBox[{"oo0", ".", "proj0"}]}], 
  ";"}]], "Input",ExpressionUUID->"86d74fe7-1adc-4eb5-afb1-41947b59bef0"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "133", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "3456", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 133, " of ", 3456, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"4908038d-f0e0-4d7f-8ac4-fc8d3034733b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "5.151305569552345`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "2.`"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 5.151305569552345, " to ", 2.],
  Editable->
   False]], "Print",ExpressionUUID->"de52b2eb-6998-45c2-8c8b-19252a74f84a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "8.3807649999999999991`3.359133668004865", ",", 
     "10.06802`7.153459067429914", ",", "32.77853`7.6661044709467845", ",", 
     "0.063397`4.95258370501543"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   8.3807649999999999991`3.359133668004865, 10.06802`7.153459067429914, 
    32.77853`7.6661044709467845, 0.063397`4.95258370501543}],
  Editable->
   False]], "Print",ExpressionUUID->"1e58449b-1c74-4569-b908-86ab4e461f6b"]
}, Open  ]]
}, Open  ]],

Cell["Map to the shift on the full lattice:", \
"Text",ExpressionUUID->"dd874f12-c1ab-454e-975a-871f80814120"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ffdd", "=", "2"}], ";", 
  RowBox[{"Dimensions", "[", 
   RowBox[{"axialProj", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"proj", "=", 
         RowBox[{"Association", "[", "]"}]}], ",", "i", ",", "j"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"coords", "=", 
             RowBox[{"latticeCoordinates", "[", "i", "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"proj", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"coords2grad", "[", "ffdd", "]"}], "[", 
                RowBox[{"dir", ",", "coords", ",", "k"}], "]"}], ",", 
               RowBox[{
                RowBox[{"coords2grad", "[", 
                 RowBox[{"-", "1"}], "]"}], "[", 
                RowBox[{"dir", ",", "coords", ",", "k"}], "]"}]}], "}"}], 
             "]"}], "=", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "nd"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"latticeVolume", "[", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{
            RowBox[{"nc", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"Normal", "[", "proj", "]"}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"fb6f81ff-93ce-4bba-bd8d-9be84faecccf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1152", ",", "1536"}], 
  "}"}]], "Output",ExpressionUUID->"21a3f704-f300-4b01-8053-34c5338ec10a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"setAxialGauge", "[", "ffdd", 
  "]"}]], "Input",ExpressionUUID->"e36c5c59-204b-48a4-a161-2345bffcf20e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugeFieldAxial", "=", 
   RowBox[{"latticeSaddlePointStep", "[", 
    RowBox[{
     RowBox[{"storePairs", "\[Rule]", "True"}], ",", 
     RowBox[{"fixedDir", "\[Rule]", "ffdd"}]}], "]"}]}], ";", 
  RowBox[{"pairsAxial", "=", "pairs0"}], ";", 
  RowBox[{"ooprojAxial", "=", 
   RowBox[{"oo0", ".", "proj0", ".", "axialProj"}]}], 
  ";"}]], "Input",ExpressionUUID->"844c2bc3-df34-4b21-8071-deb593c6bb6b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"cutoff:  \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["cutoff:  ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"3725a376-fb09-41c1-ae78-5ade7f2484d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3 zeros: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"16", ",", "1152"}], "}"}]}],
  SequenceForm["applyCutoff3 zeros: ", {16, 1152}],
  Editable->
   False]], "Print",ExpressionUUID->"3a545986-1f22-4fbe-b7d5-13d1126cb1e6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2 rescale: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"13.162435875684988`", ",", "1"}], "}"}]}],
  SequenceForm["applyCutoff2 rescale: ", {13.162435875684988`, 1}],
  Editable->
   False]], "Print",ExpressionUUID->"42e0d4c6-7af1-4fc1-9da0-ba96580dc651"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"times:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.1750639999999999985`3.301595822479056", ",", 
     "2.510806`6.550328155632788", ",", "0.312187`5.644929812170774", ",", 
     "0.018249`4.411754069014576"}], "}"}]}],
  SequenceForm[
  "times:  ", {
   2.1750639999999999985`3.301595822479056, 2.510806`6.550328155632788, 
    0.312187`5.644929812170774, 0.018249`4.411754069014576}],
  Editable->
   False]], "Print",ExpressionUUID->"a899fe58-3de6-4e69-939a-e8d77f2326f0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution of shifts", \
"Subsubsection",ExpressionUUID->"3351a8a0-4458-426b-986e-9b7034f32567"],

Cell["\<\
Need to turn on switch in function applyCutoff3 to accumulate data for this \
plot.\
\>", "Text",ExpressionUUID->"5cda3090-c9f1-42c3-9af7-0385e60e0a62"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "goodPairs0"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "badPairs0"}], "]"}]}], "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"1fc1e9d1-47ac-42d1-967f-b99d80d43ddb"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
     "pairsDynamic"}], "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"f2423630-8b43-4e1f-a7c3-6d8f8faa07fe"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsAll"}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsAxial"}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"First", ",", "pairsDynamic"}], "]"}]}], "}"}], 
  "]"}]], "Input",ExpressionUUID->"a47972e2-d1c2-4964-b3cf-b66a94116325"],

Cell["\<\
Note that a Cauchy Distribution is generated by the ratio of two normally \
distributed variables.\
\>", "Text",ExpressionUUID->"d264501a-9c05-42f2-b945-84876a292caf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fitt", "=", 
  RowBox[{"FindDistribution", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], "]"}],
    "]"}]}]], "Input",ExpressionUUID->"3b8bcf26-7b15-435c-811c-f55b65932537"],

Cell[BoxData[
 RowBox[{"CauchyDistribution", "[", 
  RowBox[{
   RowBox[{"-", "0.004456584998476357`"}], ",", "0.30153209861780533`"}], 
  "]"}]], "Output",ExpressionUUID->"0e1a1803-c6fe-4508-9aaf-d6fcb72cae98"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "=", "0.2"}], ",", 
     RowBox[{"max", "=", "2"}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], 
        "]"}], ",", 
       RowBox[{"{", "w", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", "All"}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PDF", "[", 
         RowBox[{"fitt", ",", "x"}], "]"}], 
        RowBox[{"Length", "[", "pairsDynamic", "]"}], " ", "w"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"976d614a-d6da-4f94-9d2c-fa151b6806d7"],

Cell["\<\
We see that there is a good fit in the tails and at the peak.\
\>", "Text",ExpressionUUID->"044a8f0f-69dc-4376-a0bb-d769237fc75b"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "=", "0.2"}], ",", 
     RowBox[{"data", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
        "pairsDynamic"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"data", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Log\>\"", ",", 
         RowBox[{"{", "w", "}"}]}], "}"}], ",", 
       RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log\>\""}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     RowBox[{"LogPlot", "[", " ", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{"fitt", ",", 
            RowBox[{
             RowBox[{"Exp", "[", "x", "]"}], " ", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"w", "/", "2"}], ")"}]}]}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{"fitt", ",", 
            RowBox[{
             RowBox[{"Exp", "[", "x", "]"}], 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "w"}], "/", "2"}], ")"}]}]}]}], "]"}]}], ")"}], 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Min", "[", "data", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Max", "[", "data", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"e02b74d3-ab79-41e9-b95d-0565d9299c06"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsAll"}], "]"}], 
     ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsAxial"}], "]"}],
      ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairsDynamic"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "Automatic"}], "}"}]}], 
   ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}]], "Input",ExpressionUUID->"4c6edeb0-ef5e-4215-925a-75ff9e370f7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare shift vectors", \
"Subsubsection",ExpressionUUID->"bbb308fb-cc39-4caf-afe4-96de077d9a82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cosAngle", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", ".", "b"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", "a", "]"}], " ", 
     RowBox[{"Norm", "[", "b", "]"}]}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"d2f25e1c-27a2-44cb-8db3-b0b1b05fca3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "shifts", "]"}], ";", 
  RowBox[{
   RowBox[{"makeShifts", "[", 
    RowBox[{"type_", ",", "pairs_", ",", "ooproj_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "0", ",", "0"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "pairs"}], "]"}], 
        ".", "ooproj"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "1", ",", "0"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"applyCutoff3", "[", 
            RowBox[{"##", ",", "ooproj", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", "pairs", "]"}]}], "]"}], ".", 
        "ooproj"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "0", ",", "1"}], "]"}], "=", 
      RowBox[{"applyCutoff2", "[", 
       RowBox[{"shifts", "[", 
        RowBox[{"type", ",", "0", ",", "0"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"shifts", "[", 
       RowBox[{"type", ",", "1", ",", "1"}], "]"}], "=", 
      RowBox[{"applyCutoff2", "[", 
       RowBox[{"shifts", "[", 
        RowBox[{"type", ",", "1", ",", "0"}], "]"}], "]"}]}], ";"}], 
    ")"}]}]}]], \
"Input",ExpressionUUID->"ce7f505f-a804-4dfb-a24a-bf9fed0fcac0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting All\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<All\>\"", ",", "pairsAll", ",", "ooprojAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting Dynamic\>\"", "]"}], ";", 
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<Dynamic\>\"", ",", "pairsDynamic", ",", "ooprojDynamic"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<starting Axial\>\"", "]"}], ";", 
  RowBox[{"makeShifts", "[", 
   RowBox[{"\"\<Axial\>\"", ",", "pairsAxial", ",", "ooprojAxial"}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"0d094de9-7433-4499-9a5d-85103d33f3b8"],

Cell[CellGroupData[{

Cell[BoxData["\<\"starting All\"\>"], \
"Print",ExpressionUUID->"f218ac0f-d63c-41ed-8775-839fc9171b8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "70", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1536", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 70, " of ", 1536, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"a7c2a932-451e-4f4d-a3a7-579c95f6fe67"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "256.1295353274988`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 256.1295353274988, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"4a84adcd-314d-4897-a187-b63e700891b0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "8.268441115483451`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 8.268441115483451, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"ddfb736c-b28d-41ba-aa73-e41f1635f252"],

Cell[BoxData["\<\"starting Dynamic\"\>"], \
"Print",ExpressionUUID->"93d51b98-daa6-4907-aeea-f54e2464c6cb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "32", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1024", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 32, " of ", 1024, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"d91b1c8a-b35b-418d-8bef-5e3387bf779c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "48.38767552974463`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 48.38767552974463, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"bb4e8d9e-d329-4b9d-8c9f-9b4154968b99"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "6.3107193177545104`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  "applyCutoff2: rescale maxNorm ", 6.3107193177545104`, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"f32ab095-6011-4b6a-8dba-2fd847d9c4b2"],

Cell[BoxData["\<\"starting Axial\"\>"], \
"Print",ExpressionUUID->"721fa577-c42e-4313-9a1d-ee6051b7660d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff3:  \"\>", "\[InvisibleSpace]", "48", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "1152", 
   "\[InvisibleSpace]", "\<\" zeros\"\>"}],
  SequenceForm["applyCutoff3:  ", 48, " of ", 1152, " zeros"],
  Editable->
   False]], "Print",ExpressionUUID->"4ffa33b5-f89b-434a-90a0-6a87ec39a774"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "303.041061134496`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 303.041061134496, " to ", 1],
  
  Editable->
   False]], "Print",ExpressionUUID->"8f13e73b-e2e1-4d94-accc-c821cffab126"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"applyCutoff2: rescale maxNorm \"\>", "\[InvisibleSpace]", 
   "6.756595777700484`", "\[InvisibleSpace]", "\<\" to \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["applyCutoff2: rescale maxNorm ", 6.756595777700484, " to ", 1],
  Editable->
   False]], "Print",ExpressionUUID->"c7784d36-9519-482d-8d79-73098f196c34"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"typeOuter", "[", "type_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sh", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "0", ",", "1"}], "]"}], ",", 
        RowBox[{"shifts", "[", 
         RowBox[{"type", ",", "1", ",", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"TableForm", "[", 
     RowBox[{"Outer", "[", 
      RowBox[{"cosAngle", ",", "sh", ",", "sh", ",", "1"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",ExpressionUUID->"e1016f09-e08e-4135-80f4-eaa49d3c54df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<All\>\"", 
  "]"}]], "Input",ExpressionUUID->"77bac56d-fd67-44b1-b2ed-028f5e919d5b"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.0000000000000004`", "0.029184582026525824`", "1.`", 
     "0.029184582026525834`"},
    {"0.029184582026525824`", "1.`", "0.029184582026525813`", "1.`"},
    {"1.`", "0.029184582026525813`", "0.9999999999999998`", 
     "0.029184582026525817`"},
    {"0.029184582026525834`", "1.`", "0.029184582026525817`", "1.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"613c99e5-402a-4d4a-8997-46898dfb2a30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<Dynamic\>\"", 
  "]"}]], "Input",ExpressionUUID->"6b415e11-14d2-4106-8e01-f4b3640c28ff"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.0000000000000004`", "0.10859340149780253`", "1.`", 
     "0.10859340149780249`"},
    {"0.10859340149780253`", "1.`", "0.10859340149780251`", 
     "0.9999999999999999`"},
    {"1.`", "0.10859340149780251`", "1.`", "0.10859340149780251`"},
    {"0.10859340149780249`", "0.9999999999999999`", "0.10859340149780251`", 
     "1.0000000000000002`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"c1e166c7-4108-4364-b8ac-cc027450409b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typeOuter", "[", "\"\<Axial\>\"", 
  "]"}]], "Input",ExpressionUUID->"eb2b12df-e702-4116-af87-60617f7fca47"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.0000000000000002`", "0.02551511016982429`", "0.9999999999999998`", 
     "0.025515110169824284`"},
    {"0.02551511016982429`", "1.`", "0.02551511016982429`", 
     "1.0000000000000002`"},
    {"0.9999999999999998`", "0.02551511016982429`", "1.`", 
     "0.025515110169824277`"},
    {"0.025515110169824284`", "1.0000000000000002`", "0.025515110169824277`", 
     "0.9999999999999998`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"065602c7-7a83-4ba4-92ee-a5ec779a45a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<All\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"980c51ba-2e9c-4868-b0c2-29cb89e317ea"],

Cell[BoxData["0.28641083765239306`"], \
"Output",ExpressionUUID->"4ddbd351-68a8-4e96-bb90-22333c9443bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Axial\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"fab3e66d-c418-4cd3-9262-6a90514a8777"],

Cell[BoxData["0.034195693593383994`"], \
"Output",ExpressionUUID->"102b3568-a25a-49a4-adc1-28a641dcc2b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cosAngle", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<All\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Axial\>\"", ",", "1", ",", "1"}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"b58ffdff-fc48-4dce-ab73-30d106345a3b"],

Cell[BoxData["0.08666795454794923`"], \
"Output",ExpressionUUID->"27cd2f9c-1465-4553-aa88-376ee7ecc47c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<All\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"3393e1e4-bc4a-40b3-a76a-86133d8a83fb"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.3967316208293747`", "0.3967316208293747`"},
    {"0.5821360351208185`", "0.5821360351208186`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"63206faa-58c9-4395-812f-630351b6264a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<Dynamic\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"fdccd8bf-b8f4-4706-a0c0-073e562863e5"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1.`", "1.`"},
    {"1.`", "1.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"7e85db6a-7270-4f44-a1c8-fcec85c5c676"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"dynamicShifts", ".", "#"}], "]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], ")"}], "&"}], "[", 
     RowBox[{"shifts", "[", 
      RowBox[{"\"\<Axial\>\"", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"b996afba-2344-46bb-b1e0-0e43a82b0974"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.7848695722465859`", "0.784869572246586`"},
    {"0.7985730121263523`", "0.7985730121263522`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$]]]], \
"Output",ExpressionUUID->"6c85f26d-eaca-4fa2-a841-d3c2b29ce4c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"dynamicShifts", ".", 
      RowBox[{"Transpose", "[", "dynamicShifts", "]"}]}], "-", 
     RowBox[{"IdentityMatrix", "[", "1024", "]"}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"8f9ae3cd-0ee3-474c-a637-bdabb249987c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1048576"}], "}"}], 
  "}"}]], "Output",ExpressionUUID->"4b791c53-69b7-4e5d-8251-09a5806b6874"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"shifts", "[", 
    RowBox[{"\"\<Dynamic\>\"", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"{", ".05", "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"770947f2-51a0-402a-9e5d-f2552a61e205"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Junk", "Section",ExpressionUUID->"6058e0d4-29e9-4c0b-bf03-5f86a5a84b13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phases", "=", 
  RowBox[{"centerPhases", "[", 
   RowBox[{"centerSUMatrix", "[", 
    RowBox[{"1", ",", "3"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"277532bf-3deb-4fef-b6d6-67aa25160b1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "\[Pi]"}], "3"], ",", 
   FractionBox[
    RowBox[{"2", " ", "\[Pi]"}], "3"], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "\[Pi]"}], "3"]}]}], 
  "}"}]], "Output",ExpressionUUID->"c4d7d41f-7fb0-484a-8040-30f1f337dd26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"phases", ",", "16"}], 
  "]"}]], "Input",ExpressionUUID->"4078f171-a99e-4a43-b33a-fc161e2f414e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.09439510239319549230842892218633613323`16.", ",", 
   "2.09439510239319549230842892218633613323`16.", ",", 
   RowBox[{"-", "4.18879020478639098461685784437267226645`16."}]}], 
  "}"}]], "Output",ExpressionUUID->"0153f11a-8163-4830-ba94-7243d453d797"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"lineLinks", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"e7cf3e5c-b44d-4718-be51-22cf4ce78c61"],

Cell[BoxData[
 RowBox[{"Only", " ", "place", " ", "where", " ", 
  RowBox[{"plotAction", "[", "]"}], " ", "is", " ", 
  RowBox[{
  "called", 
   "."}]}]], "Input",ExpressionUUID->"40fc700c-7eab-4933-bf2c-3b2f5f37a662"],

Cell[BoxData[
 RowBox[{"plotAction", "[", 
  RowBox[{"1", ",", "2", ",", "3", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"4", " ", 
      RowBox[{
       RowBox[{"nc", "^", "2"}], "/", "3"}]}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"c052c00b-f1d9-46f0-bd23-1bb2d83bdd87"],

Cell[BoxData[
 RowBox[{"latticeSaddlePoint", "[", "5", 
  "]"}]], "Input",ExpressionUUID->"73683594-847e-4113-a0a3-576649dddedb"],

Cell[BoxData[
 RowBox[{"stats", "=", 
  RowBox[{
  "latticeSaddlePoint", "[", "50", 
   "]"}]}]], "Input",ExpressionUUID->"b240671b-9f8c-40a1-94c1-8cac5fe8a9d1"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], "]"}], "]"}], "&"}], ",", "stats"}], 
   "]"}], "]"}]], \
"Input",ExpressionUUID->"77eed4f3-7414-4960-b3f4-a9e7e68ef686"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"norm", "/.", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
         "]"}]}]}], "}"}], "&"}], ",", "stats"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"570da784-b5f8-447e-9c5f-47ec6ef5f759"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"aw", "/.", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
         "]"}]}]}], "}"}], "&"}], ",", "stats"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"cfd0fd2f-fb03-41e1-9542-3f338b342f15"],

Cell[BoxData[
 RowBox[{"stats", "=", 
  RowBox[{
  "latticeSaddlePoint", "[", "14", 
   "]"}]}]], "Input",ExpressionUUID->"2b12fb8b-143a-4ca9-a9a3-23fbc0a68389"],

Cell["Save resulting lattice", \
"Text",ExpressionUUID->"a97e92d4-94bc-4489-bbcb-0ef6337b72fa"],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{"\"\<periodic-3-3-22-42-1-fastcool.m\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "nd", ",", "nc", ",", "beta", ",", "latticeDimensions", ",", 
     "latticeLayout", ",", "gaugeField", ",", "linearSiteIndex"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"a18df784-83d1-4e71-bbd0-bf1f9ac17071"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{985, 642},
WindowMargins->{{59, Automatic}, {Automatic, 30}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]

