(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25002,        674]
NotebookOptionsPosition[     21832,        614]
NotebookOutlinePosition[     22171,        629]
CellTagsIndexPosition[     22128,        626]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Coulomb potential", "Title",
 CellChangeTimes->{{3.790812209407577*^9, 
  3.790812237291781*^9}},ExpressionUUID->"0649c7b1-f7b6-405d-8336-\
3374adcfcfe9"],

Cell["\<\
Abelian theory U(1) energy associated with a Wilson loop or pair of Polyakov \
loops.  Using formula on p. 261 or Jackson E&M.\
\>", "Text",
 CellChangeTimes->{{3.790812240218306*^9, 3.790812301933989*^9}, {
  3.790812332229616*^9, 
  3.7908123743367662`*^9}},ExpressionUUID->"024ebba7-3bcb-4595-b5f1-\
2305ff4fd40d"],

Cell["\<\
Pair of Polyakov loops, separation r, box length ll. Lower cutoff eps, upper \
cutoff.  One current is integrated over the size of the box, but the other \
goes off to infinity, representing the field effects from the periodic \
boundary conditions.The upper cutoff should cancel.\
\>", "Text",
 CellChangeTimes->{{3.790812307234522*^9, 3.790812329830674*^9}, {
  3.790813257532969*^9, 3.7908132683548822`*^9}, {3.79081338491359*^9, 
  3.790813410574812*^9}, {3.790814103223621*^9, 3.7908141686765623`*^9}, {
  3.790979995641047*^9, 
  3.790979996541913*^9}},ExpressionUUID->"22d43f03-e791-458a-85f8-\
17f583500e24"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exprp", "=", 
  RowBox[{"(*", " ", 
   RowBox[{"Self", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"y", "-", "x"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "ll"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"x", "+", "eps"}], ",", "upper"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"eps", ">", "0"}], ",", 
         RowBox[{"upper", ">", "0"}], ",", 
         RowBox[{"ll", ">", "0"}], ",", 
         RowBox[{"upper", ">", 
          RowBox[{"eps", "+", "ll"}]}]}], "}"}]}]}], "]"}]}], "-", 
   RowBox[{"2", "*", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y", "-", "x"}], ")"}], "^", "2"}], "+", 
         RowBox[{"r", "^", "2"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "ll"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "x", ",", "upper"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"eps", ">", "0"}], ",", 
         RowBox[{"upper", ">", "0"}], ",", 
         RowBox[{"ll", ">", "0"}], ",", 
         RowBox[{"upper", ">", 
          RowBox[{"eps", "+", "ll"}]}], ",", 
         RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7908123904534883`*^9, 3.7908123910807543`*^9}, {
  3.7908129723194036`*^9, 3.790813213270533*^9}, {3.790813252360138*^9, 
  3.790813252983933*^9}, {3.790813298875525*^9, 3.790813299477984*^9}, {
  3.79081335612222*^9, 3.790813377540638*^9}, {3.790813878098014*^9, 
  3.7908138834678507`*^9}, {3.791391270587164*^9, 
  3.7913912713715076`*^9}},ExpressionUUID->"597cd3fe-a037-40df-8adb-\
0f49c9884800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"upper", " ", 
      RowBox[{"Log", "[", 
       FractionBox["upper", 
        RowBox[{
         RowBox[{"-", "ll"}], "+", "upper"}]], "]"}]}], "+", 
     RowBox[{"ll", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"Log", "[", "eps", "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"-", "ll"}], "+", "upper"}], "]"}]}], ")"}]}]}], ")"}]}], 
  "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["upper", "2"]}]]}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["ll", "2"], "+", 
       SuperscriptBox["r", "2"], "-", 
       RowBox[{"2", " ", "ll", " ", "upper"}], "+", 
       SuperscriptBox["upper", "2"]}]], "-", 
     RowBox[{"upper", " ", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"-", "upper"}], "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["upper", "2"]}]]}], "]"}]}], "+", 
     RowBox[{"ll", " ", 
      RowBox[{"Log", "[", 
       FractionBox["r", 
        RowBox[{"ll", "-", "upper", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["ll", "2"], "+", 
           SuperscriptBox["r", "2"], "-", 
           RowBox[{"2", " ", "ll", " ", "upper"}], "+", 
           SuperscriptBox["upper", "2"]}]]}]], "]"}]}], "+", 
     RowBox[{"upper", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"ll", "-", "upper", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["ll", "2"], "+", 
          SuperscriptBox["r", "2"], "-", 
          RowBox[{"2", " ", "ll", " ", "upper"}], "+", 
          SuperscriptBox["upper", "2"]}]]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.790813154270589*^9, 3.7908133924175673`*^9, 3.7908135374944887`*^9, 
   3.7908138151553993`*^9, 3.790813896163065*^9, {3.791391273409266*^9, 
   3.791391301325862*^9}},ExpressionUUID->"31b93e6c-81cf-4843-88e4-\
f1b2cddc3a79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"Limit", "[", 
       RowBox[{"exprp", ",", 
        RowBox[{"upper", "\[Rule]", "Infinity"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"eps", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eps", ">", "0"}], ",", 
      RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.790813493817404*^9, 3.790813502564653*^9}, {
  3.79081384783613*^9, 
  3.790813947877891*^9}},ExpressionUUID->"e944391b-42fe-444d-94c4-\
b6d0fe59dfd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", "ll", " ", 
  RowBox[{"Log", "[", 
   FractionBox[
    RowBox[{"2", " ", "eps"}], "r"], "]"}]}]], "Output",
 CellChangeTimes->{
  3.790813516427753*^9, 3.790813549932788*^9, 3.790813835521019*^9, {
   3.7908139025924273`*^9, 3.790813950432942*^9}, 
   3.7913913106692553`*^9},ExpressionUUID->"93ba75e2-618c-4985-8d70-\
cc9fd6ab8df2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle", "Section",
 CellChangeTimes->{{3.791037375581409*^9, 
  3.7910373843133793`*^9}},ExpressionUUID->"a84d3c2a-5c87-44a1-8331-\
e5decc44718e"],

Cell["The energy of two currents, length l, separation r.", "Text",
 CellChangeTimes->{{3.7908140035879393`*^9, 3.790814042908709*^9}, {
  3.796508906976131*^9, 
  3.7965089287632303`*^9}},ExpressionUUID->"f3bba52e-4430-4297-aa9d-\
e78d091b6043"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr1", "=", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"x2", "-", "x1"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "0", ",", 
        RowBox[{"l", "-", "eps"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", 
        RowBox[{"x1", "+", "eps"}], ",", "l"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l", ">", "0"}], ",", 
         RowBox[{"eps", ">", "0"}], ",", 
         RowBox[{"eps", "<", "l"}]}], "}"}]}]}], "]"}]}], "-", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}], "^", "2"}], "+", 
        RowBox[{"r", "^", "2"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "0", ",", "l"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "0", ",", "l"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l", ">", "0"}], ",", 
        RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.791391666652857*^9, 3.791391685059746*^9}, {
   3.796508981032935*^9, 3.7965090491505413`*^9}, {3.796509264841423*^9, 
   3.796509266661573*^9}, 
   3.7965093392647533`*^9},ExpressionUUID->"48c1c21c-05b2-4a31-a034-\
fb2512cf2f5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "r"}], "+", 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["l", "2"], "+", 
     SuperscriptBox["r", "2"]}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"eps", "-", "l", "+", 
     RowBox[{"l", " ", 
      RowBox[{"Log", "[", 
       FractionBox["l", "eps"], "]"}]}]}], ")"}]}], "-", 
  RowBox[{"l", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"2", " ", "l", " ", 
       RowBox[{"(", 
        RowBox[{"l", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["l", "2"], "+", 
           SuperscriptBox["r", "2"]}]]}], ")"}]}], 
      SuperscriptBox["r", "2"]]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.79650905506742*^9, 3.796509271241527*^9, 
  3.796509344097435*^9, 3.7965108348623447`*^9, 
  3.796512955718493*^9},ExpressionUUID->"c969c2ac-f451-4e56-8123-\
e96d93154b9c"]
}, Open  ]],

Cell["Normal[Series[ ...]] removes the 4*eps term", "Text",
 CellChangeTimes->{{3.790980667991486*^9, 
  3.790980693581952*^9}},ExpressionUUID->"942f23f4-e216-45c7-9865-\
f33fad28ed46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{"expr1", ",", 
       RowBox[{"{", 
        RowBox[{"eps", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", ">", "0"}], ",", 
       RowBox[{"r", ">", "0"}], ",", 
       RowBox[{"eps", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.790814468917882*^9, 3.790814491296875*^9}, {
   3.790814665360067*^9, 3.79081468043969*^9}, {3.7908156953503437`*^9, 
   3.790815705860203*^9}, {3.790935421415251*^9, 3.79093542299478*^9}, {
   3.7909358655965223`*^9, 3.790935867542748*^9}, {3.7909364223822527`*^9, 
   3.790936465135607*^9}, {3.7909804066152983`*^9, 3.790980431391693*^9}, {
   3.796509289240382*^9, 3.796509304891911*^9}, 
   3.7965093457518473`*^9},ExpressionUUID->"3a714ea0-9a54-4d9a-ad72-\
2832170c8ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "r"}], "+", 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["l", "2"], "+", 
     SuperscriptBox["r", "2"]}]]}], "-", 
  RowBox[{"l", " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", "eps", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", "l", "]"}]}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"2", " ", "l", " ", 
         RowBox[{"(", 
          RowBox[{"l", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["l", "2"], "+", 
             SuperscriptBox["r", "2"]}]]}], ")"}]}], 
        SuperscriptBox["r", "2"]]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.790814493472303*^9, 3.790814688145536*^9, 3.790815707924446*^9, 
   3.790815930622501*^9, 3.790935425441004*^9, 3.790936289851177*^9, {
   3.790936437076991*^9, 3.790936478520049*^9}, 3.790979452021641*^9, 
   3.790980435522694*^9, 3.791037590161704*^9, 3.7913015975944033`*^9, 
   3.79650930734993*^9, 3.796509347983131*^9, 3.796510838823948*^9, 
   3.796512959010491*^9},ExpressionUUID->"a68bc05a-6e82-4ab8-813b-\
12445b947deb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr22", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"eta", "-", " ", "r", "-", "l", "-", 
      RowBox[{"l", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"eps", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"eta", "+", "l"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"l", "*", "r"}], ")"}]}]}], "]"}]}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7909365089477997`*^9, 3.7909365691791286`*^9}, {
   3.790979497518118*^9, 3.7909795006352167`*^9}, {3.790980458993312*^9, 
   3.790980459990182*^9}, {3.791037528005978*^9, 3.791037574449028*^9}, {
   3.791038168893717*^9, 3.7910382570040283`*^9}, 3.796509394750889*^9, {
   3.796509446658046*^9, 3.7965094763972387`*^9}, {3.796509532818759*^9, 
   3.796509571221096*^9}, {3.796509619836412*^9, 3.7965096221687183`*^9}, {
   3.7965096817995377`*^9, 3.796509683706806*^9}, {3.79650973099015*^9, 
   3.796509731863121*^9}, {3.796509768233614*^9, 3.796509833102644*^9}, {
   3.796509906093383*^9, 3.796509961759451*^9}, {3.7965100751004267`*^9, 
   3.796510096071719*^9}, {3.7965101325998383`*^9, 
   3.7965101430899363`*^9}},ExpressionUUID->"aca47611-37aa-4e3e-b242-\
688c87b64e23"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{"eta", "-", "l", "-", "r", "-", 
    RowBox[{"l", " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"eps", " ", 
        RowBox[{"(", 
         RowBox[{"eta", "+", "l"}], ")"}]}], 
       RowBox[{"l", " ", "r"}]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7909365712994204`*^9, 3.790979502018869*^9, 3.790980460914791*^9, 
   3.7910375948541107`*^9, 3.791038264224126*^9, 3.796509490645403*^9, {
   3.796509535407531*^9, 3.796509571724977*^9}, 3.796509623741193*^9, 
   3.796509684676214*^9, 3.796509732566811*^9, 3.796509771207505*^9, 
   3.796509805204934*^9, 3.796509837088483*^9, 3.7965099225411863`*^9, 
   3.796509962583132*^9, 3.7965100969773407`*^9, 3.796510143804291*^9, 
   3.7965108454378643`*^9, 
   3.796512963824547*^9},ExpressionUUID->"b980802d-ea3b-44f2-92a7-\
6c57ba8b59cf"]
}, Open  ]],

Cell["The two expressions are the same :", "Text",
 CellChangeTimes->{{3.790936684955879*^9, 
  3.790936694895823*^9}},ExpressionUUID->"c33498fa-7dcd-4a15-ba08-\
4cc139cc267b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"expr22", "//.", 
      RowBox[{"eta", "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"l", "^", "2"}], "+", 
         RowBox[{"r", "^", "2"}]}], "]"}]}]}], ")"}], "-", "expr2"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l", ">", "0"}], ",", 
      RowBox[{"r", ">", "0"}], ",", 
      RowBox[{"eps", ">", "0"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.790936575932702*^9, 3.7909366553255367`*^9}, {
  3.790936697842058*^9, 3.7909367014193697`*^9}, {3.791037691260037*^9, 
  3.791037692066155*^9}, {3.791037740712141*^9, 3.7910377685380697`*^9}, {
  3.791037800710927*^9, 3.7910378403608*^9}, {3.791038269584263*^9, 
  3.791038275786118*^9}, {3.796509430214973*^9, 3.796509442905096*^9}, {
  3.796509485163178*^9, 
  3.796509497282709*^9}},ExpressionUUID->"8a5d65d4-87a6-4097-ba56-\
9695f0bf1734"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7909365995667753`*^9, 3.790936618538678*^9}, {
   3.790936648702433*^9, 3.790936669393753*^9}, 3.7909367021895723`*^9, 
   3.790979505392583*^9, 3.790980463591069*^9, 3.791037603979424*^9, 
   3.791037693179883*^9, 3.7910377724893723`*^9, {3.791037831429096*^9, 
   3.7910378428144493`*^9}, 3.7910382777625713`*^9, 3.796509508001202*^9, {
   3.7965095398082952`*^9, 3.7965095760701733`*^9}, 3.796509627167617*^9, 
   3.796509688571217*^9, 3.79650973674622*^9, 3.796509774697406*^9, 
   3.796509966768036*^9, 3.796510100479298*^9, 3.796510148825542*^9, 
   3.796510849783264*^9, 
   3.796512966757725*^9},ExpressionUUID->"8d6e1249-5ef7-4ec9-a70c-\
2f05817907b6"]
}, Open  ]],

Cell["Compare with library routine :", "Text",
 CellChangeTimes->{{3.791301262212763*^9, 
  3.791301275758687*^9}},ExpressionUUID->"a4ca6ca1-7522-4ca1-9a8b-\
821a238e0887"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/lattice.m\>\""}], ";"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"expr2", "-", 
    RowBox[{"wilsonCoulomb", "[", 
     RowBox[{"False", ",", "l", ",", "r", ",", "eps"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eps", ">", "0"}], ",", 
      RowBox[{"l", ">", "0"}], ",", 
      RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.791301234406117*^9, 3.7913012429515133`*^9}, {
   3.791301314372394*^9, 3.791301316893875*^9}, 3.791301446180972*^9, {
   3.791301568777711*^9, 3.791301578947928*^9}, {3.796510660756531*^9, 
   3.796510691413353*^9}},ExpressionUUID->"70d42ac9-bf48-4c6d-b2d0-\
63e654289e34"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.79651069866817*^9, 3.7965108539407053`*^9, 
  3.7965129762854013`*^9},ExpressionUUID->"029d8eeb-ec80-460e-b9c2-\
ed9113a6d7d4"]
}, Open  ]],

Cell["The potential of a square:  ", "Text",
 CellChangeTimes->{{3.796511348788352*^9, 
  3.796511389694062*^9}},ExpressionUUID->"9817395b-39ed-4a7c-b2d0-\
bf4efc02f81f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exprww", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"expr2", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", "\[Rule]", "w"}], ",", 
       RowBox[{"r", "\[Rule]", "w"}], ",", 
       RowBox[{"eps", "\[Rule]", 
        RowBox[{"eps2", " ", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"Sqrt", "[", "2", "]"}], "-", "2"}], "]"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"3", "+", 
            RowBox[{"Sqrt", "[", "8", "]"}]}], "]"}]}]}]}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w", ">", "0"}], ",", 
       RowBox[{"eps", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.790814983146084*^9, 3.790815075933975*^9}, {
   3.790815121743819*^9, 3.790815123009687*^9}, 3.790815191656151*^9, {
   3.790815221810063*^9, 3.790815241783812*^9}, {3.790815285296525*^9, 
   3.790815302552373*^9}, {3.790815889756328*^9, 3.790815963429247*^9}, {
   3.79081599619308*^9, 3.790816010992402*^9}, 3.790979624007975*^9, {
   3.790979690222742*^9, 3.790979700734888*^9}, {3.790979796304173*^9, 
   3.7909798064281797`*^9}, {3.790979843088645*^9, 3.790979851022513*^9}, {
   3.790979899735868*^9, 3.790979930928417*^9}, {3.790980482310831*^9, 
   3.790980542176816*^9}, {3.790980609916829*^9, 3.7909806239717493`*^9}, {
   3.796511316569119*^9, 
   3.7965113266541224`*^9}},ExpressionUUID->"5fc6efb6-dc55-4df7-8685-\
be33c33337b2"],

Cell[BoxData[
 RowBox[{"2", " ", "w", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Log", "[", "eps2", "]"}]}], "+", 
    RowBox[{"Log", "[", "w", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.790815003331501*^9, 3.790815076806334*^9}, 
   3.790815123878639*^9, 3.7908151937961197`*^9, 3.790815303735619*^9, {
   3.790815882515717*^9, 3.7908159123317347`*^9}, {3.790815954211738*^9, 
   3.7908159642602987`*^9}, {3.7908160071480913`*^9, 3.7908160119661217`*^9}, 
   3.790859575764092*^9, 3.790979530896818*^9, 3.790979626077828*^9, 
   3.790979703889763*^9, {3.790979800052122*^9, 3.7909798074373426`*^9}, 
   3.790979852581833*^9, {3.7909799134748583`*^9, 3.790979931889423*^9}, 
   3.790980484281785*^9, 3.790980625090064*^9, 3.79651133862624*^9, 
   3.796512990064858*^9},ExpressionUUID->"54ee1a6a-0ed8-4e73-89fe-\
fbcb9830dff1"]
}, Open  ]],

Cell["\<\
Plot difference between discrete and continuous versions, showing they are \
qualitatively similar up to a perimeter term and a normalization constant:\
\>", "Text",
 CellChangeTimes->{{3.796514071312591*^9, 
  3.796514136642919*^9}},ExpressionUUID->"5eb45f54-9606-4873-8526-\
424b8245eff3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mma-lib/point-potential3.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.7965132475438423`*^9, 
  3.796513264172673*^9}},ExpressionUUID->"beef8753-ec51-4b30-9730-\
f4afb8309e5f"],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{
            RowBox[{"5", " ", 
             RowBox[{"wilsonCoulomb", "[", 
              RowBox[{"True", ",", "i", ",", "j"}], "]"}]}], "-", 
            RowBox[{"3", " ", "i"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"wilsonCoulomb", "[", 
            RowBox[{"False", ",", "i", ",", "j"}], "]"}]}], "}"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "20"}], "}"}]}], "]"}], ",", "1"}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.796513520142131*^9, 3.7965135996694117`*^9}, {
  3.796513646889883*^9, 3.796513705002152*^9}, {3.796513744791898*^9, 
  3.796513781114627*^9}, {3.7965138293423777`*^9, 
  3.796513829560605*^9}},ExpressionUUID->"0724e862-fadf-493d-8494-\
a68f8359e5c8"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1067, 673},
WindowMargins->{{68, Automatic}, {0, Automatic}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 98, "Title",ExpressionUUID->"0649c7b1-f7b6-405d-8336-3374adcfcfe9"],
Cell[743, 27, 327, 7, 35, "Text",ExpressionUUID->"024ebba7-3bcb-4595-b5f1-2305ff4fd40d"],
Cell[1073, 36, 626, 11, 58, "Text",ExpressionUUID->"22d43f03-e791-458a-85f8-17f583500e24"],
Cell[CellGroupData[{
Cell[1724, 51, 2020, 53, 101, "Input",ExpressionUUID->"597cd3fe-a037-40df-8adb-0f49c9884800"],
Cell[3747, 106, 2117, 64, 185, "Output",ExpressionUUID->"31b93e6c-81cf-4843-88e4-f1b2cddc3a79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5901, 175, 685, 19, 31, "Input",ExpressionUUID->"e944391b-42fe-444d-94c4-b6d0fe59dfd9"],
Cell[6589, 196, 384, 10, 53, "Output",ExpressionUUID->"93ba75e2-618c-4985-8d70-cc9fd6ab8df2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7010, 211, 156, 3, 68, "Section",ExpressionUUID->"a84d3c2a-5c87-44a1-8331-e5decc44718e"],
Cell[7169, 216, 246, 4, 35, "Text",ExpressionUUID->"f3bba52e-4430-4297-aa9d-e78d091b6043"],
Cell[CellGroupData[{
Cell[7440, 224, 1497, 43, 55, "Input",ExpressionUUID->"48c1c21c-05b2-4a31-a034-fb2512cf2f5b"],
Cell[8940, 269, 934, 30, 76, "Output",ExpressionUUID->"c969c2ac-f451-4e56-8123-e96d93154b9c"]
}, Open  ]],
Cell[9889, 302, 185, 3, 35, "Text",ExpressionUUID->"942f23f4-e216-45c7-9865-f33fad28ed46"],
Cell[CellGroupData[{
Cell[10099, 309, 976, 22, 31, "Input",ExpressionUUID->"3a714ea0-9a54-4d9a-ad72-2832170c8ebc"],
Cell[11078, 333, 1226, 34, 90, "Output",ExpressionUUID->"a68bc05a-6e82-4ab8-813b-12445b947deb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12341, 372, 1252, 26, 31, "Input",ExpressionUUID->"aca47611-37aa-4e3e-b242-688c87b64e23"],
Cell[13596, 400, 881, 20, 54, "Output",ExpressionUUID->"b980802d-ea3b-44f2-92a7-6c57ba8b59cf"]
}, Open  ]],
Cell[14492, 423, 176, 3, 35, "Text",ExpressionUUID->"c33498fa-7dcd-4a15-ba08-4cc139cc267b"],
Cell[CellGroupData[{
Cell[14693, 430, 985, 24, 31, "Input",ExpressionUUID->"8a5d65d4-87a6-4097-ba56-9695f0bf1734"],
Cell[15681, 456, 712, 11, 35, "Output",ExpressionUUID->"8d6e1249-5ef7-4ec9-a70c-2f05817907b6"]
}, Open  ]],
Cell[16408, 470, 172, 3, 35, "Text",ExpressionUUID->"a4ca6ca1-7522-4ca1-9a8b-821a238e0887"],
Cell[CellGroupData[{
Cell[16605, 477, 764, 18, 55, "Input",ExpressionUUID->"70d42ac9-bf48-4c6d-b2d0-63e654289e34"],
Cell[17372, 497, 177, 3, 35, "Output",ExpressionUUID->"029d8eeb-ec80-460e-b9c2-ed9113a6d7d4"]
}, Open  ]],
Cell[17564, 503, 170, 3, 35, "Text",ExpressionUUID->"9817395b-39ed-4a7c-b2d0-bf4efc02f81f"],
Cell[CellGroupData[{
Cell[17759, 510, 1515, 34, 55, "Input",ExpressionUUID->"5fc6efb6-dc55-4df7-8685-be33c33337b2"],
Cell[19277, 546, 857, 16, 35, "Output",ExpressionUUID->"54ee1a6a-0ed8-4e73-89fe-fbcb9830dff1"]
}, Open  ]],
Cell[20149, 565, 301, 6, 58, "Text",ExpressionUUID->"5eb45f54-9606-4873-8526-424b8245eff3"],
Cell[20453, 573, 224, 5, 31, "Input",ExpressionUUID->"beef8753-ec51-4b30-9730-f4afb8309e5f"],
Cell[20680, 580, 1124, 30, 78, "Input",ExpressionUUID->"0724e862-fadf-493d-8494-a68f8359e5c8"]
}, Open  ]]
}, Open  ]]
}
]
*)

